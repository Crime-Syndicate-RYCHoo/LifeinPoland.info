function ManageSession(){var n=function(n){var i,t;if(n||(n=window.event),n.newValue)if(n.key=="getSessionStorage")localStorage.setItem("sessionStorage",JSON.stringify(sessionStorage)),localStorage.removeItem("sessionStorage");else if(n.key=="sessionStorage"&&!sessionStorage.length){i=JSON.parse(n.newValue);for(t in i)(t=="Istooltipclosed"||t=="IsFAQVA_ClosedbyCustomer")&&sessionStorage.setItem(t,i[t])}};window.addEventListener?window.addEventListener("storage",n,!1):window.attachEvent("onstorage",n);sessionStorage.length||(localStorage.setItem("getSessionStorage","contactSession"),localStorage.removeItem("getSessionStorage","contactSession"))}function InitVA(n,t){ManageSession();var i="",r="";n.toLowerCase()=="ips"||n.toLowerCase()=="dep"?(window.location.href.indexOf("/servicetag")>-1?r="tag":window.location.href.indexOf("product-support/product")>-1&&(r="lob"),i=VAUrl+"?appname="+n+"&route="+r):i=VAUrl+"?appname="+n;i=i+"&isDDS=true";supportOrderNumber!=""&&(i=i+"&ordernumber="+supportOrderNumber);fetch(i,{method:"GET",headers:{"X-Robots-Tag":"noindex"}}).then(n=>n.json()).then(i=>{i.IsUnifiedAI?(loadFile(i.UnifiedMFEJs),document.querySelector("#"+t).innerHTML=i.Html,loadFile(i.UnifiedAISfdcJs)):(document.querySelector("#"+t).innerHTML=i.Html,i.Html!=null&&i.Html!=""&&i.Html!=undefined&&(i.IsDAEnabled?(sessionStorage.setItem("DAInActiveTime",i.DAInActiveTime),startDA(i,n)):startVA(i,n)))}).catch(()=>{console.error("FAQ BOT init error")})}function startVA(n,t){if(popOverCloseEle=undefined,n==null||n.IsEmcUserLoggedIn==!0||n.IsEmcProduct)document.getElementById("Chat-icon").style.display="none";else{setTimeout(function(){var o,r,e;document.getElementById("Chat-icon").style.visibility="hidden";o=document.getElementById("popover-191977210");popOverApi=DDS.Popover(o);document.getElementById("popover-title-935013565").innerHTML=n.TooltipTitle;document.getElementById("dds-popover-body").innerHTML=n.TooltipDesc;popOverCloseEle=document.getElementById("va_popover_container").getElementsByClassName("dds__popover__close");popOverCloseEle&&popOverCloseEle!=null&&popOverCloseEle!=undefined&&popOverCloseEle.length>0&&(popOverCloseEle[0].setAttribute("tabindex","-1"),popOverCloseEle[0].setAttribute("aria-label","Dismiss Virtual Assistant"));setTimeout(function(){sessionStorage.getItem("Istooltipclosed")=="true"?popOverApi.close():popOverApi.open();popOverCloseEle&&popOverCloseEle!=null&&popOverCloseEle!=undefined&&popOverCloseEle.length>0&&popOverCloseEle[0].addEventListener("click",function(){sessionStorage.setItem("Istooltipclosed","true")});document.getElementById("Chat-icon").style.visibility="visible"},0);r=sessionStorage.getItem("DriverScanData");typeof r!="undefined"&&r!=null&&r!=""&&(e=n.SfdcCoreUrl,u(e)||t!="IPS"&&t!="DEP"||loadFile(e));(sessionStorage.getItem("IsFAQVA_ClosedbyCustomer")==null||sessionStorage.getItem("IsFAQVA_ClosedbyCustomer")=="false")&&(WPILoadTime2=n.WPILoadTime2,setTimeout(function(){wpiCallCount=1;document.querySelector("div#divVA_"+t+".d-none")||f()},n.WPILoadTime));i("222.900.100.300","Chatbotoffered:")},n.VALoadTime);function i(n,i){var r=0,u=window.setInterval(function(){r+=1e3;typeof dellmetricsTrack=="function"&&(dellmetricsTrack(n,i+t),window.clearInterval(u));r>=3e3&&window.clearInterval(u)},1e3)}document.getElementById("Chat-icon").addEventListener("click",function(){r()});document.getElementById("chatbuttonid").addEventListener("mouseenter",function(){popOverApi.open()});document.getElementById("chatbuttonid").addEventListener("mouseleave",function(){});document.getElementById("chatbuttonid").addEventListener("focus",function(){popOverApi.open()});function r(){document.getElementById("Chat-icon").style.visibility="hidden";popOverApi.close();var t=n.SfdcCoreUrl;u(t)?startFaqSprinklrChat(n.AppName):loadFile(t,function(){startFaqSprinklrChat(n.AppName)})}function u(n){return Boolean(document.querySelector('script[src="'+n+'"]'))}function f(){try{if(visitor_id=getVisitorId("s_ecid"),visitor_id!=null&&visitor_id!=""){var f={visitor_id:visitor_id,appName:t},n=new XMLHttpRequest;n.open("POST",WPIurl,!0);n.setRequestHeader("Content-Type","application/json; charset=UTF-8");n.onload=function(){if(this.status>=200){var n=this.response;n!=null&&n!=undefined?(n=JSON.parse(n),sessionStorage.setItem("IsFAQVA_LaunchedbyWPI","false"),sessionStorage.removeItem("IsFAQVA_IssueValueWPI"),n.isfaqLaunch.toLowerCase()=="true"?document.querySelector("#sprinklrChatDom")==null?(WpiLogsToSplunk("Wpi_True",n.message,n.serivceTag),sessionStorage.setItem("IsFAQVA_LaunchedbyWPI","true"),sessionStorage.setItem("IsFAQVA_IssueValueWPI",n.wpiWithContextIssueType),sessionStorage.setItem("IsFAQVA_ClosedbyCustomer","false"),i("222.830.810.550","proactivebotoffered:"),r()):WpiLogsToSplunk("Wpi_Customer_click","VA_already_Opened",n.serivceTag):n.isfaqLaunch.toLowerCase()=="false"&&WpiLogsToSplunk("Wpi_False",n.message,n.serivceTag)):WpiLogsToSplunk("Wpi_response_Null")}else WpiLogsToSplunk("Wpi_wrongStatus_"+this.status)};n.onerror=function(n){console.error("Error in wpicall ajax Call > Error: "+JSON.stringify(n));WpiLogsToSplunk("Wpi_Error_"+JSON.stringify(n))};n.send(JSON.stringify(f))}}catch(u){console.error("Exception in wpicall > Error: "+JSON.stringify(u));WpiLogsToSplunk("Wpi_ex_"+JSON.stringify(u))}}}}function getVisitorId(n){for(var r,t,u=null,f=document.cookie.split(";"),i=0;i<f.length;i++)if(r=f[i].split("="),n==r[0].trim())return t=decodeURIComponent(r[1]).split("|"),t!==null&&t!==undefined&&(u=t[1]),u;return null}function WpiLogsToSplunk(n,t="",i=""){var r,u;try{r="https://www.dell.com/support/onlineapi/no-result-found/wpicall.html";r+="?methodName="+n+"&vID="+visitor_id+"&appName="+appName;t!=""&&(r+="&msg="+t);i!=""&&(r+="&sTag="+i);Dell&&Dell.OnlineUtils&&Dell.OnlineUtils.Lwp&&Dell.OnlineUtils.Lwp!=undefined&&Dell.OnlineUtils.Lwp.country&&(r+="&country="+Dell.OnlineUtils.Lwp.country);u=new XMLHttpRequest;u.open("GET",r,!0);u.setRequestHeader("X-Requested-With","XMLHttpRequest");u.send()}catch(f){console.error("Exception in posting WpiLogsToSplunk: "+JSON.stringify(f))}}function startDA(n,t){if(popOverCloseEle=undefined,n!=null&&n.IsEmcUserLoggedIn!=!0&&!n.IsEmcProduct){clearTimeout(startDATimer);LogCaseDAinit("DA_Enabled",n.ServiceTag);startDATimer=setTimeout(function(){document.getElementById("Chat-icon").style.visibility="hidden";i("222.950.210.310","DAOffered");t=document.querySelectorAll("[id*='divVA_']")[0].getAttribute("data-appname");const r=document.getElementById("Chat-icon"),f=document.getElementById("da-chat-window");var u;u=document.getElementById("popover-191977210");popOverApi=DDS.Popover(u);document.getElementById("popover-title-935013565").innerHTML=n.TooltipTitle;document.getElementById("dds-popover-body").innerHTML=n.TooltipDesc;popOverCloseEle=document.getElementById("va_popover_container").getElementsByClassName("dds__popover__close");popOverCloseEle&&popOverCloseEle!=null&&popOverCloseEle!=undefined&&popOverCloseEle.length>0&&(popOverCloseEle[0].setAttribute("tabindex","-1"),popOverCloseEle[0].setAttribute("aria-label","Dismiss Virtual Assistant"));setTimeout(function(){sessionStorage.getItem("Istooltipclosed")=="true"?popOverApi.close():popOverApi.open();popOverCloseEle&&popOverCloseEle!=null&&popOverCloseEle!=undefined&&popOverCloseEle.length>0&&popOverCloseEle[0].addEventListener("click",function(){sessionStorage.setItem("Istooltipclosed","true")});document.getElementById("Chat-icon").style.visibility="visible"},0);r.addEventListener("click",function(){r.classList.add("d-none");f.classList.replace("d-none","d-block");getDA(t,n.ServiceTag)})},n.VALoadTime);function i(n,i){var r=0;let u=setInterval(function(){r+=1;typeof dellmetricsTrack=="function"&&(clearInterval(u),dellmetricsTrack(n,i+t));r>=6&&clearInterval(u)},5e3)}document.getElementById("chatbuttonid").addEventListener("mouseenter",function(){popOverApi.open()});document.getElementById("chatbuttonid").addEventListener("mouseleave",function(){popOverApi.close()});document.ready(function(){document.getElementById("daChatContent").parent().css({"background-color":"#D9F5FD"});document.getElementById("hdnLoggedInUser").value=n.LoggedInUserName})}}async function daBotAJAX(n){var r="",t;Dell&&Dell.OnlineUtils&&Dell.OnlineUtils.Lwp&&Dell.OnlineUtils.Lwp!=undefined&&Dell.OnlineUtils.Lwp.country&&(r+=Dell.OnlineUtils.Lwp.language+"-"+Dell.OnlineUtils.Lwp.country);daInitObject=DAObjectGetFromSession();t={};t=daInitObject.IsDaCarebot==!0?{customData:{context_conversation:"CARE",order_number:daInitObject.OrderNumber},userInput:n,uneeqSessionId:daInitObject.Guid,CountryCode:r}:{sid:"SESSION-ID",customData:{context_conversation:"CSGTechSupport",personaID:"",current_appid:"",system_name:daInitObject.Servicetag,product_name:daInitObject.ProductName,product_type:daInitObject.ProductGroup,user_info:["",""],customer_id:[0x7efc312fa230,0x7efc312fa270],prompt_template:"",locale_lang:"en-US",mode:"text"},userInput:n,conversationPayload:"{}",type:"QUESTION",uneeqSessionId:daInitObject.Guid,userLocale:"en-US",userLocation:"US"};const u=document.getElementById("da-ai-data-processing"),i=document.getElementById("da-chat-history");i.classList.add("pb-10");u.classList.remove("d-none");i.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"});try{const n=await fetch(daInitObject.DaTechSupportUrl,{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}});if(u.classList.add("d-none"),i.classList.remove("pb-10"),n.ok)return await n.json();console.error("Failed to get DA GenAI data")}catch(f){LogCaseDAinit("daBotAJAX",daInitObject.Servicetag,"",f);console.error(f)}return null}function daDellMetrics(n,t){typeof dellmetricsTrack=="function"&&dellmetricsTrack&&dellmetricsTrack(n,t)}async function getDA(n,t){const i=document.getElementById("da-loading"),r=document.getElementById("da-main-chat-section");var u="https://www.dell.com/support/guidedpath/guidedPath/getda?appName="+n;supportOrderNumber!=""&&(u=u+"&ordernumber="+supportOrderNumber);try{const f=await fetch(u,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!f.ok){LogCaseDAinit("getDA_Failed",t,"",f);console.error("Failed to get DA");i.classList.replace("d-flex","d-none");document.getElementById("Chat-icon").classList.remove("d-none");document.getElementById("da-chat-window").classList.replace("d-block","d-none");return}const n=await f.json();if(n&&n.Html){LogCaseDAinit("getDA_Success",t);daDellMetrics("222.950.210.311","DAClick");r.innerHTML="";r.innerHTML=n.Html;const u=document.createElement("script");u.setAttribute("type","text/javascript");u.setAttribute("src",n.DaCoreUrl);DAObjectSaveToSession(n);u.onload=function(){SaveSnapinDataToDaObject(n.Servicetag)};r.appendChild(u);const f=new Date,e=f.getMonth()+1+"/"+f.getDate()+"/"+f.getFullYear(),o=f.toLocaleTimeString(),s=document.getElementById("da-start-timestamp");s.innerHTML=`${e}&nbsp;${o}`;i.classList.replace("d-flex","d-none");r.classList.replace("d-none","d-flex")}else LogCaseDAinit("getDA_None",t),i.classList.replace("d-flex","d-none"),document.getElementById("Chat-icon").classList.remove("d-none"),document.getElementById("da-chat-window").classList.replace("d-block","d-none")}catch(f){LogCaseDAinit("getDA_Error",t,"",f);console.error(f);i.classList.replace("d-flex","d-none");document.getElementById("Chat-icon").classList.remove("d-none");document.getElementById("da-chat-window").classList.replace("d-block","d-none")}}function LogCaseDAinit(n="",t,i="",r){var e;try{e="https://www.dell.com/support/onlineapi/no-result-found/daflow.html"+("?methodName="+n+"&sTag="+t+"&msg="+i);var o="",f="",u="";typeof r!="undefined"&&r!==null&&(r.Exception!==undefined&&r.Exception!==null?(f=r.Exception.Code!==undefined?r.Exception.Code:"",u=r.Exception.Message!==undefined?r.Exception.Message:"",o=r.Exception.Type!==undefined?r.Exception.Type:""):r.errorCode!==undefined&&r.errorCode!==null?(f=r.errorCode!==undefined?r.errorCode:"",u=r.message!==undefined?r.message:"",o=r.type!==undefined?r.type:""):r.status!==undefined&&r.status!==null?(f=r.status!==undefined?r.status:"",u=r.statusText!==undefined?r.statusText:""):u=r,e+="&errorCode="+f+"&errorMessage="+u+"&errorType="+o);LogDACaseToSplunk(e)}catch(s){console.error("Exception in posting LogCaseDAinit: "+s)}}function LogDACaseToSplunk(n){try{fetch(n,{method:"get",keepalive:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}})}catch(t){console.error("Exception in posting LogDACaseToSplunk: "+t)}}function DAObjectGetFromSession(){return daInitObjectGlobal=sessionStorage.getItem("daInitObjectSession"),daInitObject=JSON.parse(daInitObjectGlobal)}function DAObjectSaveToSession(n){n&&(daInitObjectGlobal=JSON.stringify(n),sessionStorage.setItem("daInitObjectSession",daInitObjectGlobal))}var VAUrl="https://www.dell.com/support/guidedpath/guidedPath/getva",WPIurl="https://www.dell.com/support/guidedpath/guidedPath/WpiCall",popOverApi,appName="",visitor_id="",WPILoadTime2="",wpiCallCount=0,startDATimer,supportOrderNumber="",daInitObject={},daInitObjectGlobal={},sc;document.querySelector("[id^='divVA_']")&&(appName=document.querySelector("[id^='divVA_']").getAttribute("data-appname"),Dell&&Dell.Metrics&&Dell.Metrics.sc&&(sc=Dell.Metrics.sc),InitVA(appName,"divVA_"+appName));