function GetDriversAlert(){console.log("Get Driver Alerts");driverAlert!==undefined&&driverAlert!==null&&(AlertCore.AppName=driverAlert.dataset.appname);driverAlert&&driverAlert.dataset.ismobile==="False"?typeof clientApi!="undefined"&&typeof window.clientApi.eSupportClientApi!="undefined"?AlertDriverTile.getDriverData(function(n){bindDriversHtml(n)}):Promise.all([AlertCore.renderSaScript(driverAlert.dataset.supportassistconfigurl,"divDriversAlertScripts"),AlertCore.renderSaScript(driverAlert.dataset.dsdapiurlnojq,"divDriversAlertScripts")]).then(()=>{AlertDriverTile.getDriverData(function(n){bindDriversHtml(n)})}).catch(n=>{AlertCore.driversCustomEvent(!1),console.error("eSupportClientApi or SupportAssistClientJson not loaded:",n)}):AlertCore.driversCustomEvent(!1)}function bindDriversHtml(n){try{const t=n.driverData;if(n!=null&&n.isSACommOrNonAdmin!==undefined&&n.isSACommOrNonAdmin==!0){document.getElementById("divDriversAlert").remove();document.getElementById("divDriversAlertScripts").remove();AlertCore.driversCustomEvent(!1);return}let i=!1,r="info",u="4";if(sessionStorage.tagFromSA&&typeof PlatformTag!="undefined"&&sessionStorage.tagFromSA!==PlatformTag)raiseNoSAEvent(),btnPropValue="ScanNow_TagMismatch",AlertCore.logOmniture("222.950.210.342","Offered_TagMismatch");else{const f=Object.values(n.exception).every(n=>n===null||n==="");if(n!=null&&n.isSupportAssistAvailable==!0&&f&&n.hideDriverAlertforWin11==!1&&t)if((t.lastScanDaysPassed===null||t.lastScanDaysPassed==="")&&(t.lastScanRunTime===null||t.lastScanRunTime==="")&&(i=!0),i)raiseNoSAEvent(),btnPropValue="ScanNow_NeverScanned",AlertCore.logOmniture("222.950.210.342","Offered_Never_Scanned");else if(t.lastScanDaysPassed<=7){let n=`${driverAlert.dataset.lastscantxt} ${AlertCore.dateConversion(t.lastScanRunTime)}`;if(t.totalDriverUpdates!==""&&t.totalDriverUpdates>0){let i=[t.critical!==""?`${t.critical} ${driverAlert.dataset.criticaltxt}`:"",t.recommended!==""?`${t.recommended} ${driverAlert.dataset.recommendedtxt}`:""].filter(Boolean).join(", ");i=`${i} ${driverAlert.dataset.availabletxt}`;let f=`${t.totalDriverUpdates} ${driverAlert.dataset.singledriveralert}`;t.totalDriverUpdates>1&&(f=`${t.totalDriverUpdates} ${driverAlert.dataset.multipledriveralert}`);document.getElementById("divDriversSubHeader").textContent=driverAlert.dataset.takeactiontxt;document.getElementById("divDriversSubHeader").ariaLabel=driverAlert.dataset.takeactiontxt;r="critical";u="1";changeDriversContent(f,i,driverAlert.dataset.checkagain,n,"#BB2A33","dds__icon--alert-notice");raiseNoSAEvent();btnPropValue="CheckAgain_Issues";AlertCore.logOmniture("222.950.210.342","Offered_Issues")}else changeDriversContent(driverAlert.dataset.driversuptodate,driverAlert.dataset.noupdatesfounddesc,driverAlert.dataset.checkagain,n,"#4F7D00","dds__icon--task-check"),raiseNoSAEvent(),btnPropValue="CheckAgain_NIssues",AlertCore.logOmniture("222.950.210.342","Offered_Nissues")}else document.getElementById("divDriversSubHeader").textContent=driverAlert.dataset.needattention,document.getElementById("divDriversSubHeader").ariaLabel=driverAlert.dataset.needattention,document.getElementById("divDriversDescription").textContent=driverAlert.dataset.scannowforupdatesdesc,document.getElementById("divDriversDescription").ariaLabel=driverAlert.dataset.scannowforupdatesdesc,document.getElementById("divDriversScanBtnText").textContent=driverAlert.dataset.scanforupdates,document.getElementById("divDriversScanBtnText").ariaLabel=driverAlert.dataset.scanforupdates,raiseNoSAEvent(),btnPropValue="ScanforUpdates_NotScanned",AlertCore.logOmniture("222.950.210.342","Offered_Not_Scanned");else raiseNoSAEvent(),btnPropValue="ScanNow_NoSA",AlertCore.logOmniture("222.950.210.342","Offered_NoSA")}document.getElementById("divDriversAlert").setAttribute("data-alertpriortity",u);document.getElementById("divDriversAlert").setAttribute("data-alertype",r);AlertCore.driversCustomEvent(!0)}catch(t){AlertCore.driversCustomEvent(!1);console.error("Error in bindDriversHtml",t)}}function loadDriverAlertAccordion(){var n,t,i;if(typeof DDS!="undefined"){const t=document.getElementById("divDriverAlertAccordion");ddsAccElem=DDS.Accordion(t,{independent:!0});ddsAccElem!=null&&(n=t.getElementsByClassName("dds__icon dds__accordion__icon"),n.length>0&&n[0].remove())}t=document.getElementById("btnClose");t.addEventListener("click",function(){ddsAccElem!==null&&ddsAccElem.collapseAll()});i=document.getElementById("btnRunDriversScan");i.addEventListener("click",function(){typeof btnPropValue!="undefined"&&btnPropValue!==""&&AlertCore.logOmniture("222.950.210.343",btnPropValue)});window?.addEventListener("click",function(n){document.getElementById("btnHeadingDrv")===null||document.getElementById("btnHeadingDrv").contains(n.target)||ddsAccElem===null||ddsAccElem.collapseAll()})}var btnPropValue;window.AlertCore=function(){var n={},t,r,i,u;return n.token=null,n.alertESC=null,n.homeAlertsDriverUrl=null,n.getEncryptedTagUrl="https://www.dell.com/support/components/detectproduct/encvalue/{0}/odeweb",n.filterUrl="https://www.dell.com/support/driver/ips/api/driversbyscan/getdriversbyscan",n.findServiceToken=null,n.findServiceExpiry=null,n.alertsTokenUrl="https://www.dell.com/support/diagnose/{0}/gettokensforalerts",n.srCheckUrl=null,n.odeApiUrl=null,n.homeAlertsDiagnoseUrl=null,n.homeDiagResultUrl=null,n.encryptedServiceTag=null,n.isSASupportedOS=null,n.isSASupportedBrowser=null,n.SAType=null,n.clientVersion=null,n.osInfo=null,n.productWin11ButNotDellSupported=!1,n.hideDriversAlert=!1,n.driversCustomEvent=function(n){let t=new CustomEvent("diag_driveralert_event",{detail:{isAlertAvailable:n}});document.dispatchEvent(t)},n.diagnosticCustomEvent=function(n){let t=new CustomEvent("diag_hardwarealert_event",{detail:{isAlertAvailable:n}});document.dispatchEvent(t)},n.tabLoadCustomEvent=function(n){let t=new CustomEvent("alert_nosa_event",{detail:{tabName:n}});document.dispatchEvent(t)},n.getEncryptedTag=function(t,i,r){n.encryptedServiceTag!=null&&n.encryptedServiceTag!=""?i(n.encryptedServiceTag):n.httpGETRequest(n.getEncryptedTagUrl.replace("{0}",t),function(t){n.encryptedServiceTag=t;i(t)},function(n){console.error("Get Encrypted Tag Failed",n);r("Get Encrypted Tag Failed")})},n.getAlertToken=function(t,i,u,f){var o,e,s;try{if(o=typeof u!="undefined"&&u.length>0?u:"",n.token!=""&&n.token!=null)n.fillSATokens(n.token,f),t();else{e=window.sessionStorage.getItem("sid");s=e!=null&&e.length>0?1:0;let u=r()+"?code="+o+"&sid="+s+"&ctime="+n.getClientTime();n.httpGETRequest(u,function(i){n.fillSATokens(i,f);t()},function(n){console.error("token generation error",n);i("Get Client Security Token Failed")})}}catch(h){i("Get Client Security Token Failed")}},n.fillSATokens=function(t,i){n.findServiceToken=t.IsAliveToken;n.findServiceExpiry=t.Expires;n.isSASupportedOS=t.IsSASupportedOS;n.isSASupportedBrowser=t.IsSASupportedBrowser;n.productWin11ButNotDellSupported=t.IsProductWin11ButNotDellSupported;i||(typeof t.Expires!="undefined"&&t.Expires!=null&&t.Expires!=""&&n.alertESC.tokenExpires.setValue(t.Expires),typeof t.IsAliveToken!="undefined"&&t.IsAliveToken!=null&&t.IsAliveToken!=""&&n.alertESC.isAliveToken.setValue(t.IsAliveToken));(n.token==null||n.token=="")&&typeof t.GetClientSystemInfoTokenM!="undefined"&&t.GetClientSystemInfoTokenM!=null&&t.GetClientSystemInfoTokenM!=""&&(n.token=t);typeof t.GetClientSystemInfoTokenM!="undefined"&&t.GetClientSystemInfoTokenM!=null&&t.GetClientSystemInfoTokenM!=""&&n.alertESC.getClientSystemInfoTokenM.setValue(t.GetClientSystemInfoTokenM);typeof t.DeviceDriversTokenM!="undefined"&&t.DeviceDriversTokenM!=null&&t.DeviceDriversTokenM!=""&&n.alertESC.getDeviceDriversTokenM.setValue(t.DeviceDriversTokenM);typeof t.GetDiagScanHistoryTokenM!="undefined"&&t.GetDiagScanHistoryTokenM!=null&&t.GetDiagScanHistoryTokenM!=""&&n.alertESC.getDiagScanHistoryTokenM.setValue(t.GetDiagScanHistoryTokenM);n.homeAlertsDriverUrl=t.HomeAlertsDriverUrl;n.srCheckUrl=t.HomeDiagnosticCaseCheckUrl;n.odeApiUrl=t.HomeDiagnosticApiUrl;n.homeAlertsDiagnoseUrl=t.HomeAlertsDiagnosticUrl;n.homeDiagResultUrl=t.OdeHardwareRedirectUrl},n.inIt=function(t,i){typeof clientApi!="undefined"&&typeof window.clientApi.eSupportClientApi!="undefined"?(n.alertESC==null&&(n.alertESC=new window.clientApi.eSupportClientApi),n.setAlertSAToken(function(){typeof n.isSASupportedOS!="undefined"&&n.isSASupportedOS==!0?typeof n.isSASupportedOS!="undefined"&&n.isSASupportedBrowser==!0?t():i("Browser not supported"):i("Operating system not supported")},function(n){i(n)},!0)):i("Client API is not available")},n.setAlertSAToken=function(t,i,r){n.checkSAThenGetTag(function(u,f,e,o){n.SAType=f;n.clientVersion=e;n.osInfo=o;n.getEncryptedTag(u,function(u){n.getAlertToken(function(){t()},function(n){i(n)},u,r)},function(n){console.error("getEncryptedTag failed",n);i("Tag Encryption Failed")})},function(n,t){console.error(n,t);i("SA Available Check Failed")})},n.checkSAThenGetTag=function(t,i){var r=window.sessionStorage.getItem("tagFromSA"),u=window.sessionStorage.getItem("SAType"),f=window.sessionStorage.getItem("clientVersion"),e=window.sessionStorage.getItem("osInfo");r&&r!=null&&r.length>0&&u&&u!=null&&u.length>0?t(r,u,f,e):n.getAlertToken(function(){n.findServiceExpiry!=null&&n.findServiceExpiry!=""&&n.alertESC.tokenExpires.setValue(n.findServiceExpiry);n.findServiceToken!=null&&n.findServiceToken!=""&&n.alertESC.isAliveToken.setValue(n.findServiceToken);n.alertESC.findService(function(){var n=window.sessionStorage.getItem("tagFromSA"),i=window.sessionStorage.getItem("SAType"),r=window.sessionStorage.getItem("clientVersion"),u=window.sessionStorage.getItem("osInfo");t(n,i,r,u)},function(n){var t=typeof n.errorCode!="undefined"?n.errorCode:"pingFailed";i("SA is not available - "+t,n)})},function(n){i("Alert Token failed",n)},"",!0)},n.getClientSystemInfo=function(t,i){n.alertESC.getClientSystemInfo(!0,!1,!1,function(n){t(n)},function(n){i(n)})},n.getDriverDetails=function(t,i){n.alertESC.getDeviceDrivers(function(n){t(n)},function(n){i(n)},!1,null,"dl.dell.com")},n.getDriverSessionData=function(){var n=null;return sessionStorage.lastDriverScanDetails&&(n=JSON.parse(window.sessionStorage.getItem("lastDriverScanDetails"))),n},n.getDiagnosticSessionData=function(){var n=null;return sessionStorage.lastDiagScanDetails&&(n=JSON.parse(window.sessionStorage.getItem("lastDiagScanDetails"))),n},n.setDriverSessionData=function(n){n!==null&&(sessionStorage.lastDriverScanDetails&&window.sessionStorage.removeItem("lastDriverScanDetails"),window.sessionStorage.setItem("lastDriverScanDetails",JSON.stringify(n)))},n.setDiagnosticSessionData=function(n){n!==null&&(sessionStorage.lastDiagScanDetails&&window.sessionStorage.removeItem("lastDiagScanDetails"),window.sessionStorage.setItem("lastDiagScanDetails",JSON.stringify(n)))},n.logExceptionToSplunk=function(t){try{if(typeof t!="undefined"&&t!==null){var i="https://www.dell.com/support/onlineapi/scan-download-log/home-alerts-flow-mfe";i+="?Source="+t.Source+"&ErrorCode="+t.ErrorCode+"&ErrorType="+t.ErrorType+"&Message="+t.Message;sessionStorage.clientVersion&&(i+="&SAversion="+sessionStorage.getItem("clientVersion"));sessionStorage.SAType&&(i+="&SAtype="+sessionStorage.getItem("SAType"));sessionStorage.tagFromSA&&(i+="&ServiceTag="+sessionStorage.getItem("tagFromSA"));AlertCore.AppName!==undefined&&AlertCore.AppName!==null&&(i+="&AppName="+AlertCore.AppName);n.httpGETRequest(i,function(n){console.log("Home alerts failure logged:"+n)},function(n){console.error("Error in posting home alerts failure",n)})}else console.log("Empty Error from splunk log")}catch(r){console.error("Function: logExceptionSplunk Failure",r)}},n.getClientTime=function(){const n=new Date,t=n.getTime()+n.getTimezoneOffset()*60;return Math.round(t/1e3)},n.httpGETRequest=function(n,i,r){var u=fetch(n);u.then(function(n){return t(n)}).then(function(n){i(n)}).catch(function(n){r(n)})},n.httpPOSTRequest=function(n,t,i,r){var u={method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},f=fetch(n,u);f.then(function(n){return n.json()}).then(function(n){i(n)}).catch(function(n){r(n)})},t=function(n){const t=n.headers.get("content-type");return t&&t.indexOf("json")!==-1?n.json():n.text()},r=function(){return typeof Dell!="undefined"&&typeof Dell.Metrics!="undefined"&&typeof Dell.Metrics.sc!="undefined"&&Dell.Metrics.sc.language!==""&&Dell.Metrics.sc.country!==""?n.alertsTokenUrl.replace("{0}",Dell.Metrics.sc.language+"-"+Dell.Metrics.sc.country):n.alertsTokenUrl.replace("{0}/","")},n.dateDiff=function(n){const t=new Date,i=new Date(n),r=Math.abs(t-i);return Math.ceil(r/864e5)},i=function(t){if(sessionStorage.osInfo){var i=JSON.parse(window.sessionStorage.getItem("osInfo")),r=parseInt(i.OSVersion.split(".")[2]),u=i.OSName;r>=22e3&&u.indexOf("11")>-1&&n.productWin11ButNotDellSupported?t(!0):t(!1)}else t(!1)},u=function(n){try{var t=0;typeof window.navigator.userAgentData!="undefined"&&typeof window.navigator.userAgentData.getHighEntropyValues!="undefined"?window.navigator.userAgentData.getHighEntropyValues(["platformVersion"]).then(function(i){typeof window.navigator.userAgentData.platform!="undefined"&&window.navigator.userAgentData.platform==="Windows"&&(t=parseInt(i.platformVersion.split(".")[0]));n(t>=13)}):(console.log("getHighEntropyValues not available",0),n(!1))}catch(i){console.log("getHighEntropyValues not available catch",i);n(!1)}},n.HideDriverScanforWin11=function(t){u(function(r){r?n.productWin11ButNotDellSupported?t(!0):t(!1):sessionStorage.osInfo?i(function(n){n?t(!0):t(!1)}):n.checkSAThenGetTag(function(r,u,f,e){n.osInfo=e;i(function(n){n?t(!0):t(!1)})},function(n,i){console.error(n,i);t(!1)})})},n.filteredDrivers=(i,r,u)=>{var e=new FormData,f=new URLSearchParams(e);f.append("scanResult",JSON.stringify(i));f.append("appId","home - alert");fetch(n.filterUrl,{method:"POST",headers:new Headers({"X-Requested-With":"XMLHttpRequest",GBPageInfo:"url="+window.location.href+";PN="+Dell.Metrics.sc.pagename+";Sindex="+Dell.Metrics.sc.supportappindex,"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}),body:f}).then(n=>t(n)).then(n=>{r(n)}).catch(n=>{console.error("filteredDrivers api Failure"),u(n)})},n.dateDiff=function(n){const t=new Date,i=new Date(n),r=Math.abs(t-i);return Math.ceil(r/864e5)},n.renderSaScript=(n,t)=>new Promise((i,r)=>{const u=document.createElement("script");document.getElementById(t).appendChild(u);u.onload=i;u.onerror=r;u.async=!0;u.src=n}),n.dateConversion=function(n){var r,t;const i=new Date(n);r="";r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"][i.getMonth()];t=i.getDate()+"";t.length===1&&(t="0"+t);return r+" "+t+", "+i.getFullYear()},n.logOmniture=function(t,i){var r=0;typeof dellmetricsTrack=="function"?dellmetricsTrack(t,i):r<=10&&(r++,setTimeout(function(){n.logOmniture(t,i)},200))},n}();window.AlertDriverTile=function(){var n={},t=AlertCore,i;return n.driverTileData={isSupportAssistAvailable:!1,isSACommOrNonAdmin:!1,saType:"",clientVersion:"",hideDriverAlertforWin11:!1,driverData:{critical:"",recommended:"",totalDriverUpdates:"",driverScanInitiateUrl:"",lastScanRunTime:"",lastScanDaysPassed:""},exception:{type:null,code:null,message:null}},n.getDriverData=function(r){try{typeof t=="undefined"&&(t=AlertCore);n.driverTileData=initializeDriverTileData();t.inIt(function(){n.driverTileData.driverData.driverScanInitiateUrl=t.homeAlertsDriverUrl;n.driverTileData.isSupportAssistAvailable=!0;n.driverTileData.saType=t.SAType;n.driverTileData.clientVersion=t.clientVersion;typeof t.SAType!="undefined"&&t.SAType=="SAConsumer"&&sessionStorage.IsAdmin&&sessionStorage.getItem("IsAdmin")==="true"?t.HideDriverScanforWin11(function(u){if(u)n.driverTileData.hideDriverAlertforWin11=!0,r(n.driverTileData);else{n.driverTileData.hideDriverAlertforWin11=!1;var f=t.getDriverSessionData();f!=null?populateDriverTileData(f,r):t.setAlertSAToken(function(){t.getDriverDetails(function(i){typeof i.LastScanRunTime!=null?(t.setDriverSessionData(i),populateDriverTileData(i,r)):r(n.driverTileData)},function(t){i(t);r(n.driverTileData)})},function(t){i(null,t);r(n.driverTileData)},!1)}}):(n.driverTileData.isSACommOrNonAdmin=!0,r(n.driverTileData))},function(t){i(null,t);(sessionStorage.IsAdmin&&sessionStorage.getItem("IsAdmin")==="false"||sessionStorage.SAType&&sessionStorage.getItem("SAType")==="SAComm")&&(n.driverTileData.isSACommOrNonAdmin=!0);r(n.driverTileData)})}catch(u){i(null,u.message);r(n.driverTileData)}},populateDriverTileData=function(r,u){var e=0,o=0,f;n.driverTileData.driverData.driverScanInitiateUrl=t.homeAlertsDriverUrl;r!=null?typeof r.LastScanRunTime!="undefined"&&r.LastScanRunTime!=null?(f=AlertCore.dateDiff(r.LastScanRunTime),n.driverTileData.driverData.lastScanDaysPassed=f,f<=7?r.data!=null&&r.data.Updates!=null?(r.data.ServiceTag=t.encryptedServiceTag,t.filteredDrivers(r.data,function(t){for(var i=0;i<t.Updates.length;i++)switch(t.Updates[i].DriverImportanceLevel.toLowerCase()){case"recommended":o++;break;case"critical":e++}n.driverTileData.driverData.critical=e;n.driverTileData.driverData.recommended=o;n.driverTileData.driverData.totalDriverUpdates=t.Updates.length;n.driverTileData.driverData.lastScanRunTime=r.LastScanRunTime;u(n.driverTileData)},function(t){console.error("drivers filteredResponse failed in homealert - ",t);i(t);u(n.driverTileData)})):u(n.driverTileData):u(n.driverTileData)):u(n.driverTileData):u(n.driverTileData)},initializeDriverTileData=function(){return{isSupportAssistAvailable:!1,saType:"",clientVersion:"",hideDriverAlertforWin11:!1,driverData:{critical:"",recommended:"",totalDriverUpdates:"",driverScanInitiateUrl:"",lastScanRunTime:"",lastScanDaysPassed:""},exception:{type:null,code:null,message:null}}},i=function(i,r){var u=null;i!=null?(n.driverTileData.exception={type:i.type,code:i.errorCode,message:i.message},u={Source:"From Driver Alert",ErrorCode:i.errorCode,ErrorType:i.type,Message:i.message}):(n.driverTileData.exception={type:"GeneralException",code:"GeneralException",message:r},u={Source:"From Driver Alert",ErrorCode:"GeneralException",ErrorType:"GeneralException",Message:r});t.logExceptionToSplunk(u)},n}();const driverAlert=document.getElementById("divDriversAlert");btnPropValue="";var changeDriversContent=function(n,t,i,r,u,f){document.getElementById("divDriversHeader").textContent=n;document.getElementById("divDriversHeader").ariaLabel=n;document.getElementById("divDriversDescription").textContent=t;document.getElementById("divDriversDescription").ariaLabel=t;document.getElementById("divDriversScanBtnText").textContent=i;document.getElementById("divDriversScanBtnText").ariaLabel=i;document.getElementById("divDriversLastScanDate").textContent=r;document.getElementById("divDriversLastScanDate").ariaLabel=r;document.getElementById("iconDrvrAlrt").classList.remove("dds__icon--alert-info-cir");document.getElementById("iconDrvrAlrt").classList.remove("dds__rounded-circle");document.getElementById("iconDrvrAlrt").classList.add(f);document.getElementById("iconDrvrAlrt").style.color=u;document.getElementById("divDriversLastScanDate").classList.remove("dds__d-none")},enableDriverAlert=function(n){document.getElementById("divDriversAlert").classList.remove("dds__d-none");document.getElementById("btnRunDriversScan").href=n},raiseNoSAEvent=function(){document.getElementById("divDriversAlert").classList.remove("dds__d-none");var n=document.getElementById("btnRunDriversScan");n.href="javascript:void(0);";n.addEventListener("click",function(){AlertCore.tabLoadCustomEvent("drivers")})};loadDriverAlertAccordion();GetDriversAlert();
//# sourceMappingURL=driversAlert.min.js.map