"use strict";(()=>{var _t=Object.defineProperty;var j=Object.getOwnPropertySymbols;var ht=Object.prototype.hasOwnProperty,St=Object.prototype.propertyIsEnumerable;var tt=(t,e,o)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,v=(t,e)=>{for(var o in e||(e={}))ht.call(e,o)&&tt(t,o,e[o]);if(j)for(var o of j(e))St.call(e,o)&&tt(t,o,e[o]);return t};var I=(t,e,o)=>new Promise((r,n)=>{var s=c=>{try{l(o.next(c))}catch(m){n(m)}},a=c=>{try{l(o.throw(c))}catch(m){n(m)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,a);l((o=o.apply(t,e)).next())});var p=(t,e)=>(e==null?void 0:e.constructor)===t;var et=Object,C=et.create,ot=et.keys,d=window,f=d.document,rt=t=>new Promise(e=>setTimeout(()=>e(),t)),nt=60;var g="=",D=";",L=D+"domain"+g,st=D+"expires"+g,Rt=D+"path"+g,k=D+"SameSite"+g+"None"+D+"Secure",ct="tld_cookie",it=ct+g+"cookie",J=(t,e="",o=0)=>{let r="";if(o){let n=new Date;n.setDate(n.getDate()+o),r=st+n.toUTCString()}f.cookie=t+g+e+r+Rt+"/"+L+Ct()+k},at=t=>b(f.cookie,/;\s*/)[t],b=(t,e="&")=>t.split(e).reduce((o,r)=>{var a;let[,n,s]=(a=r.match(/^([^=]+)=(.*)$/))!=null?a:[0,r,""];try{o[decodeURIComponent(""+n)]=decodeURIComponent(""+s)}catch(l){}return o},C(null)),mt=(t,e="&")=>{let o=[];return ot(t).forEach(r=>{try{o.push(encodeURIComponent(r)+g+encodeURIComponent(t[r]))}catch(n){}}),o.join(e)},Ct=()=>{let t=f.location.hostname.split("."),e="";for(let o=t.length-2;o>=0;o--)if(e=t.slice(o).join("."),f.cookie=it+L+"."+e+k,f.cookie.indexOf(it)>-1)return f.cookie=ct+g+L+"."+e+st+"Thu, 01 Jan 1970 00:00:01 GMT"+k,e};var Tt=["expires_ms","ttl_ms","fp_ms"],Mt=62,u=()=>{let t=at("ats_ri"),e=p(String,t)?b(t):{};return Tt.forEach(o=>{let r=e[o];r!=null&&(e[o]=+r)}),e},lt=t=>{J("ats_ri",mt(v(v({},u()),t)),Mt)},pt=()=>{J("ats_ri","",-1)};var dt=(t,e=100)=>{t.idReportingEnabled=Math.random()<e/100};var T=()=>"0.9.0";var ft=(t,e)=>(p(String,t)||p(Number,t)||p(Symbol,t))&&Object.hasOwnProperty.call(e!=null?e:Object,t);var A=t=>new Proxy(t,{get(e,o){var r;return A(e[o]=(r=e[o])!=null?r:{})}});var M=t=>{A(d).ringDataLayer.user.id.artemis=t},w=t=>{A(d).ringDataLayer.user.id.external.model=t},y=t=>{A(d).ringDataLayer.user.id.external.models=t};var O,E=t=>{if(O==null){let{dlApi:e,cfgFunc:o,dlApiRequire:r}=t;if(r.isError("tracking/events-api-browser"))return;let n=r("tracking/events-api-browser");O=new Promise(s=>I(void 0,null,function*(){var a,l,c,m,_,h,S,F,P,W,B,q,K,V,Y,G,H;try{let Q=yield n.getGlobalID(),X=yield n.getLocalID(),xt=btoa(JSON.stringify({user:{id:{local:X,global:Q}},version:T(),flags:{ignoreId:wt(X,nt)}})),It=[(a=e==null?void 0:e.getTid)==null?void 0:a.call(e),e.tid,"1746213"].find(R=>p(String,R)&&R!=="").replace(/^EA-/,""),$=yield Promise.race([fetch("https://events.ocdn.eu/v2/EA-"+It+"/user/"+xt,{credentials:"include"}),rt(1e4)]);if($!=null){let R=yield $.text(),i=JSON.parse(R);((c=(l=i==null?void 0:i.cfg)==null?void 0:l.cmds)!=null?c:[]).forEach(([N,...Dt])=>ft(N,o)?o[N].apply(null,Dt):e.errEvent("AppError",`Unknown function '${N}' in cfg.cmds`,void 0,"ArtemisUnknownFunction"));let z=1e3*((_=(m=i==null?void 0:i.cfg)==null?void 0:m.ttl)!=null?_:0),Z=(F=(S=(h=i==null?void 0:i.user)==null?void 0:h.id)==null?void 0:S.models)!=null?F:{},x={ri:(B=(W=(P=i==null?void 0:i.user)==null?void 0:P.id)==null?void 0:W.real)!=null?B:"",model:(V=(K=(q=i==null?void 0:i.user)==null?void 0:q.id)==null?void 0:K.model)!=null?V:"",models:btoa(JSON.stringify(Z)),ttl_ms:z,expires_ms:z+ +new Date,version:(G=(Y=i==null?void 0:i.cfg)==null?void 0:Y.version)!=null?G:"",fs:(H=i==null?void 0:i.fs)!=null?H:""},U=u();U.ri&&U.ri!==x.ri&&e.uaEvent("ArtemisChangedID","ArtemisEvent",JSON.stringify({newRi:x.ri,oldRi:U.ri})),lt(x),M(x.ri),w(x.model),y(Z),t.idReportingEnabled&&e.uaEvent("ArtemisId","ArtemisEvent",JSON.stringify({ri:x.ri})),s(i)}}catch(Q){s()}O=null}))}return O};function wt(t,e){if(!p(String,t)||!t.match(/^\d{24}/))return!0;let o=+new Date(+t.slice(0,4),+t.slice(4,6)-1,+t.slice(6,8),+t.slice(8,10),+t.slice(10,12));return(+new Date-o)/6e4<e}var ut=t=>I(void 0,null,function*(){var e,o,r,n,s;return(s=(e=u())==null?void 0:e.ri)!=null?s:(n=(r=(o=yield E(t))==null?void 0:o.user)==null?void 0:r.id)==null?void 0:n.real});var gt=t=>new Uint8Array((t.length%2===0?t:"0"+t).match(/[\da-f]{2}/gi).map(e=>parseInt(e,16)));var yt=(t,e)=>t.map((o,r)=>o^e[r%e.length]),At=(t,e)=>I(void 0,null,function*(){var r,n,s;let o=(s=(r=u())==null?void 0:r.fs)!=null?s:(n=yield E(t))==null?void 0:n.fs;if(p(String,o)&&o.match(/^([\da-f]{2})+$/i))try{let{dlApiRequire:a}=t,c=yield a("tracking/events-api-browser").getLocalID(),m=BigInt(c).toString(16),_=gt(o),h=gt(m),S=new TextDecoder().decode(yt(_,h));return JSON.parse(S)[e]}catch(a){}});var Et=t=>{var n,s,a,l,c;let{dlApi:e}=t;if((l=(a=(s=(n=d)==null?void 0:n.ringDataLayer)==null?void 0:s.context)==null?void 0:a.tracking)!=null&&l.id5test)try{let m=JSON.parse(decodeURIComponent(localStorage.getItem("id5"))).universal_uid;A(d).ringDataLayer.user.id.external.id5=m,e.uaEvent("id5test","ArtemisEvent",m)}catch(m){}let o=u();M(o==null?void 0:o.ri),w(o==null?void 0:o.model),y(JSON.parse(atob((c=o==null?void 0:o.models)!=null?c:"e30=")));let r=o==null?void 0:o.expires_ms;if(r!=null&&r>=+new Date){let m=o==null?void 0:o.ttl_ms;m!=null&&setTimeout(()=>E(t),m);return}E(t)};dlApiDefine("artemis",["core","tracking"],({module:t})=>{try{let e=C(null),o={idReportingEnabled:!1,cfgFunc:e,dlApiDefine,dlApiRequire,dlApiExec};e.enableIdReporting=dt.bind(null,o),e.clearAtsRi=pt.bind(null);let r=Et.bind(null,o);t.exports={getVersion:T,getArtemisId:ut.bind(null,o),getFeature:At.bind(null,o),init:n=>{var s,a,l,c;o.dlApi=n,!(f.documentMode!=null||!p(Function,fetch)||(c=(l=(a=(s=d)==null?void 0:s.ringDataLayer)==null?void 0:a.user)==null?void 0:l.consents)!=null&&c.dnt)&&(n.on("afterChangeView",r),r())}}}catch(e){}});})();
