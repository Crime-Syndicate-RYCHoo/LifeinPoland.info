!function(){"use strict";var e={28:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={NETWORK:"EA-1551662",AD_NETWORK:"1746213",MAX_HTTP_GET_URL_LENGTH:5e3,URL:"https://csr.onet.pl",ENABLE_LOGGING:!0,TOPICS_API_IFRAME_SRC:"https://csr.onet.pl/topics/csr-onet-topics.html"}},518:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),o=n(405),a=n(128),c=n(224),u=n(576),d=n(778),s=n(185),v=n(845),l=null,E=null;function p(e,t){var n,p;void 0===t&&(t=!0);try{if(!l)throw new Error("You should initialize module with Window context first");var _=String(e.network||i.default.NETWORK);e.referrer=u.default.getReferrer(l);var T=o.default.prepareActivityEvent(e),y=a.default.getSavedContextParams(l),m=c.default.prepareUrl(_,y);if(E){var g=(null===(n=e.products)||void 0===n?void 0:n.map((function(e){return e.id})))||[];(0,v.updateOfferIds)(l,E,g)}if("product_list"===T.event)return;f.apply(void 0,r(r([m],function(e,t,n){if(!t.products)return["GET",t];var r=c.default.useGetPossible(e,t);if(r)return["GET",t];var i=t.products,a=o.default.prepareProducts(n,"base");t.products=a;var u=c.default.useGetPossible(e,t);if(u&&a)return["GET",t];return t.products=i,["POST",t]}(m,T,e.products),!1),[t],!1)),(0,d.reportEcommerceEvents)(T,e.products),null===(p=null==E?void 0:E.fire)||void 0===p||p.call(E,"sendActivity",{event:e.event,eventProducts:e.products,eventData:e})}catch(e){(0,s.logMessage)("A critical error occurred while sending the activity event.",e)}}function f(e,t,n,r){var i={method:t,credentials:"include",attributionReporting:{eventSourceEligible:!1,triggerEligible:!0}};"POST"===i.method&&(i.headers={"Content-type":"application/x-www-form-urlencoded"},i.body=o.default.actToPostBody(n)),"GET"===i.method&&(e=o.default.actToGetUrl(e,n),r&&e.searchParams.set("_",String(Date.now()))),fetch(e,i).catch((function(e){return(0,s.logMessage)("A critical error occurred while sending the activity event.",e)}))}t.default={init:function(e,t){l=e,E=null!=t?t:null,a.default.storeUserContextParams(e),u.default.storeReferrer(e)},sendActivityEvent:p,sendActivity:function(e,t,n,r,i,o){var a=t.event,c=t.actid,u=i.antiCache;p({event:a,actid:c,products:n,network:r,touchPoint:o.touched},u)},defineDlApiFunctions:function(e,t){e.consent=function(e){e&&["0","1"].includes(String(e.npa))?a.default.updateConsentInContextParams(t,String(e.npa)):(0,s.logMessage)("Consent object should have npa property which should be 0 or 1.")},e.identify=function(e){e&&"string"==typeof e.extaid&&32===e.extaid.length?a.default.updateExternalAidInContextParams(t,e.extaid):(0,s.logMessage)("Identity object should have extaid property which should be md5 string.")}}}},405:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getFullProductsData=void 0;var i=n(185);function o(e,t){if(void 0===t&&(t="base"),function(e){return Array.isArray(e)}(e)){var n=[];return e.forEach((function(e){if(u(e)&&(e.id||e.name)){var i={price:d(e.price,0),qty:d(e.qty,1),id:d(e.id)};if("string"!=typeof i.id&&(i.name=d(e.name)),"base"!==t){var o=r(r({},i),{name:d(e.name),brand:d(e.brand),category:d(e.category),variant:d(e.variant)});n.push(c(o))}else n.push(c(i))}})),n}}function a(e,t){void 0===t&&(t="base");var n=o(e,t);if(n)try{return JSON.stringify(n)}catch(e){return void(0,i.logMessage)("Error stringifying products",e)}}function c(e){for(var t in e)null!==e[t]&&void 0!==e[t]||delete e[t];return e}function u(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function d(e,t){var n=e||t;if("string"==typeof n||"number"==typeof n)return n.toString().trim()}t.getFullProductsData=function(e){return o(e,"full")},t.default={prepareActivityEvent:function(e){if(!u(e))throw new Error("Invalid eventData object");var t={actid:d(e.actid),actgid:d(e.actgid),event:d(e.event),encrypted_data:d(e.encrypted_data),ord:d(e.ord),qty:d(e.qty,1),cost:d(e.cost,0),tax:d(e.tax,0),sitetype:d(e.sitetype),products:a(e.products,"full"),referrer:d(e.referrer),vast_node_ids:d(e.vast_node_ids),touched:d(e.touchPoint)};if(("string"!=typeof t.actgid||"string"!=typeof t.event)&&"string"!=typeof t.actid)throw new Error("Invalid eventData object missing - event/actgid or actid");return c(t)},prepareProducts:a,actToPostBody:function(e){return"data="+encodeURIComponent(JSON.stringify(e))},actToGetUrl:function(e,t){var n;for(n in t){var r=t[n];void 0!==r&&e.searchParams.set(n,r)}return e}}},122:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.updateIFrame=t.storeDlapiProducts=t.saveInterestGroup=void 0;var r=n(28),i=n(185),o={add_to_cart:"atc",product_detail:"pd"};function a(e,t){if(void 0===t||void 0===e)return null;try{var n="dlapi_products",r=JSON.parse(localStorage.getItem(n)||"[]");if(!Array.isArray(r))return null;var o=r.findIndex((function(t){return t.products.every((function(t){return e.includes(t)}))}));o>=0&&r.splice(o,1),r.push({event:t,products:(JSON.parse(e)||[]).map((function(e){return e.id}))});return r.length>20&&r.splice(0,r.length-20),localStorage.setItem(n,JSON.stringify(r)),r}catch(e){return(0,i.logMessage)("Failed to store dlapi products to local storage",e),null}}function c(e,t){var n=function(){var e="protectedAudienceApiIFrame",t=document.getElementById(e);return t||((t=document.createElement("iframe")).id=e,t.style.width="0",t.style.height="0",t.style.border="0",t.style.display="none",document.body.appendChild(t)),t}(),a=function(e,t){return t.map((function(t){return[e,t.products,o[t.event]]}))}(t,e),c=encodeURIComponent(r.default.AD_NETWORK),u=encodeURIComponent("actgid:".concat(t)),d=encodeURIComponent(JSON.stringify(a)),s=encodeURIComponent((0,i.getParamsFromUrl)(window).get("dl_debug")||"0"),v="".concat(r.default.URL,"/").concat(c,"/v1/protected-audience-api/interest-group/interest-group.html#name=").concat(u,"&adp_products=").concat(d,"&dl_debug=").concat(s);n.contentWindow&&n.contentWindow.location.replace(v)}t.storeDlapiProducts=a,t.updateIFrame=c,t.saveInterestGroup=function(e){if(("product_detail"===e.event||"add_to_cart"===e.event)&&void 0!==e.actgid){var t=a(e.products,e.event);t&&c(t,e.actgid)}}},576:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(185),i=["utm_campaign","utm_medium","utm_source","utm_term","utm_content"];function o(e){var t=void 0;try{t=e.localStorage.getItem("dlapi_ref")||void 0}catch(e){(0,r.logMessage)("Failed to get referrer data from local storage",e)}return t}t.default={storeReferrer:function(e){try{var t=function(e){var t,n="";try{var i=null===(t=e.document)||void 0===t?void 0:t.referrer;i&&(n=new URL(i).hostname)}catch(e){(0,r.logMessage)("Invalid referrer URL",e)}return n}(e),n=function(e){var t={};try{var n=new URLSearchParams(e.location.search);i.forEach((function(e){var r=n.get(e);r&&(t[e]=r)}))}catch(e){(0,r.logMessage)("Invalid search params",e)}if(Object.keys(t).length)return t}(e);if(!function(e,t,n){try{var i=o(e),a=i&&JSON.parse(i),c=!!(u=a)&&Object.keys(u).some((function(e){return e.startsWith("utm_")}));return t!==e.location.hostname&&(!(!n&&!t)&&!(!n&&c))}catch(e){return(0,r.logMessage)("Failed to read saved referrer data from local storage",e),!0}var u}(e,t,n))return;var a=n||{};t&&(a.referrer=t),e.localStorage.setItem("dlapi_ref",JSON.stringify(a))}catch(e){(0,r.logMessage)("Failed to save referrer data to local storage",e)}},getReferrer:o}},224:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(28);t.default={prepareUrl:function(e,t){void 0===t&&(t={});var n,i="".concat(r.default.URL,"/").concat(e.replace("EA-",""),"/activity"),o=new URL(i);for(n in t){var a=t[n];"string"!=typeof a&&"number"!=typeof a||o.searchParams.set(n,String(a))}return o},useGetPossible:function(e,t){return e.toString().length+JSON.stringify(t).length<r.default.MAX_HTTP_GET_URL_LENGTH}}},128:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(185),o="dlapi_ucp",a=["skapiec.pl","lamoda.pl"];function c(e){var t={};try{var n=e.localStorage.getItem(o);if(n&&("object"!=typeof(t=JSON.parse(n))||null===t))throw new Error("Invalid context parameters ".concat(n))}catch(e){return(0,i.logMessage)("Error parsing context params:",e),{}}return t}function u(e,t){try{var n=JSON.stringify(e);t.localStorage.setItem(o,n)}catch(e){(0,i.logMessage)("Error saving User context params to local storage",e)}}t.default={storeUserContextParams:function(e){var t=c(e),n=function(e){var t={};try{var n=new URLSearchParams(e.location.search),r=new URLSearchParams(e.location.hash.substring(1)),o=n.get("dlapi_lu")||r.get("dlapi_lu"),a=n.get("dlapi_aid")||r.get("dlapi_aid"),c=n.get("dlapi_npa")||r.get("dlapi_npa");o&&(t.lu=o),a&&(t.aid=a),c&&(t.npa=c)}catch(e){(0,i.logMessage)("Error retrieving query parameters:",e)}return t}(e);u(r(r({},t),n),e),function(e){var t=e.location.hostname||"";if(a.some((function(e){return t.includes(e)})))return;e.location.hash&&/[#&]dlapi_(lu|aid|npa)=/.test(e.location.hash)&&e.history.replaceState(null,"",e.location.pathname+e.location.search)}(e)},getSavedContextParams:c,updateExternalAidInContextParams:function(e,t){var n=c(e);n.eid=t,u(n,e)},updateConsentInContextParams:function(e,t){var n=c(e);n.npa=t,u(n,e)}}},778:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.reportEcommerceEvents=t.renderEcommerceEventsReporter=t.EcommerceEventsReporter=void 0;var r=n(595),i=n(562),o=n(405),a=n(184),c=n(632),u=n(29),d=n(866),s=n(303),v=function(){function e(){this.ecommerceEventsBuffer=[],this.contexts=[],this.interestGroups=new s.InterestGroups}return e.prototype.renderEcommerceEventsReporter=function(e){var t=this,n=(0,r.extractContext)(e);this.interestGroups.setContext(n),this.contexts.push(n),this.ecommerceEventsBuffer.forEach((function(e){return t.reportEvent(n,e)}))},e.prototype.addInterestGroups=function(e){this.interestGroups.saveInterestGroup(e)},e.prototype.reportEcommerceEvents=function(e,t){var n=this.convertToUnifiedEvent(e,t);this.addInterestGroups(e),n&&(this.broadcastEvent(n),this.ecommerceEventsBuffer.push(n))},e.prototype.extractEventType=function(e){return Object.values(i.UnifiedEventType).find((function(t){return a.ADP_EVENTS[t]===e}))},e.prototype.parseProducts=function(e){var t=(0,o.getFullProductsData)(e);return Array.isArray(t)?t.map((function(e){return{id:e.id||null,name:e.name||"",price:Number(e.price)||null,quantity:Number(e.qty)||1,brand:e.brand,category:e.category,variant:e.variant}})):[]},e.prototype.convertToUnifiedEvent=function(e,t){var n=this.extractEventType(e.event);if(n)return{eventType:n,products:this.parseProducts(t),quantity:Number(e.qty),cost:Number(e.cost),tax:Number(e.tax),orderId:e.ord}},e.prototype.reportEvent=function(e,t){(0,c.insertMetaPixel)(e,t),(0,u.sendGoogleMetric)(e,t),(0,d.sendGoogleConversionTracking)(e,t)},e.prototype.broadcastEvent=function(e){var t=this;this.contexts.forEach((function(n){return t.reportEvent(n,e)}))},e}();t.EcommerceEventsReporter=v;var l=new v;t.renderEcommerceEventsReporter=l.renderEcommerceEventsReporter.bind(l),t.reportEcommerceEvents=l.reportEcommerceEvents.bind(l)},184:function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.sendAdpActivityEvent=t.ADP_EVENTS=void 0;var i=n(518),o=n(562);t.ADP_EVENTS=((r={})[o.UnifiedEventType.PRODUCT_LIST_EVENT]=null,r[o.UnifiedEventType.PRODUCT_DETAIL_EVENT]="product_detail",r[o.UnifiedEventType.ADD_TO_CART_EVENT]="add_to_cart",r[o.UnifiedEventType.REMOVE_FROM_CART_EVENT]="remove_from_cart",r[o.UnifiedEventType.CHECKOUT_EVENT]="checkout",r[o.UnifiedEventType.PURCHASE_EVENT]="purchased",r[o.UnifiedEventType.VIEW_CART]="view_cart",r[o.UnifiedEventType.TRANSACTION_EVENT]=null,r[o.UnifiedEventType.PAGE_VIEW_EVENT]="page_view",r);var a="";t.sendAdpActivityEvent=function(e,n){var r,c,u,d=t.ADP_EVENTS[n.eventType];if(!d)return!1;if(!e.eventWhitelist.has(d))return!1;if(d===t.ADP_EVENTS[o.UnifiedEventType.PAGE_VIEW_EVENT]){var s=(null===(c=null===(r=e.winRef)||void 0===r?void 0:r.location)||void 0===c?void 0:c.pathname)||"/";if(a===s)return!1;a=s}var v={actgid:e.activityGroup.id,event:d,network:e.activityGroup.network,ord:n.orderId,qty:n.quantity,cost:n.cost,tax:n.tax,sitetype:n.siteType,products:(null!==(u=n.products)&&void 0!==u?u:[]).map((function(e){return{id:e.id,name:e.name,price:e.price,qty:e.quantity||1,brand:e.brand,category:e.category,variant:e.variant,position:e.position}}))};return i.default.sendActivityEvent(v),!0}},29:function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.sendGoogleMetric=t.GOOGLE_GA4_EVENT_NAMES=t.GOOGLE_GA4_EVENTS=void 0;var i=n(562),o=n(771);t.GOOGLE_GA4_EVENTS=((r={})[i.UnifiedEventType.PRODUCT_LIST_EVENT]="view_item_list",r[i.UnifiedEventType.PRODUCT_DETAIL_EVENT]="view_item",r[i.UnifiedEventType.ADD_TO_CART_EVENT]="add_to_cart",r[i.UnifiedEventType.REMOVE_FROM_CART_EVENT]="remove_from_cart",r[i.UnifiedEventType.CHECKOUT_EVENT]="begin_checkout",r[i.UnifiedEventType.PURCHASE_EVENT]="purchase",r[i.UnifiedEventType.TRANSACTION_EVENT]="transaction_id",r[i.UnifiedEventType.VIEW_CART]="view_cart",r[i.UnifiedEventType.PAGE_VIEW_EVENT]="page_view",r),t.GOOGLE_GA4_EVENT_NAMES=new Set(Object.values(t.GOOGLE_GA4_EVENTS)),t.sendGoogleMetric=function(e,n){var r;if(e.googleMeasurementId){var i=t.GOOGLE_GA4_EVENTS[n.eventType];if(i){var a={send_to:e.googleMeasurementId,transaction_id:n.orderId,value:n.cost,tax:n.tax,currency:n.currency,items:null===(r=n.products)||void 0===r?void 0:r.map((function(e){return{item_id:e.id,item_name:e.name,price:e.price,quantity:e.quantity,item_brand:e.brand,item_category:e.category,item_variant:e.variant,index:e.position}}))};(0,o.getGtag)(e)("event",i,a)}}}},866:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sendGoogleConversionTracking=void 0;var r=n(562),i=n(771);t.sendGoogleConversionTracking=function(e,t){var n;if(e.googleConversionTrackingId){var o=(0,i.getGtag)(e),a=function(e){var t;return null===(t=(e.googleConversionTrackingId||"").split("/"))||void 0===t?void 0:t[0]};if(o("config",a(e),{groups:"RASP"}),e.googleAdsSendViewItemEvent&&t.eventType===r.UnifiedEventType.PRODUCT_DETAIL_EVENT)o("event","view_item",{send_to:a(e),value:t.cost||(t.products?(0,r.sumProducts)(t.products).cost:0),items:(null===(n=t.products)||void 0===n?void 0:n.map((function(t){return{id:t.id,google_business_vertical:e.googleBusinessVertical}})))||[]});else if(t.eventType===r.UnifiedEventType.PURCHASE_EVENT||t.eventType===r.UnifiedEventType.TRANSACTION_EVENT)o("event","conversion",{send_to:e.googleConversionTrackingId,transaction_id:t.orderId,value:t.cost})}}},462:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getGA4FallbackEvent=t.isGtagEcommerceEvent=t.isGA4EcommerceEvent=t.parseGa4Event=void 0;var r=n(562),i=n(29),o={view_item_list:{events:["viewitemlist","impression"],keys:[]},view_item:{events:["viewitem","detail"],keys:["currency","value"]},add_to_cart:{events:["addtocart"],keys:["currency","value"]},remove_from_cart:{events:["removefromcart"],keys:["currency","value"]},begin_checkout:{events:["checkout"],keys:["currency","value"]},purchase:{events:["purchase"],keys:["currency","value","transaction_id"]},view_cart:{events:["viewcart"],keys:["currency","value"]}};t.parseGa4Event=function(e){var t,n,o,a,c,u=e.event,d=e.ecommerce;d.items||(u in e.ecommerce?d=e.ecommerce[u]:"action"in e.ecommerce&&(d=e.ecommerce.action));var s=function(e){return Array.isArray(e)?e.map((function(e){return{id:e.item_id||e.id||null,name:e.item_name||e.name,price:Number(e.price)||null,quantity:Number(e.quantity)||1,brand:e.item_brand||e.brand,category:e.item_category||e.category,variant:e.item_variant||e.variant,position:e.index}})):[]}(d.items);switch(u){case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.PRODUCT_LIST_EVENT]:return{eventType:r.UnifiedEventType.PRODUCT_LIST_EVENT,products:s,cost:null!==(n=null===(t=d.purchase)||void 0===t?void 0:t.value)&&void 0!==n?n:0};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.PRODUCT_DETAIL_EVENT]:return{eventType:r.UnifiedEventType.PRODUCT_DETAIL_EVENT,siteType:r.SiteType.PRODUCT_DETAIL_SITE,products:s};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.ADD_TO_CART_EVENT]:return{eventType:r.UnifiedEventType.ADD_TO_CART_EVENT,products:s};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.REMOVE_FROM_CART_EVENT]:return{eventType:r.UnifiedEventType.REMOVE_FROM_CART_EVENT,products:s};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.CHECKOUT_EVENT]:for(var v=0,l=0,E=s;l<E.length;l++){v+=(null!==(o=(T=E[l]).price)&&void 0!==o?o:0)*T.quantity}return{eventType:r.UnifiedEventType.CHECKOUT_EVENT,siteType:r.SiteType.CART_SITE,products:s,quantity:s.reduce((function(e,t){return e+t.quantity}),0),cost:v};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.VIEW_CART]:for(var p=0,f=0,_=s;f<_.length;f++){var T;p+=(null!==(a=(T=_[f]).price)&&void 0!==a?a:0)*T.quantity}return{eventType:r.UnifiedEventType.VIEW_CART,siteType:r.SiteType.CART_SITE,products:s,quantity:s.reduce((function(e,t){return e+t.quantity}),0),cost:p};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.PURCHASE_EVENT]:var y=Number(d.value);return null===d.value||void 0===d.value||""===d.value||isNaN(y)?null:{eventType:r.UnifiedEventType.PURCHASE_EVENT,siteType:r.SiteType.CART_SITE,products:s,orderId:d.transaction_id,quantity:s.reduce((function(e,t){return e+t.quantity}),0),cost:y,tax:Number(d.tax)||void 0,currency:null!==(c=d.currency)&&void 0!==c?c:void 0};case i.GOOGLE_GA4_EVENTS[r.UnifiedEventType.PAGE_VIEW_EVENT]:return{eventType:r.UnifiedEventType.PAGE_VIEW_EVENT}}return null},t.isGA4EcommerceEvent=function(e){var t,n,r=Object.prototype.hasOwnProperty.call(e,"ecommerce")&&null!==e.ecommerce;if(Array.isArray(null===(n=null===(t=e.ecommerce)||void 0===t?void 0:t[e.event])||void 0===n?void 0:n.products))return!1;var o=e.event;return r&&i.GOOGLE_GA4_EVENT_NAMES.has(o)},t.isGtagEcommerceEvent=function(e){if(!function(e){return"[object Arguments]"===Object.prototype.toString.call(e)&&Object.prototype.hasOwnProperty.call(e,"callee")}(e))return!1;var t=e;if(3!==t.length)return!1;var n=t[0],r=t[1],o=t[2];return!("event"!==n||!i.GOOGLE_GA4_EVENT_NAMES.has(r))&&("object"==typeof o&&null!==o)},t.getGA4FallbackEvent=function(e){var t;if(e&&e.event&&Array.isArray(null===(t=e.ecommerce)||void 0===t?void 0:t.items)){var n=String(e.event).toLowerCase().replace(/[^a-z]+/g,""),r=new Set(Object.keys(e.ecommerce));for(var i in o){var a=o[i];if(a.events.some((function(e){return n.includes(e)}))&&a.keys.every((function(e){return r.has(e)})))return{event:i,ecommerce:e.ecommerce}}}}},310:function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.parseUaEvents=t.isUaEcommerceEvent=t.GOOGLE_UA_EVENT_KEY_NAMES=t.GOOGLE_UA_EVENT_KEYS=void 0;var i=n(562);function o(e){return Array.isArray(e)?e.map((function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){return null}return e})).filter((function(e){return null!==e})).map((function(e){return{id:e.id||null,name:e.name,price:Number(e.price)||null,quantity:Number(e.quantity)||1,brand:e.brand,category:"undefined"===e.category?void 0:e.category,variant:e.variant}})):[]}function a(e,n){var r,a,c,u=e.ecommerce[n],d=o(u.products),s=(0,i.sumProducts)(d);switch(n){case t.GOOGLE_UA_EVENT_KEYS[i.UnifiedEventType.PRODUCT_LIST_EVENT]:return{eventType:i.UnifiedEventType.PRODUCT_LIST_EVENT,products:o(u),currency:e.ecommerce.currencyCode||void 0};case t.GOOGLE_UA_EVENT_KEYS[i.UnifiedEventType.PRODUCT_DETAIL_EVENT]:return{eventType:i.UnifiedEventType.PRODUCT_DETAIL_EVENT,siteType:i.SiteType.PRODUCT_DETAIL_SITE,products:d,currency:e.ecommerce.currencyCode||void 0};case t.GOOGLE_UA_EVENT_KEYS[i.UnifiedEventType.ADD_TO_CART_EVENT]:return{eventType:i.UnifiedEventType.ADD_TO_CART_EVENT,products:d,currency:e.ecommerce.currencyCode||void 0};case t.GOOGLE_UA_EVENT_KEYS[i.UnifiedEventType.REMOVE_FROM_CART_EVENT]:return{eventType:i.UnifiedEventType.REMOVE_FROM_CART_EVENT,products:d,currency:e.ecommerce.currencyCode||void 0};case t.GOOGLE_UA_EVENT_KEYS[i.UnifiedEventType.CHECKOUT_EVENT]:return{eventType:i.UnifiedEventType.CHECKOUT_EVENT,siteType:i.SiteType.CART_SITE,products:d,quantity:s.quantity,cost:s.cost,currency:e.ecommerce.currencyCode||void 0};case t.GOOGLE_UA_EVENT_KEYS[i.UnifiedEventType.PURCHASE_EVENT]:return{eventType:i.UnifiedEventType.PURCHASE_EVENT,siteType:i.SiteType.CART_SITE,products:d,orderId:null===(r=u.actionField)||void 0===r?void 0:r.id,quantity:s.quantity,cost:Number(null===(a=u.actionField)||void 0===a?void 0:a.revenue)||s.cost,tax:Number(null===(c=u.actionField)||void 0===c?void 0:c.tax)||void 0,currency:e.ecommerce.currencyCode||void 0}}return null}t.GOOGLE_UA_EVENT_KEYS=((r={})[i.UnifiedEventType.PRODUCT_LIST_EVENT]="impressions",r[i.UnifiedEventType.PRODUCT_DETAIL_EVENT]="detail",r[i.UnifiedEventType.ADD_TO_CART_EVENT]="add",r[i.UnifiedEventType.REMOVE_FROM_CART_EVENT]="remove",r[i.UnifiedEventType.CHECKOUT_EVENT]="checkout",r[i.UnifiedEventType.PURCHASE_EVENT]="purchase",r[i.UnifiedEventType.TRANSACTION_EVENT]="transactionId",r),t.GOOGLE_UA_EVENT_KEY_NAMES=new Set(Object.values(t.GOOGLE_UA_EVENT_KEYS)),t.isUaEcommerceEvent=function(e){return"object"==typeof e&&null!==e&&(!!e.ecommerce&&Object.keys(e.ecommerce).some((function(e){return t.GOOGLE_UA_EVENT_KEY_NAMES.has(e)})))},t.parseUaEvents=function(e){var n=[];for(var r in e.ecommerce)if(t.GOOGLE_UA_EVENT_KEY_NAMES.has(r)&&e.ecommerce[r]){var i=a(e,r);i&&n.push(i)}return n}},771:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getGtag=void 0,t.getGtag=function(e){return function(){var t=function(){var t=e.winRef[e.dataLayerObjectName];if(!t)throw new Error('Cannot find "'.concat(e.dataLayerObjectName,'" object'));if(!t.push||"function"!=typeof t.push)throw new Error('Cannot find "'.concat(e.dataLayerObjectName,'.push" method'));return t.push}(),n=arguments;Object.defineProperty(n,"__raspPixel",{get:function(){return!0}}),t(n)}}},303:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.InterestGroups=void 0;var r=n(122),i=function(){function e(){this.joinAdInterestGroup=1}return e.prototype.isFledgeSupported=function(){return"runAdAuction"in navigator&&"joinAdInterestGroup"in navigator},e.prototype.setContext=function(e){e&&this.joinAdInterestGroup&&(this.joinAdInterestGroup=e.joinAdInterestGroup)},e.prototype.saveInterestGroup=function(e){this.isFledgeSupported()&&this.joinAdInterestGroup&&(0,r.saveInterestGroup)(e)},e}();t.InterestGroups=i},632:function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.insertMetaPixel=void 0;var i=n(562),o=((r={})[i.UnifiedEventType.PRODUCT_LIST_EVENT]=null,r[i.UnifiedEventType.PRODUCT_DETAIL_EVENT]="ViewContent",r[i.UnifiedEventType.ADD_TO_CART_EVENT]="AddToCart",r[i.UnifiedEventType.REMOVE_FROM_CART_EVENT]=null,r[i.UnifiedEventType.CHECKOUT_EVENT]="InitiateCheckout",r[i.UnifiedEventType.PURCHASE_EVENT]="Purchase",r[i.UnifiedEventType.VIEW_CART]="InitiateCheckout",r[i.UnifiedEventType.TRANSACTION_EVENT]=null,r[i.UnifiedEventType.PAGE_VIEW_EVENT]=null,r);t.insertMetaPixel=function(e,t){var n,r,a;if(e.metaPixelId&&(!(null===(a=null===(r=null===(n=e.winRef)||void 0===n?void 0:n.location)||void 0===r?void 0:r.host)||void 0===a?void 0:a.endsWith(".mediaexpert.pl"))||t.eventType===i.UnifiedEventType.PRODUCT_DETAIL_EVENT)){var c=o[t.eventType];if(c){var u=function(e){(new Image).src=e},d="https://www.facebook.com/tr?id=".concat(e.metaPixelId,"&ev=").concat(c);t.products&&t.products.length?t.products.forEach((function(e){var t=d;e.name&&(t+="&cd[content_name]=".concat(encodeURIComponent(e.name))),e.category&&(t+="&cd[content_category]=".concat(encodeURIComponent(e.category))),e.price&&(t+="&cd[value]=".concat(encodeURIComponent(e.price))),e.id&&(t+="&cd[content_ids]=".concat(encodeURIComponent(e.id))),u(t)})):u(d)}}}},845:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.handleRetailMediaNetworkEvent=t.updateOfferIds=void 0;var r=n(185);function i(e,t,n){t.keyvalues=t.keyvalues||{};var i=new Set(n.concat(t.keyvalues.offer_ids||[]).filter((function(e){return Boolean(e)})).map((function(e){return String(e)}))),o=Array.from(i);t.offersContextTargeting?t.keyvalues.offer_ids=o:(0,r.saveToSessionStorage)(e,"offer_ids",o)}t.updateOfferIds=i,t.handleRetailMediaNetworkEvent=function(e,t){var n,r=e.winRef.dlApi,o=(null===(n=t.products)||void 0===n?void 0:n.map((function(e){return e.id})))||[];i(e.winRef,r,o)}},562:function(e,t){var n,r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.sumProducts=t.UnifiedEventSource=t.SiteType=t.UnifiedEventType=void 0,function(e){e[e.PRODUCT_LIST_EVENT=0]="PRODUCT_LIST_EVENT",e[e.PRODUCT_DETAIL_EVENT=1]="PRODUCT_DETAIL_EVENT",e[e.ADD_TO_CART_EVENT=2]="ADD_TO_CART_EVENT",e[e.REMOVE_FROM_CART_EVENT=3]="REMOVE_FROM_CART_EVENT",e[e.CHECKOUT_EVENT=4]="CHECKOUT_EVENT",e[e.PURCHASE_EVENT=5]="PURCHASE_EVENT",e[e.TRANSACTION_EVENT=6]="TRANSACTION_EVENT",e[e.VIEW_CART=7]="VIEW_CART",e[e.PAGE_VIEW_EVENT=8]="PAGE_VIEW_EVENT"}(n||(t.UnifiedEventType=n={})),function(e){e.PRODUCT_DETAIL_SITE="product",e.CART_SITE="cart"}(r||(t.SiteType=r={})),function(e){e[e.UNIVERSAL_ANALYTICS=0]="UNIVERSAL_ANALYTICS",e[e.GOOGLE_ANALYTICS_4=1]="GOOGLE_ANALYTICS_4",e[e.GOOGLE_ANALYTICS_4_GTAG=2]="GOOGLE_ANALYTICS_4_GTAG",e[e.GOOGLE_ANALYTICS_4_FALLBACK=3]="GOOGLE_ANALYTICS_4_FALLBACK"}(i||(t.UnifiedEventSource=i={})),t.sumProducts=function(e){var t=e.reduce((function(e,t){var n;return e+(null!==(n=t.price)&&void 0!==n?n:0)*t.quantity}),0);return{cost:Math.round(100*t)/100,quantity:e.reduce((function(e,t){return e+t.quantity}),0)}}},595:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.extractContext=void 0,t.extractContext=function(e){var t,n,r,i,o,a,c,u,d,s,v,l=e.data.fields,E=l.sendGoogleConversions;return{dataLayerObjectName:l.source_dl||"dataLayer",winRef:window.parent,eventSourcePerType:{},metaPixelId:(null===(t=l.sendMetaPixel)||void 0===t?void 0:t.value)&&(null===(r=null===(n=l.sendMetaPixel)||void 0===n?void 0:n.fields)||void 0===r?void 0:r.pixelId)||null,googleConversionTrackingId:(null==E?void 0:E.value)&&(null===(i=null==E?void 0:E.fields)||void 0===i?void 0:i.conversionTrackingId)||null,googleAdsSendViewItemEvent:(null==E?void 0:E.value)&&!!(null===(o=null==E?void 0:E.fields)||void 0===o?void 0:o.sendViewItemEvent)||!1,googleBusinessVertical:(null===(a=null==E?void 0:E.fields)||void 0===a?void 0:a.googleBusinessVertical)||"retail",googleMeasurementId:(null===(c=l.sendGoogleMeasurements)||void 0===c?void 0:c.value)&&(null===(d=null===(u=l.sendGoogleMeasurements)||void 0===u?void 0:u.fields)||void 0===d?void 0:d.measurementId)||null,joinAdInterestGroup:null!==(v=null===(s=l.joinAdInterestGroup)||void 0===s?void 0:s.value)&&void 0!==v?v:1}}},862:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.renderGoogleEcommerce=t.markGoogleEcommerceAsRendered=t.isGoogleEcommerceRendered=t.dataLayerEventHandler=void 0;var r=n(28),i=n(185),o=n(434),a=n(184),c=n(29),u=n(866),d=n(462),s=n(310),v=n(632),l=n(845),E=n(562),p=n(595),f=function(e){var t=e.data.fields,n=(0,p.extractContext)(e);return n.eventWhitelist=function(e){return new Set((e.activityEventsWhitelist||[]).map((function(e){return e.id})))}(t),n.activityGroup={id:t.activityGroup?t.activityGroup.activityGroupId:0,network:t.activityGroup?t.activityGroup.networkId:""},n};function _(e,t){for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(o.__raspPixel)return!1;if((0,d.isGA4EcommerceEvent)(o))(T=(0,d.parseGa4Event)(o))&&(T._eventSource=E.UnifiedEventSource.GOOGLE_ANALYTICS_4,n.push(T));else if((0,d.isGtagEcommerceEvent)(o)){var p={event:o[1],ecommerce:o[2]};(T=(0,d.parseGa4Event)(p))&&(T._eventSource=E.UnifiedEventSource.GOOGLE_ANALYTICS_4_GTAG,n.push(T))}else if((0,s.isUaEcommerceEvent)(o))for(var f=0,_=(0,s.parseUaEvents)(o);f<_.length;f++){(T=_[f])._eventSource=E.UnifiedEventSource.UNIVERSAL_ANALYTICS,n.push(T)}else{var T;if(p=(0,d.getGA4FallbackEvent)(o))(T=(0,d.parseGa4Event)(p))&&(T._eventSource=E.UnifiedEventSource.GOOGLE_ANALYTICS_4_FALLBACK,n.push(T))}}for(var y=0,m=n;y<m.length;y++){var g=m[y];if(void 0===e.eventSourcePerType[g.eventType]||e.eventSourcePerType[g.eventType]===g._eventSource){void 0===e.eventSourcePerType[g.eventType]&&(e.eventSourcePerType[g.eventType]=g._eventSource);var A=(0,a.sendAdpActivityEvent)(e,g);g.eventType!==E.UnifiedEventType.PAGE_VIEW_EVENT&&(A||(0,l.handleRetailMediaNetworkEvent)(e,g),(0,v.insertMetaPixel)(e,g),(0,c.sendGoogleMetric)(e,g),(0,u.sendGoogleConversionTracking)(e,g))}}}t.dataLayerEventHandler=_;var T=!1;t.isGoogleEcommerceRendered=function(){return T};t.markGoogleEcommerceAsRendered=function(){return T=!0},t.renderGoogleEcommerce=function(e){var n;if((0,t.isGoogleEcommerceRendered)())(0,i.logMessage)("Template was already rendered.",e);else{var c=e.data.fields;if(""!==c.activityGroup){var u=f(e);!function(e,t){var n=e.dataLayerObjectName,r=e.winRef;r[n]=r[n]||[];var o=r.parent[n],a=o.push;if(o.dlOriginalPushMethod=a,Object.defineProperty(o,"push",{configurable:!0,set:function(e){this.dlOriginalPushMethod=e,Object.defineProperty(this,"push",{writable:!0,value:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{t(e)}catch(e){(0,i.logMessage)("Error while processing event",e)}return a.apply(o,e)}})},get:function(){return this.dlOriginalPushMethod}}),o.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.apply(o,e)},o.length)try{t(o)}catch(e){(0,i.logMessage)("Error while processing events queue",e)}}(u,_.bind(null,u)),(null===(n=c.topicsApiEnabled)||void 0===n?void 0:n.value)&&((0,o.isTopicsApiAvailable)()?(0,o.embedTopicsApiIframe)(r.default.TOPICS_API_IFRAME_SRC):(0,i.devLog)("document.browsingTopics() is not supported on this page")),u.eventWhitelist.has(a.ADP_EVENTS[E.UnifiedEventType.PAGE_VIEW_EVENT]||"")&&(0,a.sendAdpActivityEvent)(u,{eventType:E.UnifiedEventType.PAGE_VIEW_EVENT}),(0,t.markGoogleEcommerceAsRendered)()}else(0,i.logMessage)("Missing activity group in tag.",e)}}},978:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.render=void 0;var r=n(185),i=n(862),o=n(778),a=n(185),c={"lps/Google-Ecommerce":i.renderGoogleEcommerce,"lps/Ecommerce-Events-Reporter":o.renderEcommerceEventsReporter,default:function(e){(0,r.logMessage)("Tag template code is not supported.",e)}};t.render=function(e){e.forEach((function(e){try{!function(e){(c[e.data.tplCode]||c.default)(e)}(e),(0,a.devLog)('Tag rendered: "'.concat(e.adid,'", template: "').concat(e.data.tplCode,'"'))}catch(t){(0,r.logMessage)('Problem while rendering tag: "'.concat(e.adid,'", template: "').concat(e.data.tplCode,'"'),t)}}))}},434:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isTopicsApiAvailable=t.embedTopicsApiIframe=void 0;var r=n(185);t.embedTopicsApiIframe=function(e){try{var t=document.createElement("iframe");t.src=e,t.width="0",t.height="0",t.name="topics-api-iframe",t.style.display="none",document.body.appendChild(t)}catch(e){(0,r.logMessage)("Error while creating topics-api iframe",e)}},t.isTopicsApiAvailable=function(){return"browsingTopics"in document&&"featurePolicy"in document&&document.featurePolicy.allowsFeature("browsing-topics")}},397:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(518),o=n(978),a=n(434),c=n(185);!function(){(0,c.devLog)("E-commerce pixel module script loaded.");var e=window.dlApiDefine;e?e("pixel",[],(function(e){var t=e.module;(0,c.devLog)("dlApiDefine module constructor."),t.exports={init:function(e,t){var n;(0,c.devLog)("dlApiDefine module initialization."),i.default.init(t,e),e.sendActivityEvent=i.default.sendActivityEvent,i.default.defineDlApiFunctions(e,t),Object.defineProperty(e,"offersContextTargeting",{enumerable:!0,get:function(){return n},set:function(e){var i,o,a,u=function(e,t){return Array.from(new Set(r(r([],e||[],!0),t||[],!0)))};if(!e&&(null===(i=this.keyvalues)||void 0===i?void 0:i.offer_ids)){var d=(0,c.getFromSessionStorage)(t,"offer_ids")||[];(0,c.saveToSessionStorage)(t,"offer_ids",u(null===(o=this.keyvalues)||void 0===o?void 0:o.offer_ids,d)),delete this.keyvalues.offer_ids}else if(e){d=(0,c.getFromSessionStorage)(t,"offer_ids")||[];this.keyvalues.offer_ids=u(null===(a=this.keyvalues)||void 0===a?void 0:a.offer_ids,d)}n=e}}),function(e){var t=function(e,t,n){var r;(0,o.render)([{adid:(null===(r=null==e?void 0:e.onetAd)||void 0===r?void 0:r.adid)||"",data:{tplCode:e.tplCode,fields:e.fields}}])};if(e.registerTemplate)for(var n=0,r=["lps/Google-Ecommerce","lps/Ecommerce-Events-Reporter"];n<r.length;n++){var i=r[n];e.registerTemplate({tplCode:i,renderAd:t})}else console.error("dlApi.registerTemplate is not defined.")}(e)},sendActivity:i.default.sendActivity,isTopicsApiAvailable:a.isTopicsApiAvailable,embedTopicsApiIframe:a.embedTopicsApiIframe}})):(0,c.logMessage)("dlApiDefine is not defined.")}()},185:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getTopWindow=t.saveToSessionStorage=t.getFromSessionStorage=t.devLog=t.logMessage=t.getParamsFromUrl=void 0;var r=n(28);t.getParamsFromUrl=function(e){var t=e.location.search;return new URLSearchParams(t)},t.logMessage=function(e,t){r.default.ENABLE_LOGGING&&(t?console.log("[RASP pixel]: ".concat(e),t):console.log("[RASP pixel]: ".concat(e)))};t.devLog=function(e){0},t.getFromSessionStorage=function(e,t){var n=null;try{var r=e.sessionStorage&&e.sessionStorage.getItem(t);null!==r&&(n=JSON.parse(r))}catch(e){console.error("Error parsing session storage item:",e)}return n},t.saveToSessionStorage=function(e,t,n){try{var r=JSON.stringify(n);e.sessionStorage&&e.sessionStorage.setItem(t,r)}catch(e){console.error("Error storing item in session storage:",e)}},t.getTopWindow=function(){var e;try{if(!(null===(e=window.top)||void 0===e?void 0:e.document))return null}catch(e){return null}return window.top}}},t={};(function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports})(397)}();