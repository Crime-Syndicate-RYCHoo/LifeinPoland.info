define("plugins/counter",["require","adapter/dom","common/basePlugin","adapter/jsClass","adapter/enumerable"],function(e){var t=e("adapter/dom"),n=e("common/basePlugin"),r=e("adapter/jsClass"),i=e("adapter/enumerable"),s=r.Class(n,{constructor:function(e,n,r,o){var u={elemTxt:"#elem-textarea",elemCounter:"#letter-counter",limit:2048};this.context=t.find("#"+e),this.settings=i.defaults(o,u),this.elemTxt=t.find(this.settings.elemTxt,this.context),this.elemCounter=t.find(this.settings.elemCounter,this.context),s.$super.call(this,e,n,r,o),t.removeAttribute(this.elemTxt,"maxlength"),$(this.elemTxt).keyup(this.initAction.bind(this)),t.on(this.elemTxt,"keyup",null,null,this.onDeleteAction.bind(this)),this.initAction()},initAction:function(e){BACKSPACE_KEY=8,DELETE_KEY=46,ENTER_KEY=13,TAB_KEY=9;var n=t.getProperty(this.elemTxt,"value"),r=n.replace(/\n/g,"☻☻"),i=this.settings.limit-r.length;e!=undefined&&!e.keyCode==TAB_KEY&&(i-=1);if(i<0&&e.keyCode!=DELETE_KEY&&e.keyCode!=BACKSPACE_KEY)return e.preventDefault(),!1;t.append(this.elemCounter,i.toString(),"inside")},onDeleteAction:function(e){if(e.keyCode!=37&&e.keyCode!=38&&e.keyCode!=39&&e.keyCode!=40){var n=$(this.elemTxt).prop("selectionStart"),r=$(this.elemTxt).prop("selectionEnd"),i=t.getProperty(this.elemTxt,"value"),s=i.replace(/\n/g,"☻☻");while(s.length>this.settings.limit)/☻☻$/.test(s)?s=s.slice(0,-2):s=s.slice(0,-1);s=s.replace(/☻☻/g,"\n"),t.setProperty(this.elemTxt,"value",s),$(this.elemTxt).prop({selectionStart:n,selectionEnd:r});if(e!=undefined&&e.which===8){var i=t.getProperty(this.elemTxt,"value"),o=i.split("\n").length-1,u=i.length+o,a=this.settings.limit-u;t.append(this.elemCounter,a.toString(),"inside")}}}});return s});