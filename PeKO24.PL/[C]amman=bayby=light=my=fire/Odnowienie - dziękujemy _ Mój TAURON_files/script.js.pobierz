var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,o=arguments.length;a<o;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Accordion=function(){var t=dom.query(".accordion");t.children(".accordion-item").children(".accordion-item-header").click(function(){var e=dom.query(this).parent();e.hasClass("active")?e.removeClass("active"):(t.hasClass("accordion-nocollapse")||t.children(".accordion-item").removeClass("active"),e.addClass("active"))})},AlertCarousel=function(){function e(){this.time=5e3;var t=this;this.container=dom.query(".alert-carousel"),this.alertList=this.getAlerts(),this.alertList.on("click",".close-button",function(){if(t.showNextAlert(),dom.query(this).parent(".alert").remove(),t.alertList=t.getAlerts(),0===t.alertList.length){var e=document.querySelector(".alert-carousel");e instanceof HTMLElement&&(e.style.display="none")}});var e=this.container.attr("data-time");e&&(this.time=e),this.showAlert(this.alertList.first()),this.interval=setInterval(function(){1<t.alertList.length?t.showNextAlert():t.stop()},t.time)}return e.prototype.stop=function(){clearInterval(this.interval)},e.prototype.showAlert=function(e){var t=this,a=e.outerHeight();this.container.css({minHeight:a,height:a}),e.slideDown(function(){e.addClass("active"),dom.removeInlineCss(t.container,"height")})},e.prototype.getAlerts=function(){return this.container.find(".alert")},e.prototype.getCurrentAlert=function(){return this.getAlerts().filter(".active")},e.prototype.getNextAlert=function(e){return e.next(".alert")},e.prototype.showNextAlert=function(){var e=this,t=this.getCurrentAlert();t.slideUp(),t.removeClass("active");var a=e.getNextAlert(t);a.length?e.showAlert(a):e.showAlert(e.getAlerts().first())},e}(),Attachment=function(){function e(){this.containers=dom.query(".attachments-download-container"),this.initDownload()}return e.prototype.initDownload=function(){var n=this;this.containers.children(".attachments-download-container-file").click(function(){var e=dom.query(this).parent(),t=dom.query(this).attr("data-attachment-id"),a=dom.query(this).attr("data-attachment-checksum");n.hideError(e);var o={attachmentId:t,checksum:a};return n.getAjaxFileApi(e,"/api/sitecore/EbokSzczegolyWiadomosci/GetReceivedSodAttachment",o),!1})},e.prototype.showError=function(e){e.addClass("has-error"),e.removeClass("has-download")},e.prototype.cleanClass=function(e){e.removeClass("has-error"),e.removeClass("has-download")},e.prototype.hideError=function(e){e.removeClass("has-error"),e.addClass("has-download")},e.prototype.getParam=function(e,t){return"undefined"!=e[t]?e[t]:null},e.prototype.convertToByteArray=function(e){for(var t=window.atob(e),a=new Array(t.length),o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return new Uint8Array(a)},e.prototype.downloadFile=function(e,t){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var a=window.URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=t,o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(function(){window.URL.revokeObjectURL(a),o.remove()},100)}},e.prototype.getAjaxFileApi=function(s,e,t){var d=this;e?dom.query.ajax({url:e,data:t,type:"GET"}).done(function(e){var t;if("object"==typeof e)t=e;else try{t=JSON.parse(e)}catch(e){d.showError(s)}var a=d.getParam(t,"status"),o=d.getParam(t,"file"),n=d.getParam(t,"name");if("OK"==a&&""!=o&&""!=n){var i=d.convertToByteArray(o),r=new Blob([i],{type:"application/octet-stream"});d.downloadFile(r,n),d.cleanClass(s)}else d.showError(s)}).fail(function(){d.showError(s)}):d.showError(s)},e}(),BoxYesNo=function(e){this.container=dom.query(e),this.columnYes=this.container.find(".column-answer-yes"),this.columnNo=this.container.find(".column-answer-no");var t=this;this.columnYes.find(".yes-no-icon").each(function(e,t){dom.query(t).text(e+1)}),this.columnYes.find(".yes-no-circle").click(function(){return t.columnNo.removeClass("active"),t.columnYes.addClass("active"),!1}),this.columnNo.find(".yes-no-circle").click(function(){return t.columnYes.removeClass("active"),t.columnNo.addClass("active"),!1})},Checkbox=function(){function e(e){this.input=dom.query(e)}return e.prototype.isEnabled=function(){return this.input.is(":enabled")},e.prototype.setChecked=function(e){this.input.prop("checked",e)},e.prototype.isChecked=function(){return this.input.prop("checked")},e.prototype.getInput=function(){return this.input[0]},e.prototype.setActive=function(e){this.input.parent().find(".checkbox-icon").toggleClass("inactive",!e)},e}(),ClipboardUtils=function(){function e(){var o=this,e=dom.query("main");document.queryCommandSupported("copy")||(e.find(".copy-data-link").hide(),e.find(".copy-account").hide()),e.on("click",".copy-data-link",function(){var e=o.getNewLine(),t=dom.query(this).parent().parent().children(),a=dom.query(t[1]).find("span").text()+e+(dom.query(t[3]).text()+e)+dom.query(t[5]).text();return o.copyToClipboard(a),!1}),e.on("click",".copy-account",function(){var e=dom.query(this).parent().find("span").text();return o.copyToClipboard(e),!1})}return e.prototype.copyToClipboard=function(e){var t=document.createElement("textarea");if(t.style.position="fixed",t.style.top="0",t.style.left="0",dom.query(t).text(e),document.body.appendChild(t),navigator.userAgent.match(/ipad|ipod|iphone/i)){var a=document.createRange();a.selectNodeContents(t);var o=window.getSelection();o.removeAllRanges(),o.addRange(a),t.setSelectionRange(0,999999)}else t.select();document.queryCommandEnabled("copy")?document.execCommand("copy"):alert("Kopiowanie zablokowane."),document.body.removeChild(t)},e.prototype.getNewLine=function(){var e=navigator.platform.toLowerCase();return-1!=e.indexOf("win")?"\r\n":-1!=e.indexOf("mac")?"\r":"\n"},e}(),DOM=function(){function e(){if(this.RESIZE_DELAY=250,this.LIB_NAME="jQuery",this.selector={CHECKBOX:'input[type="checkbox"]',ENABLED_CHECKBOX:'input[type="checkbox"]:enabled'},!window[this.LIB_NAME])throw new Error(this.LIB_NAME+" not found!");this.query=window[this.LIB_NAME]}return e.prototype.removeInlineCss=function(e,t){e.css(t,"")},e.prototype.findCheckboxes=function(e,t){t||(t=this.selector.CHECKBOX);var a=new Array;return e.find(t).each(function(){a.push(new Checkbox(this))}),a},e.prototype.setCheckedAll=function(e,t){e.forEach(function(e){e.setChecked(t)})},e}(),DataTableLayout=function(){function i(){this.CARET_HTML="<span class='caret'></span>",this.SLIDE_UP_HTML="Zwiń "+this.CARET_HTML,this.SLIDE_DOWN_HTML="Rozwiń "+this.CARET_HTML,this.activePage=1,this.container=dom.query(".table-layout"),this.handleDisabledLinks(),this.initToggleButtons(),this.initCheckboxes(),this.addWindowResizeEvent(),this.dataFillTables(),this.toggleFilters(),this.initAutoDownload()}return i.onChange=function(e){this.onChangeFn=e},i.setInactiveMessage=function(e){this.inactiveMessage=e},i.prototype.updateView=function(){this.updateControlls()},i.prototype.updateSumControll=function(e,t){var a=t.toString().replace(/\./g,",");e.text(a+" zł");var o=e.closest(".amount-column").find(".btn-primary, .btn-default");o&&(0===parseFloat(t)?this.disableButton(o):this.enableButton(o))},i.prototype.enableButton=function(e){e.removeAttr("data-link-disabled")},i.prototype.disableButton=function(e){e.attr("data-link-disabled",!0)},i.prototype.addWindowResizeEvent=function(){var e,t=this;dom.query(window).resize(function(){clearTimeout(e),e=setTimeout(function(){dom.query(".table-expanded").each(function(){t.fitInnerTableHeight(dom.query(this))})},dom.RESIZE_DELAY)})},i.prototype.handleDisabledLinks=function(){this.container.delegate("[data-link-disabled]","click",function(){return!1})},i.prototype.expandTableRow=function(e){e.addClass("table-expanded"),this.fitInnerTableHeight(e)},i.prototype.hideTableRow=function(e){e.removeClass("table-expanded")},i.prototype.toggleDetailsRow=function(e,t){var a="row-expanded";!0===t?e.addClass(a):!1===t?e.removeClass(a):e.toggleClass(a)},i.prototype.initToggleButtons=function(){var i="expanded",r=this;this.container.delegate(".toggle-button","click",function(e){var t=dom.query(this),a=t.parent(),o=a.parent();if(o.hasClass("row")){var n=o.next().next(".row-table-container");o.toggleClass(i),o.hasClass(i)?(r.toggleDown(t),r.expandTableRow(n)):(r.hideTableRow(n),r.toggleDetailsRow(n.prev(".row-details-container"),!1),r.toggleUp(t))}else a.toggleClass(i),a.hasClass(i)?r.toggleUp(t):r.toggleDown(t);e.preventDefault()}),this.container.delegate(".toggle-details-button","click",function(e){var t=dom.query(this).parents(".amount-column").parent().next(".row-details-container");r.toggleDetailsRow(t),e.preventDefault()})},i.prototype.selectCheckboxesInOrder=function(e){var t=!0;e.forEach(function(e){e.isEnabled()&&(t?e.setActive(!0):(e.setChecked(!1),e.setActive(!1)),e.isChecked()||(t=!1))})},i.prototype.updateControlls=function(){var s=this,d=0,l=0,e=s.container.find(".row-table-container"),t=new Checkbox(s.container.find("[data-select-all]")),a=s.container.find("#ebokPayAllChecked");if(0<e.length?e.each(function(){var e=dom.query(this),t=s.getTableCheckboxes(e,!1),o=0;s.selectCheckboxesInOrder(t),t.forEach(function(e,t){var a=dom.query(e.getInput()).closest(".row").find(".btn");0==t&&e.isChecked()?s.enableButton(a):s.disableButton(a),e.isChecked()&&o++});var a=o===t.length,n=e.find(".check-all-in-pp-sum"),i=e.prev().prev().find(".check-all-in-pp-expanded"),r=e.find(".ebok-button-pay-all-agreement");n.prop("checked",a),i.prop("checked",a),0<o?s.enableButton(r):s.disableButton(r),l+=t.length,d+=o}):s.container.find(".amount-column").each(function(){var e=dom.query(this),t=dom.findCheckboxes(e.find(".toggle-box")),a=e.find(".ebok-button-pay-agreement"),o=new Checkbox(e.find(".ebok-checkbox-payment"));if(0<t.length){var n=0;t.forEach(function(e,t){e.isChecked()&&n++,l++});var i=n===t.length;o.setChecked(i),0<n?s.enableButton(a):s.disableButton(a),d+=n}else o.isChecked()?s.enableButton(a):s.disableButton(a)}),0<d||0<l)t.setChecked(d==l);else{var o=s.container.find(".ebok-checkbox-payment"),n=o.filter(":checked");t.setChecked(o.length===n.length)}0<d?s.enableButton(a):s.disableButton(a),i.onChangeFn&&i.onChangeFn()},i.prototype.getAllEnabledCheckboxes=function(){return dom.findCheckboxes(this.container,dom.selector.ENABLED_CHECKBOX)},i.prototype.getTableCheckboxes=function(e,t){var a=".table-wrapper [data-charge-id]";return t?dom.findCheckboxes(e,a+":enabled"):dom.findCheckboxes(e,a)},i.prototype.initCheckboxes=function(){var d=this;if(this.container.on("change",dom.selector.ENABLED_CHECKBOX,function(){var e=dom.query(this),t=e.prop("checked");if(e.hasClass("check-all-in-pp-sum")){var a=e.closest(".row"),o=d.getTableCheckboxes(a,!0);dom.setCheckedAll(o,t)}else if(e.hasClass("check-all-in-pp-expanded")){var n=e.closest(".row").next().next(".row-table-container");o=d.getTableCheckboxes(n,!0);dom.setCheckedAll(o,t)}else if(e.is("[data-select-all]")){var i=d.getAllEnabledCheckboxes();dom.setCheckedAll(i,t)}else if(e.hasClass("ebok-checkbox-payment")){var r=e.closest(".amount-column").find(".toggle-box"),s=dom.findCheckboxes(r,dom.selector.ENABLED_CHECKBOX);dom.setCheckedAll(s,t)}d.updateControlls()}),i.inactiveMessage){var t=dom.query("<div>",{class:"inactive-checkbox-msg tooltip",text:i.inactiveMessage});dom.query(document.body).append(t),this.container.delegate(".inactive","mouseenter",function(){var e=dom.query(this).parent().offset();t.css({top:e.top,left:e.left}),t.show()}),this.container.delegate(".inactive","mouseleave",function(){t.hide()})}},i.prototype.convertToByteArray=function(e){for(var t=window.atob(e),a=new Array(t.length),o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return new Uint8Array(a)},i.prototype.downloadFile=function(e,t){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var a=window.URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=t,o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(function(){window.URL.revokeObjectURL(a),o.remove()},100)}},i.prototype.toggleUp=function(e){e.html(this.SLIDE_DOWN_HTML)},i.prototype.toggleDown=function(e){e.html(this.SLIDE_UP_HTML)},i.prototype.fitInnerTableHeight=function(e){if(e.find("table").length){var t=e.find(".row-above-table").height()?e.find(".row-above-table").height():0,a=e.find("table").height(),o=e.find(".pagination").height()?e.find(".pagination").height()-18:0,n=e.find(".sum-wrapper").outerHeight();e.height(t+a+o+n+3)}},i.prototype.toggleFilters=function(){var t=this;dom.query(".filters-row").hide(),dom.query(".table-layout-container").on("click",".btn-show-filters",function(){var e=dom.query(this).closest(".filters").find(".filters-row");return e.toggle(),e.is(":visible")?dom.query(this).addClass("btn-show-filters-expand"):dom.query(this).removeClass("btn-show-filters-expand"),t.fitInnerTableHeight(dom.query(this).closest(".table-expanded")),!1})},i.prototype.goToPage=function(e){this.activePage=dom.query(e).data("page");var t=dom.query(e).closest("[data-ajaxfill]");return this.dataAjaxFillTable(t),!1},i.prototype.dataFillTables=function(){var a=this;dom.query("[data-ajaxfill]").each(function(e,t){a.initTableButtons(t),a.searchFilters(dom.query(t).find(".filters"))})},i.prototype.getParam=function(e,t){return"undefined"!=e[t]?e[t]:null},i.prototype.dataAjaxFillTable=function(e){var t,i=this,r=dom.query(e),a=r.find("[data-table]"),o=r.data("api-url"),n=r.data("api-json"),s=r.data("api-excel-url"),d=r.data("api-excel-filename"),l=r.data("client-number"),c=r.data("client-checksum"),u=r.data("system"),h=r.data("text-error"),p=r.data("text-none"),f=r.find("[data-pagination]"),m=a.find("tbody"),v=r.find(".table-spinner"),y=a.find("[data-template-row]"),g=a.find("[data-template-none]"),b=r.find(".filters"),w=b.find(".active[data-pikaday-start]").val(),C=b.find(".active[data-pikaday-end]").val(),q=b.find(".active[data-select-type]").find("option:selected").val(),k=b.find(".active[data-doc-number]").val(),x=b.find(".active[data-payment-from]").val(),T=b.find(".active[data-payment-to]").val(),E=r.find("[data-excel]"),A=[],S=r.data("perpage"),D=0,L=this.activePage*S-S+1,P=this.activePage*S;function I(e){var t,a=function(e){var t;t="object"==typeof e?e:JSON.parse(e);return"OK"==i.getParam(t,"Status")?(A=i.getParam(t,"Documents"),D=i.getParam(t,"TotalNumber"),L=i.getParam(t,"RangeFrom"),P=i.getParam(t,"RangeTo"),!0):(E.off("click").hide(),!1)}(e);if(m.css("visibility","visible"),v.hide(),m.empty(),a){E.show();var o=function(){var e=dom.query("<div/>");if(0<A.length){var t=0;for(var a in A){if(S<++t)break;var o=y.clone();o.removeAttr("data-template-row"),o.show();var n=A[a];for(var i in n)o.find("[data-param="+i+"]").html(n[i]),o.find("[data-param-href="+i+"]").attr("href",n[i]),o.find("[data-href="+i+"]").attr("href","#").attr("data-base",n[i]);e.append(o)}f.empty().show()}else{var r=g.clone().removeAttr("data-template-none").show();r.find("span").html(p),e.html(r),E.off("click").hide(),f.empty().hide()}return e.html()}();m.html(o),i.initDownloadHref(r),function(){for(var e=Math.ceil(D/S),t=!1,a=1;a<=e;a++){var o=a.toString();if(1==a||2==a||3==a||a==i.activePage-2||a==i.activePage-1||a==i.activePage||a==i.activePage+1||a==i.activePage+2||a==e-2||a==e-1||a==e){t=!1;var n=dom.query("<a/>").html(o).attr("data-page",a).attr("href","").on("click",function(){return i.goToPage(this),!1});parseInt(o)==i.activePage&&n.addClass("active"),f.append(n),parseInt(o)!=e&&f.append(" / ")}else t||f.append("... / "),t=!0}}(),t={clientNumber:l,clientNumberCheckSum:c,system:u,from:w,to:C,docKind:q,docNumber:k,paymentFrom:x,paymentTo:T},E.off("click").click(function(){var e=d.trim()+".xlsx";return i.getAjaxFileApi(dom.query(this).parent().parent(),s,e,"xlsx",t),!1})}else O();var n=dom.query(window).scrollTop();i.fitInnerTableHeight(r.closest(".table-expanded")),dom.query(window).scrollTop(n)}function O(){m.empty();var e=g.clone().removeAttr("data-template-none").show();e.find("span").addClass("simple-error").html(h),m.html(e),f.empty().hide(),E.off("click").hide(),i.fitInnerTableHeight(r.closest(".table-expanded"))}t={rangeFrom:L,rangeTo:P,clientNumber:l,clientNumberCheckSum:c,system:u,from:w,to:C,docKind:q,docNumber:k,paymentFrom:x,paymentTo:T},m.css("visibility","hidden"),v.show(),E.hide(),i.hideError(r),i.fitInnerTableHeight(r.closest(".table-expanded")),void 0!==n&&""!=n?I(n.replace(/'/g,'"')):dom.query.ajax({url:o,type:"GET",data:t}).done(function(e){I(e)}).fail(function(){m.css("visibility","visible"),v.hide(),O()})},i.prototype.initTableButtons=function(e){var t=this,a=dom.query(e),o=a.find("[data-search]"),n=a.find("[data-clean]"),i=a.find(".filters");o.on("click",function(){return t.searchFilters(i),dom.query(this).blur(),!1}),n.on("click",function(){return t.cleanFilters(i),!1})},i.prototype.searchFilters=function(e){this.activePage=1;var t=e.find("[data-pikaday-start]"),a=e.find("[data-pikaday-end]"),o=e.find("[data-select-type]"),n=e.find("[data-doc-number]"),i=e.find("[data-payment-from]"),r=e.find("[data-payment-to]");t.val()?t.addClass("active"):t.removeClass("active"),a.val()?a.addClass("active"):a.removeClass("active"),o.addClass("active"),n.addClass("active"),i.addClass("active"),r.addClass("active"),t.val()||a.val()||"all"!=o.find("option:selected").val()||n.val()?e.find("[data-clean]").show():e.find("[data-clean]").hide();var s=e.closest("[data-ajaxfill]");this.dataAjaxFillTable(s)},i.prototype.cleanFilters=function(e){var t=new Date,a=new Date;t.setMonth(t.getMonth()-6);var o=e.find("[data-pikaday-start]").data("pikaday"),n=e.find("[data-pikaday-end]").data("pikaday");o.setDate(t),n.setDate(a),e.find("[data-select-type]").find("option:selected").prop("selected",!1),e.find("[data-doc-number]").val(""),e.find("[data-payment-from]").val(""),e.find("[data-payment-to]").val(""),e.find("[data-filter]").removeClass("active"),this.searchFilters(e)},i.prototype.getAjaxFileApi=function(r,e,s,t,a){var d=this,l="application/octet-stream";"pdf"==t&&(l="application/pdf"),"xls"!=t&&"xlsx"!=t||(l="application/vnd.ms-excel"),e?dom.query.ajax({url:e,data:a,type:"GET"}).done(function(e){var t;if("object"==typeof e)t=e;else try{t=JSON.parse(e)}catch(e){d.showError(r)}var a=d.getParam(t,"Status"),o=d.getParam(t,"Document");if("OK"==a&&""!=o){var n=d.convertToByteArray(o),i=new Blob([n],{type:l});d.downloadFile(i,s)}else d.showError(r)}).fail(function(){d.showError(r)}):d.showError(r)},i.prototype.initDownloadHref=function(e){var a=this;dom.query(e).find("a[data-href]").each(function(){var t=dom.query(this);t.off("click"),""!=t.attr("data-base")?t.click(function(){a.hideError(t.parent());var e=t.text().trim()+".pdf";return a.getAjaxFileApi(t.closest("tr"),dom.query(t).attr("data-base"),e,"pdf",{}),!1}):t.replaceWith(dom.query("<span>"+dom.query(t).html()+"</span>"))})},i.prototype.showError=function(e){e.find("[data-error]").show(),this.fitInnerTableHeight(e.closest(".table-expanded"))},i.prototype.hideError=function(e){e.find("[data-error]").hide(),this.fitInnerTableHeight(e.closest(".table-expanded"))},i.prototype.initAutoDownload=function(){var t=this;dom.query(".table-inside[data-url-download]").each(function(){var e=dom.query(this);t.hideError(e),t.initDownloadHref(e)})},i}(),Datepicker=function(){function e(){this.defaultBefore=36,this.format="DD.MM.YYYY",this.i18n={previousMonth:"Poprzedni meisiąc",nextMonth:"Następny miesiąc",months:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],weekdays:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],weekdaysShort:["Nie","Pon","Wto","Śr","Czw","Pią","Sob"]},this.run()}return e.prototype.getMinDate=function(e){var t=new Date;return null!=e?t.setMonth(t.getMonth()-e):t.setMonth(t.getMonth()-this.defaultBefore),t},e.prototype.run=function(){var l=this;dom.query("[data-pikaday-main]").each(function(){var t,a,e=this.getAttribute("data-before-months"),o=function(){i.setStartRange(t),r.setStartRange(t),r.setMinDate(t)},n=function(){i.setEndRange(a),i.setMaxDate(a),r.setEndRange(a)};dom.query(this).find("[data-pikaday]").pikaday({format:l.format,i18n:l.i18n,toString:function(e,t){var a=e.getDate(),o=e.getMonth()+1;return(a=a<10?"0"+a:a)+"."+(o=o<10?"0"+o:o)+"."+e.getFullYear()},parse:function(e,t){var a=(e=e.replace(/-/g,".")).split("."),o=parseInt(a[0],10),n=parseInt(a[1],10)-1,i=parseInt(a[2],10),r=new Date(i,n,o);if(isNaN(r.getTime())){var s=(e=dom.query(this.field).attr("data-value")).split("."),d=parseInt(s[0],10),l=parseInt(s[1],10)-1,c=parseInt(s[2],10);r=new Date(c,l,d)}return r},firstDay:1,maxDate:new Date,minDate:l.getMinDate(e),onSelect:function(e){void 0!==dom.query(this.config().field).attr("data-pikaday-start")?(t=(i=this).getDate(),o()):(a=(r=this).getDate(),n())}});var i=dom.query(this).find("[data-pikaday-start]").data("pikaday"),r=dom.query(this).find("[data-pikaday-end]").data("pikaday"),s=i.getDate(),d=r.getDate();s&&(t=s,o()),d&&(a=d,n())})},e}(),DropdownMenu=function(){this.ACTIVE_CLASS="active";var r=dom.query(".dropdown-list"),s=r.find("li").children("a"),d=r.find(".dropdown-menu-container"),l=dom.query("[data-dropdown]"),c=parseInt(d.css("max-width")),u=30+c,h=this;s.click(function(e){var t=dom.query(this),a=t.data("item");if(l.each(function(){var e=dom.query(this);e.data("dropdown")===a?e.show():e.hide()}),t.hasClass(h.ACTIVE_CLASS))t.removeClass(h.ACTIVE_CLASS),r.removeClass(h.ACTIVE_CLASS);else{var o=t.offset().left-s.first().offset().left,n=d.width(),i=o+80-(n-t.width())/2;i<30?i=30:u<i+n&&(i=c-n+30),d.css("left",i),s.removeClass(h.ACTIVE_CLASS),t.addClass(h.ACTIVE_CLASS),r.addClass(h.ACTIVE_CLASS)}e.preventDefault()}),dom.query(document).mouseup(function(e){r.is(e.target)||0!==r.has(e.target).length||(r.removeClass(h.ACTIVE_CLASS),s.removeClass(h.ACTIVE_CLASS),l.hide())})},EditNameBox=function(){function e(){this.ENTER_KEY=13,this.context=dom.query("main");var a=this;this.context.delegate(".header-container .edit-button","click",function(e){var t=a.getWrapper(dom.query(this));a.showEditInput(t),e.preventDefault()}),this.context.delegate(".header-container .btn-no","click",function(e){var t=a.getWrapper(dom.query(this));a.hideEditInput(t,!1),e.preventDefault()}),this.context.delegate(".header-container .btn-yes","click",function(e){var t=a.getWrapper(dom.query(this));a.hideEditInput(t,!0),e.preventDefault()}),this.context.delegate(".change-name-box input","keypress",function(e){e.which===a.ENTER_KEY&&(a.getWrapper(dom.query(this)).find(".btn-yes").click(),e.preventDefault())})}return e.prototype.getWrapper=function(e){return e.closest(".header-container")},e.prototype.showEditInput=function(e){e.children().hide();var t=e.find("input");t.val(e.find("h3").text()),e.find(".change-name-box").show(0,function(){t.focus()})},e.prototype.hideEditInput=function(e,t){if(t){var a=e.find("input");e.find("h3").text(a.val())}e.children().show(),e.find(".change-name-box").hide()},e}(),MessagesView=function(){function e(){var e=this;this.messagesView=dom.query(".messages-view"),this.navTabs=this.messagesView.find(".nav-tabs"),this.tabContent=this.messagesView.find(".tab-content"),this.tabsLinks=this.navTabs.find("a");var a=this;this.tabsLinks.click(function(e){var t=dom.query(this);a.messagesView.removeClass("archive-tab"),a.messagesView.removeClass("sent-tab"),a.messagesView.removeClass("received-tab"),a.messagesView.addClass(t.attr("data-tab")),t.parent().hasClass("active")?a.isMobileView()&&(t.parent().removeClass("active"),a.hideTabContent(),a.fitHeight()):(a.tabsLinks.parent().removeClass("active"),a.showTabContent(),a.isMobileView(),t.parent().addClass("active"),a.fitHeight()),a.messagesView.find(".to-received-button").hide(),a.messagesView.find(".archive-button").hide(),e.preventDefault()}),this.messagesView.find('input[type="checkbox"]').change(function(){a.messagesView.find('input[type="checkbox"]').each(function(){if(dom.query(this).prop("checked"))return a.messagesView.hasClass("archive-tab")?a.messagesView.find(".to-received-button").show():a.messagesView.find(".archive-button").show(),!1;a.messagesView.hasClass("archive-tab")?a.messagesView.find(".to-received-button").hide():a.messagesView.find(".archive-button").hide()})});var t=this.navTabs.find(".active a").attr("data-tab");this.messagesView.addClass(t),dom.query(window).resize(function(){e.fitHeight()}),this.fitHeight()}return e.prototype.update=function(){this.fitHeight()},e.prototype.showTabContent=function(){this.tabContent.removeClass("hide")},e.prototype.hideTabContent=function(){this.tabContent.addClass("hide")},e.prototype.getMobileTabsHeight=function(){return(this.tabsLinks.first().outerHeight()+6)*this.tabsLinks.length+1},e.prototype.fitHeight=function(){if(this.isMobileView()){var e=this.getMobileTabsHeight();this.tabContent.hasClass("hide")||(e+=this.tabContent.outerHeight()),this.navTabs.height(e)}else this.navTabs.css("height","auto"),this.tabContent.hasClass("hide")&&(this.showTabContent(),this.tabsLinks.first().click())},e.prototype.isMobileView=function(){return 50==dom.query(".navbar-mobile").height()},e}(),Popup=function(){function e(){this.values={},this.popupSel=".ebok-pop-up",this.closeSel="[data-popup-close]",this.closeUrlParam="popup-close-url",this.triggerParam="popup-trigger",this.saveParam="[data-popup-save]",this.saveContainer="[data-save-container]",this.popupContainerSel="[data-popup-container]",this.checkedTogglerParam="checked-toggler",this.run()}return e.prototype.run=function(){this.bindClose(),this.bindTrigger(),this.bindSave(),this.bindCheckedToggler()},e.prototype.bindClose=function(){var t=this;dom.query(t.closeSel).click(function(){var e=dom.query(this).data(t.closeUrlParam);dom.query(t.popupSel).hide(),t.closeUrlParam&&void 0!==e&&""!=e&&(window.location=e)}),dom.query("main").delegate(".popup-close","click",function(){dom.query(this).closest(t.popupSel).hide()})},e.prototype.bindTrigger=function(){var t=this;dom.query("main").find("[data-"+t.triggerParam+"]").each(function(){var e=dom.query(this);dom.query(e.data(t.triggerParam)).click(function(){e.show()})})},e.prototype.bindCheckedToggler=function(){dom.query("main").find("[data-"+this.checkedTogglerParam+"]").each(function(){var e=dom.query(this);e.change(function(){e.prop("checked")&&(dom.query('div[data-checked-block="'+e.attr("name")+'"]').hide(),dom.query('div[data-checked-block="'+e.attr("name")+'"][data-checked-value="'+e.val()+'"]').show())})})},e.prototype.bindSave=function(){var e=this;dom.query(e.saveParam).click(function(){switch(e.saveElement=dom.query(this),e.form=e.saveElement.closest(e.saveContainer),e.form.length||(e.form=dom.query(e.saveContainer)),e.saveType=e.saveElement.data("save-type"),e.saveUrl=e.saveElement.data("save-url"),e.saveMethod=e.saveElement.data("save-method"),e.saveType){case"save":e.save();break;case"save-sequence":e.saveSequence();break;default:e.runAjax()}})},e.prototype.validateForm=function(){this.form.validator("update"),this.form.validator("validate")},e.prototype.save=function(){var a=this;a.validateForm(),0<a.form.has(".has-error").length||(dom.query.each(a.form.serializeArray(),function(e,t){a.values[t.name]=t.value}),this.runAjax())},e.prototype.saveSequence=function(){var i=this,r=[];i.validateForm();var t=!0;if(i.form.find(".form-group").removeClass("has-success"),i.form.find("input").each(function(){var e=dom.query(this);e.prop("checked")?r[e.attr("data-id")]=e.val():void 0===r[e.attr("data-id")]&&(r[e.attr("data-id")]=null,t=!1)}),t){var s=[];for(var e in r){var a=i.form.find("input[data-id="+e+"]"),d=r[e],o=a.closest(".form-group");o.addClass("has-spin"),s[e]=o}setTimeout(function(){for(var a in r){var e=dom.query("input[data-id="+a+"]"),t=s[a];if(null==(d=r[a]))t.removeClass("has-spin");else{var o={};o[e.attr("name")]=d;var n=i.saveElement.data("save-check");dom.query.ajax({url:i.saveUrl,async:!1,type:"POST",data:o}).done(function(e){s[a].removeClass("has-spin");var t=JSON.parse(e);void 0!==t.status&&"success"==t.status?(s[a].addClass("has-success").addClass("has-save"),void 0!==t.action&&("hidebuttons"==t.action&&dom.query(".popup-buttons-box").hide(),"hide"==t.action&&dom.query(i.popupContainerSel).hide()),dom.query(".popup-box-error").hide(),void 0!==t.html&&null!=t.html&&""!=t.html&&(i.form.html(t.html),i.form.validator("update"),i.bindClose(),i.bindTrigger(),i.bindCheckedToggler(),i.bindSave(),new Accordion)):s[a].addClass("has-error"),i.checkSaveSequence(n)}).fail(function(){s[a].removeClass("has-spin"),s[a].addClass("has-error")})}}},0)}},e.prototype.runAjax=function(){var a=this;dom.query.ajax({url:a.saveUrl,async:!1,type:a.saveMethod,data:a.values}).done(function(e){var t=JSON.parse(e);void 0!==t.status&&"success"==t.status?(void 0!==t.action&&("hidebuttons"==t.action&&dom.query(".popup-buttons-box").hide(),"hide"==t.action&&dom.query(a.popupContainerSel).hide()),dom.query(".popup-box-error").hide(),void 0!==t.html&&null!=t.html&&""!=t.html&&(a.form.html(t.html),a.form.validator("update"),a.bindClose(),a.bindTrigger(),a.bindCheckedToggler(),a.bindSave(),new Accordion)):(void 0!==t.status&&"error"==t.status&&dom.query(a.saveContainer).hide(),a.showError(),0<dom.query(a.saveContainer).find(".popup-box-error").length&&(dom.query(".popup-box-error").hide(),dom.query(a.saveContainer).children().hide(),dom.query(a.saveContainer).show().find(".popup-box-error").show()))}).fail(function(){a.showError()})},e.prototype.checkSaveSequence=function(e){var a=this,t=a.form.find(".form-group"),o=a.form.find(".form-group.has-save");t.length==o.length&&dom.query.ajax({url:e,async:!1,type:"POST"}).done(function(e){var t=JSON.parse(e);void 0!==t.status&&"success"==t.status?window.location.reload():(a.showError(),dom.query(".popup-box-error").html(t.html))}).fail(function(){a.showError()})},e.prototype.showError=function(){dom.query(".popup-buttons-box").hide(),dom.query(".popup-box").hide(),dom.query(".popup-box-error").show()},e}(),defaults={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",fadeColor:"transparent",animation:"spinner-line-fade-default",rotate:0,direction:1,speed:1,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:"0 0 1px transparent",position:"absolute"},Spinner=function(){function e(e){void 0===e&&(e={}),this.opts=__assign(__assign({},defaults),e)}return e.prototype.spin=function(e){return this.stop(),this.el=document.createElement("div"),this.el.className=this.opts.className,this.el.setAttribute("role","progressbar"),css(this.el,{position:this.opts.position,width:0,zIndex:this.opts.zIndex,left:this.opts.left,top:this.opts.top,transform:"scale("+this.opts.scale+")"}),e&&e.insertBefore(this.el,e.firstChild||null),drawLines(this.el,this.opts),this},e.prototype.stop=function(){return this.el&&("undefined"!=typeof requestAnimationFrame?cancelAnimationFrame(this.animateId):clearTimeout(this.animateId),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=void 0),this},e}();function css(e,t){for(var a in t)e.style[a]=t[a];return e}function getColor(e,t){return"string"==typeof e?e:e[t%e.length]}function drawLines(e,t){var a=Math.round(t.corners*t.width*500)/1e3+"px",o="none";!0===t.shadow?o="0 2px 4px #000":"string"==typeof t.shadow&&(o=t.shadow);for(var n=parseBoxShadow(o),i=0;i<t.lines;i++){var r=~~(360/t.lines*i+t.rotate),s=css(document.createElement("div"),{position:"absolute",top:-t.width/2+"px",width:t.length+t.width+"px",height:t.width+"px",background:getColor(t.fadeColor,i),borderRadius:a,transformOrigin:"left",transform:"rotate("+r+"deg) translateX("+t.radius+"px)"}),d=i*t.direction/t.lines/t.speed;d-=1/t.speed;var l=css(document.createElement("div"),{width:"100%",height:"100%",background:getColor(t.color,i),borderRadius:a,boxShadow:normalizeShadow(n,r),animation:1/t.speed+"s linear "+d+"s infinite "+t.animation});s.appendChild(l),e.appendChild(s)}}function parseBoxShadow(e){for(var t=/^\s*([a-zA-Z]+\s+)?(-?\d+(\.\d+)?)([a-zA-Z]*)\s+(-?\d+(\.\d+)?)([a-zA-Z]*)(.*)$/,a=[],o=0,n=e.split(",");o<n.length;o++){var i=n[o].match(t);if(null!==i){var r=+i[2],s=+i[5],d=i[4],l=i[7];0!==r||d||(d=l),0!==s||l||(l=d),d===l&&a.push({prefix:i[1]||"",x:r,y:s,xUnits:d,yUnits:l,end:i[8]})}}return a}function normalizeShadow(e,t){for(var a=[],o=0,n=e;o<n.length;o++){var i=n[o],r=convertOffset(i.x,i.y,t);a.push(i.prefix+r[0]+i.xUnits+" "+r[1]+i.yUnits+i.end)}return a.join(", ")}function convertOffset(e,t,a){var o=a*Math.PI/180,n=Math.sin(o),i=Math.cos(o);return[Math.round(1e3*(e*i+t*n))/1e3,Math.round(1e3*(-e*n+t*i))/1e3]}var dom,messagesView,dataTableLayout,TableOperations=function(){function e(){this.activePage=1,this.container=document.querySelector(".operation-history"),this.select=document.querySelector("[data-select-type]"),this.dateFrom=document.querySelector("[data-pikaday-start]"),this.dateTo=document.querySelector("[data-pikaday-end]"),this.searchBtn=document.querySelector("[data-search]"),this.cleanBtn=document.querySelector("[data-clean]"),this.init()}return e.prototype.init=function(){null!=this.container&&this.dataFillTables()},e.prototype.dataAjaxFillTable=function(e){var t,r=this,a=dom.query(e),o=a.find("[data-table]"),n=a.data("api-url"),i=a.data("text-error"),s=a.data("text-none"),d=a.find("[data-pagination]"),l=o.find("tbody"),c=a.find(".table-spinner"),u=o.find("[data-template-row]"),h=o.find("[data-template-none]"),p=a.find(".filters"),f=p.find(".active[data-pikaday-start]").val(),m=p.find(".active[data-pikaday-end]").val(),v=p.find(".active[data-select-type]").find("option:selected").val(),y=a.data("perpage"),g=0,b=[],w=this.activePage*y-y+1,C=this.activePage*y;function q(){l.empty();var e=h.clone().removeAttr("data-template-none").show();e.find("span").addClass("simple-error").html(i),l.html(e),d.empty().hide()}t={rangeFrom:w,rangeTo:C,from:f,to:m,type:v},l.css("visibility","hidden"),c.show(),r.hideError(a),dom.query.ajax({url:n,type:"GET",data:t}).done(function(e){!function(e){var t,a,o=(a="object"==typeof(t=e)?t:JSON.parse(t),"OK"==r.getParam(a,"Status")&&(b=r.getParam(a,"Actions"),g=r.getParam(a,"TotalNumber"),w=r.getParam(a,"RangeFrom"),C=r.getParam(a,"RangeTo"),!0));if(l.css("visibility","visible"),c.hide(),l.empty(),o){var n=function(){var e=dom.query("<div/>");if(0<b.length){var t=0;for(var a in b){if(y<++t)break;var o=u.clone();o.removeAttr("data-template-row"),o.show();var n=b[a];for(var i in n)o.find("[data-param="+i+"]").html(n[i]),o.find("[data-param-href="+i+"]").attr("href",n[i]),o.find("[data-href="+i+"]").attr("href","#").attr("data-base",n[i]);e.append(o)}d.empty().show()}else{var r=h.clone().removeAttr("data-template-none").show();r.find("span").html(s),e.html(r),d.empty().hide()}return e.html()}();l.html(n),function(){for(var e=Math.ceil(g/y),t=!1,a=1;a<=e;a++){var o=a.toString();if(1==a||2==a||3==a||a==r.activePage-2||a==r.activePage-1||a==r.activePage||a==r.activePage+1||a==r.activePage+2||a==e-2||a==e-1||a==e){t=!1;var n=dom.query("<a/>").html(o).attr("data-page",a).attr("href","").on("click",function(){return r.goToPage(this),!1});parseInt(o)==r.activePage&&n.addClass("active"),d.append(n),parseInt(o)!=e&&d.append(" / ")}else t||d.append("... / "),t=!0}}()}else q();var i=dom.query(window).scrollTop();dom.query(window).scrollTop(i)}(e)}).fail(function(){l.css("visibility","visible"),c.hide(),q()})},e.prototype.hideError=function(e){e.find("[data-error]").hide()},e.prototype.goToPage=function(e){this.activePage=dom.query(e).data("page");var t=dom.query(e).closest("[data-ajaxfill-operation]");return this.dataAjaxFillTable(t),!1},e.prototype.dataFillTables=function(){var a=this;dom.query("[data-ajaxfill-operation]").each(function(e,t){a.initTableButtons(t),a.searchFilters(dom.query(t).find(".filters"))})},e.prototype.getParam=function(e,t){return"undefined"!=e[t]?e[t]:null},e.prototype.initTableButtons=function(e){var t=this,a=dom.query(e),o=a.find("[data-search]"),n=a.find("[data-clean]"),i=a.find(".filters");o.on("click",function(){return t.searchFilters(i),dom.query(this).blur(),!1}),n.on("click",function(){return t.cleanFilters(i),!1})},e.prototype.searchFilters=function(e){this.activePage=1;var t=e.find("[data-pikaday-start]"),a=e.find("[data-pikaday-end]"),o=e.find("[data-select-type]");t.val()?t.addClass("active"):t.removeClass("active"),a.val()?a.addClass("active"):a.removeClass("active"),o.addClass("active");var n=e.closest("[data-ajaxfill-operation]");this.dataAjaxFillTable(n)},e.prototype.cleanFilters=function(e){var t=new Date,a=new Date;t.setMonth(t.getMonth()-6);var o=e.find("[data-pikaday-start]").data("pikaday"),n=e.find("[data-pikaday-end]").data("pikaday");o.setDate(t),n.setDate(a),e.find("[data-select-type]").find("option:selected").prop("selected",!1),e.find("[data-filter]").removeClass("active"),this.searchFilters(e)},e}(),Tooltips=function(){this.AUTO_HIDE_CLASS="auto-hide-tooltip",this.BTN_SELECTOR=".info-button",this.FOCUS_SELECTOR=".tooltip-focus";var e=dom.query("main"),n=dom.query("<a>",{href:"#",class:"icon-close",text:"x"}),i=this;e.find(i.FOCUS_SELECTOR).each(function(){this.addEventListener("focus",function(e){var t=e.target.querySelector(i.BTN_SELECTOR);dom.query(t).trigger("mouseenter")},!0),this.addEventListener("blur",function(e){var t=e.target.querySelector(i.BTN_SELECTOR);dom.query(t).trigger("mouseleave")},!0)}),e.on("mouseenter",i.BTN_SELECTOR,function(e){var t=dom.query(this);if(e.preventDefault(),!t.next().hasClass("tooltip")){var a=t.find(".content-for-tooltip");if(0<a.length){var o=dom.query("<span>",{class:"tooltip",html:a.html()});t.parent().hasClass("favourite-icon")?o.append(n.clone()):t.addClass(i.AUTO_HIDE_CLASS),t.after(o)}}}),e.find(i.BTN_SELECTOR+".show-on-start").each(function(){dom.query(this).mouseenter()}),e.on("mouseleave","."+i.AUTO_HIDE_CLASS,function(e){dom.query(this).next(".tooltip").remove(),e.preventDefault()}),dom.query(document.body).on("click",".tooltip .icon-close",function(e){dom.query(this).parent(".tooltip").remove(),e.preventDefault()})};function init(){(dom=new DOM).query(document).ready(function(){initCommons(),new AlertCarousel,new DropdownMenu,new Tooltips,new Popup,new Spinner,new EditNameBox,new Accordion,new ClipboardUtils,new Datepicker,new Attachment,new TableOperations,dataTableLayout=new DataTableLayout,messagesView=new MessagesView;for(var e=document.getElementsByClassName("box-yes-no"),t=0;t<e.length;t++)new BoxYesNo(e[t]);dom.query.fn.validator.Constructor.prototype.focusError=function(){this.options.focus&&this.$element.find(".has-error:first :input").focus()}})}function initCommons(){var e,t=dom.query("[data-show-mask]");function a(){dom.query(".table-grid").find(".row").each(function(){var e=dom.query(this),t=e.find("div > .tile:first-child"),a=i(t),o=e.find("div > .tile:nth-child(2)"),n=i(o);function i(e){var t=0;return e.height("auto"),e.each(function(){dom.query(this).height()>t&&(t=dom.query(this).height())}),t}t.each(function(){dom.query(this).height(a)}),o.each(function(){dom.query(this).height(n)})})}function o(){dom.query('form[data-toggle="validator"]:not(.valid-on-change)').validator().off("input.bs.validator change.bs.validator focusout.bs.validator"),dom.query(".form-group").removeClass("has-success")}t.mouseenter(function(){dom.query(".page-mask").show(),dom.query(this).css("z-index",9)}),t.mouseleave(function(){dom.query(".page-mask").hide(),dom.query(this).css("z-index",0)}),dom.query(".mobile-menu-button").click(function(){dom.query(".header-right-box").toggleClass("main-menu-opened")}),dom.query(".button-more").click(function(){dom.query(this).prev(".nav").addClass("expanded")}),dom.query(".parent-item").click(function(){dom.query(this).parent().toggleClass("expanded")}),dom.query(".messages-view").find("[data-select-all]").click(function(){var e=dom.query(this),t=dom.query(".email-list"),a=dom.findCheckboxes(t,'input[type="checkbox"]'),o=!0===e.prop("checked");dom.setCheckedAll(a,o)}),dom.query(".email-buttons .btn-primary").click(function(e){var t=dom.query(this).closest(".panel");t.find(".email-buttons").hide(),t.find(".panel-response").show(),e.preventDefault()}),dom.query("#SearchName").on("keypress",function(e){13===e.which&&dom.query("#searchEbok").click()}),dom.query(".toggle-all-doc").click(function(e){dom.query(this).parents(".doc-list").toggleClass("expanded"),e.preventDefault()}),dom.query(".toggle-aside").click(function(){return dom.query(this).parent().toggleClass("expanded"),!1}),dom.query(".expand-banner-button").click(function(){return dom.query(this).parents(".box-banner").toggleClass("expanded"),!1}),dom.query(".video-button").click(function(){var e=dom.query(this).parent(),t=e.attr("data-video")+"?rel=0&autoplay=1&enablejsapi=1",a=e.find(".video-cont");e.removeClass("icon-play"),dom.query(this).hide();var o='<iframe src="'+t+'" frameborder="0" allowfullscreen scrolling="no"></iframe>';a.append(o)}),dom.query("main").delegate(".msp-item .btn-msp-popup","click",function(){dom.query(this).parents(".msp-item").next().children(".ebok-pop-up").toggle()}),dom.query(".required-on-change").on("blur",function(){var e=dom.query(this)[0];e.value&&null===e.getAttribute("data-required")&&(e.setAttribute("required",!0),e.setAttribute("data-required",!0))}),setTimeout(function(){a()},0),dom.query(window).resize(function(){clearTimeout(e),e=setTimeout(function(){a()},dom.RESIZE_DELAY)}),dom.query(".spin").each(function(){new Spinner({scale:.5}).spin(this)}),dom.query(".spin-attachments").each(function(){new Spinner({scale:.5,position:"relative",className:"spinner-attachments"}).spin(this)}),dom.query(".disable-inputs").change(function(){var e=dom.query(this).prop("checked"),t=dom.query(this).attr("value");if(e){var a=dom.query(".disable-inputs-element[data-disable-inputs="+t+"]");a.prop("disabled",!1).attr("data-validate","true").change(),a.filter("[data-required=true]").prop("required",!0),a.closest(".form-group").removeClass("has-success");var o=dom.query(".disable-inputs-element[data-disable-inputs!="+t+"]");o.filter("[data-required=true]").removeAttr("required"),o.prop("disabled",!0).attr("data-validate","false").change(),o.closest(".form-group").removeClass("has-null has-spin has-success"),o.closest(".form-group").find(".help-block").each(function(){dom.query(this).text("")})}dom.query('form[data-toggle="validator"]').validator("update"),e&&(a.closest(".form-group").removeClass("has-success"),o.closest(".form-group").removeClass("has-success"))}),dom.query(".disable-inputs").change(),dom.query(".expander-toggle").on("click",function(){var e=dom.query(this),t=dom.query(this).parent(),a=t.find(".expander-content");e.hasClass("expand")?(a.css("height","auto"),e.hide(),t.find(".collapse").show()):(a.css("height","39px"),e.hide(),t.find(".expand").show())}),dom.query(".expander-toggle").keyup(function(e){13===e.keyCode&&dom.query(e.target).trigger("click")}),dom.query(".checkbox-enter").keyup(function(e){13===e.keyCode&&dom.query(e.target).find("input").prop("checked",!0)}),dom.query("form.ajax-save").on("submit",function(e){e.preventDefault();var n=[],i=dom.query(this),r=i.attr("data-ajax-url"),s=0;for(var t in i.find(".form-group").removeClass("has-danger has-error"),i.find("input").each(function(){var e=dom.query(this);e.prop("checked")?n[e.attr("name")]=e.val():void 0===n[e.attr("name")]&&(n[e.attr("name")]=null)}),n)s++;var d=[],l=s,c=parseInt(i.find("input:checked").length);for(var t in n){var a=i.find("input[name="+t+"]"),o=n[t],u=a.closest(".form-group");if(d[t]=u,null!=o){if(i.hasClass("form-required")&&c<s)continue;u.addClass("has-spin")}}function h(e){var t=0;for(var a in d)d[a].hasClass("has-success")&&t++;if(e==t){var o=i.attr("data-save-check");dom.query.ajax({url:o,async:!1,type:"POST"}).done(function(e){dom.query("[data-popup-container]").show()}).fail(function(){dom.query("[data-popup-container]").show().find("h3").html("Nieoczekiwany błąd...")})}}setTimeout(function(){for(var a in n){var e=i.find("input[name="+a+"]"),t=n[a],o=e.closest(".form-group");if(d[a]=o,null==t)o.removeClass("has-spin"),o.addClass("has-danger");else{if(i.hasClass("form-required")&&c<s)continue;o.addClass("has-spin"),dom.query.ajax({url:r,async:!1,type:"POST",data:{IsChecked:"on"==t,RecordTypeId:i.find("input[name="+a+"]:checked").data("id")}}).done(function(e){var t=JSON.parse(e);void 0!==t.status&&"success"==t.status?(d[a].removeClass("has-spin"),d[a].addClass("has-success"),h(l)):(d[a].removeClass("has-spin"),d[a].addClass("has-error"))}).fail(function(e){d[a].removeClass("has-spin"),d[a].addClass("has-error")})}}},0)}),dom.query("form.ajax-form").on("submit",function(e){e.preventDefault();var n=[],i=dom.query(this),r=i.attr("data-ajax-url"),t=!1;i.find(".form-group").removeClass("has-success has-danger has-error"),i.find("input:not(:disabled):not(.ajax-form-nosave)").each(function(){var e=dom.query(this);n[e.attr("name")]=e.val()});var s=[];n.length;if(t=function(e){var t=dom.query("form.ajax-form"),a=!1;for(var o in e){if(void 0===(n=t.find("input[name="+o+"]"))||void 0===n.attr("data-required-one"))return!1;if(""!=n.val()){a=!1;break}a=!0}if(a)for(var o in e)(n=t.find("input[name="+o+"]")).attr("required",!0);else for(var o in e){var n;(n=t.find("input[name="+o+"]")).removeAttr("required")}return a}(n),i.data("bs.validator").validate(),!t){for(var d in n){var a=i.find("input[name="+d+"]"),o=a.closest(".form-group");if(s[d]=o,""==a.val()&&void 0!==a.data("warning")&&void 0===a.data("required")){var l=a,c=l.data("warning");""!=l.val()||l.is(":disabled")?l.closest(".form-group.has-danger").removeClass("has-danger").find(".help-block").text(""):l.closest(".form-group").addClass("has-danger").find(".help-block").text(c),o.hasClass("has-null")||(o.addClass("has-null"),o.removeClass("has-spin"),t=!0)}}if(!t)if(i.data("bs.validator").validate().hasErrors())console.log("error...");else{i.find(".form-group").removeClass("has-danger has-error").find(".help-block").text("");var u=0,h=Object.keys(n).length;!function a(){if(u===h)return;d=Object.keys(n)[u];u++;var e=i.find("input[name="+d+"]:not(.ajax-form-nosave)");var t=e.closest(".form-group");t.removeClass("has-danger has-success").addClass("has-spin");t.find(".help-block").text("");var o=n[d];setTimeout(function(){dom.query.ajax({url:r,async:!1,type:"POST",data:{value:o,all:e.data("all"),id:e.data("id")}}).done(function(e){var t=JSON.parse(e);void 0!==t.status&&"success"==t.status?(i.find(".form-group").removeClass("has-spin"),s[d].addClass("has-success")):(i.find(".form-group").removeClass("has-spin").removeClass("has-success"),s[d].addClass("has-error"),s[d].find(".help-block.with-errors").text(t.html)),a(),p(h)}).fail(function(e){i.find(".form-group").removeClass("has-spin").removeClass("has-success"),s[d].addClass("has-error"),s[d].find(".help-block.with-errors").text(""),a(),p(h)})})}()}}function p(e){var t=0;for(var a in s)s[a].hasClass("has-success")&&t++;if(e==t){var o=i.attr("data-save-check");if(o){var n=1==parseInt(dom.query("input.form-check-input:checked").val());dom.query.ajax({url:o,async:!1,type:"POST",data:{all:n}}).done(function(e){i.data("popup")&&dom.query("#"+i.data("popup")).show()})}i.data("popup")?dom.query("#"+i.data("popup")).show():i.data("prev-page")&&(window.location=i.data("prev-page"))}}}),dom.query("[data-location]").on("click",function(e){var t=dom.query(this).attr("data-location");window.location=t}),dom.query('form[data-toggle="validator"]:not(.valid-on-change)').off("input.bs.validator change.bs.validator focusout.bs.validator"),setTimeout(function(){o()},0),setTimeout(function(){o()},10)}init();