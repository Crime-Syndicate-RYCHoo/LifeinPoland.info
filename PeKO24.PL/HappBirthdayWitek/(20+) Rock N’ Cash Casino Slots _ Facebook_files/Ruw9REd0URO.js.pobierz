;/*FB_PKG_DELIM*/

__d("VideoPlayerNextgendashNetworkDiagnosticsUtils",["oz-player/networks/OzBandwidthUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a==null?function(a,b){return 0}:function(b,c){c=d("oz-player/networks/OzBandwidthUtils").getEstimatedRequestTimeToLastByteMs(a,b,c);return b/c*8e3}}var h=2e5,i=2e5,j=10,k=1e8;function b(a,b,c){var d=a.bytes+h;d=c>=d?{bytes:c,clock:b}:a;var e=b.perfMs-a.clock.perfMs;c=c-a.bytes;a=null;l(c,e)||(a={bandwidthSample:{bytes:c,timeInMs:e},clock:b,navigationTimingSample:void 0});return{networkDiagnosticsSample:a,nextBandwidthSamplingState:d}}function c(a,b,c,d,e){a=m(a.host.getPerformanceResourceTimingByName(b));b=void 0;if(a){var f=a.responseStart-a.requestStart;a=a.responseEnd-a.requestStart;b={bytes:e,timeToFirstByteMs:f,timeToLastByteMs:a}}f=d.perfMs-c.clock.perfMs;a=e-c.bytes;var g=void 0;c.bytes===0&&e>=i&&!l(a,f)&&(g={bytes:a,timeInMs:f});if(b||g){c={bandwidthSample:g,clock:d,navigationTimingSample:b};return c}return null}function l(a,b){a=a*8/(b/1e3);return b<j&&a>k}function m(a){return a.reduce(function(a,b){return a==null?b:b.responseEnd<a.responseEnd?a:b},null)}g.getBandwidthEstimateFn=a;g.computeNetworkDiagnosticsSampleOnChunk=b;g.computeNetworkDiagnosticsSampleOnDone=c}),98);
__d("VideoPlayerNextgendashWorkQueue",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a,c=null,d=[],e=null,f=!1,g=!1,h=!1;function i(){if(!g)return;g=!1;var a=e;if(a==null)return;try{c=[],a()}catch(a){h=!0;throw a}finally{e=null;a=c;a!=null&&a.length>0&&d.unshift.apply(d,a);c=null;f=!0;j()}}function j(){if(!f)return;f=!1;if(h||e!=null||d.length<=0||g)return;e=d.shift();g=!0;i()}function k(){if(h||f)return;f=!0;b(j)}a=function(){if(arguments.length<=0)return;if(c!=null){var a;(a=c).push.apply(a,arguments)}else d.push.apply(d,arguments),k()};return{enqueueWork:a,getHalted:function(){return h},getQueueLength:function(){var a;return d.length+((a=(a=c)==null?void 0:a.length)!=null?a:0)},setHalted:function(a){a?h=!0:(h=!1,k())},setScheduleToRun:function(a){b=a}}}f.createVideoPlayerNextgendashWorkQueue=a}),66);
__d("VideoPlayerNextgendashStateMachine",["VideoPlayerNextgendashWorkQueue","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h={},i={},j="$$nextgendashSkipAutoDisposeSymbol";function a(a){a!=null&&typeof a==="object"&&Object.defineProperty(a,j,{configurable:!1,enumerable:!1,value:i,writable:!1});return a}function k(a,b,c,d,e){var f;f=(f=d.options)==null?void 0:f.augmentEnv;f=f?f(b.env,e):b.env;d=d.createSM(b.displayName+"."+c,babelHelpers["extends"]({},f,{workQueue:a}),b,e);return d}function l(a,b,c,d,e,f){b.env.logging.log(b.env,{event:c,eventClock:d,fromSm:e,sendReason:f,sm:b,type:"state_machine_send_event"}),a.enqueueWork(function(){m(b,c,d,e,f)})}function m(a,b,c,e,f){var g=a.state;if(g.state==="__disposed__"&&b.type!=="__enter")return;var h=new Set();a.$$nextgendashEverCalledMakeChildSm&&r(a,g,h,!1);try{a.env.logging.log(a.env,{event:b,eventClock:c,fromSm:e,sendReason:f,sm:a,type:"state_machine_receive_event_begin"});try{var i=!0,j=[],m=function(a){j.push(a)},n=a.env.workQueue.enqueueWork,o=d("VideoPlayerNextgendashWorkQueue").createVideoPlayerNextgendashWorkQueue(m);m={args:a.args,env:a.env,eventClock:c,fromSm:e,makeChildSm:function(b,c){a.$$nextgendashEverCalledMakeChildSm=!0;if(!i){var e;throw d("nextgendasherr").nextgendasherr(a.env,"VideoPlayerNextgendashStateMachineChildSMOutsideTransition["+a.displayName+"]@"+((e=g.state)!=null?e:"?")+">["+b+"]")}for(var f=arguments.length,j=new Array(f>2?f-2:0),l=2;l<f;l++)j[l-2]=arguments[l];var m=k.apply(void 0,[o,a,b,c].concat(j));h.add(m);return m},sendReason:f,sendToOther:function(b,c,d){var e=a.env.host.clock();l(o,b,c,e,a,(b=d)!=null?b:"sendToOther")},sendToSelf:function(b,c){var d=a.env.host.clock();l(o,a,b,d,a,(b=c)!=null?b:"sendToSelf")},stateClock:a.stateClock,thisName:a.displayName,thisSm:a,unexpectedEvent:function(c,e){var f;for(var h=arguments.length,i=new Array(h>2?h-2:0),j=2;j<h;j++)i[j-2]=arguments[j];var k=d("nextgendasherr").nextgendasherr.apply(void 0,[a.env,"VideoPlayerNextgendashStateMachineUnexpectedEvent["+a.displayName+"]@"+((f=g.state)!=null?f:"?")+"<--"+b.type,e].concat(i));if(c==="log")a.env.logging.log(a.env,{error:k,type:"generic_error_as_warning"});else throw k}};m=g.state==="__null__"&&b.type==="__dispose"?void 0:g.state==="__null__"?a.initialTransition(m):a.transition(babelHelpers["extends"]({},m,{event:b,state:g}));if(b.type==="__exception"&&m===void 0||b.type==="__dispose"){var p=b.exception,q=b.reason;m!=null&&(a.$$nextgendashEverCalledMakeChildSm&&r(a,m,h,!1));m={exception:p,reason:(p=q)!=null?p:b.type,state:"__disposed__"}}a.stateClock=a.env.host.clock();m!==void 0&&(a.$$nextgendashEverCalledMakeChildSm&&r(a,a.state,h,!1),a.state=m);if(m!==void 0&&m.state!==g.state&&b.type!=="__enter"){l(a.env.workQueue,a,{prevState:g,type:"__enter"},a.env.host.clock(),a,"from:"+((q=g.state)!=null?q:"?")+":to:"+((p=a.state.state)!=null?p:"?"))}i=!1;o.setScheduleToRun(n);(q=a.env.workQueue).enqueueWork.apply(q,j);if(m!==void 0){p=a.args;var s=p.onDisposed,t=p.onTransitioned;if(t){var u=a.state,v="#"+a.sequentialId+"#"+a.displayName+":from:"+((n=g.state)!=null?n:"?")+":to:"+((q=a.state.state)!=null?q:"?")+":event:"+b.type;a.env.workQueue.enqueueWork(function(){t(g,u,v)})}if(s&&a.state.state==="__disposed__"){var w=a.state,x="#"+a.sequentialId+"#"+a.displayName+":from:"+((m=g.state)!=null?m:"?")+":to:"+((p=a.state.state)!=null?p:"?")+":event:"+b.type;a.env.workQueue.enqueueWork(function(){s(g,w,x)})}}a.env.logging.log(a.env,{event:b,eventClock:c,fromSm:e,sendReason:f,sm:a,smPrevState:g,type:"state_machine_receive_event_success"})}catch(h){n=d("nextgendasherr").nextgendasherrFromNextgendasherr(h);m=n!=null&&n.name.startsWith("VideoPlayerNextgendashStateMachineUnexpectedEvent")?n:d("nextgendasherr").nextgendasherrFromCause(a.env,h,"VideoPlayerNextgendashStateMachineException["+a.displayName+"]@"+((q=g.state)!=null?q:"?")+"<--"+b.type);a.env.logging.log(a.env,{event:b,eventClock:c,exception:m,fromSm:e,sendReason:f,sm:a,smPrevState:g,type:"state_machine_receive_event_exception"});if(b.type!=="__exception"){l(a.env.workQueue,a,{exception:m,type:"__exception"},a.env.host.clock(),a,"in:"+((p=g.state)!=null?p:"?")+":event:"+b.type+":exception:"+m.name)}else throw h}}catch(i){q=d("nextgendasherr").nextgendasherrFromCause(a.env,i,"VideoPlayerNextgendashStateMachineFatalException["+a.displayName+"]@"+((n=g.state)!=null?n:"?")+"<--"+b.type);a.$$nextgendashEverCalledMakeChildSm&&r(a,a.state,h,!1);a.state={exception:q,reason:"state_machine_fatal_exception",state:"__disposed__"};a.env.logging.log(a.env,{exception:q,sm:a,smPrevState:g,type:"state_machine_fatal_exception"});if(g.state!=="__disposed__"&&b.type!=="__enter"){l(a.env.workQueue,a,{prevState:g,type:"__enter"},a.env.host.clock(),a,"from:"+((c=g.state)!=null?c:"?")+":to:"+((e=a.state.state)!=null?e:"?"))}f=a.parentSm;if(f){l(a.env.workQueue,f,{exception:q,type:"__exception"},a.env.host.clock(),a,"child:#"+a.sequentialId+"#"+a.displayName+":from:"+((p=g.state)!=null?p:"?")+":to:"+((m=a.state.state)!=null?m:"?")+":event:"+b.type)}}finally{if(h.size>0){r(a,a.state,h,!0);for(n=h,c=Array.isArray(n),e=0,n=c?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(c){if(e>=n.length)break;f=n[e++]}else{e=n.next();if(e.done)break;f=e.value}q=f;l(q.env.workQueue,q,{reason:"__released_by_parent",type:"__dispose"},a.env.host.clock(),a,"parent:#"+a.sequentialId+"#"+a.displayName+":from:"+((p=g.state)!=null?p:"?")+":to:"+((m=a.state.state)!=null?m:"?")+":event:"+b.type)}}}}var n={}.constructor,o=[].constructor,p=new Map().constructor,q=new Set().constructor;function r(a,b,c,d){d===void 0&&(d=!1);if(d&&c.size<=0)return;if(b[j]===i)return;var e=[],f=new Set();f.add(b);b=b;while(b!=null){if(b.$$nextgendashBaseSymbol===h){if(b.parentSm===a)if(d){c["delete"](b);if(c.size<=0)break}else c.add(b)}else{var g=b.constructor;if(g===n)for(var k in b){var l=b[k];l!=null&&typeof l==="object"&&b[j]!==i&&!f.has(l)&&(f.add(l),e.push(l))}else if(g===o||g===p||g===q)for(l=b,k=Array.isArray(l),g=0,l=k?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(g>=l.length)break;m=l[g++]}else{g=l.next();if(g.done)break;m=g.value}m=m;m!=null&&typeof m==="object"&&b[j]!==i&&!f.has(m)&&(f.add(m),e.push(m))}}b=e.pop()}}var s=1;function b(a){return t(a)}function t(a){return typeof a==="object"&&a!=null&&a.$$nextgendashBaseSymbol===h}function c(a,b,c){var d={};return{createSM:function(a,e,f,g){var i=e.host.clock(),j={$$nextgendashBaseSymbol:h,$$nextgendashDefinitionSymbol:d,$$nextgendashEverCalledMakeChildSm:!1,args:g,displayName:a,env:e,initialTransition:b,parentSm:f,sendEvent:function(a,b,c,d){l(j.env.workQueue,j,a,(a=d)!=null?a:j.env.host.clock(),b,c)},sequentialId:s++,state:{state:"__null__"},stateClock:i,transition:c};j.env.logging.log(j.env,{fromSm:f,sm:j,type:"state_machine_created"});l(j.env.workQueue,j,{type:"__init"},j.env.host.clock(),f);return j},didDefineThisSM:function(a){return t(a)&&a.$$nextgendashDefinitionSymbol===d},options:a}}g.skipAutoDisposeInsideThisObject=a;g.isStateMachine=b;g.defineStateMachine=c}),98);
__d("nextgendasherr",["VideoPlayerImplementationErrors","VideoPlayerNextgendashStateMachine","fb-error"],(function(a,b,c,d,e,f,g){"use strict";var h="nextgendashClock";function i(a,b,e){var f;for(var g=arguments.length,i=new Array(g>3?g-3:0),j=3;j<g;j++)i[j-3]=arguments[j];var k=c("fb-error").err.apply(c("fb-error"),[(f=e)!=null?f:i.length>0?i.map(function(){return"%s"}).join(" "):""].concat(i));k.name=b;k.project="comet_video_player_nextgendash";var l=new(c("fb-error").ErrorMetadata)();p(a,l);k.metadata=l;k.stack=k.stack.replace(/^[^\n]+/,"Error: ");c("fb-error").TAAL.blameToPreviousFrame(k);k[h]=a.host.clock();return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(k)}function j(a,b){return(a===""||b.startsWith(a+"/")?"":a+"/")+(a.startsWith("VideoPlayerNextgendash")?b.replace(/VideoPlayerNextgendash/g,""):b)}function k(a,b,d,e){var f,g=void 0,k=void 0,l="",m=[],n=[];try{var o,p=typeof b==="object"&&b!=null?b:null;k=p!=null&&typeof p.code==="number"?p.code:void 0;n=p!=null&&typeof p.stack==="string"?p.stack.split("\n").slice(1):[];g=p!=null&&typeof p.name==="string"&&p.name!==""?p.name:void 0;var q=c("fb-error").getErrorSafe(b);l=(o=q.messageFormat)!=null?o:q.message;m=q.messageFormat!=null&&Array.isArray(q.messageParams)?q.messageParams:[];if(g!=null&&n.length>0&&["TypeError","ReferenceError","RangeError"].includes(g)){var r=n.slice(0,2).map(function(a){return a.trim()});l+=" - stack: %s";m=m.concat([r.join("\n")])}}catch(a){}g==null&&(k!=null?g="NotAnErrorWithCode":g="NotAnError");var s=j(d,g+(k!=null?"#"+k:""));for(var t=arguments.length,u=new Array(t>4?t-4:0),v=4;v<t;v++)u[v-4]=arguments[v];var w=i.apply(void 0,[a,s,((f=e)!=null?f:"")+(e!=null&&e!==""&&l!==""?" / ":"")+l].concat((e!=null?u:[]).concat(l!=null?m:[])));typeof b==="object"&&b!=null&&typeof b[h]==="object"&&b[h]!=null&&typeof b[h].unixMs==="number"&&typeof b[h].perfMs==="number"&&(w[h]=b[h]);n.length>0&&(w.stack+="\n    at <cause_stack_below>\n"+n.join("\n"));c("fb-error").TAAL.blameToPreviousFrame(w);return w}function a(a,b,d,e){var f=b.filter(Boolean).map(function(b){var c=b[0];b=b[1];return[c,k(a,b,"")]}).sort(function(a,b){return a[1].nextgendashClock.perfMs-b[1].nextgendashClock.perfMs});for(var g=arguments.length,l=new Array(g>4?g-4:0),m=4;m<g;m++)l[m-4]=arguments[m];if(f.length<=0)return i.apply(void 0,[a,d,"No causes."+(e!=null?" :: "+e:"")].concat(e!=null?l:[]));var n=f.map(function(a,b){var c=a[0];a=a[1];return[b+1+">"+c+">"+a.name+": "+a.messageFormat,a.messageParams]}),o=n.map(function(a){a=a[0];return a}).join(" ++ "),p=n.reduce(function(a,b){b=b[1];return a.concat(b)},[]),q=f[0],r=j(d,q[0]+">"+q[1].name),s=i.apply(void 0,[a,r,n.length+" causes: "+o+(e!=null?" :: "+e:"")].concat(p,e!=null?l:[]));s[h]=q[1].nextgendashClock;c("fb-error").TAAL.blameToPreviousFrame(s);return s}function b(a,b,d,e){for(var f=arguments.length,g=new Array(f>4?f-4:0),h=4;h<f;h++)g[h-4]=arguments[h];var j=typeof b==="object"&&b!=null&&b.name==="TypeError"&&typeof b.message==="string"?i.apply(void 0,[a,d,e!=null&&e!==""?e+" / "+b.name+": "+b.message:b.name+": "+b.message].concat(g)):k.apply(void 0,[a,b,d,e].concat(g));c("fb-error").TAAL.blameToPreviousFrame(j);return j}function e(a){return typeof a==="object"&&a!=null&&"name"in a&&typeof a.name==="string"&&"message"in a&&typeof a.message==="string"&&"messageFormat"in a&&typeof a.messageFormat==="string"&&"messageParams"in a&&Array.isArray(a.messageParams)&&"project"in a&&a.project==="comet_video_player_nextgendash"&&"metadata"in a&&a.metadata instanceof c("fb-error").ErrorMetadata?a:null}function f(a){return{messageFormat:a.messageFormat,messageParams:a.messageParams,metadataSnapshot:a.metadata.getAll(),name:a.name,nextgendashClock:a.nextgendashClock,project:a.project}}function l(a){var b=c("fb-error").err.apply(c("fb-error"),[a.messageFormat].concat(a.messageParams));b.name=a.name;b.project="comet_video_player_nextgendash";var d=new(c("fb-error").ErrorMetadata)();d.addEntries.apply(d,a.metadataSnapshot);b.metadata=d;b[h]=a.nextgendashClock;return b}function m(a){var b,c=typeof a==="object"&&a!=null&&typeof a.code==="number"?a.code:void 0;a=typeof a==="object"&&a!=null&&typeof a.message==="string"?a.message:void 0;b=(b={"":"MEDIA_ERR_UNKNOWN",1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"}[String((b=c)!=null?b:"")])!=null?b:"MEDIA_ERR_UNKNOWN";var e=a!=null?d("VideoPlayerImplementationErrors").getMoreGranularErrorNameFromHTMLVideoElementErrorMessage(a):null;b="VideoPlayerNextgendashMediaError/"+b+(c!=null?"#"+c:"")+(e!=null?"/"+e:"");return[b,a]}function n(a,b,d){var e,f=m(b),g=f[0],h=f[1];for(var j=arguments.length,k=new Array(j>3?j-3:0),l=3;l<j;l++)k[l-3]=arguments[l];var n=i.apply(void 0,[a,g,((e=d)!=null?e:"MediaError")+(h!=null?": %s":"")].concat(k.concat(h!=null?[h]:[])));c("fb-error").TAAL.blameToPreviousFrame(n);return n}function o(a){var b=new(c("fb-error").ErrorMetadata)();p(a,b);var d=c("fb-error").FBLogger("comet_video_player_nextgendash");b.getAll().forEach(function(a){d=d.addMetadata(a[0],a[1],a[2])});return d}function p(a,b){a=a.loggingState.metadata;"videoFBID"in a&&a.videoFBID!=null&&b.addEntry("COMET_VIDEO","VIDEO_ID",a.videoFBID);b.addEntry("COMET_VIDEO","VIDEO_IMPLEMENTATION_DEBUG_DATA",JSON.stringify({nextgendash_metadata:a}))}function q(a){return a.replace(/(?:[0-9a-f]+[a-f][0-9][0-9a-f]*)|(?:[0-9a-f]*[0-9][a-f][0-9a-f]+)|(?:[0-9]+[a-f]+)|(?:[a-f]+[0-9]+)/g,"{NHEX}").replace(/[0-9]+,[0-9]+(?:,[0-9]+)*/g,"{NLIST}").replace(/(HTTP(?:(?:0)|(?:[1-9][0-9]{1,5}))(?:[^0-9]|\b))|(#[0-9]+)|([0-9]+)/g,function(a,b,c){return b||c?a:"{N}"})}g.nextgendasherr=i;g.nextgendasherrFromCause=k;g.nextgendasherrFromMultipleCauses=a;g.nextgendasherrFromFetchRejection=b;g.nextgendasherrFromNextgendasherr=e;g.nextgendasherrToSnapshot=f;g.nextgendasherrFromSnapshot=l;g.nextgendasherrNameAndMessageFromMediaError=m;g.nextgendasherrFromMediaError=n;g.nextgendasherrFBLogger=o;g.reduceCardinalityOfNextgendashErrorName=q}),98);
__d("VideoPlayerNextgendashABR",["MetaConfig","OzSystemicRiskABRUtils","OzSystemicRiskUtils","QualityScoreUtils","SidneeAbrAlgorithm","VideoPlayerNextgendashNetworkDiagnosticsUtils","nextgendasherr","oz-player/configs/OzGlobalConfig","oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,e,f){var g=f==="csvqm";return a.map(function(a){var f,h=g?a.playbackResolutionCsvqmScoreCurve:a.playbackResolutionMosScoreCurve;h=d("QualityScoreUtils").parseQualityScoreCurve(String(h));h=h!=null?d("QualityScoreUtils").calculateQualityScore(h,b,c,e):0;return{bandwidth:a.bandwidth,displayLabel:(f=a.qualityLabel)!=null?f:"",height:a.height,id:a.representationId,qualityScore:h,uploadQuality:66,width:a.width}})}function a(a,b,c,d){var e=d.abrConfig,f=d.bandwidthDiagnostics,g=d.devicePixelRatio,h=d.isDocumentHidden,k=d.mediaDurationSec,l=d.playerDimensions,m=d.playheadMediaTimeSec,n=d.prefetchResult;d=d.sourceBufferBufferedRangesSec;return e.sidneeConfig!=null?i(a,b,c,{bandwidthDiagnostics:f,devicePixelRatio:g,mediaDurationSec:k,playerDimensions:l,playheadMediaTimeSec:m,prefetchResult:n,sidneeConfig:e.sidneeConfig,sourceBufferBufferedRangesSec:d}):j(a,b,c,{bandwidthDiagnostics:f,devicePixelRatio:g,isDocumentHidden:h,mediaDurationSec:k,playerDimensions:l,playheadMediaTimeSec:m,prefetchResult:n,sourceBufferBufferedRangesSec:d,systemicRiskConfig:e.systemicRiskConfig})}function i(a,b,c,e){a=e.bandwidthDiagnostics;c=e.devicePixelRatio;var f=e.mediaDurationSec,g=e.playerDimensions,i=e.playheadMediaTimeSec,j=e.prefetchResult,k=e.sidneeConfig;e=e.sourceBufferBufferedRangesSec;var l=b.every(function(a){return a.playbackResolutionCsvqmScoreCurve!=null})?"csvqm":"mos";g=h(b,g,k.useDpr,c,l);c=isNaN(f)||!isFinite(f)?k.defaultVideoDurationMs:f*1e3;f=d("oz-player/utils/OzBufferingUtils").getBufferAheadFromCurrentTime(i,(l=e.map(function(a){var b=a[0];a=a[1];return{endTime:a,startTime:b}}))!=null?l:[])*1e3;e=f+i*1e3;l=k.lookAheadMs-e;f={isAudioTrack:!1,playbackDurationInfo:{bufferDurationMs:e,playbackPositionMs:i*1e3,videoDurationMs:c},totalWindowDurationMs:k.lookAheadMs,unbufferedWindowDurationMs:l};var m=d("SidneeAbrAlgorithm").sidneeAbrSelectQualityImpl(g,k,f,d("VideoPlayerNextgendashNetworkDiagnosticsUtils").getBandwidthEstimateFn(a));i=(e=b.find(function(a){return a.representationId===m.chosenRepresentation.id}))!=null?e:null;g={bestRepresentationId:(c=i==null?void 0:i.representationId)!=null?c:null,bestRepresentationIsPrefetched:(l=j==null?void 0:j.prefetchedRepresentationIds.includes(m.chosenRepresentation.id))!=null?l:!1,hasMadeInitialDecision:!0,lastEvaluationReason:m.decisionReasonDetails};return{bestRepresentation:i,nextABRState:g}}function j(a,b,c,e){var f,g=e.bandwidthDiagnostics,h=e.devicePixelRatio,i=e.isDocumentHidden,j=e.mediaDurationSec,l=e.playerDimensions,m=e.playheadMediaTimeSec,n=e.prefetchResult,o=e.sourceBufferBufferedRangesSec;e=e.systemicRiskConfig;var p=b.every(function(a){return a.playbackResolutionCsvqmScoreCurve!=null})?"csvqm":"mos",q=b.map(function(b){return k(a,b)}),r=q.filter(function(a){return(a=n==null?void 0:n.prefetchedRepresentationIds.includes(a.getID()))!=null?a:!1});r=(r=r[0])!=null?r:q[0];f=c!=null?{bestRepresentation:(f=q.find(function(a){return a.getID()===c.bestRepresentationId}))!=null?f:r,hasMadeInitialDecision:c.hasMadeInitialDecision,lastEvaluationReason:c.lastEvaluationReason}:{bestRepresentation:r,hasMadeInitialDecision:!1,lastEvaluationReason:null};var s=d("OzSystemicRiskABRUtils").evaluateSystemicRiskABR({abrState:f,bandwidthDiagnostics:g,devicePixelRatio:h,durationMode:"static",isDocumentHidden:i,mediaDurationSec:j,playerDimensions:l,playheadMediaTimeSec:m,qualityScoreType:p,segments:null,sourceBufferBufferedRangesSec:o.map(function(a){return{endTime:a[1],startTime:a[0]}}),systemicRiskConfig:e,videoRepresentationRestrictions:[],videoRepresentations:q});f=(r=b.find(function(a){return a.representationId===s.bestRepresentation.getID()}))!=null?r:null;i={bestRepresentationId:(g=f==null?void 0:f.representationId)!=null?g:null,bestRepresentationIsPrefetched:(h=n==null?void 0:n.prefetchedRepresentationIds.includes(f==null?void 0:f.representationId))!=null?h:!1,hasMadeInitialDecision:s.hasMadeInitialDecision,lastEvaluationReason:s.lastEvaluationReason};return{bestRepresentation:f,nextABRState:i}}function k(a,b){var c=function(b){throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSystemicRiskABRError","Unexpected call to "+b)};return{addUpdateListener:function(){throw c("addUpdateListener")},blockTimeRange:function(){throw c("blockTimeRange")},canApproximateId:function(){return!1},canPredict:function(){return!1},getBandwidth:function(){return b.bandwidth},getCodecs:function(){return b.mimeCodecsParsed.codecs},getContentProtectionXml:function(){throw c("getContentProtectionXml")},getCustomField:function(){throw c("getCustomField")},getCustomFieldFirstSegment:function(){throw c("getCustomFieldFirstSegment")},getDisplayLabel:function(){throw c("getDisplayLabel")},getEndingSegment:function(){throw c("getEndingSegment")},getHeight:function(){return b.height},getID:function(){return b.representationId},getInitSegment:function(){throw c("getInitSegment")},getLang:function(){return b.lang},getMaxGopSec:function(){throw c("getMaxGopSec")},getMimeCodecs:function(){return b.mimeCodecsParsed.mimeCodecs},getMimeType:function(){return b.mimeCodecsParsed.mimeType},getPredictedSegmentAfter:function(){throw c("getPredictedSegmentAfter")},getQualityScoreCurveString:function(a){switch(a){case"mos":return b.playbackResolutionMosScoreCurve;case"csvqm":return b.playbackResolutionCsvqmScoreCurve;default:a;return null}},getRole:function(){return b.role},getSegment:function(){throw c("getSegment")},getSegmentAfter:function(){throw c("getSegmentAfter")},getSegmentByTime:function(){throw c("getSegmentByTime")},getTimeRanges:function(){throw c("getTimeRanges")},getVariantKey:function(){return b.variantKey},getWidth:function(){return b.width},isEndingSegment:function(){throw c("isEndingSegment")}}}function b(){var a=l();return a.useSidnee?{sidneeConfig:a}:{systemicRiskConfig:d("OzSystemicRiskUtils").getSystemicRiskConfigFromOzPlayerConfig(c("oz-player/configs/OzGlobalConfig"))}}function l(){var a;return{avgSegmentDurationMs:(a=c("MetaConfig"))._("57"),badUploadQualityRewardCurve:a._("84"),badUploadQualityRewardCurveFallback:a._("100"),badUploadQualityThreshold:a._("101"),bitrateMultiplier:a._("102"),bufferReductionMs:a._("109"),defaultVideoDurationMs:a._("110"),encodingRisk:a._("111"),goodUploadQualityRewardCurve:a._("113"),goodUploadQualityRewardCurveFallback:a._("119"),isInitialBitrateEnabled:a._("120"),lookAheadMs:a._("121"),maxAggressiveRisk:a._("122"),maxBandwidthConfidencePct:a._("123"),maxConservativeRisk:a._("124"),maxNormalRisk:a._("125"),maxVeryAggressiveRisk:a._("126"),minBandwidthConfidencePct:a._("127"),minBitrateMultiplier:a._("128"),rewardRatioRoundDigits:a._("129"),riskCurve:a._("130"),riskCurveFallback:a._("131"),riskRatioRoundDigits:a._("133"),riskRewardRatioRoundDigits:a._("134"),useDpr:a._("154"),useSidnee:a._("143")}}g.evaluateVideoPlayerNextgendashABRForVideo=a;g.createVideoPlayerNextgendashABRConfig=b}),98);
__d("VideoPlayerNextgendashConnectionUtils",["CometThrottle","Promise","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e,f,g,i,j,k,l,m){var n=[],o=!1,p=null,q=[],r=[],s=0,t=0,u=0,v=0,w=0,x={clock:a.host.clock(),disconnectedReason:p,displayInstanceKey:f,displayName:e,fullyConnected:o,inboundEventsReceivedCount:t,inboundMessagesReceivedCount:s,inboundMessagesReceivedPerMs:0,inboundQueueLength:q.length,outboundEventsQueuedCount:u,outboundEventsSentCount:v,outboundMessagesSentCount:w,outboundMessagesSentPerMs:0,outboundQueueLength:r.length};function y(){var b={clock:a.host.clock(),disconnectedReason:p,displayInstanceKey:f,displayName:e,fullyConnected:o,inboundEventsReceivedCount:t,inboundMessagesReceivedCount:s,inboundMessagesReceivedPerMs:0,inboundQueueLength:q.length,outboundEventsQueuedCount:u,outboundEventsSentCount:v,outboundMessagesSentCount:w,outboundMessagesSentPerMs:0,outboundQueueLength:r.length},c=Math.max(1,b.clock.perfMs-x.clock.perfMs);b.outboundMessagesSentPerMs=b.outboundMessagesSentCount/c;b.inboundMessagesReceivedPerMs=b.inboundMessagesReceivedCount/c;return b}var z=function(){var a;while(p==null){a=q.shift();if(a==null)break;a.type==="__exception"&&D(a.exception);i(a)}},A=c("CometThrottle")(z,0,{leading:!0,trailing:!0}),B=function(){if(!o||r.length<=0)return;if(g.hasErrored()){F(d("nextgendasherr").nextgendasherr(a,e+"/FlushToErroredPort"));return}var b=r.length,c=k(r),f=c.message;c=c.transferList;r.length=0;g.postMessage(f,c);w+=1;v+=b},C=c("CometThrottle")(B,0,{leading:!0,trailing:!0}),D=function(b){B(),p=b,o=!1,n.forEach(function(a){return a()}),(r.length>0||q.length>0)&&a.logging.log(a,{error:b,format:"["+e+"][%s] disconnected ("+b.name+"); dropped outbound: %s %s; dropped inbound: %s %s; stats=%s",params:[f,r.length,r.map(j).join(","),q.length,q.map(function(a){return a.type}).join(","),JSON.stringify(y())],type:"generic_error_as_warning"}),r.length=0,q.length=0};function E(a){if(p!=null)return;if(a.canSendOnlyLatestOfTypeIfThrottled===!0)for(var b=0;b<r.length;++b)j(r[b])===j(a)&&(r.splice(b,1),u-=1,--b);r.push(a);u+=1;C()}function F(a){q.push({exception:a,type:"__exception"}),z()}try{g.hasErrored()?F(d("nextgendasherr").nextgendasherr(a,e+"/CreateQueuesOnErroredPort")):a.config.isInWorkerType==="RealWorkerV2"?(o=!0,B()):g.fullyConnected.then(function(){if(p!=null)return;o=!0;B()})["catch"](function(b){if(p!=null)return;o=!1;F(d("nextgendasherr").nextgendasherrFromCause(a,b,e+"/FullyConnectedRejection"))});var G=g.onError.add(function(b){F(d("nextgendasherr").nextgendasherrFromCause(a,b,e+"/ErrorFromPort"))});n.push(function(){g.onError.remove(G)});l(n,function(a){s+=1,t+=a.events.length,a.events.forEach(function(a){q.push(a)}),A()});m(n)}catch(c){(h||(h=b("Promise"))).reject(c)["catch"](function(){F(d("nextgendasherr").nextgendasherrFromCause(a,c,e+"/InitException"))})}return{disconnect:D,getStats:y,send:E}}g.createInboundOutboundQueues=a}),98);
__d("VideoPlayerNextgendashHostAPI",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return{perfMs:a.perfMs-b.perfMs,unixMs:a.unixMs-b.unixMs}}function b(a){return a}function c(a){return a}function d(a){return a}function e(a){return a}function g(a){return a}function h(a){return a}function i(a){return a}function j(a){return a}function k(a){return a}f.diffVideoPlayerNextgendashClockstamp=a;f.opaqueVideoPlayerNextgendashHostMediaElement=b;f.unopaqueVideoPlayerNextgendashHostMediaElement=c;f.opaqueVideoPlayerNextgendashHostMediaSource=d;f.unopaqueVideoPlayerNextgendashHostMediaSource=e;f.opaqueVideoPlayerNextgendashHostSourceBuffer=g;f.unopaqueVideoPlayerNextgendashHostSourceBuffer=h;f.opaqueVideoPlayerNextgendashHostMediaSourceHandle=i;f.unopaqueVideoPlayerNextgendashHostMediaSourceHandle=j;f.unopaqueVideoPlayerNextgendashHostEventTarget=k}),66);
__d("VideoPlayerNextgendashHostXMLDOMParser",["nextgendasherr","oz-player/shims/www/OzXmlParserTrustedTypesHTMLPolicyWWW"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){try{var c=d("oz-player/shims/www/OzXmlParserTrustedTypesHTMLPolicyWWW").createTrustedHTMLForDOMParser(b),e=new DOMParser();e=e.parseFromString(c,"application/xml");c=e.querySelector("parsererror");var f=c==null?void 0:c.firstChild,g=f==null?void 0:f.nextSibling;f=f!=null&&f.nodeName.toLowerCase()==="h3"&&g!=null&&g.nodeName.toLowerCase()==="div"?g.innerText:c==null?void 0:c.innerText;if(c!=null){f=(g=f)!=null?g:c.innerHTML;g=new Error(f);g.name="parsererror";throw g}return h(e.documentElement)}catch(e){c=typeof e==="object"&&e!=null&&typeof e.name==="string"?e.name:"NotAnError";f=typeof e==="object"&&e!=null&&typeof e.message==="string"?e.message:String(e);g=1e3;throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostXMLDOMParserException","parseXMLViaDOMParser exception: "+c+": "+f+"; (%s/%s): %s",Math.min(g,b.length),b.length,b.substr(0,g))}}function h(a){var b={$:{}};a!=null&&(b[a.nodeName]=[i(a)]);return b}function i(a){var b={$:{}};for(var c=a.attributes,d=0;d<c.length;++d){var e=c[d];b.$[e.name]=e.value}for(e=a.childNodes,c=0;c<e.length;++c){d=e[c];if(d.nodeName==="#text"){a=d.nodeValue.trim();a&&(b._=a)}else{var f;a=d.nodeName;f=(f=b[a])!=null?f:[];b[a]=f;f.push(i(d))}}return b}g.parseXMLViaDOMParser=a}),98);
__d("VideoPlayerNextgendashMediaUtils",["nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h={byteLength:null,byteOffset:0};function a(a,b,c){if(b<0)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashStartEndByteIndexInvalid","startByteIndex < 0 %s",JSON.stringify([b,c]));if(c<b)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashStartEndByteIndexInvalid","endByteIndex < startByteIndex %s",JSON.stringify([b,c]));return{byteLength:c-b+1,byteOffset:b}}function b(a,b){if(b.byteOffset<0)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashByteRangeInvalid","byteOffset < 0 %s",JSON.stringify(b));if(b.byteLength!=null&&b.byteLength<=0)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashByteRangeInvalid","byteLength <= 0 %s",JSON.stringify(b));return[b.byteOffset,b.byteLength!=null?b.byteOffset+b.byteLength-1:null]}function c(a){var b=[];try{a=a();if(a)for(var c=0,d=a.length;c<d;c++)b.push([a.start(c),a.end(c)])}catch(a){}return b}function e(a,b,c){c===void 0&&(c=0);return a[0]-c<=b&&b<=a[1]+c}function f(a,b){return(a||"unknown")+'; codecs="'+b+'"'}function i(a){var b=/^([^;]+)(?:;\s*codecs=(?:(?:\"([^\"]*?)\")|([^;]*)))?.*$/i;b=(b=b.exec(a))!=null?b:[];var c=b[1],d=b[2];b=b[3];c=c||"";d=d||b||"";b=d.split(",").map(function(a){return a.trim()}).filter(function(a){return a!==""});b=(b=b[0])!=null?b:"";b=(b=b.split(".")[0])!=null?b:"";var e=c.split("/"),f=e[0];e=e[1];return{codecFamily:b,codecs:d,containerType:(b=e)!=null?b:"",contentType:(d=f)!=null?d:"",mimeCodecs:a,mimeType:c}}function j(a){return a.mimeType+"/"+a.codecs}g.ZERO_TO_EOF_OPEN_ENDED_BYTE_RANGE=h;g.makeByteRangeFromStartEndByteIndex=a;g.makeStartEndByteIndexFromByteRangeMaybeOpenEnded=b;g.snapshotTimeRanges=c;g.isWithinRange=e;g.combineMimeTypeAndCodecs=f;g.parseMimeCodecs=i;g.debugStringifyMimeCodecs=j}),98);
__d("VideoPlayerNextgendashHostAPIBrowser",["FBLogger","NetworkStatus","Promise","VideoPlayerNextgendashHostAPI","VideoPlayerNextgendashHostXMLDOMParser","VideoPlayerNextgendashMediaUtils","VideoPlayerNextgendashStateMachine","fb-error","nextgendasherr","oz-player/configs/OzGlobalConfig","oz-player/networks/OzBandwidthEstimator","performance","performanceAbsoluteNow","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=new Set();e=(a=(i||(i=c("performance"))).timeOrigin)!=null?a:(j||(j=c("performanceAbsoluteNow")))()-(k||(k=c("performanceNow")))();function m(a){l.has(a)&&(URL.revokeObjectURL(a),l["delete"](a))}var n={clock:function(){return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({perfMs:(k||(k=c("performanceNow")))(),unixMs:Date.now()})},clockPerfOriginMs:e,fetch:typeof window.fetch==="function"?function(a,b,c){return window.fetch(b,c?babelHelpers["extends"]({},c):void 0)}:function(a){a=d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashBrowserHostAPIFetchUnsupported","VideoPlayerNextgendashBrowserHostAPI.fetch: Missing global.fetch");return(h||(h=b("Promise"))).reject(a)},getPerformanceResourceTimingByName:typeof (i||(i=c("performance"))).getEntriesByName==="function"?function(a){return(i||(i=c("performance"))).getEntriesByName(a,"resource")}:function(){return[]},mediaElementCollectSnapshot:function(a,b){var c=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaElement(b);a=c.getAttribute("src");b=c.srcObject!=null||a!=null&&a.startsWith("blob:");a=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({buffered:d("VideoPlayerNextgendashMediaUtils").snapshotTimeRanges(function(){return c.buffered}),currentTime:c.currentTime,duration:c.duration,ended:c.ended,error:c.error!=null?{code:c.error.code,message:c.error.message}:null,mediaSourceAttached:b,networkState:c.networkState,paused:c.paused,playbackRate:c.playbackRate,readyState:c.readyState,seeking:c.seeking});return a},mediaElementSetPlayhead:function(a,b,c){b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaElement(b);if(!Number.isFinite(c)||c<0)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashBrowserHostAPIMediaElementSetPlayheadInvalid","VideoPlayerNextgendashBrowserHostAPI.mediaElementSetPlayhead: Invalid playheadMediaTimeSec: %s",c);b.currentTime=c},mediaElementSetSource:function(a,b,c,e){b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaElement(b);var f=b.paused===!1;"srcObject"in b&&b.srcObject!=null&&(b.srcObject=null);var g=b.getAttribute("src");g!=null&&g!==""&&(b.removeAttribute("src"),m(g));if(c!=null){if(c.mediaSourceHandle!=null)if("srcObject"in b)b.srcObject=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSourceHandle(c.mediaSourceHandle);else throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashBrowserHostAPIMediaElementSrcObjectMissing","VideoPlayerNextgendashBrowserHostAPI.mediaElementSetSource: Unable to set mediaSourceHandle because HTMLMediaElement.srcObject is missing");else if(c.mediaSource!=null){g=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(c.mediaSource);var h=URL.createObjectURL(g);l.add(h);b.setAttribute("src",h);g.addEventListener("sourceopen",function(){m(h)},{once:!0})}else if(c.url!=null)if(c.url!=="")b.setAttribute("src",c.url);else throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashBrowserHostAPIMediaElementUrlEmpty","VideoPlayerNextgendashBrowserHostAPI.mediaElementSetSource: Unable to set url because it is empty; use null source instead of empty source.url to clear the media element source");else throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashBrowserHostAPIMediaElementInvalidSource","VideoPlayerNextgendashBrowserHostAPI.mediaElementSetSource: Invalid source provided");(e==null?void 0:e.playheadMediaTimeSec)!=null&&(b.currentTime=e.playheadMediaTimeSec);f&&void b.play()["catch"](function(){})}},mediaElementSubscribe:function(a,b,c,e){return o(a,b,d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostEventTarget(b),c,e)},mediaSourceAddSourceBuffer:function(a,b,c,e){var f=c.mimeCodecsParsed,g=c.representationId,h=c.type,i=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(b);c=i.readyState;if(c!=="open")throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostAPIBrowserAddSourceBufferMediaSourceNotOpen","Unable to addSourceBuffer for "+h+" representation %s: mediaSource.readyState='"+c+"'.",g);b=a.host.mediaSourceIsTypeSupported(f.mimeCodecs);if(!b)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostAPIBrowserAddSourceBufferCodecNotSupported","Unable to addSourceBuffer for "+h+" representation %s: mimeCodecs (%s) is not supported by the browser.",g,f.mimeCodecs);var j=i.addSourceBuffer(f.mimeCodecs),k=o(a,d("VideoPlayerNextgendashHostAPI").opaqueVideoPlayerNextgendashHostSourceBuffer(j),j,["updateend","abort","error"],e),l=!1;c=function(){if(l)return;k();l=!0;try{i.removeSourceBuffer(j)}catch(c){if(!(typeof c==="object"&&c!=null&&c.name==="NotFoundError")){var b=d("nextgendasherr").nextgendasherrFromCause(a,c,"VideoPlayerNextgendashHostAPIBrowserAddSourceBufferUnableToCleanup","Unable to removeSourceBuffer originally added for "+h+" representation %s: mimeCodecs (%s)",g,f.mimeCodecs);throw b}}};return[d("VideoPlayerNextgendashHostAPI").opaqueVideoPlayerNextgendashHostSourceBuffer(j),c]},mediaSourceCanConstructInDedicatedWorker:function(){var a;return typeof MediaSource==="function"&&"canConstructInDedicatedWorker"in MediaSource?(a=MediaSource.canConstructInDedicatedWorker)!=null?a:!1:!1},mediaSourceCollectSnapshot:function(a,b){var c="unknown",e="unknown",f=null,g=null;try{var h=[];b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(b);c=b.duration;e=b.readyState;for(var i=0;i<b.sourceBuffers.length;i++)h.push(b.sourceBuffers[i].updating);f=h}catch(b){g=d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashHostAPIMediaSourceCollectSnapshotError")}return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({duration:c,exception:g,readyState:e,sourceBuffersUpdating:f})},mediaSourceCreate:function(a,b){var c=new MediaSource();a=o(a,d("VideoPlayerNextgendashHostAPI").opaqueVideoPlayerNextgendashHostMediaSource(c),c,["sourceopen","sourceended","sourceclose"],b);return[d("VideoPlayerNextgendashHostAPI").opaqueVideoPlayerNextgendashHostMediaSource(c),a]},mediaSourceEndOfStream:function(a,b,c){var e=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(b);if(n.mediaSourceEndOfStreamCallIsExpectedToBeSafeAndNotNoop(a,b,c))try{e.endOfStream()}catch(a){}},mediaSourceEndOfStreamCallIsExpectedToBeSafeAndNotNoop:function(a,b,c){a=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(b);return a.readyState==="open"&&((b=c==null?void 0:c.readyState)!=null?b:0)>=1},mediaSourceGetDuration:function(a,b){a=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(b);return a.duration},mediaSourceGetHandleInWorker:function(a,b){b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaSource(b);b=b.handle;if(b==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostAPIMissingMediaSourceHandle");return d("VideoPlayerNextgendashHostAPI").opaqueVideoPlayerNextgendashHostMediaSourceHandle(b)},mediaSourceIsTypeSupported:function(a){return MediaSource.isTypeSupported(a)},networkDiagnosticsReadBandwidth:function(){return c("oz-player/networks/OzBandwidthEstimator").getBandwidthDiagnostics(c("oz-player/configs/OzGlobalConfig"))},networkDiagnosticsUpdate:function(a){a.navigationTimingSample&&c("oz-player/networks/OzBandwidthEstimator").addNavigationTimingSample(a.navigationTimingSample.timeToFirstByteMs,a.navigationTimingSample.timeToLastByteMs,a.navigationTimingSample.bytes,a.clock.unixMs),a.bandwidthSample&&c("oz-player/networks/OzBandwidthEstimator").addBandwidthSample(a.bandwidthSample.bytes,a.bandwidthSample.timeInMs,a.clock.unixMs)},networkIsOnline:function(){var a=c("NetworkStatus").isOnline();return a?navigator.onLine:a},parseXML:d("VideoPlayerNextgendashHostXMLDOMParser").parseXMLViaDOMParser,scheduleToRun:function(a){try{a()}catch(a){c("FBLogger")("comet_video_player_nextgendash").catching(c("fb-error").getErrorSafe(a)).mustfix("VideoPlayerNextgendashHostAPIWorkException")}},sourceBufferAbort:function(a,b,c){var e=c.mimeCodecsParsed,f=c.representationId;c=c.type;b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostSourceBuffer(b);try{b.abort()}catch(g){b=d("nextgendasherr").nextgendasherrFromCause(a,g,"VideoPlayerNextgendashHostAPISourceBufferAbortException","Unable to abort for "+c+" representation %s: mimeCodecs (%s)",f,e.mimeCodecs);if(typeof g==="object"&&g!=null&&g.name==="InvalidStateError"){a.logging.log(a,{error:b,type:"generic_error_as_warning"});return}throw b}},sourceBufferAppendBuffer:function(a,b,c,e,f){var g=f.mimeCodecsParsed,h=f.representationId;f=f.type;c=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostSourceBuffer(c);if(c.updating)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostAPISourceBufferAppendBufferIsUpdating","Unable to appendBuffer for "+f+" representation %s: mimeCodecs (%s) - updating is true.",h,g.mimeCodecs);try{c.appendBuffer(e)}catch(i){e=d("nextgendasherr").nextgendasherrFromCause(a,i,"");b=n.mediaSourceCollectSnapshot(a,b);throw d("nextgendasherr").nextgendasherrFromMultipleCauses(a,[["appendBuffer",e],b.exception?["snapshot",b.exception]:null].filter(Boolean),"VideoPlayerNextgendashHostAPISourceBufferAppendBufferException","Unable to appendBuffer for "+f+" representation %s: mimeCodecs (%s) "+(b.exception?"snapshotError:partialResults:":"")+" %s %s %s %s",h,g.mimeCodecs,"mediaSource readyState="+b.readyState,"mediaSource duration="+b.duration,"sourceBuffersUpdating=["+(b.sourceBuffersUpdating?b.sourceBuffersUpdating.join(","):"unknown")+"]","target sourceBuffer updating="+(c.updating?"true":"false"))}},sourceBufferChangeType:function(a,b,c){var e=c.mimeCodecsParsed,f=c.mimeCodecsParsedBeforeChangeType,g=c.representationId;c=c.type;b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostSourceBuffer(b);if(b.updating)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostAPISourceBufferChangeTypeIsUpdating","Unable to sourceBuffer.changeType(%s) for "+c+" representation %s: mimeCodecs (%s) - updating is true.",e.mimeCodecs,g,f.mimeCodecs);try{b.changeType(e.mimeCodecs)}catch(b){throw d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashHostAPISourceBufferChangeTypeException","Unable to sourceBuffer.changeType(%s) for "+c+" representation %s: mimeCodecs (%s)",e.mimeCodecs,g,f.mimeCodecs)}},sourceBufferRemove:function(a,b,c){var e=c.mimeCodecsParsed,f=c.removeRange,g=c.representationId;c=c.type;b=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostSourceBuffer(b);if(b.updating)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashHostAPISourceBufferRemoveIsUpdating","Unable to sourceBuffer.remove() for "+c+" representation %s: mimeCodecs (%s) - updating is true.",g,e.mimeCodecs);try{b.remove(f[0],f[1])}catch(b){throw d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashHostAPISourceBufferRemoveException","Unable to sourceBuffer.remove() for "+c+" representation %s: mimeCodecs (%s)",g,e.mimeCodecs)}},sourceBufferSnapshotBuffered:function(a,b){var c=d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostSourceBuffer(b);return d("VideoPlayerNextgendashMediaUtils").snapshotTimeRanges(function(){return c.buffered})}};n.networkIsOnline();f=n;function o(a,b,c,d,e){var f=[];new Set(d).forEach(function(d){var g=function(c){var f=a.host.clock();c=c.timeStamp;var g=f.perfMs-c;c={perfMs:c,unixMs:f.unixMs-g};e({domEventAdjustedClock:c,domEventClock:f,domEventType:d,eventTarget:b})};f.push([d,g]);c.addEventListener(d,g)});return function(){f.forEach(function(a){var b=a[0];a=a[1];c.removeEventListener(b,a)})}}g["default"]=f}),98);
__d("WorkerSyncedMessagePortWithErrored",["WorkerMessagePort"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,b,c)||this;d.$WorkerSyncedMessagePortWithErrored$p_1=!1;b=function(){d.$WorkerSyncedMessagePortWithErrored$p_1=!0};d.onError.add(b);d.fullyConnected["catch"](b);return d}var c=b.prototype;c.hasErrored=function(){return this.$WorkerSyncedMessagePortWithErrored$p_1};return b}(d("WorkerMessagePort").WorkerSyncedMessagePort);g.WorkerSyncedMessagePortWithErrored=a}),98);
__d("VideoPlayerNextgendashConnectionMainToWorker",["CometVideoPlayerNextgendashWorkerResource","CometVideoPlayerNextgendashWorkerWithDebugResource","JSResourceForInteraction","VideoPlayerNextgendashConnectionUtils","VideoPlayerNextgendashHostAPIBrowser","VideoPlayerNextgendashStateMachine","VideoPlayerNextgendashWorkerV2EntrypointWorkerResource","VirtualMessageChannel","WorkerSyncedMessagePortWithErrored","cr:1020","cr:2887","cr:5058","cr:6193","cr:6632","cr:8973","err","fb-error","gkx","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("VideoPlayerNextgendashWorkerEnvironment").__setRef("VideoPlayerNextgendashConnectionMainToWorker"),i=c("gkx")("24365")||c("gkx")("24367")?c("CometVideoPlayerNextgendashWorkerWithDebugResource"):c("CometVideoPlayerNextgendashWorkerResource"),j={RealWorker:null,RealWorkerV2:null,VirtualWorker:null},k={RealWorker:function(a,e){if(b("cr:6632")==null){var f=c("err")("WorkerBundleResource is missing");f.name="WorkerBundleResourceMissing";throw f}if(b("cr:1020")==null){f=c("err")("WorkerClient is missing");f.name="WorkerClientMissing";throw f}f=i===c("CometVideoPlayerNextgendashWorkerWithDebugResource")?"CometVideoPlayerNextgendashWorkerWithDebug":"CometVideoPlayerNextgendashWorker";f=b("cr:6632").createDedicatedWebWorker(i,{logImportScriptsErrors:!0,name:f},{workerEnvConfig:e});e=new(d("WorkerSyncedMessagePortWithErrored").WorkerSyncedMessagePortWithErrored)(f,a);b("cr:1020").init(e);return e},RealWorkerV2:function(a,e){if(b("cr:6193")==null){var f=c("err")("WebWorkerV2Resource is missing");f.name="WebWorkerV2ResourceMissing";throw f}if(b("cr:1020")==null){f=c("err")("WorkerClient is missing");f.name="WorkerClientMissing";throw f}f="CometVideoPlayerNextgendashWorkerV2";f=b("cr:6193").createDedicatedV2WebWorker(c("VideoPlayerNextgendashWorkerV2EntrypointWorkerResource"),f).worker;var g=new(d("WorkerSyncedMessagePortWithErrored").WorkerSyncedMessagePortWithErrored)(f,a);b("cr:1020").init(g);g.fullyConnected.then(function(){g.postMessage({type:"comet_video_player_nextgendash__main_to_worker_init",workerEnvConfig:e})})["catch"](function(a){});return g},VirtualWorker:function(a,e){var f=!0;f=new(d("VirtualMessageChannel").VirtualMessageChannel)(f,f);var g=f.port1;f=f.port2;var i=new(d("WorkerSyncedMessagePortWithErrored").WorkerSyncedMessagePortWithErrored)(f,"VideoPlayerNextgendashConnectionWorkerToMain_VirtualWorker");f=new(d("WorkerSyncedMessagePortWithErrored").WorkerSyncedMessagePortWithErrored)(g,a);a=(g=b("cr:2887"))!=null?g:h.getModuleIfRequireable();a!=null?a.createVideoPlayerNextgendashWorkerEnvironment(e,i,b("cr:5058"),b("cr:8973")):h.load().then(function(a){a.createVideoPlayerNextgendashWorkerEnvironment(e,i,b("cr:5058"),b("cr:8973"))})["catch"](function(a){a=c("fb-error").getErrorSafe(a);c("fb-error").FBLogger("comet_video_player_nextgendash","WorkerEnvironmentJSResourceLoadRejection").catching(a).fatal('Failed to load module "VideoPlayerNextgendashWorkerEnvironment" / '+String(a))});return f}};function a(){return c("gkx")("24364")&&c("gkx")("4484")&&c("VideoPlayerNextgendashHostAPIBrowser").mediaSourceCanConstructInDedicatedWorker()?"RealWorkerV2":c("gkx")("24364")&&c("VideoPlayerNextgendashHostAPIBrowser").mediaSourceCanConstructInDedicatedWorker()?"RealWorker":"VirtualWorker"}a=a();a==="VirtualWorker"&&b("cr:2887")==null&&h.preload();function e(a,b){try{l(a,b,{host:{clock:c("VideoPlayerNextgendashHostAPIBrowser").clock},loggingState:{metadata:{}}})}catch(a){}}function l(a,b,c){var e=j[a];if(e!=null){if(e.port!=null)return e.port;throw e.exception}e="VideoPlayerNextgendashConnectionMainToWorker_"+a;try{var f=k[a];f=f(e,babelHelpers["extends"]({},b,{isInWorkerType:a}));j[a]={port:f};return f}catch(f){b=d("nextgendasherr").nextgendasherrFromCause(c,f,e+"/PortFactoryException");j[a]={exception:b};throw b}}function f(a,b,c,e){var f="VideoPlayerNextgendashConnectionMainToWorker_"+b,g=c,h=l(b,a.config,a);f=d("VideoPlayerNextgendashConnectionUtils").createInboundOutboundQueues(a,f,g,h,function(a){(a.type==="__exception"||a.workerType===b&&(a.playerInstanceKey==null||a.playerInstanceKey===c))&&e(a)},function(a){return a.eventToWorker.type},function(a){return{message:{events:a.map(function(a){return a.eventToWorker}),type:"comet_video_player_nextgendash__main_to_worker"},transferList:a.reduce(function(a,b){return a.concat((a=b.transferList)!=null?a:[])},[])}},function(a,b){var c=h.addMessageListener("comet_video_player_nextgendash__worker_to_main",b);a.push(function(){h.removeMessageListener("comet_video_player_nextgendash__worker_to_main",c)})},function(b){var c=h.addMessageListener("comet_video_player_nextgendash__worker_to_main_qpl_calls",function(b){b.calls.forEach(function(b){a.logging.log(a,{qplCall:b,type:"qpl_call"})})});b.push(function(){h.removeMessageListener("comet_video_player_nextgendash__worker_to_main_qpl_calls",c)});var d=h.addMessageListener("comet_video_player_nextgendash__worker_to_main_debug_snapshot",function(b){a.logging.log(a,{snapshot:b.snapshot,type:"state_machine_debug_snapshot_from_worker"})});b.push(function(){h.removeMessageListener("comet_video_player_nextgendash__worker_to_main_debug_snapshot",d)});var e=h.addMessageListener("comet_video_player_nextgendash__worker_to_main_debug_events",function(b){a.logging.log(a,{events:b.events,type:"state_machine_debug_events_from_worker"})});b.push(function(){h.removeMessageListener("comet_video_player_nextgendash__worker_to_main_debug_events",e)})});g=f.disconnect;var i=f.getStats;f=f.send;function j(a){h.postMessage({haltReason:a,type:"comet_video_player_nextgendash__main_to_worker_debug_halt"},[])}return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({disconnectFromWorker:g,getStats:i,sendHaltedToWorker:j,sendToWorker:f})}g.initialWorkerType=a;g.preloadWorker=e;g.connectToWorker=f}),98);
__d("VideoPlayerNextgendashConnectionWorkerToMain",["VideoPlayerNextgendashConnectionUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f){b="VideoPlayerNextgendashConnectionWorkerToMain_"+b;var g="";b=d("VideoPlayerNextgendashConnectionUtils").createInboundOutboundQueues(a,b,g,c,f,function(a){return a.eventToMain.type},function(a){return{message:{events:a.map(function(a){return a.eventToMain}),type:"comet_video_player_nextgendash__worker_to_main"},transferList:a.reduce(function(a,b){return a.concat((a=b.transferList)!=null?a:[])},[])}},function(a,b){var d=c.addMessageListener("comet_video_player_nextgendash__main_to_worker",b);a.push(function(){c.removeMessageListener("comet_video_player_nextgendash__main_to_worker",b),a.push(function(){c.removeMessageListener("comet_video_player_nextgendash__main_to_worker",d)})})},function(b){e&&b.push(e(a,c))});g=b.disconnect;f=b.getStats;b=b.send;return{disconnectFromMain:g,getStats:f,sendToMain:b}}g.connectToMain=a}),98);
__d("VideoPlayerNextgendashEngineErrors",["nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e,f){return{createdTimestamp:Date.now(),errorLocation:c,errorMessageFormat:(e!=null&&e!==""?e+" :: ":f!=null&&f.length>0?f.map(function(){return"%s"}).join(" ")+" :: ":"")+b.messageFormat,errorMessageParams:((a=f==null?void 0:f.map(function(a){return String(a)}))!=null?a:[]).concat(b.messageParams),errorName:d("nextgendasherr").reduceCardinalityOfNextgendashErrorName(b.name)}}g.createVideoPlayerErrorFromNextgendashEngine=a}),98);
__d("VideoPlayerNextgendashManifestParser",["VideoPlayerNextgendashMediaUtils","fb-error","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function b(a){return a}function h(a,b,e,f){for(var g=arguments.length,h=new Array(g>4?g-4:0),i=4;i<g;i++)h[i-4]=arguments[i];var j=d("nextgendasherr").nextgendasherr.apply(void 0,[a,"VideoPlayerNextgendashManifestParser/"+e,f+" :: MPD=%s"].concat(h,[JSON.stringify(b)]));c("fb-error").TAAL.blameToPreviousFrame(j);return j}function e(a,b,c){var e,f=c.audioOnly;c=(c=b.MPD)==null?void 0:c[0];if(!c)throw h(a,b,"NoMPD","Missing MPD root");e=(e=c.Period)==null?void 0:e[0];if(!e)throw h(a,b,"NoPeriod","Missing MPD>Period[1]");e=e.AdaptationSet;if(!e||e.length<=0)throw h(a,b,"NoAdaptationSet","Missing MPD>Period[1]>AdaptationSet");if(e.some(function(a){return a.Representation==null||a.Representation.length===0}))throw h(a,b,"SomeEmptyAdaptationSets","Some AdaptationSets contain no Representations");var g=function(c){var e,f,g,j,p,q=c.adaptationSetId,r=c.adaptationSetMimeType,s=c.adaptationSetXml,t=c.representationIndex;c=c.representationXml;e=(e=c.$.id)!=null?e:q+"-#"+t;q=(t=(q=c.$.mimeType)!=null?q:s.$.mimeType)!=null?t:"";if(q===""||q!==r){throw h(a,b,"MimeTypeMismatch",'Representation id="%s" Representation>@mimeType="%s" and AdaptationSet>@mimeType="%s" mismatch',e,(t=c.$.mimeType)!=null?t:"",(r=s.$.mimeType)!=null?r:"")}t=(r=(t=c.$.codecs)!=null?t:s.$.codecs)!=null?r:"";if(t===""){a.logging.log(a,{error:h(a,b,"CodecsMissingOrEmpty",'Representation id="%s" Representation>@codecs="%s" and AdaptationSet>@codecs="%s" is missing or empty',e,(r=c.$.codecs)!=null?r:"",(r=s.$.codecs)!=null?r:""),type:"generic_error_as_warning"})}r=d("VideoPlayerNextgendashMediaUtils").parseMimeCodecs(o(q,t));if(r.contentType===""||r.contentType==="unknown"||r.containerType===""){throw h(a,b,"MimeCodecsParsedUnexpected",'Representation id="%s" missing contentType or containerType: %s; AdaptationSet>@mimeType="%s", AdaptationSet>@codecs="%s", Representation>@mimeType="%s", Representation>@codecs="%s"',e,JSON.stringify(r),(q=s.$.mimeType)!=null?q:"",(t=s.$.codecs)!=null?t:"",(q=c.$.mimeType)!=null?q:"",(t=c.$.codecs)!=null?t:"")}t=s.$.FBVariantKey==="und"?null:(q=s.$.FBVariantKey)!=null?q:null;q=s.$.lang==="und"?null:(q=s.$.lang)!=null?q:null;f=(f=(f=s.Role)==null?void 0:(f=f[0])==null?void 0:f.$.value)!=null?f:null;var u=Number(c.$.bandwidth);if(!Number.isFinite(u)||u<=0)throw h(a,b,"RepresentationBandwidthInvalid",'Representation id="%s" Representation>@bandwidth is missing or invalid: %s',e,c.$.bandwidth);var v=c.$.FBPlaybackResolutionMos,w=c.$.FBPlaybackResolutionCsvqm,x=c.$.FBQualityLabel;g=((g=c.$.FBAbrPolicyTags)!=null?g:"").split(",").map(function(a){return a.trim()}).filter(function(a){return a!==""});j=(j=c.ContentProtection)!=null?j:s.ContentProtection;j=j==null?void 0:(s=j.map(function(a){var b=a.$.schemeIdUri;return b==null?null:{cencPsshBase64:(a=a["cenc:pssh"])==null?void 0:(a=a[0])==null?void 0:(a=a._)==null?void 0:a.replace(/-/g,"+").replace(/_/g,"/"),schemeIdUri:b}}))==null?void 0:s.filter(Boolean);s=(s=c.BaseURL)==null?void 0:(s=s[0])==null?void 0:s._;if(s==null)throw h(a,b,"RepresentationBaseURLMissing",'Representation id="%s" Representation>BaseURL is missing',e);p=(p=c.SegmentBase)==null?void 0:p[0];c=(c=c.SegmentTemplate)==null?void 0:c[0];if(p!=null){var y;y=(y=p.Initialization)==null?void 0:y[0];if(y==null)throw h(a,b,"SegmentBaseInitializationMissing",'Representation id="%s" SegmentBase>Initialization is missing',e);y=n(a,b,e,"SegmentBase>Initialization>@range",y.$.range);var z=n(a,b,e,"SegmentBase>@indexRange",p.$.indexRange);if(p.$.indexRangeExact==="false")throw h(a,b,"SegmentBaseIndexRangeExactFalseUnsupported",'Representation id="%s" SegmentBase>@indexRangeExact="false" is unsupported',e);p={baseURL:s,indexByteRange:d("VideoPlayerNextgendashMediaUtils").makeByteRangeFromStartEndByteIndex(a,z[0],z[1]),initByteRange:d("VideoPlayerNextgendashMediaUtils").makeByteRangeFromStartEndByteIndex(a,y[0],y[1]),type:"SegmentBase"}}else if(c!=null){z=c.$.media;if(z==null)throw h(a,b,"SegmentTemplateMediaMissing",'Representation id="%s" SegmentTemplate>@media is missing',e);y=c.$.initialization;if(y==null)throw h(a,b,"SegmentTemplateInitializationMissing",'Representation id="%s" SegmentTemplate>@initialization is missing',e);var A=m(a,b,e,"SegmentTemplate>@timescale",c.$.timescale,k),B=c.$.startNumber!=null?m(a,b,e,"SegmentTemplate>@startNumber",c.$.startNumber,l):null;c=(c=c.SegmentTimeline)==null?void 0:c[0];if(c==null)throw h(a,b,"SegmentTimelineMissing",'Representation id="%s" SegmentTemplate>SegmentTimeline is missing',e);c=i(a,b,e,c);p={baseURL:s,initURL:y,segmentTimeline:c,segmentURLTemplate:z,startNumber:B,timescale:A,type:"SegmentTemplate"}}else throw h(a,b,"SegmentsInfoInvalid",'Representation id="%s" SegmentBase and SegmentTemplate are missing',e);return{abrPolicyTags:g,bandwidth:u,contentProtections:j,lang:q,mimeCodecsParsed:r,playbackResolutionCsvqmScoreCurve:w,playbackResolutionMosScoreCurve:v,qualityLabel:x,representationId:e,role:f,segmentsInfo:p,variantKey:t}},j=function(a,b){a=Number.parseInt((a=a)!=null?a:"",10);b=Number.parseInt((b=b)!=null?b:"",10);return Number.isSafeInteger(a)&&Number.isSafeInteger(b)&&a>0&&b>0?{height:b,width:a}:null},q=function(c){var d=g(c),e=c.adaptationSetXml;c=c.representationXml;var f=j(c.$.width,c.$.height),i=j(e.$.width,e.$.height);f=(f=f)!=null?f:i;if(f==null)throw h(a,b,"InvalidWidthHeight",'Representation width and/or height attributes are invalid: Representation id="%s" width=%s height=%s, AdaptationSet id="%s" width=%s height=%s',d.representationId,String(c.$.width),String(c.$.height),String(e.$.id),String(e.$.width),String(e.$.height));return babelHelpers["extends"]({},d,{height:f.height,type:"video",width:f.width})},r=function(a){return babelHelpers["extends"]({},g(a),{type:"audio"})},s=function(a){return babelHelpers["extends"]({},g(a),{type:"application"})},t=function(a){if(a.$.mimeType!=null)return a.$.mimeType;a=a.Representation;return a&&a.length>0&&a[0].$.mimeType!=null?a[0].$.mimeType:null},u=e.findLast(function(a){return a.Representation!=null&&a.Representation.length>0}),v=e.map(function(a){return a.$.id}),w=new Set(v).size===v.length;v=e.reduce(function(c,d,e){var g,i,j=(g=w?d.$.id:void 0)!=null?g:"id-mpdas-"+e;g=d===u;var k=(i=t(d))!=null?i:"";i=((i=d.Representation)!=null?i:[]).map(function(a,b){return{adaptationSetId:j,adaptationSetMimeType:k,adaptationSetXml:d,representationIndex:b,representationXml:a}});g={adaptationSetId:j,adaptationSetIsLastNonEmpty:g,adaptationSetMimeType:k};var l;k.indexOf("video")===0?f||(l=babelHelpers["extends"]({},g,{representations:i.map(q),type:"video"})):k.indexOf("audio")===0?l=babelHelpers["extends"]({},g,{representations:i.map(r),type:"audio"}):k.indexOf("application")===0?l=babelHelpers["extends"]({},g,{representations:i.map(s),type:"application"}):a.logging.log(a,{error:h(a,b,"UnsupportedAdaptationSet",'Unsupported mimeType="%s" resolved for AdaptationSet id="%s" at index %s',j,k,String(e)),type:"generic_error_as_warning"});l&&c.push(l);return c},[]);e=v.map(function(a){a=a.representations;return a}).flat();if(e.length===0)throw h(a,b,"NoRepresentations","Not found any Representations in any of %s AdaptationSets",String(v.length));var x=v.map(function(a){return a.adaptationSetId});if(new Set(x).size<x.length)throw h(a,b,"NonUniqueAdaptationSetID","AdaptationSet ids are required to be unique within the manifest: %s",x.join(","));x=e.map(function(a){return a.representationId});if(new Set(x).size<x.length)throw h(a,b,"NonUniqueRepresentationID","Representation ids are required to be unique within the manifest: %s",x.join(","));x=f?null:p(a,v.map(function(a){return a.type==="video"?a:null}).filter(Boolean));var y=p(a,v.map(function(a){return a.type==="audio"?a:null}).filter(Boolean));v=v.map(function(a){return a.type==="application"?a.representations:null}).filter(Boolean).flat();if(x!=null)if(x.selected.length===0)if(x.ignored.size>0)throw h(a,b,"AllVideoRepresentationsIgnored","All video representations ignored: %s",Array.from(x.ignored.entries()).map(function(a){var b=a[0];a=a[1];return b.representationId+":"+a}).join("; "));else throw h(a,b,"NoVideoRepresentations","Not found any video representations, found: %s",e.map(function(a){return a.representationId+":"+d("VideoPlayerNextgendashMediaUtils").debugStringifyMimeCodecs(a.mimeCodecsParsed)}).join("; "));else x.ignored.size>0&&a.logging.log(a,{error:h(a,b,"IgnoredVideoRepresentations","Some video representations ignored: %s",Array.from(x.ignored.entries()).map(function(a){var b=a[0];a=a[1];return b.representationId+":"+a}).join("; ")),type:"generic_error_as_warning"});function z(a){return new Set(a.map(function(a){return[a.mimeCodecsParsed.contentType,a.mimeCodecsParsed.containerType,a.mimeCodecsParsed.codecFamily].join("/")})).size>1}e=z((e=x==null?void 0:x.selected)!=null?e:[]);z=z(y.selected);return{audioOnly:f,createdAt:a.host.clock(),debugXml:a.config.debugViz||a.config.debugLog?c:void 0,manifestRepresentations:{application:v,audio:y.selected,video:(v=x==null?void 0:x.selected)!=null?v:[]},metadata:{manifestIsLiveTemplated:c.$.FBIsLiveTemplated==="true",manifestIsMixedCodecAudio:z,manifestIsMixedCodecVideo:e,manifestType:c.$.type==="dynamic"?"dynamic":"static"}}}function i(a,b,c,d){d=((d=d.S)!=null?d:[]).map(function(d,e){return{d:m(a,b,c,"SegmentTimeline>S["+(e+1)+"]>@d",d.$.d,k),id:d.$.id==null?void 0:m(a,b,c,"SegmentTimeline>S["+(e+1)+"]>@id",d.$.id,l),r:d.$.r==null?0:m(a,b,c,"SegmentTimeline>S["+(e+1)+"]>@r",d.$.r,l),t:m(a,b,c,"SegmentTimeline>S["+(e+1)+"]>@t",d.$.t,l)}});var e=d.filter(function(a){return a.id!=null});if(e.length>0&&e.length<d.length)throw h(a,b,"SegmentTimelineMissingSomeIds",'Representation id="%s" SegmentTimeline should either have or not have @id on every S tag; found on %s out of %s tags',c,e.length,d.length);return d}function j(a){return Number.isFinite(a)?null:'not a finite integer, expected format: "123"'}function k(a){return a>0?null:"not a positive integer"}function l(a){return a>=0?null:"not a positive integer or zero"}function m(a,b,c,d,e,f){var g=parseInt(e,10),i=j(g);i==null&&f!=null&&(i=f(g));if(i!=null)throw h(a,b,"VideoPlayerNextgendashManifestParserInvalidNumberInteger["+d+"]",'Representation id="%s" %s "%s" is missing or invalid ('+i+")",c,d,e);return g}function n(a,b,c,d,e){var f=e==null?void 0:e.split("-").map(Number);if(f==null||f.length!==2)throw h(a,b,"InvalidRange["+d+"]",'Representation id="%s" %s "%s" is missing or invalid (expected format: "start-end")',c,d,e);return[f[0],f[1]]}function o(a,b){return a+'; codecs="'+b+'"'}function p(a,b){var c=[],d=new Map();b.forEach(function(b){for(var e=b.representations,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;if(h.abrPolicyTags.includes("avoid_on_abr")&&!b.adaptationSetIsLastNonEmpty){d.set(h,"avoid_on_abr");continue}if(!a.host.mediaSourceIsTypeSupported(h.mimeCodecsParsed.mimeCodecs)){d.set(h,"codec_not_supported");continue}c.push(h)}});return{ignored:d,selected:c}}function f(a){var b=a.height;a=a.qualityLabel;return a==null||a===""?String(b)+"p":(b=a)!=null?b:""}function q(a){var b=a.lang;a=a.role;b=(b=b)!=null?b:"Default";return a!=null?b+" - "+a:b}g.makeVideoPlayerNextgendashOpaqueManifestRepresentationId=a;g.unopaqueVideoPlayerNextgendashManifestRepresentationId=b;g.parseMPD=e;g.getDisplayLabelFromVideoRepresentation=f;g.getDisplayLabelFromAudioRepresentation=q}),98);
__d("VideoPlayerNextgendashEngineExtrasAPI",["VideoPlayerNextgendashManifestParser","VideoPlayerOzWWWGlobalConfig","emptyFunction","gkx","oz-player/networks/OzBandwidthEstimator"],(function(a,b,c,d,e,f,g){"use strict";c("emptyFunction");function a(a){a.getVideoElementAPI;var b=a.mainSm,e=function(){var a=b.state;if(a.state==="__null__"||a.state==="__disposed__")return null;a=a.dashManifestParsed.state;return a.state!=="parsed"?null:a},f=function(){var a=b.state;return a.state==="linked_to_worker"?a.playerStateFromWorker:null},g=function(){var a=e();return(a=a==null?void 0:a.data.manifestRepresentations.video)!=null?a:[]},h=function(){var a=e();return(a=a==null?void 0:a.data.manifestRepresentations.audio)!=null?a:[]},i=function(a){var b=f(),c=new Set((b=b==null?void 0:(b=b.blockedRepresentationIds)==null?void 0:b.video)!=null?b:[]);return a.filter(function(a){return!c.has(a.representationId)})},j=function(a){var b=f(),c=new Set((b=b==null?void 0:(b=b.blockedRepresentationIds)==null?void 0:b.audio)!=null?b:[]);return a.filter(function(a){return!c.has(a.representationId)})},k=function(a){var b=f(),c=new Set((b=b==null?void 0:(b=b.targetVariantRepresentationIds)==null?void 0:b.video)!=null?b:[]);return a.filter(function(a){return c.has(a.representationId)})},l=function(){var a=f(),b=a==null?void 0:a.playingRepresentationId.audio;a=h().find(function(a){return a.representationId===b});return a},m=function(){var a=f(),b=a==null?void 0:a.playingRepresentationId.video;a=g().find(function(a){return a.representationId===b});return a},n=function(){var a=f(),b=a==null?void 0:a.targetRepresentationId.audio;a=h().find(function(a){return a.representationId===b});return a},o=function(){var a=f(),b=a==null?void 0:a.targetRepresentationId.video;a=g().find(function(a){return a.representationId===b});return a},p=function(a){return{displayLabel:d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromAudioRepresentation(a),id:a.representationId,lang:a.lang,mimeCodecs:a.mimeCodecsParsed.mimeCodecs,role:a.role,variantKey:a.variantKey}},q=function(a){return{codec:a.mimeCodecsParsed.codecs,codecFamily:a.mimeCodecsParsed.codecFamily,displayLabel:d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(a),height:a.height,id:a.representationId,lang:a.lang,mimeCodecs:a.mimeCodecsParsed.mimeCodecs,qualityLabel:a.qualityLabel,role:a.role,variantKey:a.variantKey,width:a.width}},r=function(){var a=b.state;a=a.state==="__null__"||a.state==="__disposed__"?null:a.selectedMediaVariant;return a};a={getApproximateFBLSToPlayerDisplayLatency:function(){return null},getAvailableAudioTracks:function(){return j(h()).map(function(a){return p(a)})},getAvailableVideoQualities:function(){return Array.from(new Set(k(i(g())).sort(function(a,b){return a.bandwidth-b.bandwidth}).map(d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation)))},getAvailableVideoTracks:function(){return i(g()).map(function(a){return q(a)})},getCurrentAudioRepresentation:function(){var a=l();return a==null?null:{getBandwidth:function(){return a.bandwidth},getDisplayLabel:function(){return d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromAudioRepresentation(a)},getID:function(){return a.representationId},getMimeCodecs:function(){return a.mimeCodecsParsed.mimeCodecs}}},getCurrentPlayingAudioRepresentationID:function(){var a=l();return a!=null?a.representationId:null},getCurrentPlayingAudioTrackID:function(){var a=l();return a!=null?a.representationId:null},getCurrentPlayingVideoQuality:function(){var a=m();return a!=null?d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(a):""},getCurrentPlayingVideoRepresentationID:function(){var a=m();return a!=null?a.representationId:null},getCurrentTargetVideoQuality:function(){var a=o();return a!=null?d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(a):""},getCurrentVideoRepresentation:function(){var a=m();return a==null?null:{canPredict:function(){return!1},getBandwidth:function(){return a.bandwidth},getDisplayLabel:function(){return d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(a)},getID:function(){return a.representationId},getMimeCodecs:function(){return a.mimeCodecsParsed.mimeCodecs},getQualityScoreCurveString:function(b){if(b==="csvqm")return a.playbackResolutionCsvqmScoreCurve;else return a.playbackResolutionMosScoreCurve},getTimeRanges:function(){return[]}}},getEstimatedBandwidth:function(){return c("oz-player/networks/OzBandwidthEstimator").getBandwidth(c("VideoPlayerOzWWWGlobalConfig"))},getInbandCaptionsAutogeneratedFromManifest:function(){return!1},getInbandCaptionsExpectedFromManifest:function(){return!1},getManifestIdentifier:function(){return null},getMpdValidationErrors:function(){return null},getPerfLoggerProvider:function(){return null},getRepresentationCaptionsExpectedFromManifest:function(){return!1},getStreamType:function(){return"dash"},getTargetAudioTrack:function(){var a=n();return a==null?null:p(a)},getUserSelectedVideoQuality:function(){var a=b.state;a=a.state==="__null__"||a.state==="__disposed__"?null:a.selectedVideoQualityDisplayLabel;return(a=a)!=null?a:"auto"},getUserSelectedVideoVariant:function(){var a,b=r();return b==null?null:{lang:(a=(a=b.audioLang)!=null?a:b.videoLang)!=null?a:null,role:(a=(a=b.audioRole)!=null?a:b.videoRole)!=null?a:null}},getVideoProjectionType:function(){return null},getVideoRepresentations:function(){return null},isDrm:function(){return!1},isFBIsLiveTemplated:function(){return!1},isFBMS:function(){return!1},isFBWasLive:function(){return!1},isLiveRewindAvailable:function(){return!1},isMixedCodecManifest:function(){var a=e();return a==null||a.state!=="parsed"?null:a.data.metadata.manifestIsMixedCodecVideo||a.data.metadata.manifestIsMixedCodecAudio},isPredictiveDash:function(){return!1},setDimensions:function(a){},setEnableLiveheadCatchup:function(a){},setLatencyLevel:function(a){},setUserSelectedVideoQuality:function(a){a=a==="auto"||a==="notselected"?null:a;b.sendEvent({type:"select_video_quality",videoQualityDisplayLabel:a})},setUserSelectedVideoVariant:function(a){var c=b.state;c=c.state==="__null__"||c.state==="__disposed__"?null:c.selectedMediaVariant;b.sendEvent({mediaVariant:babelHelpers["extends"]({},(c=c)!=null?c:{audioLang:null,audioRole:null,videoLang:null,videoRole:null},{audioLang:(c=a==null?void 0:a.lang)!=null?c:null,audioRole:(c=a==null?void 0:a.role)!=null?c:null,videoLang:(c=a==null?void 0:a.lang)!=null?c:null,videoRole:(c=a==null?void 0:a.role)!=null?c:null}),type:"select_media_variant"})}};return a}g.createVideoPlayerNextgendashEngineExtrasAPI=a}),98);
__d("VideoPlayerNextgendashLoggingAPI",["VideoPlayerNextgendashStateMachine","emptyFunction","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";function b(a){var b,c=a.loggingState.prevLogstamp;b={clock:a.host.clock(),sequence:((b=c==null?void 0:c.sequence)!=null?b:0)+1};a.loggingState.prevLogstamp=b;return[c,b]}function h(a,b){b=(b=b==null?void 0:b.slice())!=null?b:[];var c=b.slice(),d=0;a=(a=a)!=null?a:"";var e=/(?!\\)%[sidfoOc]/g,f=e.exec(a);while(f!=null)++d,c.shift(),f=e.exec(a);while(c.length>0)c.shift(),a+=" %s",++d;while(b.length<d)b.push("NOPARAM");return[a,b]}function e(a,b,c,d){a=h(a,b);b=a[0];a=a[1];c=h(c,d);d=c[0];c=c[1];b=b!==""&&d!==""?b+" :: "+d:b+d;return[b,a.concat(c)]}var i={displayName:"VideoPlayerNextgendashLoggingDestinationNull",log:c("emptyFunction")};function f(a){var b=new Set(a.filter(Boolean));if(b.size<1)return i;else return{displayName:"VideoPlayerNextgendashLoggingDestinationCombined:"+Array.from(b).map(function(a){return a.displayName}).join(":"),log:function(a,c){b.forEach(function(e){try{e.log(a,c)}catch(g){var f;b["delete"](e);e=d("nextgendasherr").nextgendasherrFromCause(a,g,"VideoPlayerNextgendashLoggingDestinationError","Caught exception from "+e.displayName+" when calling log with "+c.type);(f=d("nextgendasherr").nextgendasherrFBLogger(a).catching(e)).mustfix.apply(f,[e.messageFormat].concat(e.messageParams))}})}}}function j(a,b){return{_:"#"+a.sequentialId+"#"+a.displayName,state:b===!0?babelHelpers["extends"]({state:a.state.state},a.state.state==="__disposed__"&&a.state.exception!=null?{exception:a.state.exception}:{}):a.state}}var k=a.Element,l=a.HTMLVideoElement,m=a.HTMLAudioElement,n=Object.prototype.toString;function o(a,b){return p(a,function(c){if(typeof c==="function")return b.shouldSnapshotFunctions?"[Function "+c.toString()+"]":c;else if(c instanceof Error){if(!b.shouldSnapshotErrors)return c;var e=c,f={message:e.message!==e.messageFormat?e.message:void 0,messageFormat:e.messageFormat,messageParams:e.messageParams,metadata:e.metadata?e.metadata.getAll():void 0,name:e.name,nextgendashClock:c.nextgendashClock,project:e.project,stack:b.shouldSnapshotIncludeErrorStackTrace?e.stack:void 0};Object.keys(f).forEach(function(a){f[a]==null&&a!=="name"&&delete f[a]});return f}else if(typeof c==="object"&&c!=null){e=function(a){if(!b.shouldSnapshotIncludeObjectProperties)return new Map();var c=[];if(k!=null&&a instanceof k){for(var d=a.attributes,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.push([g.name==="class"?"className":g.name==="for"?"htmlFor":g.name,g.value])}c.push.apply(c,[].concat(l!=null&&a instanceof l||m!=null&&a instanceof m?Object.getOwnPropertyNames((g=Object.getPrototypeOf(Object.getPrototypeOf(a)))!=null?g:{}):[],Object.getOwnPropertyNames((f=Object.getPrototypeOf(a))!=null?f:{}),Object.getOwnPropertyNames(a)).map(function(b){try{return[b,a[b]]}catch(a){return[b,"<exception:"+String(a)+">"]}}))}else if(a instanceof Map){e=[];for(d=a.entries(),g=Array.isArray(d),f=0,d=g?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(g){if(f>=d.length)break;h=d[f++]}else{f=d.next();if(f.done)break;h=f.value}h=h;e.push(h)}c.push(["$Map.entries",e])}else if(a instanceof Set){h=[];for(f=a.values(),g=Array.isArray(f),d=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(d>=f.length)break;e=f[d++]}else{d=f.next();if(d.done)break;e=d.value}e=e;h.push(e)}c.push(["$Set.values",h])}else if(a instanceof Uint8Array){e=[];d=5;g=0;for(;g<d&&g<a.length;++g)e.push(a[g]);a.length>d+d&&e.push("...");for(g=Math.max(g,a.length-d);g<a.length;++g)e.push(a[g]);c.push(["$Uint8Array.length",a.length]);c.push(["$Uint8Array.byteOffset",a.byteOffset]);c.push(["$Uint8Array.byteLength",a.byteLength]);c.push(["$Uint8Array.bytes",e])}else if(a instanceof ArrayBuffer){f=new Uint8Array(a);h=[];d=5;g=0;for(;g<d&&g<f.length;++g)h.push(f[g]);f.length>d+d&&h.push("...");for(g=Math.max(g,f.length-d);g<f.length;++g)h.push(f[g]);c.push(["$ArrayBuffer.byteLength",a.byteLength]);c.push(["$ArrayBuffer.bytes",h])}return new Map(c.filter(function(a){var b=a[0];a=a[1];return b.startsWith("$Map.")||b.startsWith("$Set.")||b.startsWith("$Uint8Array.")||b.startsWith("$ArrayBuffer.")||!(typeof a==="object"||typeof a==="function"||b.startsWith("on")&&a===null||b.toUpperCase()===b)}))};if(d("VideoPlayerNextgendashStateMachine").isStateMachine(c))return j(c,c!==a&&b.shouldOmitChildStateMachineState);else if(k!=null&&c instanceof k){var g=c,h=e(g),i={$_:"<"+g.nodeName.toLowerCase()+">"};b.shouldSnapshotIncludeOriginalReference&&(i.$$=g);for(var g=h.entries(),h=Array.isArray(g),o=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(h){if(o>=g.length)break;p=g[o++]}else{o=g.next();if(o.done)break;p=o.value}p=p;var q=p[0];p=p[1];i[q]=p}return i}else{q=n.call(c);if(typeof c==="object"&&c!==null&&!(c instanceof Boolean)&&!(c instanceof Date)&&!(c instanceof Number)&&!(c instanceof RegExp)&&!(c instanceof String)&&q!=="[object Object]"&&q!=="[object Array]"){p=e(c);o={$_:q};b.shouldSnapshotIncludeOriginalReference&&(o.$$=c);for(h=p.entries(),g=Array.isArray(h),i=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(i>=h.length)break;e=h[i++]}else{i=h.next();if(i.done)break;e=i.value}q=e;p=q[0];e=q[1];o[p]=e}return o}else return c}}else return c})}function p(a,b){var c=new WeakMap();return function a(d,e){var f;d=b!==void 0?b(d):d;if(typeof d==="object"&&d!==null&&!(d instanceof Boolean)&&!(d instanceof Date)&&!(d instanceof Number)&&!(d instanceof RegExp)&&!(d instanceof String)){f=c.get(d);if(f!==void 0)return{$ref:f};c.set(d,e);if(Array.isArray(d)){f=[];var g=d;for(var h=0,i=g.length;h<i;++h)f[h]=a(g[h],e+"["+h+"]");g=f}else{h={};i=Object.keys(d);for(var f=0,j=i.length;f<j;++f){var k=i[f];k==="$$"?h[k]=d[k]:h[k]=a(d[k],e+"["+JSON.stringify(k)+"]")}g=h}return g}return d}(a,"$")}g.getLogstamps=b;g.normalizeFormatAndParams=h;g.combineFormatAndParams=e;g.VideoPlayerNextgendashLoggingDestinationNull=i;g.combineLoggingDestinations=f;g.formatStateMachineForLogging=j;g.snapshotObjectForLogging=o}),98);
__d("VideoPlayerNextgendashLoggingDestinationEngineWarning",["VideoPlayerNextgendashEngineErrors","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{displayName:"VideoPlayerNextgendashLoggingDestinationEngineWarning",log:function(b,c){switch(c.type){case"generic_error":a(d("VideoPlayerNextgendashEngineErrors").createVideoPlayerErrorFromNextgendashEngine(b,d("nextgendasherr").nextgendasherrFromCause(b,c.error,"VideoPlayerNextgendashLogError"),"nextgendash_warning_from_"+c.type,c.format,c.params));break;case"generic_error_as_warning":a(d("VideoPlayerNextgendashEngineErrors").createVideoPlayerErrorFromNextgendashEngine(b,d("nextgendasherr").nextgendasherrFromCause(b,c.error,"VideoPlayerNextgendashLogErrorAsWarning"),"nextgendash_warning_from_"+c.type,c.format,c.params));break;case"generic_warning":a(d("VideoPlayerNextgendashEngineErrors").createVideoPlayerErrorFromNextgendashEngine(b,d("nextgendasherr").nextgendasherr.apply(void 0,[b,"VideoPlayerNextgendashLogWarning",c.format].concat((b=c.params)!=null?b:[])),"nextgendash_warning_from_"+c.type));break}}}}g.createVideoPlayerNextgendashLoggingDestinationEngineWarning=a}),98);
__d("VideoPlayerNextgendashQPL",["QPLEvent","SiteData","emptyFunction","nextgendasherr","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return a==null?{}:{string:{error:d("nextgendasherr").reduceCardinalityOfNextgendashErrorName(a.name),errorMessageFormat:a.messageFormat},string_array:{errorMessageParams:a.messageParams}}}var j=["bool","bool_array","double","double_array","int","int_array","string","string_array"];function k(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.filter(Boolean);if(d.length===0)return void 0;var e={};for(var f=0;f<d.length;++f){var g=d[f];if(g!=null)for(var h=0;h<j.length;++h){var i=j[h];(e[i]!=null||g[i]!=null)&&(e[i]=Object.assign({},e[i],g[i]))}}return e}var l=0;function m(a,b){return(h||(h=d("QPLEvent"))).getMarkerId(a)+"."+((a=b)!=null?a:"")}function a(a){var b=c("qpl")._(424476673,"93"),e=(h||(h=d("QPLEvent"))).getMarkerId(b),f=a.loggingState.metadata.nextgendashInstanceIndex;f==null&&(++l,f=Number.MAX_SAFE_INTEGER-l,a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashQPLStartPlayingWithFallbackInstanceKey","START_PLAYING marker (%s) created with fallback instance key (%s).",e,f),type:"generic_error_as_warning"}));e=p(a,b,f);return e}var n=new Map(),o={endWithError:e=c("emptyFunction"),endWithSuccess:e,point:e,start:e,subspan:e.thatReturns(e)};function p(a,b,e){var f=m(b,e),g=n.get(f);if(g!=null)return g;var h=!1,j=!1,l=new Map(),p=new Set();function r(b){return(b=b)!=null?b:q(a)}function s(d){if(h||j)return;h=!0;a.logging.log(a,{qplCall:{event:b,instanceKey:e,method:"markerStart",timestamp:r(d)},type:"qpl_call"});a.config.isInWorkerType==null&&a.logging.log(a,{qplCall:{annotations:{"int":{clientRev:c("SiteData").client_revision,cometEnv:c("SiteData").comet_env,dev:void 0,nextgendashInstanceIndex:a.loggingState.metadata.nextgendashInstanceIndex},string:{playerInstanceKey:a.loggingState.metadata.playerInstanceKey,playerSubOrigin:a.loggingState.metadata.playerSubOrigin,videoFBID:a.loggingState.metadata.videoFBID}},event:b,instanceKey:e,method:"markerAnnotate"},type:"qpl_call"})}function t(b){a.config.isInWorkerType==null?s(b):j||(h=!0)}function u(){if(a.config.qplMarkersEnded.includes(f)){v();return!0}return!1}function v(){j=!0,l.clear(),p.clear(),n.set(f,o)}var w=/(_(?:(?:start)|(?:begin)|(?:finish)|(?:end)|(?:success)))$/;function x(a,b){a=a+":"+b;var c=b,d=l.get(a);if(d!=null){w.lastIndex=0;c=c.replace(w,"_"+d+"$1");c===b&&(c=b+"_"+d);var e=5;d>e&&(c=b+"_"+e+"_more");d+=1}else d=1;l.set(a,d);return c}function y(c,d,f){if(j||u())return;Array.from(p).reverse().forEach(function(a){a({bool:{markerEnd:!0}})});d!=null&&a.logging.log(a,{qplCall:{annotations:d,event:b,instanceKey:e,method:"markerAnnotate"},type:"qpl_call"});a.logging.log(a,{qplCall:{action:(d=c)!=null?d:467,event:b,instanceKey:e,method:"markerEnd",timestamp:r(f)},type:"qpl_call"});v()}function z(a,b){y(2,a,b)}function A(a,b,c){y(3,k(i(a),b),c)}function B(c,d,f){a.logging.log(a,{qplCall:{annotations:d,event:b,instanceKey:e,method:"markerPoint",point:c,timestamp:r(f)},type:"qpl_call"})}function C(b,c,e){var f;if(j||u())return;w.lastIndex=0;f=(f=w.exec(b))!=null?f:[];f=f[1];if(f!=null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashQPLUseSubspanAPI",'QPL point "'+b+'" suffix "'+f+'" reserved for subspans.');f=r(e);t(f);B(x("point",b),c,f)}function D(a,b,d){if(j||u())return c("emptyFunction");d=r(d);t(d);var e=x("subspan",a+"_start");B(e,b,d);var f=!1;a=function a(c,d){p["delete"](a);if(!h||j||f||u())return;B(e.replace(/_start$/,"_end"),k(b,c),r(d));f=!0};p.add(a);return a}g={endWithError:A,endWithSuccess:z,point:C,start:s,subspan:D};n.set(f,g);return g}function b(a,b){return a.host.clockPerfOriginMs+b.perfMs}function q(a){return a.host.clockPerfOriginMs+a.host.clock().perfMs}g.qplAnnotationsForError=i;g.qplAnnotationsMerge=k;g.qplCacheKey=m;g.qplStartPlayingApi=a;g.qplEventApi=p;g.qplTimestampFromClockstamp=b;g.qplTimestampFromNow=q}),98);
__d("VideoPlayerNextgendashQPLFromMain",["QuickPerformanceLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(b.method!=="markerStart"&&!(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(b.event,(a=b.instanceKey)!=null?a:0))return;switch(b.method){case"markerStart":(h||(h=c("QuickPerformanceLogger"))).markerStart(b.event,b.instanceKey,b.timestamp,{cancelExisting:!0,cancelOnUnload:!0});return;case"markerAnnotate":(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(b.event,b.annotations,{instanceKey:b.instanceKey});return;case"markerPoint":(h||(h=c("QuickPerformanceLogger"))).markerPoint(b.event,b.point,{data:b.annotations,instanceKey:b.instanceKey,timestamp:b.timestamp});return;case"markerEnd":(h||(h=c("QuickPerformanceLogger"))).markerEnd(b.event,b.action,b.instanceKey,b.timestamp);return;default:b.method;return}}g.qplCallFromMain=a}),98);
__d("VideoPlayerNextgendashLoggingDestinationQPLFromEngine",["VideoPlayerNextgendashQPL","VideoPlayerNextgendashQPLFromMain","removeFromArray"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e=null,f=null,g=void 0,h=void 0;return{displayName:"VideoPlayerNextgendashLoggingDestinationQPLFromEngine",log:function(i,j){var k=a.current,l=b.current;if(k!=null&&l!=null&&(j.type==="state_machine_fatal_exception"||j.type==="state_machine_receive_event_success"||j.type==="state_machine_receive_event_exception")&&j.sm===k){var m=k.state,n=m.workerType;n!==g&&(e!=null&&(e(),e=null),n!=null&&(e=l.subspan("selected_worker_"+n)),g=n);n=m.state==="linked_to_worker"?m.workerType:void 0;n!==h&&(f!=null&&(f(),f=null),n!=null&&(f=l.subspan("linked_worker_"+n)),h=n)}if(j.type==="qpl_call"){d("VideoPlayerNextgendashQPLFromMain").qplCallFromMain(i,j.qplCall);m=!1;if(j.qplCall.method==="markerStart"){l=d("VideoPlayerNextgendashQPL").qplCacheKey(j.qplCall.event,j.qplCall.instanceKey);i.config.qplMarkersEnded.includes(l)&&(c("removeFromArray")(i.config.qplMarkersEnded,l),m=!0)}else if(j.qplCall.method==="markerEnd"){n=d("VideoPlayerNextgendashQPL").qplCacheKey(j.qplCall.event,j.qplCall.instanceKey);i.config.qplMarkersEnded.includes(n)||(i.config.qplMarkersEnded.push(n),m=!0)}m&&k!=null&&k.sendEvent({type:"update_config_from_env"})}}}}g.createVideoPlayerNextgendashLoggingDestinationQPLFromEngine=a}),98);
__d("VideoPlayerNextgendashRetryLogic",["VideoPlayerNextgendashStateMachine","clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(a){a=a.args;var b=a.retryConfig;a=a.retryReason;return babelHelpers["extends"]({},b,{retryReason:a,state:"waiting_schedule_retry"})},function(a){var b=a.args,d=b.onAttempt,e=b.onExhausted,f=b.retryConfig;b=b.retryReason;var g=a.event,h=a.eventClock,i=a.sendToSelf,j=a.state;a=a.unexpectedEvent;switch(j.state){case"waiting_schedule_retry":switch(g.type){case"schedule_retry":switch(j.retryBehavior){case"linear":var k=j.retryState;k=(k=k)!=null?k:{retryCountRemaining:j.retryCount,retryIndex:-1,retryLastAttemptedClock:void 0,retryLastScheduledClock:void 0,retryTimerID:void 0};c("clearTimeout")(k.retryTimerID);if(k.retryCountRemaining>0){var l=c("setTimeout")(function(){i({type:"_attempt"})},j.retryDelayMs);l=babelHelpers["extends"]({},k,{retryCountRemaining:k.retryCountRemaining-1,retryIndex:k.retryIndex+1,retryLastScheduledClock:h,retryTimerID:l});return babelHelpers["extends"]({},j,{retryState:l,state:"waiting_attempt"})}else return babelHelpers["extends"]({},j,{retryState:babelHelpers["extends"]({},k,{retryTimerID:void 0}),state:"exhausted"});default:j.retryBehavior;return}case"_attempt":throw a("throw","Unexpected retry attempt");default:g.type;return}case"waiting_attempt":switch(g.type){case"schedule_retry":throw a();case"_attempt":switch(j.retryBehavior){case"linear":l=j.retryState;if(l!=null&&l.retryTimerID!=null){c("clearTimeout")(l.retryTimerID);k=babelHelpers["extends"]({},l,{retryLastAttemptedClock:h,retryTimerID:void 0});d({retryConfig:f,retryReason:b,retryState:k});if(l.retryCountRemaining>0)return babelHelpers["extends"]({},j,{retryState:k,state:"waiting_schedule_retry"});else return babelHelpers["extends"]({},j,{retryState:k,state:"exhausted"})}else throw a("throw","Missing retryTimerID");default:j.retryBehavior;return}default:g.type;return}case"exhausted":switch(g.type){case"__enter":i({reason:"exhausted",type:"__dispose"});return;case"__exception":return;case"__dispose":return;default:throw a()}case"__disposed__":switch(g.type){case"__enter":h=g.prevState;switch(h.retryBehavior){case"linear":c("clearTimeout")((d=h.retryState)==null?void 0:d.retryTimerID);break;default:h.retryBehavior;break}e()}return;default:j.state}});g.VideoPlayerNextgendashRetryLogicSM=a}),98);
__d("VideoPlayerNextgendashFetchedResource",["Promise","VideoPlayerNextgendashNetworkDiagnosticsUtils","VideoPlayerNextgendashQPL","VideoPlayerNextgendashRetryLogic","VideoPlayerNextgendashStateMachine","VideoPlayerNextgendashWorkerPrefetchCache","clearInterval","nextgendasherr","setInterval"],(function(a,b,c,d,e,f,g){"use strict";var h,i={fetchRejection:{retryBehavior:"linear",retryCount:20,retryDelayMs:2e3},httpNotOk:{retryBehavior:"linear",retryCount:20,retryDelayMs:2e3},offline:{retryBehavior:"linear",retryCount:Number.POSITIVE_INFINITY,retryDelayMs:5e3},responseDataFailed:{retryBehavior:"linear",retryCount:20,retryDelayMs:2e3}};a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(a){var b=a.args.request;a=a.env;b.responseMode==="text"&&b.reportToBandwidthEstimator===!0&&a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashFetchedResourceReportToBandwidthEstimatorUnsupportedForTextResponses"),type:"generic_error_as_warning"});return{request:b,retryLogic:null,state:"waiting_start"}},function(a){var b=a.env,c=a.event,e=a.eventClock,f=a.makeChildSm,g=a.sendToOther,h=a.sendToSelf,l=a.state;a=a.unexpectedEvent;function m(a,c,e){var g=l.retryLogic;e=c+(e?"-"+e:"");if(g!=null&&(e===g.state.retryReason||g.state.state==="__disposed__"))return g;g=i[c];c=g!=null?f("retryLogic-"+e,d("VideoPlayerNextgendashRetryLogic").VideoPlayerNextgendashRetryLogicSM,{onAttempt:function(c){h({request:babelHelpers["extends"]({},a,{attemptInfo:c,requestCreatedClock:b.host.clock()}),type:"_start_from_retry"})},onExhausted:function(){},onTransitioned:function(a,b,c){h({type:"_retry_logic_transitioned"},c)},retryConfig:g,retryReason:e}):null;return c}function n(c){var e,f=c.abortController;f!=null&&f.abort();f=(f=(f=l.error)!=null?f:l.abortReason)!=null?f:l.exception;e=(e=c.requestAbortedClock)!=null?e:c.requestCompletedClock;var a=c.state==="waiting_headers"?c.qplSubspanForHeadersEnd:void 0;a!=null&&a(d("VideoPlayerNextgendashQPL").qplAnnotationsForError(f),e!=null?d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(b,e):void 0);a=c.state==="waiting_headers"||c.state==="waiting_data"?c.qplSubspanForRequestEnd:void 0;a!=null&&a(d("VideoPlayerNextgendashQPL").qplAnnotationsForError(f),e!=null?d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(b,e):void 0)}function o(){switch(c.type){case"__enter":n(c.prevState);return;default:return}}switch(l.state){case"waiting_start":switch(c.type){case"__enter":return;case"__exception":return;case"__dispose":return;case"_retry_logic_transitioned":return;case"start":return j(b,l,h);case"abort_and_clear":return;default:c.type;throw a()}case"waiting_retry_or_failed":var p=function(){var c=l.retryLogic,a=babelHelpers.objectWithoutPropertiesLoose(l,["retryLogic"]),e=a.request.attemptInfo;if(c!=null)if(c.state.state==="waiting_schedule_retry"){g(c,{type:"schedule_retry"});return babelHelpers["extends"]({},l,{requestCompletedClock:null,requestStartedClock:null,responseData:null,responseHeader:null,state:"waiting_start_from_retry"})}else if(c.state.state==="__disposed__")return babelHelpers["extends"]({},a,{error:e!=null?d("nextgendasherr").nextgendasherrFromCause(b,a.error,"VideoPlayerNextgendashFetchedResourceLastAttempt","Last attempt: %s",JSON.stringify(e,function(a,b){return typeof b==="number"&&!Number.isFinite(b)?String(b):b})):a.error,state:"failed"});else return;else return babelHelpers["extends"]({},a,{error:e!=null?d("nextgendasherr").nextgendasherrFromCause(b,a.error,"VideoPlayerNextgendashFetchedResourceLastAttempt","Last attempt: %s",JSON.stringify(e)):a.error,state:"failed"})};switch(c.type){case"__enter":n(c.prevState);return p();case"__exception":return;case"__dispose":return;case"_retry_logic_transitioned":return p();case"abort_and_clear":return{abortReason:c.abortReason,prefetchResultState:l.prefetchResultState,request:l.request,requestAbortedClock:e,requestCompletedClock:l.requestCompletedClock,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:null,state:"aborted"};default:c.type;throw a()}case"waiting_start_from_retry":switch(c.type){case"__enter":return;case"__exception":return;case"__dispose":return;case"_retry_logic_transitioned":return;case"abort_and_clear":return{abortReason:c.abortReason,prefetchResultState:l.prefetchResultState,request:l.request,requestAbortedClock:e,requestCompletedClock:l.requestCompletedClock,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:null,state:"aborted"};case"_start_from_retry":if(c.request.requestID!==l.request.requestID)throw a("throw","Request mismatch: %s !== %s",c.request.requestID,l.request.requestID);p=l.retryLogic;var q=babelHelpers.objectWithoutPropertiesLoose(l,["retryLogic"]);if(p==null||p.state.state==="__disposed__")return babelHelpers["extends"]({},q,{state:"failed"});else if(p.state.retryReason==="offline"&&!b.host.networkIsOnline()){g(p,{type:"schedule_retry"});return babelHelpers["extends"]({},l,{state:"waiting_start_from_retry"})}else{h({type:"start"});return{request:c.request,retryLogic:l.retryLogic,state:"waiting_start"}}default:c.type;throw a()}case"waiting_headers":switch(c.type){case"__enter":return;case"__exception":return{error:c.exception,prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:null,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:null,state:"failed"};case"__dispose":return;case"_retry_logic_transitioned":return;case"start":throw a("throw","Please 'abort_and_clear' first.");case"abort_and_clear":return{abortReason:c.abortReason,prefetchResultState:l.prefetchResultState,request:l.request,requestAbortedClock:e,requestCompletedClock:null,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:null,state:"aborted"};case"_aborted":return{abortReason:c.abortReason,prefetchResultState:l.prefetchResultState,request:l.request,requestAbortedClock:c.requestAbortedClock,requestCompletedClock:null,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:null,state:"aborted"};case"_fetch_rejection":return{error:c.error,prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:null,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:null,retryLogic:m(l.request,c.isOnline?"fetchRejection":"offline",c.isOnline?c.error.name:""),state:"waiting_retry_or_failed"};case"_headers":q=l.request;if(q===c.request){p=c.fetchResponse;var r={httpHeaders:p.headers,httpHeadersReceivedClock:c.httpHeadersReceivedClock,httpStatus:p.status,httpStatusOk:p.ok,httpStatusText:p.statusText},s=l.qplSubspanForHeadersEnd,t={bool:{fetchResponseOK:p.ok},string:{fetchResponseStatus:String(p.status),fetchResponseStatusText:p.ok?void 0:String(p.statusText)}};if(r.httpStatusOk){q=k(b,e,q,p,h);s(t,d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(b,c.httpHeadersReceivedClock));return{abortController:l.abortController,prefetchResultState:l.prefetchResultState,qplSubspanForRequestEnd:l.qplSubspanForRequestEnd,request:l.request,requestStartedClock:l.requestStartedClock,responseData:q,responseHeader:r,retryLogic:l.retryLogic,state:"waiting_data"}}else{p=d("nextgendasherr").nextgendasherr(b,"VideoPlayerNextgendashFetchHTTP"+r.httpStatus,"Request "+l.request.qplName+" (%s) HTTP "+r.httpStatus+" "+r.httpStatusText+".",l.request.requestID);s(d("VideoPlayerNextgendashQPL").qplAnnotationsMerge(t,d("VideoPlayerNextgendashQPL").qplAnnotationsForError(p)),d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(b,c.httpHeadersReceivedClock));return{error:p,prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:null,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:r,retryLogic:m(l.request,"httpNotOk",String(r.httpStatus)),state:"waiting_retry_or_failed"}}}else{b.logging.log(b,{error:d("nextgendasherr").nextgendasherr(b,"VideoPlayerNextgendashFetchedResourceIrrelevantCompletion","Request "+c.request.qplName+" (%s) irrelevant "+c.type+" %sms after created, now running "+l.request.qplName+" (%s).",c.request.requestID,String(e.perfMs-c.request.requestCreatedClock.perfMs),l.request.requestID),type:"generic_error_as_warning"});return}default:c.type;throw a()}case"waiting_data":switch(c.type){case"__enter":return;case"__exception":q=c.exception.name.startsWith("VideoPlayerNextgendashFetchResponseStreamReaderOffline");return{error:c.exception,prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:e,requestStartedClock:l.requestStartedClock,responseData:l.responseData,responseHeader:l.responseHeader,retryLogic:m(l.request,q?"offline":"responseDataFailed",q?"":c.exception.name),state:"waiting_retry_or_failed"};case"__dispose":return;case"_done_text":s=l.responseData.state;if(s.state!=="reading_text")throw a();return{prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:e,requestStartedClock:l.requestStartedClock,responseData:{state:babelHelpers["extends"]({},s,{state:"done_text",text:c.text})},responseHeader:l.responseHeader,state:"completed"};case"_done_buffer":t=l.responseData.state;if(t.state!=="reading_buffer")throw a();p=null;l.request.reportToBandwidthEstimator===!0&&(p=d("VideoPlayerNextgendashNetworkDiagnosticsUtils").computeNetworkDiagnosticsSampleOnDone(b,l.request.requestInfo,{bytes:0,clock:t.startedReadingClock},e,c.buffer.byteLength),p&&b.host.networkDiagnosticsUpdate(p));return{prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:e,requestStartedClock:l.requestStartedClock,responseData:{state:babelHelpers["extends"]({},t,{buffer:c.buffer,networkDiagnosticsSample:p,state:"done_buffer"})},responseHeader:l.responseHeader,state:"completed"};case"_done_chunks":return l;case"_done_stream":r=l.responseData.state;if(r.state!=="reading_stream"&&r.state!=="done_stream")throw a("throw",'responseData state is "'+r.state+'", not "reading_stream" or "done_stream".');return{prefetchResultState:l.prefetchResultState,request:l.request,requestCompletedClock:e,requestStartedClock:l.requestStartedClock,responseData:l.responseData,responseHeader:l.responseHeader,state:"completed"};case"_retry_logic_transitioned":return;case"abort_and_clear":return{abortReason:c.abortReason,prefetchResultState:l.prefetchResultState,request:l.request,requestAbortedClock:e,requestCompletedClock:null,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:l.responseHeader,state:"aborted"};default:c.type;throw a()}case"completed":switch(c.type){case"abort_and_clear":return{abortReason:c.abortReason,prefetchResultState:l.prefetchResultState,request:l.request,requestAbortedClock:e,requestCompletedClock:l.requestCompletedClock,requestStartedClock:l.requestStartedClock,responseData:null,responseHeader:l.responseHeader,state:"aborted"};default:return o()}case"failed":return o();case"aborted":return o();case"__disposed__":return o();default:l.state;return}});function j(a,c,e){var f=a.host.clock(),g=d("VideoPlayerNextgendashQPL").qplStartPlayingApi(a),i=c.request,j=a.loggingState.metadata.prefetchKey!=null?d("VideoPlayerNextgendashWorkerPrefetchCache").getCachedValueForPrefetchKeyAndURL(a.loggingState.metadata.prefetchKey,i.requestInfo):null,k="fetch_"+i.qplName.replace(/:/g,"_")+(i.attemptInfo!=null?"_retry":""),m=g.subspan(k,{string:{fetchRequestID:i.requestID,fetchRetry:i.attemptInfo!=null?JSON.stringify(babelHelpers["extends"]({},i.attemptInfo.retryConfig,{retryReason:i.attemptInfo.retryReason},i.attemptInfo.retryState),function(a,b){return b===Number.POSITIVE_INFINITY?"Infinity":b}):void 0,prefetch:j!=null?j.resultState.resultState:"miss"}},d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(a,f)),n=g.subspan(k+"_headers",{string:{fetchRequestID:i.requestID}},d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(a,f)),o=j?j.abortController:new AbortController();function p(a){switch(a.resultState){case"has_response":return(h||(h=b("Promise"))).resolve(a.response);case"errored":return(h||(h=b("Promise"))).reject(a.error)}}var q=j?j.resultState:null,r=q?"[prefetch:"+q.resultState+"]":"";void (h||(h=b("Promise"))).resolve().then(function(){return(q?q.resultState==="pending"?q.resultPromise.then(p):p(q):a.host.fetch(a,i.requestInfo,{signal:o.signal})).then(function(b){var c=a.host.clock();e({fetchResponse:b,httpHeadersReceivedClock:c,request:i,type:"_headers"})},function(b){var c=typeof b==="object"&&b!=null&&typeof b.name==="string"&&(b.name==="AbortError"||b.name.endsWith("/AbortError"));if(c){c=a.host.clock();var f=d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashFetchedResourceAborted","Request "+i.qplName+" (%s) is aborted.",i.requestID);n(d("VideoPlayerNextgendashQPL").qplAnnotationsForError(f),d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(a,c));e({abortReason:f,request:i,requestAbortedClock:c,type:"_aborted"})}else{f=a.host.clock();c=a.host.networkIsOnline();var g=c?"VideoPlayerNextgendashFetchedResourceFetchFailure"+r:"VideoPlayerNextgendashFetchedResourceOffline"+r,h=c?"Request "+i.qplName+" (%s) failed to start. %s":"Request "+i.qplName+" (%s) failed to start while offline. %s";b=d("nextgendasherr").nextgendasherrFromFetchRejection(a,b,g,h,i.requestID,l(a,i));n(d("VideoPlayerNextgendashQPL").qplAnnotationsForError(b),d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(a,f));e({error:b,isOnline:c,request:i,requestFetchFailedClock:f,type:"_fetch_rejection"})}})})["catch"](function(b){var c=a.host.clock();b=d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashFetchedResourceFetchException"+r,"Request "+i.qplName+" (%s) failed to start. %s",i.requestID,l(a,i));n(d("VideoPlayerNextgendashQPL").qplAnnotationsForError(b),d("VideoPlayerNextgendashQPL").qplTimestampFromClockstamp(a,c));e({exception:b,type:"__exception"})});return{abortController:o,prefetchResultState:q==null?void 0:q.resultState,qplSubspanForHeadersEnd:n,qplSubspanForRequestEnd:m,request:i,requestStartedClock:f,retryLogic:c.retryLogic,state:"waiting_headers"}}function k(a,b,e,f,g){switch(e.responseMode){case"text":f.text().then(function(a){g({text:a,type:"_done_text"})},function(b){var c=a.host.networkIsOnline(),f=c?"VideoPlayerNextgendashFetchResponseTextRejection":"VideoPlayerNextgendashFetchResponseTextOffline";c=c?"Request "+e.qplName+" (%s) failed to read text.":"Request "+e.qplName+" (%s) failed to read text while offline.";g({exception:d("nextgendasherr").nextgendasherrFromFetchRejection(a,b,f,c,e.requestID),type:"__exception"})})["catch"](function(b){g({exception:d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashFetchResponseTextException","Request "+e.qplName+" (%s) failed to read text.",e.requestID),type:"__exception"})});return{state:{startedReadingClock:b,state:"reading_text"}};case"buffer":f.arrayBuffer().then(function(a){g({buffer:new Uint8Array(a),type:"_done_buffer"})},function(b){var c=a.host.networkIsOnline(),f=c?"VideoPlayerNextgendashFetchResponseBufferRejection":"VideoPlayerNextgendashFetchResponseBufferOffline";c=c?"Request "+e.qplName+" (%s) failed to read buffer.":"Request "+e.qplName+" (%s) failed to read buffer while offline.";g({exception:d("nextgendasherr").nextgendasherrFromFetchRejection(a,b,f,c,e.requestID),type:"__exception"})})["catch"](function(b){g({exception:d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashFetchResponseBufferException","Request "+e.qplName+" (%s) failed to read buffer.",e.requestID),type:"__exception"})});return{state:{startedReadingClock:b,state:"reading_buffer"}};case"stream":var h=function(b){var f=b.dataBytesLengthTotal;if(f<b.dataBytesLengthFlushed)return;var h=a.host.clock(),i=null,j=b.bandwidthSamplingState;if(e.reportToBandwidthEstimator===!0){if(b.streamReaderDone){var k=d("VideoPlayerNextgendashNetworkDiagnosticsUtils").computeNetworkDiagnosticsSampleOnChunk(b.bandwidthSamplingState,h,f);i=k.networkDiagnosticsSample;j=k.nextBandwidthSamplingState}i&&a.host.networkDiagnosticsUpdate(i);i=d("VideoPlayerNextgendashNetworkDiagnosticsUtils").computeNetworkDiagnosticsSampleOnDone(a,e.requestInfo,j,h,f);i&&a.host.networkDiagnosticsUpdate(i)}if(b.streamReaderDone){b.dataBytesLengthFlushed;b.streamReader;b.streamReaderDone;k=b.streamReaderFlushIntervalID;h=babelHelpers.objectWithoutPropertiesLoose(b,["dataBytesLengthFlushed","streamReader","streamReaderDone","streamReaderFlushIntervalID"]);c("clearInterval")(k);p.state=babelHelpers["extends"]({},h,{networkDiagnosticsSample:i,state:"done_stream"});g({type:"_done_stream"})}else b.bandwidthSamplingState=j,b.networkDiagnosticsSample=i,b.dataBytesLengthFlushed=f,g({type:"_done_chunks"})},i=function(){var a=p.state;if(a.state!=="reading_stream")return;h(a)},j=function(a){var b=p.state;if(b.state!=="reading_stream")return;if(a.done)b.streamReaderDone=!0,h(b);else{a=a.value;a.byteLength>0&&(b.chunks.push(a),b.dataBytesLengthTotal+=a.byteLength);m()}},k=function(b){var c=p.state;if(c.state!=="reading_stream")return;c.streamReaderDone=!0;h(c);var f=a.host.networkIsOnline(),i=f?"VideoPlayerNextgendashFetchResponseStreamReaderRejection":"VideoPlayerNextgendashFetchResponseStreamReaderOffline";f=f?"Request "+e.qplName+" (%s) failed to read chunk#%s.":"Request "+e.qplName+" (%s) failed to read chunk#%s while offline.";g({exception:d("nextgendasherr").nextgendasherrFromFetchRejection(a,b,i,f,e.requestID,c.chunks.length),type:"__exception"})},l=function(b){var c=p.state;if(c.state!=="reading_stream")return;c.streamReaderDone=!0;h(c);g({exception:d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashFetchResponseStreamReaderException","Request "+e.qplName+" (%s) failed to read chunk#%s.",e.requestID,c.chunks.length),type:"__exception"})},m=function(){var a=p.state;if(a.state!=="reading_stream")return;a.streamReader.read().then(j,k)["catch"](l)};f=f.body;if(f==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashFetchResponseStreamMissingBody");var n=500,o=a.host.clock(),p={state:{bandwidthSamplingState:{bytes:0,clock:o},chunks:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject([]),dataBytesLengthFlushed:0,dataBytesLengthTotal:0,networkDiagnosticsSample:null,startedReadingClock:o,state:"reading_stream",streamReader:f.getReader(),streamReaderDone:!1,streamReaderFlushIntervalID:c("setInterval")(i,n)}};m();return p;default:e.responseMode;throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashFetchedResourceUnexpectedResponseMode","Request "+e.qplName+" (%s) unexpected responseMode="+e.responseMode+".",e.requestID,String(b.perfMs-e.requestCreatedClock.perfMs))}}function l(a,b){try{a=a.host.getPerformanceResourceTimingByName(b.requestInfo);b=JSON.stringify(a.map(function(a){a=a.toJSON();a.name;a=babelHelpers.objectWithoutPropertiesLoose(a,["name"]);return a}))}catch(a){b="exception:"+String(a)}return"timings="+b}g.fetchedResourceDefaultRetryConfig=i;g.VideoPlayerNextgendashFetchedResourceSM=a}),98);
/**
 * License: https://www.facebook.com/legal/license/Vkd8AdLnKqZ/
 */
__d("VideoPlayerNextgendashMp4SidxParser",["DataViewReader","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h=1936286840;function a(a,b,e){b=new(c("DataViewReader"))(new DataView(b.buffer,b.byteOffset,b.byteLength));var f=b.readUint32(),g=b.readUint32();if(g!==h)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashMp4SidxParserInvalidBoxType",'Invalid box type, expected "sidx".');f===1&&(f=b.readUint64());g=b.readUint8();b.skip(3);b.skip(4);var i=b.readUint32();if(!i)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashMp4SidxParserInvalidTimescale","Invalid timescale.");var j;g===0?(g=b.readUint32(),j=b.readUint32()):(g=b.readUint64(),j=b.readUint64());b.skip(2);var k=b.readUint16();g=g;e=e+f+j;f=0;j=[];for(var l=0;l<k;l++){var m=b.readUint32(),n=(m&2147483648)>>>31;m=m&2147483647;var o=b.readUint32();b.readUint32();if(n===1)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashMp4SidxParserUnsupportedHierarchical","Hierarchical SIDXs are not supported.");n=g/i;var p=(g+o)/i;l===0&&(f=n);j.push({mediaFileByteRange:{byteLength:m,byteOffset:e},mediaTimeRange:[n-f,p-f]});g+=o;e+=m}return j}g.parseMp4Sidx=a}),98);
/**
 * License: https://www.facebook.com/legal/license/Vkd8AdLnKqZ/
 */
__d("VideoPlayerNextgendashWebmSidxParser",["DataViewReader","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h=440786851,i=408125543,j=357149030,k=2807729,l=17545,m=475249515,n=187,o=179,p=183,q=241,r=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])];function s(a,b){if(!a&&!b)return!0;if(!a||!b)return!1;if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0}var t=function(){function a(a,b,c){this.$1=a,this.id=b,this.$2=c}var b=a.prototype;b.getOffset=function(){return this.$2.byteOffset};b.createParser=function(){return new u(this.$1,this.$2)};b.getUint=function(){if(this.$2.byteLength>8)throw d("nextgendasherr").nextgendasherr(this.$1,"VideoPlayerNextgendashWebmSidxParserError","EbmlElement: Unsigned integer has too many bytes.");if(this.$2.byteLength==8&&this.$2.getUint8(0)&224)throw d("nextgendasherr").nextgendasherr(this.$1,"VideoPlayerNextgendashWebmSidxParserError","EbmlParser: Unsigned integer must be at most 53 bits.");var a=0;for(var b=0;b<this.$2.byteLength;b++){var c=this.$2.getUint8(b);a=256*a+c}return a};b.getFloat=function(){if(this.$2.byteLength==4)return this.$2.getFloat32(0);else if(this.$2.byteLength==8)return this.$2.getFloat64(0);else throw d("nextgendasherr").nextgendasherr(this.$1,"VideoPlayerNextgendashWebmSidxParserError","EbmlElement: floating point numbers must be 4 or 8 bytes.")};return a}(),u=function(){function a(a,b){this.$1=a,this.$2=b,this.$3=new(c("DataViewReader"))(this.$2)}var b=a.prototype;b.hasMoreData=function(){return this.$3.hasMoreData()};b.parseElement=function(){var b=this.$4(),c=this.$5(),d;a.$6(c)?d=this.$2.byteLength-this.$3.getCursor():d=a.$7(this.$1,c);c=this.$3.getCursor()+d<=this.$2.byteLength?d:this.$2.byteLength-this.$3.getCursor();d=new DataView(this.$2.buffer,this.$2.byteOffset+this.$3.getCursor(),c);this.$3.skip(c);return new t(this.$1,b,d)};b.$4=function(){var a=this.$5();if(a.length>7)throw d("nextgendasherr").nextgendasherr(this.$1,"VideoPlayerNextgendashWebmSidxParserError","EbmlParser: EBML ID must be at most 7 bytes.");var b=0;for(var c=0;c<a.length;c++)b=256*b+a[c];return b};b.$5=function(){var a=this.$3.readUint8(),b;for(b=1;b<=8;b++){var c=1<<8-b;if(a&c)break}if(b>8)throw d("nextgendasherr").nextgendasherr(this.$1,"VideoPlayerNextgendashWebmSidxParserError","EbmlParser: Variable sized integer must fit within 8 bytes.");c=new Uint8Array(b);c[0]=a;for(a=1;a<b;a++)c[a]=this.$3.readUint8();return c};a.$7=function(a,b){if(b.length==8&&b[1]&224)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","EbmlParser: Variable sized integer value must be at most 53 bits.");a=1<<8-b.length;a=b[0]&a-1;for(var c=1;c<b.length;c++)a=256*a+b[c];return a};a.$6=function(a){for(var b=0;b<r.length;b++)if(s(a,r[b]))return!0;return!1};return a}();function v(a,b){b=b.createParser();var c=1e6,e=null;while(b.hasMoreData()){var f=b.parseElement();f.id==k?c=f.getUint():f.id==l&&(e=f.getFloat())}if(e==null){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","Duration does not exist"),type:"generic_error_as_warning"});return null}f=c/1e9;b=e*f;return{duration:b,timecodeScale:f}}function w(a,b,c,e,f){var g=[];b=b.createParser();var h=-1,i=-1;while(b.hasMoreData()){var j=b.parseElement();if(j.id!=n)continue;j=x(a,j);if(!j)continue;var k=e*j.unscaledTime;j=c+j.relativeOffset;if(h>=0){if(!(i>=0))throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","Offset must be non-negative given a valid timestamp.");g.push({mediaFileByteRange:{byteLength:j-i,byteOffset:i},mediaTimeRange:[h,k]})}h=k;i=j}if(h>=0){if(!(i>=0))throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","Offset must be non-negative given a valid timestamp.");k=f;g.push({mediaFileByteRange:{byteLength:null,byteOffset:i},mediaTimeRange:[h,k]})}return g}function x(a,b){b=b.createParser();var c=b.parseElement();if(c.id!=o){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","CueTime element does not exist."),type:"generic_error_as_warning"});return null}c=c.getUint();b=b.parseElement();if(b.id!=p){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","CueTrackPositions element does not exist."),type:"generic_error_as_warning"});return null}a=b.createParser();b=0;while(a.hasMoreData()){var e=a.parseElement();if(e.id!=q)continue;b=e.getUint();break}return{relativeOffset:b,unscaledTime:c}}function y(a,b){b=b.createParser();var c=null;while(b.hasMoreData()){var e=b.parseElement();if(e.id!=j)continue;c=e;break}if(!c){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","Info element does not exist."),type:"generic_error_as_warning"});return null}return v(a,c)}function z(a,b){b=new u(a,b);var c=b.parseElement();if(c.id!=h){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","EBML element does not exist."),type:"generic_error_as_warning"});return null}c=b.parseElement();if(c.id!=i){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","Segment element does not exist."),type:"generic_error_as_warning"});return null}b=c.getOffset();a=y(a,c);return!a?null:{duration:a.duration,segmentOffset:b,timecodeScale:a.timecodeScale}}function a(a,b,c){c=new DataView(c.buffer,c.byteOffset,c.byteLength);b=new DataView(b.buffer,b.byteOffset,b.byteLength);c=z(a,c);if(!c)return[];b=new u(a,b);b=b.parseElement();if(b.id!=m){a.logging.log(a,{error:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashWebmSidxParserError","CuesElement does not exist."),type:"generic_error_as_warning"});return[]}return w(a,b,c.segmentOffset,c.timecodeScale,c.duration)}g.parseWebmSidx=a}),98);
__d("VideoPlayerNextgendashPlaybackLoop",["Promise","VideoPlayerNextgendashABR","VideoPlayerNextgendashFetchedResource","VideoPlayerNextgendashHostAPI","VideoPlayerNextgendashManifestParser","VideoPlayerNextgendashMediaUtils","VideoPlayerNextgendashMp4SidxParser","VideoPlayerNextgendashStateMachine","VideoPlayerNextgendashWebmSidxParser","clearTimeout","deepEquals","emptyFunction","nextgendasherr","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Uint8Array(0),j=.2,k={audioLang:null,audioRole:null,videoLang:null,videoRole:null};a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(a){var b=a.args,c=b.playerStateFromMain;b=b.sendMediaSourceToMain;var e=a.env,f=a.eventClock,g=a.sendToSelf;f={debugPlaybackLoopRecentChanges:[],fetchDemands:[],loopState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({loopIteration:0,loopReasons:["initial"],loopScheduledToUnixMs:f.unixMs,loopTimerDelayMs:null,loopTimerID:null}),mediaSourceState:A(e,g,b,null),playerStateFromMain:c,recoveringFromMediaError:null,recoveringFromMediaErrorAttempt:0,state:"playing",streams:[]};return(g=D(e,f,f.loopState.loopIteration,a))!=null?g:f},function(a){var b=a.args,e=b.sendMediaSourceToMain,f=b.sendPlayerWarningToMain,g=a.env,h=a.event,i=a.eventClock,j=a.sendToSelf,k=a.state;function l(a){function b(a,b){a.state==="playing"&&a.streams.forEach(function(a){a.sourceBufferState!=null&&b(a.sourceBufferState.sourceBufferCleanup)})}k.state!=="playing"&&a.loopState.loopTimerID!=null&&c("clearTimeout")(a.loopState.loopTimerID);var d=new Set();b(a,function(a){d.add(a)});k.state!=="__disposed__"&&b(k,function(a){d["delete"](a)});d.forEach(function(a){return a()})}var m=3;function n(a,b){var c=a.recoveringFromMediaError,h=a.recoveringFromMediaErrorAttempt;if(c!=null||h>=m){var i=[];c!=null&&i.push("already attempting a recovery");h>=m&&i.push("already reached max attempts");throw d("nextgendasherr").nextgendasherrFromCause(g,b,"VideoPlayerNextgendashInvalidStartErrorRecoveryAttempt","Invalid attempt to start error recovery: "+i.join(" and "))}c=a;h=c;i=h.mediaSourceState;i.mediaSourceCleanup();a=A(g,j,e,i.mediaSourceIndex);f(d("nextgendasherr").nextgendasherrFromCause(g,b,"VideoPlayerNextgendashPlaybackLoopRecoveringFromError","Replacing MediaSource #%s with #%s",i.mediaSourceIndex,a.mediaSourceIndex));c=babelHelpers["extends"]({},c,{debugPlaybackLoopRecentChanges:C(c.debugPlaybackLoopRecentChanges,["recoveringFromError:"+b.name,"mediaSourceState:replace:"+i.mediaSourceIndex+"-->"+a.mediaSourceIndex]),mediaSourceState:a,recoveringFromMediaError:b,recoveringFromMediaErrorAttempt:c.recoveringFromMediaErrorAttempt+1,streams:c.streams.map(function(a){if(a.sourceBufferState!=null){a.sourceBufferState.sourceBufferCleanup();return babelHelpers["extends"]({},a,{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({appendChain:null,currSourceBufferOperation:null,lastAppendOperation:null,lastRemoveOperation:null,lastSourceBufferOperation:null,pendingAppendOperations:[],pendingRemoveOperations:[],sourceBufferRanges:[],sourceBufferRangesAnnotated:[],workaroundForSegmentBufferedInsufficiently:[]}),sourceBufferState:null})}else return a})});return c}switch(k.state){case"playing":switch(h.type){case"__enter":l(h.prevState);return;case"__exception":return;case"__dispose":return;case"_fetch_transitioned":return u(g,a,h.type+":"+h.requestID,0,k);case"update_player_state_from_main":var o;b=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(h.playerStateFromMain);var p=babelHelpers["extends"]({},k,{playerStateFromMain:b}),q=p.playerStateFromMain.dashManifestData;if((q==null?void 0:q.createdAt.perfMs)!==((o=k.playerStateFromMain.dashManifestData)==null?void 0:o.createdAt.perfMs)){var r=[];p=babelHelpers["extends"]({},p,{streams:p.streams.map(function(a){return Z(g,r,a,q)})});p=babelHelpers["extends"]({},p,{debugPlaybackLoopRecentChanges:C(p.debugPlaybackLoopRecentChanges,r)})}o=(o=b.mediaElementSnapshot)==null?void 0:o.error;if(o!=null&&!p.recoveringFromMediaError&&p.recoveringFromMediaErrorAttempt<m)p=n(p,d("nextgendasherr").nextgendasherrFromMediaError(g,o));else if(p.recoveringFromMediaError&&b.mediaElementSnapshot!=null&&b.mediaElementSnapshot.error==null&&b.mediaSourceIndexApplied===p.mediaSourceState.mediaSourceIndex){o=p;b=o.recoveringFromMediaError;f(d("nextgendasherr").nextgendasherrFromCause(g,b,"VideoPlayerNextgendashPlaybackLoopRecoveredFromMediaError"));p=babelHelpers["extends"]({},p,{debugPlaybackLoopRecentChanges:C(p.debugPlaybackLoopRecentChanges,["recoveringFromMediaError:"+b.name+":recovered"]),recoveringFromMediaError:null,streams:p.streams.map(function(a){if(a.streamFatalError!=null)return babelHelpers["extends"]({},a,{streamFatalError:null});else return a})})}return u(g,a,""+h.type,0,p);case"_media_source_event":o=k;b="mediaSourceEvent:"+h.mediaSourceIndex+":"+h.mediaSourceEventType;if(h.mediaSource!==o.mediaSourceState.mediaSource||h.mediaSourceIndex!==o.mediaSourceState.mediaSourceIndex)o=babelHelpers["extends"]({},o,{debugPlaybackLoopRecentChanges:C(o.debugPlaybackLoopRecentChanges,[b+"->mediaSourceMismatch:"+o.mediaSourceState.mediaSourceIndex])});else if(o.mediaSourceState.waitingForFirstSourceopen&&h.mediaSourceEventType==="sourceopen")o=babelHelpers["extends"]({},o,{debugPlaybackLoopRecentChanges:C(o.debugPlaybackLoopRecentChanges,[b+"->first"]),mediaSourceState:babelHelpers["extends"]({},o.mediaSourceState,{waitingForFirstSourceopen:!1})});else if(h.mediaSourceEventType==="sourceclose")if(!o.recoveringFromMediaError&&o.recoveringFromMediaErrorAttempt<m)o=n(babelHelpers["extends"]({},o,{debugPlaybackLoopRecentChanges:C(o.debugPlaybackLoopRecentChanges,[b+"->beginErrorRecoveryBeforeSeeingMediaError"])}),d("nextgendasherr").nextgendasherr(g,"VideoPlayerNextgendashPlaybackLoopSourceCloseEventAsError"));else{p=[];o.recoveringFromMediaError&&p.push("StillAttemptingPreviousRecovery");o.recoveringFromMediaErrorAttempt>=m&&p.push("ReachedRetryCap");o=babelHelpers["extends"]({},o,{debugPlaybackLoopRecentChanges:C(o.debugPlaybackLoopRecentChanges,[b+"->"+p.join(":")])})}else o=babelHelpers["extends"]({},o,{debugPlaybackLoopRecentChanges:C(o.debugPlaybackLoopRecentChanges,[b])});return u(g,a,h.type+":"+h.mediaSourceEventType,0,o);case"_source_buffer_event":var t=k.streams.find(function(a){return((a=a.sourceBufferState)==null?void 0:a.sourceBuffer)===h.sourceBuffer});n=t==null?void 0:t.appendState.currSourceBufferOperation;if(t!=null&&n!=null){p=!1;var v=[];b=k.streams.map(function(a){var b;if(a!==t)return a;b=V(g,f,a,v,h,i,(b=(b=k.playerStateFromMain.mediaElementSnapshot)==null?void 0:b.currentTime)!=null?b:0,function(){return T(g,a.sourceBufferState)});if(b!=null){p=!0;return babelHelpers["extends"]({},a,b)}else return a});o=babelHelpers["extends"]({},k,{debugPlaybackLoopRecentChanges:C(k.debugPlaybackLoopRecentChanges,v),streams:b});if(p)return u(g,a,h.type+":"+h.sourceBufferEventType+":"+n.operationState+":stateHasChanged",0,o);else return u(g,a,h.type+":"+h.sourceBufferEventType+":"+n.operationState+":!stateHasChanged",s,k)}else return u(g,a,h.type+":"+h.sourceBufferEventType+":null_currSourceBufferOperation",s,k);case"_observe_and_act":return D(g,k,h.loopIteration,a);default:h.type;return}case"__disposed__":switch(h.type){case"__enter":l(h.prevState);return}return;default:k.state;return}});function l(a,b){return a+b}function m(a,b,c){a=d("VideoPlayerNextgendashMediaUtils").makeStartEndByteIndexFromByteRangeMaybeOpenEnded(a,c);c=a[0];a=a[1];return b+(b.indexOf("?")===-1?"?":"&")+"bytestart="+c+(a!=null?"&byteend="+a:"")}function n(a,b,c,e,f){var g=f.templateNumber,h=f.templateTime;e=e;g=[["Number",g],["Time",h]];for(h=0;h<g.length;h++){var i=g[h],j=i[0];i=i[1];var k=new RegExp("\\$"+j+"\\$","g");if(k.test(e)){if(i==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSegmentURLTemplateMissingValue/"+j,"%s:%s - Unable to build URL for segment data#%s: missing value for $"+j+"$",b,c,f.segmentId);e=e.replace(k,String(i))}}return e}function o(a){return a.slice().sort(function(a,b){return a.demandedAtClock.perfMs-b.demandedAtClock.perfMs<.001?a.fetchDemandOrder-b.fetchDemandOrder:a.demandedAtClock.perfMs-b.demandedAtClock.perfMs})}function p(a,b,c,d){for(var e=0;e<b.length;++e){var f=b[e],g=f.responseFetch;if(g!=null){var h=null;g=g.state;if(!(g.state==="failed"))if(g.state==="aborted"||g.state==="__disposed__")h="EvictedAbortedOrInvalid";else if(g.state==="__null__"||g.state==="waiting_start"||g.state==="waiting_retry_or_failed"||g.state==="waiting_start_from_retry"||g.state==="waiting_headers"||g.state==="waiting_data"){var i;c.set(f.streamType,((i=c.get(f.streamType))!=null?i:0)+1)}else g.state==="completed"||g.state;h!=null&&(d.push("evictedFetch:"+Array.from(f.dataKeyToResponseByteRange.keys()).join("+")+":"+h),b[e]=babelHelpers["extends"]({},f,{evictedClock:a.host.clock(),evictedReason:h,responseFetch:null}))}}}function q(a,b,c,d,e){a=1;for(var f=0;f<b.length;++f){var g,h=b[f];if(h.responseFetch==null&&((g=c.get(h.streamType))!=null?g:0)<a){c.set(h.streamType,((g=c.get(h.streamType))!=null?g:0)+1);g=d(h);e.push("newFetch:"+Array.from(h.dataKeyToResponseByteRange.keys()).join("+"));b[f]=babelHelpers["extends"]({},h,{evictedClock:null,evictedReason:null,responseFetch:g})}}}function r(a,b,c,e){c=o(c);var f=new Map();p(a,c,f,e);function g(c){var e=b.makeChildSm,f=b.sendToOther,g=b.sendToSelf;e=e("fetch-"+c.requestDraft.requestID,d("VideoPlayerNextgendashFetchedResource").VideoPlayerNextgendashFetchedResourceSM,{onTransitioned:function(a,b,d){g({requestID:c.requestDraft.requestID,type:"_fetch_transitioned"},d)},request:babelHelpers["extends"]({},c.requestDraft,{requestCreatedClock:a.host.clock()})});f(e,{type:"start"});return e}q(a,c,f,g,e);return c}var s=1e3,t=20;function u(a,e,f,g,i,j){j===void 0&&(j=0);var k=e.args.sendPlayerWarningToMain,l=e.sendToSelf,m=a.host.clock().unixMs;g=m+g;var n=i.loopState;if(n.loopScheduledToUnixMs==null||g<n.loopScheduledToUnixMs){var o=n.loopTimerID;o!=null&&(c("clearTimeout")(o),o=null);o=Math.max(0,g-m);var p=f+":"+(o<=0?"immediately":"new_timer="+o+"ms"),q=i.loopState.loopIteration+1,r=i.debugPlaybackLoopRecentChanges;g=function(){try{l({loopIteration:q,reason:p,type:"_observe_and_act"})}catch(b){k(d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashPlaybackLoopScheduleObserveAndActUnexpectedException",'Caught exception from sendToSelf({loopIteration:%s,reason:"%s"})',q,p,"debugPlaybackLoopRecentChanges:\n "+r.join("\n ")))}};f=babelHelpers["extends"]({},i,{loopState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},n,{loopReasons:[].concat(n.loopReasons,[p]),loopScheduledToUnixMs:m+o,loopTimerDelayMs:o,loopTimerID:o>0?c("setTimeout")(g,o):null}))});if(o>0)return f;else if(j>=t){k(d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopScheduleObserveAndActRecursion","Too many recursive iterations: %s %s",j,"debugPlaybackLoopRecentChanges:\n "+f.debugPlaybackLoopRecentChanges.join("\n ")));(h||(h=b("Promise"))).resolve().then(g)["catch"](c("emptyFunction"));return f}else return D(a,f,q,e,j)}else return}function v(a){var b=/^(.*)[ ][*][*][ ](\d+)$/;a=a.reduce(function(a,c){var d=b.exec(c)||[],e=d[1];d=d[2];d=d?parseInt(d,10):1;isNaN(d)&&(d=1);if(a.lastLineMinusMaybeSuffix===(e||c))return babelHelpers["extends"]({},a,{lastLineRepeatCount:a.lastLineRepeatCount+d});w(a);return babelHelpers["extends"]({},a,{lastLineMinusMaybeSuffix:e||c,lastLineRepeatCount:d})},{coalesced:[],lastLineMinusMaybeSuffix:null,lastLineRepeatCount:0});w(a);return a.coalesced}function w(a){a.lastLineMinusMaybeSuffix!=null&&a.coalesced.push(""+a.lastLineMinusMaybeSuffix+(a.lastLineRepeatCount===1?"":" ** "+a.lastLineRepeatCount))}function x(a,b,c){if(!a.host.mediaSourceEndOfStreamCallIsExpectedToBeSafeAndNotNoop(a,b.mediaSourceState.mediaSource,b.playerStateFromMain.mediaElementSnapshot)){c.push("endOfStream skipped: !mediaSourceEndOfStreamCallIsExpectedToBeSafeAndNotNoop");return}var e=[],f=[];b.streams.forEach(function(b){if(b.type!=="video"&&b.type!=="audio")return;if(b.targetRepresentationId==null||b.sourceBufferState==null){var c=[];b.targetRepresentationId==null&&c.push("NullTargetRepresentationId");b.sourceBufferState==null&&c.push("NullSourceBufferState");var f=c.join("And");throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashEndOfStreamRequiredStreamNotSetup/"+f,"%s:%s - Unable to endOfStream() for required stream that is not setup: %s",b.type,b.targetRepresentationId,c.join(" and "))}f=!1;c=b.appendState.sourceBufferRanges;b=b.targetRepresentationId!=null?b.sidxByRepresentationId[b.targetRepresentationId]:null;if(b!=null){b=b.findLast(function(a){return a.isEndingSegment});var g=(b=b)==null?void 0:b.mediaTimeRange;g!=null&&(c.some(function(a){return d("VideoPlayerNextgendashMediaUtils").isWithinRange(a,Math.max(g[0],g[1]-.001))})&&(f=!0))}e.push(f)});f=e.length>0&&e.every(function(a){return a});f?(a.host.mediaSourceEndOfStream(a,b.mediaSourceState.mediaSource,b.playerStateFromMain.mediaElementSnapshot),c.push("endOfStream call attempted")):c.push("endOfStream skipped: !shouldCallEndOfStreamAll")}var y=2e3;function z(a,b,c,e,f){if(b.recoveringFromMediaError||e.streamFatalError!=null)return{abortFurtherStreamProcessing:!0,stream:e};var g=e.appendState.lastSourceBufferOperation,h=g!=null&&g.operationState==="errored"?g.error:null;g=(g=g!=null&&g.operationState==="errored"?g.waitForMediaElementErrorUntilUnixMs:null)!=null?g:0;b=(b=b.playerStateFromMain.mediaElementSnapshot)==null?void 0:b.error;if(h&&!b){if(c.unixMs<g){var i;f.push(e.type+":"+((i=e.targetRepresentationId)!=null?i:"no_target_representation")+":lastSourceBufferOperationErrorWaitForMediaError:"+(g-c.unixMs)+"ms");return{abortFurtherStreamProcessing:!0,stream:e}}f.push(e.type+":"+((i=e.targetRepresentationId)!=null?i:"no_target_representation")+":streamFatalError:"+h.name);return{abortFurtherStreamProcessing:!0,stream:babelHelpers["extends"]({},e,{streamFatalError:h})}}if(b){g=d("nextgendasherr").nextgendasherrFromMediaError(a,b);b=h&&g?d("nextgendasherr").nextgendasherrFromCause.apply(void 0,[a,h,g.name,g.messageFormat].concat(g.messageParams)):(i=(c=h)!=null?c:g)!=null?i:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopUnknownStreamFatalError");f.push(e.type+":"+((h=e.targetRepresentationId)!=null?h:"no_target_representation")+":streamFatalError:"+b.name);return{abortFurtherStreamProcessing:!0,stream:babelHelpers["extends"]({},e,{streamFatalError:b})}}return{abortFurtherStreamProcessing:!1,stream:e}}function A(a,b,c,e){var f=e!=null?e+1:0;e=a.host.mediaSourceCreate(a,function(a){var c=a.domEventType;a=a.eventTarget;b({mediaSource:a,mediaSourceEventType:c,mediaSourceIndex:f,type:"_media_source_event"})});a=e[0];e=e[1];c(a,f);return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({mediaSource:a,mediaSourceCleanup:e,mediaSourceIndex:f,waitingForFirstSourceopen:!0})}var B=60;function C(a,b){return b.length===0?a:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject([].concat(a.slice(0,-1),v([].concat(a.slice(-1),b))).slice(-B))}function D(a,b,e,f,g){g===void 0&&(g=0);var h=f.eventClock,i=f.sendToSelf;if(e<b.loopState.loopIteration)return;var j=b.loopState.loopTimerID;j!=null&&(c("clearTimeout")(j),j=null);var k=b.playerStateFromMain.dashManifestData,l=10,m=10,n=[],o=[],p=0;h=h;var q=h,t=b.fetchDemands,v=b.streams,w=v,y=!1,z=!1;innerLoop:do{++p;w=v;y=!1;z=!1;o.length=0;try{if(!k){if(w.length>0)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopManifestDataDisappeared");break innerLoop}else{var A=["video","audio"].map(function(c,g){var h=w.find(function(a){return a.type===c});if(h!=null&&h.streamFatalError!=null)return h;var i=c==="video"?k.manifestRepresentations.video.length>0&&!k.audioOnly:c==="audio"?k.manifestRepresentations.audio.length>0||k.audioOnly:!1,j=i?h:void 0;j==null&&i&&(c==="video"?(j={appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({appendChain:null,currSourceBufferOperation:null,lastAppendOperation:null,lastRemoveOperation:null,lastSourceBufferOperation:null,pendingAppendOperations:[],pendingRemoveOperations:[],sourceBufferRanges:[],sourceBufferRangesAnnotated:[],workaroundForSegmentBufferedInsufficiently:[]}),blockedRepresentations:{},manifestRepresentationsCount:0,playableRepresentations:[],prevSelectedMediaVariant:null,prevSelectedVideoQualityDisplayLabel:null,sidxByRepresentationId:{},sourceBufferState:null,streamFatalError:null,targetRepresentationId:null,targetRepresentationReason:null,targetVariantRepresentationIds:[],type:"video",videoABRState:null,videoABRStateClock:null},j=Z(a,o,j,k)):c==="audio"?(j={appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({appendChain:null,currSourceBufferOperation:null,lastAppendOperation:null,lastRemoveOperation:null,lastSourceBufferOperation:null,pendingAppendOperations:[],pendingRemoveOperations:[],sourceBufferRanges:[],sourceBufferRangesAnnotated:[],workaroundForSegmentBufferedInsufficiently:[]}),blockedRepresentations:{},manifestRepresentationsCount:0,playableRepresentations:[],prevSelectedMediaVariant:null,prevSelectedVideoQualityDisplayLabel:null,sidxByRepresentationId:{},sourceBufferState:null,streamFatalError:null,targetRepresentationId:null,targetRepresentationReason:null,targetVariantRepresentationIds:[],type:"audio"},j=Z(a,o,j,k)):c);i=h==null&&j!=null?"added":h!=null&&j==null?"removed":j!==h?"replaced":null;i!=null&&(y=!0,o.push(c+":"+i+":manifestRepresentations="+Q(k.manifestRepresentations[c])));if(j!=null){var l=j;h=o.length;try{i=E(a,b,k,f,j,t,e*1e4+g*100+p-1,o);t=i.fetchDemands;j=i.stream}catch(b){g=d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashPlaybackLoopObserveAndActException");o.push(j.type+":streamFatalError:"+g.name);j=babelHelpers["extends"]({},j,{streamFatalError:g})}if(j.streamFatalError!=null&&j.streamFatalError!==l.streamFatalError){z=!0;a.logging.log(a,{error:j.streamFatalError,format:"%s:%s - new streamFatalError",params:[j.type,(i=j.targetRepresentationId)!=null?i:"no_target_representation"],type:"generic_error"})}if(j!==l){y=!0;if(o.length===h){g=Object.keys(l).map(function(a){return j!=null&&j[a]!==l[a]?a:null}).filter(Boolean);o.push(j.type+":changeWithoutReason:"+g.join(","))}}}return j}).filter(Boolean);y&&(v=A)}}finally{q=a.host.clock(),v!==w&&n.push.apply(n,o)}}while(y&&!z&&p<l&&d("VideoPlayerNextgendashHostAPI").diffVideoPlayerNextgendashClockstamp(q,h).perfMs<m);A=[];z||(t=r(a,f,t,A));l=babelHelpers["extends"]({},b,{debugPlaybackLoopRecentChanges:C(b.debugPlaybackLoopRecentChanges,n.concat(A)),fetchDemands:t,loopState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},b.loopState,{loopIteration:e,loopReasons:[],loopScheduledToUnixMs:null,loopTimerDelayMs:null,loopTimerID:j})),streams:v});m=[];q=!1;h=!1;l.streams.forEach(function(a){if(a.type!=="video"&&a.type!=="audio")return;(a.appendState.currSourceBufferOperation!=null||a.appendState.pendingAppendOperations.length!==0||a.appendState.pendingRemoveOperations.length!==0)&&(q=!0);a.streamFatalError!=null&&(h=!0)});if(q||h||l.recoveringFromMediaError!=null)m.push("endOfStream skipped: "+[q?"current or pending operation":null,h?"pending stream fatal error(s)":null,l.recoveringFromMediaError!=null?"recovering from MediaError "+l.recoveringFromMediaError.name:null].filter(Boolean).join(", "));else try{x(a,l,m)}catch(b){i({exception:d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashPlaybackLoopCheckAndCallEndOfStreamError","%s","debugPlaybackLoopRecentChanges:\n "+l.debugPlaybackLoopRecentChanges.join("\n "),"endOfStreamDebugReasons:\n "+m.join("\n ")),type:"__exception"});return l}m.length===0&&m.push("endOfStream: checked, unknown result");A=babelHelpers["extends"]({},l,{debugPlaybackLoopRecentChanges:C(l.debugPlaybackLoopRecentChanges,m)});if(z){i({exception:d("nextgendasherr").nextgendasherrFromMultipleCauses(a,A.streams.map(function(a){return a.streamFatalError!=null?[a.type,a.streamFatalError]:null}).filter(Boolean),"VideoPlayerNextgendashPlaybackLoopStreamFatalErrors","%s","debugPlaybackLoopRecentChanges:\n "+A.debugPlaybackLoopRecentChanges.concat(A.recoveringFromMediaErrorAttempt>0?["recoveringFromMediaErrorAttempt:"+A.recoveringFromMediaErrorAttempt]:[]).join("\n ")),type:"__exception"});return A}else if(A.streams!==b.streams)return u(a,f,"streamsChanged:("+n.join(",")+")",0,A,g+1);else return u(a,f,"!streamsChanged",10*s,A,g+1)}function E(a,b,c,e,f,g,h,k){var l,m,n=e.args,o=n.prefetchResult;n=n.sendPlayerWarningToMain;var p=e.eventClock,q=e.sendToSelf,r=g,s=h*1e4;e=z(a,b,p,f,k);g=e.abortFurtherStreamProcessing;var t=e.stream;if(t.streamFatalError!=null||g)return{fetchDemands:r,stream:t};h=t.sourceBufferState;if(h!=null&&b.mediaSourceState.mediaSourceIndex!==h.mediaSourceIndex){k.push(t.type+":"+((f=t.targetRepresentationId)!=null?f:"no_target_representation")+":sourceBufferState:reset:"+h.mediaSourceIndex+"-->"+b.mediaSourceState.mediaSourceIndex);h.sourceBufferCleanup();h=null;t=babelHelpers["extends"]({},t,{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({appendChain:null,currSourceBufferOperation:null,lastAppendOperation:null,lastRemoveOperation:null,lastSourceBufferOperation:null,pendingAppendOperations:[],pendingRemoveOperations:[],sourceBufferRanges:[],sourceBufferRangesAnnotated:[],workaroundForSegmentBufferedInsufficiently:[]}),sourceBufferState:null})}var u=t.appendState.sourceBufferRanges;e=null;g=c.manifestRepresentations[t.type].find(function(a){return a.representationId===t.targetRepresentationId});f=t.targetRepresentationReason;if(g==null){var v=ra(a,n,p,b.playerStateFromMain,c,o,u,t,k);e=v.prevTargetRepresentation;t=v.stream;g=v.targetRepresentation;f=v.targetRepresentationReason}v=e;var w=g;e=f;var x=w.representationId;if(h==null)try{g=a.host.mediaSourceAddSourceBuffer(a,b.mediaSourceState.mediaSource,w,function(a){var b=a.domEventType;a=a.eventTarget;q({debugStreamType:t.type,sourceBuffer:a,sourceBufferEventType:b,type:"_source_buffer_event"})});f=g[0];g=g[1];h={mediaSourceIndex:b.mediaSourceState.mediaSourceIndex,sourceBuffer:f,sourceBufferCleanup:g,sourceBufferMimeCodecsParsed:w.mimeCodecsParsed};k.push(t.type+":"+x+":sourceBufferState:new:"+d("VideoPlayerNextgendashMediaUtils").debugStringifyMimeCodecs(h.sourceBufferMimeCodecsParsed));t=babelHelpers["extends"]({},t,{sourceBufferState:h})}catch(c){if(!(typeof c==="object"&&c!=null&&c.name==="VideoPlayerNextgendashHostAPIBrowserAddSourceBufferMediaSourceNotOpen"&&b.mediaSourceState.waitingForFirstSourceopen))throw d("nextgendasherr").nextgendasherrFromCause(a,c,"VideoPlayerNextgendashPlaybackLoopAddSourceBufferException")}f=h;g=F(w);h=H(r,g,!0);g=h==null?void 0:h.responseFetch;l=h==null?void 0:(l=h.responseInfo)==null?void 0:l.buffer;if(l==null&&g!=null&&g.state.state==="completed"){t=$(a,n,k,t,c,x,d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopInitFetchBufferExtractionFailed","%s:%s - Failed to extract init buffer from the completed response; mimeCodecs=%s",t.type,x,w.mimeCodecsParsed.mimeCodecs));return{fetchDemands:r,stream:t}}else if(g!=null&&g.state.state==="failed"){t=$(a,n,k,t,c,x,d("nextgendasherr").nextgendasherrFromCause(a,g.state.error,"VideoPlayerNextgendashPlaybackLoopInitFetchFailed","%s:%s - Failed to fetch init; mimeCodecs=%s",t.type,x,w.mimeCodecsParsed.mimeCodecs));return{fetchDemands:r,stream:t}}else h==null&&(r=[].concat(r,[ca(a,++s,w)]));g=t.sidxByRepresentationId[x];var y=w.segmentsInfo,A=da(w),B=H(r,A,!0),C=B==null?void 0:B.responseFetch;m=B==null?void 0:(m=B.responseInfo)==null?void 0:m.buffer;if(g==null&&m!=null){var D=w.mimeCodecsParsed.containerType,E=null;try{switch(D){case"mp4":var J=y.type==="SegmentBase"?y.indexByteRange.byteOffset:null;if(J==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSidxParseMp4MissingSidxByteOffset");E=d("VideoPlayerNextgendashMp4SidxParser").parseMp4Sidx(a,m,J);break;case"webm":if(l!=null)E=d("VideoPlayerNextgendashWebmSidxParser").parseWebmSidx(a,m,l);else if(h==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSidxParseWebmMissingInitFetch");else E=null;break;default:throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSidxParseUnexpectedContainerType","Unexpected container type for sidx parsing: %s",D)}}catch(b){t=$(a,n,k,t,c,x,d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashPlaybackLoopSidxParseFailed","%s:%s - Failed to parse sidx; mimeCodecs=%s",t.type,x,w.mimeCodecsParsed.mimeCodecs));return{fetchDemands:r,stream:t}}var K=E;if(K!=null){g=X(a,t.type,x,K.map(function(a,b){return{isEndingSegment:b===K.length-1,mediaFileByteRange:a.mediaFileByteRange,mediaTimeRange:a.mediaTimeRange,segmentId:b}}));k.push(t.type+":"+x+":sidx/buffer:"+K.length+":"+g.length);t=babelHelpers["extends"]({},t,{sidxByRepresentationId:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},t.sidxByRepresentationId,(J={},J[x]=g,J)))});r=(h=I(r,function(a){return a===A}))!=null?h:r}}else if(m==null&&C!=null&&C.state.state==="completed"){t=$(a,n,k,t,c,x,d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSidxFetchBufferExtractionFailed","%s:%s - Failed to extract sidx buffer from the completed response; mimeCodecs=%s",t.type,x,w.mimeCodecsParsed.mimeCodecs));return{fetchDemands:r,stream:t}}else if(g==null&&C!=null&&C.state.state==="failed"){t=$(a,n,k,t,c,x,d("nextgendasherr").nextgendasherrFromCause(a,C.state.error,"VideoPlayerNextgendashPlaybackLoopSidxFetchFailed","%s:%s - Failed to fetch sidx; mimeCodecs=%s",t.type,x,w.mimeCodecsParsed.mimeCodecs));return{fetchDemands:r,stream:t}}else if(g==null&&y.type==="SegmentTemplate"){D=ua(y);g=X(a,t.type,x,D);k.push(t.type+":"+x+":sidx/template:"+D.length+":"+g.length);t=babelHelpers["extends"]({},t,{sidxByRepresentationId:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},t.sidxByRepresentationId,(E={},E[x]=g,E)))})}else if(g==null&&B==null){r=[].concat((J=I(r,function(a){return a!==A&&a.startsWith("sidx-"+w.type+"-")}))!=null?J:r,[ea(a,++s,w)])}h=g;var M=(C=(m=b.playerStateFromMain.mediaElementSnapshot)==null?void 0:m.currentTime)!=null?C:0;if(((y=t.appendState.appendChain)==null?void 0:y.mediaTail)!=null){D=va(a,t.type,x,t.appendState.appendChain,M,u,b.mediaSourceState.mediaSource,k);D!==t.appendState.appendChain&&(t=babelHelpers["extends"]({},t,{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},t.appendState,{appendChain:D}))}))}m=v!=null&&(((E=w.role)!=null?E:null)!==((B=v.role)!=null?B:null)||((J=w.lang)!=null?J:null)!==((g=v.lang)!=null?g:null));if(v!=null&&x!==v.representationId&&(e==="selected_switch"||m)){C=5;y=m?0:M+C;D=[y,Number.POSITIVE_INFINITY];E={operationState:"wait_start",operationTiming:{created:a.host.clock()},operationType:"remove_operation",removeRange:D};k.push(t.type+":"+x+":pendingRemoveOperations:newRemoveOperation:"+N(E.removeRange));t=babelHelpers["extends"]({},t,{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},t.appendState,{pendingAppendOperations:[],pendingRemoveOperations:[].concat(t.appendState.pendingRemoveOperations,[E])}))})}v=(g=(J=(B=t.appendState.pendingAppendOperations[t.appendState.pendingAppendOperations.length-1])==null?void 0:B.appendInfo.representationId)!=null?J:t.appendState.currSourceBufferOperation!=null&&t.appendState.currSourceBufferOperation.operationType==="append_operation"?t.appendState.currSourceBufferOperation.appendInfo.representationId:null)!=null?g:t.appendState.lastAppendOperation!=null&&t.appendState.lastAppendOperation.operationState==="succeeded"?t.appendState.lastAppendOperation.appendInfo.representationId:null;if(f!=null&&x!==v&&l!=null){e={appendInfo:{appendInfoType:"init",mimeCodecsParsed:w.mimeCodecsParsed,representationId:x},buffer:l,operationState:"wait_start",operationTiming:{created:a.host.clock()},operationType:"append_operation"};k.push(t.type+":"+x+":pendingAppendOperations:initAppendOperation:"+L(e.appendInfo));t=babelHelpers["extends"]({},t,{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},t.appendState,{pendingAppendOperations:[e]}))})}m=16.924449682236;C=22;y=4;D=b.playerStateFromMain.mediaElementSnapshot==null?"initial":b.playerStateFromMain.mediaElementSnapshot.paused?"paused":"playing";E={initial:m,paused:y,playing:C}[D];var O=t.appendState.appendChain!=null?M-j:M,P=M+E,Q=t.appendState.currSourceBufferOperation!=null&&t.appendState.currSourceBufferOperation.operationType==="append_operation"?t.appendState.currSourceBufferOperation.appendInfo.appendInfoType==="data"&&t.appendState.currSourceBufferOperation.appendInfo.dataByteRangeLength>0?t.appendState.currSourceBufferOperation.appendInfo:null:t.appendState.lastAppendOperation!=null&&t.appendState.lastAppendOperation.operationState==="succeeded"&&t.appendState.lastAppendOperation.appendInfo.appendInfoType==="data"&&t.appendState.lastAppendOperation.appendInfo.dataByteRangeLength>0?t.appendState.lastAppendOperation.appendInfo:null;function R(a,b){var c=t.appendState.appendChain;return c!=null&&a===c.representationId&&c.mediaTail!=null&&b<=c.mediaTail.segmentId}J=(B=h)!=null?B:[];g=J.filter(function(a){if(!ta(u,a)&&!t.appendState.workaroundForSegmentBufferedInsufficiently.some(function(b){return b.representationId===x&&b.segment.segmentId===a.segmentId})){if(a.isEndingSegment&&M>a.mediaTimeRange[1])return!R(x,a.segmentId);var b=d("VideoPlayerNextgendashMediaUtils").isWithinRange(a.mediaTimeRange,O);if(b)return!R(x,a.segmentId);b=d("VideoPlayerNextgendashMediaUtils").isWithinRange(a.mediaTimeRange,P);if(b)return!R(x,a.segmentId);b=O<=a.mediaTimeRange[0]&&a.mediaTimeRange[1]<=P;if(b)return!R(x,a.segmentId)}return!1});var S=new Set(),T=null;if(a.config.fetchCombineSegments&&g.length>1&&w.segmentsInfo.type==="SegmentBase"){f=[];for(v=0;v<g.length;++v){l=g[v];e=G(w,l);S.add(e);y=ha(a,(m=T)!=null?m:r,e);T=(C=y)!=null?C:T;y==null&&f.push(l)}D=o!=null&&o.prefetchedRepresentationIds.includes(x)?[0]:[];E=aa(f,D);for(h=0;h<E.length;++h){B=E[h];T=(J=T)!=null?J:[].concat(r);T.push(ga(a,++s,w,B))}}else g.forEach(function(b){var c,d=G(w,b);S.add(d);c=ha(a,(c=T)!=null?c:r,d);T=(d=c)!=null?d:T;if(c==null){T=(d=T)!=null?d:[].concat(r);T.push(fa(a,++s,w,b))}});m=!0;if(m){var U=new Set();((e=T)!=null?e:r).forEach(function(b){var d=p.perfMs-b.demandedAtClock.perfMs,e=0;if(d<e)return;b.activeDemands.forEach(function(b){b.startsWith("segment-"+t.type+"-")&&!S.has(b)&&![Q,t.appendState.currSourceBufferOperation!=null&&t.appendState.currSourceBufferOperation.operationType==="append_operation"?t.appendState.currSourceBufferOperation.appendInfo:null].concat(t.appendState.pendingAppendOperations.map(function(a){return a.appendInfo})).filter(Boolean).some(function(d){var e=ba(a,c.manifestRepresentations[t.type],d.representationId);switch(d.appendInfoType){case"init":return b===F(e);case"data":return b===G(e,d.segment);default:d.appendInfoType}})&&U.add(b)})});if(U.size>0){T=I((C=T)!=null?C:r,function(a){return U.has(a)})}}l=(y=T)!=null?y:r;v=l.reduce(function(a,b){if(b.streamType===t.type&&b.activeDemands.size>0)if(b.responseFetch==null)a.unfulfilledDemandsCountForThisStream+=1;else{b=b.responseFetch.state.state;b!=="completed"&&b!=="aborted"&&b!=="failed"&&b!=="__null__"&&b!=="__disposed__"&&(a.inflightFetchesCountForThisStream+=1)}return a},{inflightFetchesCountForThisStream:0,unfulfilledDemandsCountForThisStream:0});if(v.inflightFetchesCountForThisStream===0&&v.unfulfilledDemandsCountForThisStream>0){f=ra(a,n,p,b.playerStateFromMain,c,o,u,t,k);if(f.stream.targetRepresentationId!==t.targetRepresentationId)return{fetchDemands:r,stream:f.stream};t=f.stream}r=(D=T)!=null?D:r;if(!(t.appendState.pendingAppendOperations.length>0||t.appendState.currSourceBufferOperation!=null)){J=null;if(Q!=null)J={dataByteRangeStart:Q.dataByteRangeStart+Q.dataByteRangeLength,incompleteChunkedAppendInfo:Q,mimeCodecsParsed:Q.mimeCodecsParsed,representationId:Q.representationId,segment:Q.segment};else if(g.length>0){B=g[0];J={dataByteRangeStart:0,incompleteChunkedAppendInfo:null,mimeCodecsParsed:w.mimeCodecsParsed,representationId:x,segment:B}}h=J;if(!(h==null))if(t.appendState.appendChain!=null&&t.appendState.appendChain.representationId===h.representationId){E=ba(a,c.manifestRepresentations[t.type],h.representationId);m=G(E,h.segment);e=H(r,m);if(e==null){throw d("nextgendasherr").nextgendasherr(a,h.incompleteChunkedAppendInfo!=null?"VideoPlayerNextgendashPlaybackLoopMissingFetchDemandForSegmentToContinueChunkedAppend":"VideoPlayerNextgendashPlaybackLoopMissingFetchDemandForSegmentToAppend","%s:%s - nextAppendInfo=%s segmentFetchDemandKey=%s fetchDemands=%s",t.type,(C=x)!=null?C:"no_target_representation",JSON.stringify(h),m,ia(r))}y=null;e.responseFetch!=null&&e.responseFetch.state.state==="failed"?y=d("nextgendasherr").nextgendasherrFromCause(a,e.responseFetch.state.error,"VideoPlayerNextgendashPlaybackLoopSegmentFetchFailed","%s:%s - Fetch failed for media segment needed to append; segmentFetchDemandKey=%s nextAppendInfo=%s",t.type,x,m,JSON.stringify(h)):e.responseFetch!=null&&e.responseFetch.state.state==="aborted"&&(y=d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSegmentFetchAborted","%s:%s - Fetch aborted for media segment needed to append; segmentFetchDemandKey=%s nextAppendInfo=%s",t.type,x,m,JSON.stringify(h)));l=e==null?void 0:e.responseInfo;if(y!=null){t=$(a,n,k,t,c,x,y);return{fetchDemands:r,stream:t}}else if(l!=null){v=h.segment.mediaFileByteRange.byteLength;o=l.isFetchComplete||l.responseByteRange.byteLength!=null&&l.chunksByteLength>=l.responseByteRange.byteOffset+l.responseByteRange.byteLength;f=0;D=6;g=o?null:D>0&&v!=null&&v>0?Math.ceil(v/D):f>0?f:null;B=l.responseByteRange.byteOffset+h.dataByteRangeStart;J=l.responseByteRange.byteLength!=null?l.responseByteRange.byteLength-h.dataByteRangeStart:null;E=Y(l.chunks,B,g!=null?J!=null?Math.min(J,g):g:J);C=null;if(E!=null&&(g===null||E.copyTotalBytesCount>=g)){C=wa(l.chunks,E);if(C==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopFailedToCombineChunksToAppend","%s/data#%s - Failed to copy %sB from chunks #%s(%sB)..#%s(%sB) into an append buffer (out of %s chunks of total %sB).",h.representationId,h.segment.segmentId,E.copyTotalBytesCount,E.startChunkIndex,E.startChunkByteOffset,E.endChunkIndex,E.endChunkBytesCount,l.chunks.length,l.chunksByteLength)}else o&&(C=i);if(C!=null){m={appendInfoType:"data",dataByteRangeLength:C.byteLength,dataByteRangeStart:h.dataByteRangeStart,mimeCodecsParsed:h.mimeCodecsParsed,representationId:h.representationId,segment:h.segment};e={appendInfo:m,buffer:C,operationState:"wait_start",operationTiming:{created:a.host.clock()},operationType:"append_operation"};k.push(t.type+":"+x+":pendingAppendOperations:dataAppendOperation:"+L(m));t=babelHelpers["extends"]({},t,{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},t.appendState,{pendingAppendOperations:[].concat(t.appendState.pendingAppendOperations,[e])}))})}}}}y=xa(a,n,t,k,w,b.mediaSourceState.mediaSource,M);y!=null&&(t=babelHelpers["extends"]({},t,y));v=ya(a,n,t,k,w,M,b.mediaSourceState.mediaSource);v!=null&&(t=babelHelpers["extends"]({},t,v));return{fetchDemands:r,stream:t}}function aa(a,b){var c=[];for(var d=0;d<a.length;++d){var e=a[d];if(c.length===0)c.push([e]);else{var f=c[c.length-1],g=f[f.length-1];g=g.mediaFileByteRange.byteLength!=null&&e.mediaFileByteRange.byteOffset===g.mediaFileByteRange.byteOffset+g.mediaFileByteRange.byteLength&&!b.includes(g.segmentId);g?f.push(e):c.push([e])}}return c}function ba(a,b,c){var e=b.find(function(a){return a.representationId===c});if(e==null)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopUnableToFindRepresentation",'In %s manifestRepresentations, missing one with ID "%s"',b.length,c);return e}function F(a){return"init-"+a.type+"-"+a.representationId}function ca(a,b,c){var e=F(c),f=c.segmentsInfo.type==="SegmentBase"?{byteLength:c.segmentsInfo.initByteRange.byteLength,byteOffset:0}:{byteLength:null,byteOffset:0};f=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Map([[e,f]]));return{activeDemands:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Set(f.keys())),dataKeyToResponseByteRange:f,demandedAtClock:a.host.clock(),evictedClock:null,evictedReason:null,fetchDemandOrder:b,requestDraft:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({qplName:c.type+"_init",reportToBandwidthEstimator:!0,requestID:e,requestInfo:c.segmentsInfo.type==="SegmentBase"?m(a,c.segmentsInfo.baseURL,c.segmentsInfo.initByteRange):l(c.segmentsInfo.baseURL,c.segmentsInfo.initURL),responseMode:"buffer"}),responseFetch:null,streamType:c.type}}function da(a){return"sidx-"+a.type+"-"+a.representationId}function ea(a,b,c){var e=c.segmentsInfo;if(e.type!=="SegmentBase")throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSidxFetchUnknown","%s:%s - sidx fetch unknown ("+e.type+")",c.type,c.representationId);var f=da(c),g={byteLength:e.indexByteRange.byteLength,byteOffset:0};g=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Map([[f,g]]));return{activeDemands:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Set(g.keys())),dataKeyToResponseByteRange:g,demandedAtClock:a.host.clock(),evictedClock:null,evictedReason:null,fetchDemandOrder:b,requestDraft:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({qplName:c.type+"_sidx",reportToBandwidthEstimator:!0,requestID:f,requestInfo:m(a,e.baseURL,e.indexByteRange),responseMode:"buffer"}),responseFetch:null,streamType:c.type}}function G(a,b){return"segment-"+a.type+"-"+a.representationId+"-"+b.segmentId}function fa(a,b,c,e){var f=c.segmentsInfo,g=G(c,e),h=c.segmentsInfo.type==="SegmentBase"?{byteLength:e.mediaFileByteRange.byteLength,byteOffset:0}:{byteLength:null,byteOffset:0};h=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Map([[g,h]]));return{activeDemands:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Set(h.keys())),dataKeyToResponseByteRange:h,demandedAtClock:a.host.clock(),evictedClock:null,evictedReason:null,fetchDemandOrder:b,requestDraft:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({qplName:c.type+"_segment",reportToBandwidthEstimator:!0,requestID:g,requestInfo:f.type==="SegmentBase"?m(a,f.baseURL,e.mediaFileByteRange):l(f.baseURL,n(a,c.type,c.representationId,f.segmentURLTemplate,e)),responseMode:"stream"}),responseFetch:null,streamType:c.type}}function ga(a,b,c,e){if(e.length===0)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopGroupOfSegmentsFetchEmptySegments","%s:%s - Group of segments fetch empty segments",c.type,c.representationId);if(e.length===1)return fa(a,b,c,e[0]);var f=c.segmentsInfo;if(f.type!=="SegmentBase")throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopGroupOfSegmentsFetchUnsupported","%s:%s - Group of segments fetch unsupported ("+f.type+")",c.type,c.representationId);var g=e[0].mediaFileByteRange,h=e[e.length-1].mediaFileByteRange,i=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Map(e.map(function(a){return[G(c,a),{byteLength:a.mediaFileByteRange.byteLength,byteOffset:a.mediaFileByteRange.byteOffset-g.byteOffset}]})));return{activeDemands:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(new Set(i.keys())),dataKeyToResponseByteRange:i,demandedAtClock:a.host.clock(),evictedClock:null,evictedReason:null,fetchDemandOrder:b,requestDraft:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({qplName:c.type+"_segment_group",reportToBandwidthEstimator:!0,requestID:"segment-"+c.type+"-"+c.representationId+"-"+e.map(function(a){return a.segmentId}).join(","),requestInfo:m(a,f.baseURL,{byteLength:h.byteLength!=null?h.byteOffset+h.byteLength:null,byteOffset:g.byteOffset}),responseMode:"stream"}),responseFetch:null,streamType:c.type}}function H(a,b,c){c===void 0&&(c=!1);var d=!1,e=null;for(var f=0;f<a.length;++f){var g=a[f],h=g.dataKeyToResponseByteRange.get(b);if(h!=null){d=!0;if(g.responseFetch!=null){e={responseByteRange:h,responseFetch:g.responseFetch,responseFetchDataState:g.responseFetch.state.state==="waiting_data"||g.responseFetch.state.state==="completed"?g.responseFetch.state.responseData.state:null};break}}}if(e==null)if(d)return{responseFetch:null,responseInfo:null};else return null;h=e;g=h.responseByteRange;b=h.responseFetch;f=h.responseFetchDataState;if(g!=null&&f!=null&&(f.state==="reading_stream"||f.state==="done_stream"||f.state==="done_buffer")){a=f.state==="done_stream"||f.state==="done_buffer";d=f.state==="done_buffer"?[f.buffer]:f.chunks;e=f.state==="done_buffer"?f.buffer.byteLength:f.dataBytesLengthTotal;h=null;if(c&&(a||g.byteLength!=null&&e>=g.byteOffset+g.byteLength)){f=Y(d,g.byteOffset,g.byteLength);h=f!=null?wa(d,f):null}return{responseFetch:b,responseInfo:{buffer:h,chunks:d,chunksByteLength:e,isFetchComplete:a,responseByteRange:g}}}return{responseFetch:b,responseInfo:null}}function ha(a,b,c){var e=null;for(var f=0;f<b.length;++f){var g=b[f];if(g.dataKeyToResponseByteRange.has(c)){var h,i=new Set(g.activeDemands);i.add(c);e=(h=e)!=null?h:[].concat(b);e[f]=babelHelpers["extends"]({},g,{activeDemands:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(i),demandedAtClock:a.host.clock()})}}return e}function I(a,b){var c=!1;a=a.map(function(a){var e=null;a.activeDemands.forEach(function(c){if(b(c)){var d;e=(d=e)!=null?d:new Set(a.activeDemands);e["delete"](c)}});if(e!=null){c=!0;if(e.size===0)return null;else return babelHelpers["extends"]({},a,{activeDemands:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(e)})}return a});return c?a.filter(Boolean):null}function J(a,b){return a.map(function(a){var c,d;c=(c=a.responseFetch)==null?void 0:c.state;var e=c==null?void 0:c.state;d=b?{pf:c!=null?(d=c.prefetchResultState)!=null?d:void 0:void 0,rc:c!=null&&c.state!=="__null__"&&c.state!=="__disposed__"?c.request.requestCreatedClock:void 0,ttfb:(c==null?void 0:c.state)==="waiting_data"||(c==null?void 0:c.state)==="completed"?c.responseHeader.httpHeadersReceivedClock.perfMs-c.requestStartedClock.perfMs:void 0,ttlb:(c==null?void 0:c.state)==="completed"?c.requestCompletedClock.perfMs-c.requestStartedClock.perfMs:void 0,ttrs:(c==null?void 0:c.state)==="waiting_headers"||(c==null?void 0:c.state)==="waiting_data"||(c==null?void 0:c.state)==="completed"?c.requestStartedClock.perfMs-c.request.requestCreatedClock.perfMs:void 0}:void 0;c=(c=a.responseFetch)==null?void 0:(c=c.state)==null?void 0:(c=c.responseData)==null?void 0:c.state.state;a=Array.from(a.dataKeyToResponseByteRange.entries()).map(function(a){var b=a[0];a=a[1];return[b,K(a)]});return[a,e,c,d]})}function ia(a,b){b===void 0&&(b=!1);return JSON.stringify(J(a,b))}function K(a){return"["+a.byteOffset+"B.."+(a.byteLength!=null?a.byteOffset+a.byteLength-1+"B="+a.byteLength+"B":"EOF")+"]"}function L(a){switch(a.appendInfoType){case"init":return a.representationId+"/init#"+d("VideoPlayerNextgendashMediaUtils").debugStringifyMimeCodecs(a.mimeCodecsParsed);case"data":return a.representationId+"/data#"+a.segment.segmentId+N(a.segment.mediaTimeRange,a.segment.isEndingSegment)+K(a.segment.mediaFileByteRange)+"<"+(a.segment.mediaFileByteRange.byteOffset+a.dataByteRangeStart)+"B"+(a.dataByteRangeLength>0?".."+(a.segment.mediaFileByteRange.byteOffset+a.dataByteRangeStart+a.dataByteRangeLength-1)+"B="+a.dataByteRangeLength+"B":"X")+">";default:a.appendInfoType;return""}}function M(a){return a.length>0?a.map(function(a){return N(a)}).join(","):"[]"}function N(a,b){return"["+a[0]+"s.."+a[1]+"s"+(b==null?"":b?"X":"~")+"]"}function O(a){return a==null?"null":a.representationId+"["+a.playheadMinimumTimeSec+"s.."+(a.mediaTail!=null?a.mediaTail.mediaTimeSec+"s;data#"+a.mediaTail.segmentId+"]":"null]")}function P(a){return Object.entries(a).map(function(a){var b=a[0];a=a[1];return[b,a==null?void 0:a.name].join(":")}).join(",")||"none"}function Q(a){return a.map(function(a){var b=[a.lang,a.role].filter(Boolean).join("+");return a.representationId+":"+d("VideoPlayerNextgendashMediaUtils").debugStringifyMimeCodecs(a.mimeCodecsParsed)+(b!==""?":"+b:"")}).join(",")||"none"}function R(a){return a.map(function(a){var b;return a.representationId+":"+((b=a.lang)!=null?b:"null")+"+"+((b=a.role)!=null?b:"null")}).join(",")||"none"}function S(a){return a.map(function(a){var b;return a.representationId+":"+((b=a.lang)!=null?b:"null")+"+"+((b=a.role)!=null?b:"null")}).join(",")||"none"}function T(a,b){return b!=null?a.host.sourceBufferSnapshotBuffered(a,b.sourceBuffer):void 0}function U(a){return"MSreadyState:"+a.readyState+",MSduration:"+a.duration+",SBSUpdating:["+(a.sourceBuffersUpdating?a.sourceBuffersUpdating.map(function(a){return a?"T":"F"}).join(""):"")+"]"+(a.exception!=null?"MSexception:"+a.exception.name:"")}function V(a,b,c,e,f,g,h,i){var k=c.appendState,l=k.currSourceBufferOperation;if(l==null)return null;var m=null,n=null,o=null,p=function(){function e(b){b===void 0&&(b="");b="VideoPlayerNextgendashPlaybackLoopUnexpectedSourceBufferEvent["+l.operationState+"]<--"+f.sourceBufferEventType+b;if(f.exception!=null)throw d("nextgendasherr").nextgendasherrFromCause(a,f.exception,b);else throw d("nextgendasherr").nextgendasherr(a,b)}switch(l.operationState){case"wait_start":switch(f.sourceBufferEventType){case"_started":return babelHelpers["extends"]({},l,{debugSourceBufferRangesAfterStart:void 0,operationState:"wait_updateend",operationTiming:babelHelpers["extends"]({},l.operationTiming,{started:g})});case"_exception":n=i();return babelHelpers["extends"]({},l,{error:d("nextgendasherr").nextgendasherrFromCause(a,f.exception,"VideoPlayerNextgendashPlaybackLoopSourceBufferException"),operationState:"errored",operationTiming:babelHelpers["extends"]({},l.operationTiming,{ended:g,started:g}),waitForMediaElementErrorUntilUnixMs:g.unixMs+y});case"_finished":var h,j;if(l.operationType!=="append_operation"||l.appendInfo.appendInfoType!=="data"||l.appendInfo.dataByteRangeLength>0)throw e("NotDataEndSegmentAppendOperation");var k=l.appendInfo.segment;l.buffer;var p=babelHelpers.objectWithoutPropertiesLoose(l,["buffer"]);n=i();if(n!=null&&!ta(n,k)){var q;m={representationId:l.appendInfo.representationId,segment:k};b(d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSegmentBufferedInsufficiently","%s:%s - After finishing append of %s its media time range %s is missing from SourceBuffer: %s",c.type,(q=c.targetRepresentationId)!=null?q:"no_target_representation",L(l.appendInfo),JSON.stringify(k.mediaTimeRange),JSON.stringify(n)))}p.operationType==="append_operation"&&p.appendInfo.appendInfoType==="data"&&(o=p.appendInfo);return babelHelpers["extends"]({},p,{debugSourceBufferRangesAfterFinish:void 0,debugSourceBufferRangesAfterStart:void 0,operationState:"succeeded",operationTiming:babelHelpers["extends"]({},l.operationTiming,{ended:g,started:g})});default:f.sourceBufferEventType;throw e()}case"wait_updateend":switch(f.sourceBufferEventType){case"_exception":q=l.abortIsPendingUpdateEnd;k=l.errorIsPendingUpdateEnd;p=babelHelpers.objectWithoutPropertiesLoose(l,["abortIsPendingUpdateEnd","errorIsPendingUpdateEnd"]);q="VideoPlayerNextgendashPlaybackLoopSourceBufferExceptionWhileAwaitingUpdateEnd"+(q?"AfterAbort":"");n=i();return babelHelpers["extends"]({},p,{error:k?d("nextgendasherr").nextgendasherrFromMultipleCauses(a,[["InitialError",k],["LaterError",f.exception]],q):d("nextgendasherr").nextgendasherrFromCause(a,f.exception,q),operationState:"errored",operationTiming:babelHelpers["extends"]({},l.operationTiming,{ended:g}),waitForMediaElementErrorUntilUnixMs:g.unixMs+y});case"updateend":var r;p=l.abortIsPendingUpdateEnd;k=l.errorIsPendingUpdateEnd;q=babelHelpers.objectWithoutPropertiesLoose(l,["abortIsPendingUpdateEnd","errorIsPendingUpdateEnd"]);(p||k||q.operationType==="remove_operation")&&(n=i());var s=babelHelpers["extends"]({},l.operationTiming,{ended:g});if(k){var t;return babelHelpers["extends"]({},q,{debugSourceBufferRangesAfterFinish:void 0,error:k,operationState:"errored",operationTiming:s,waitForMediaElementErrorUntilUnixMs:g.unixMs+y})}q.buffer;k=babelHelpers.objectWithoutPropertiesLoose(q,["buffer"]);if(p){var u;return babelHelpers["extends"]({},k,{debugSourceBufferRangesAfterFinish:void 0,operationState:"aborted",operationTiming:s})}l.operationType==="append_operation"&&l.appendInfo.appendInfoType==="data"&&(o=l.appendInfo);return babelHelpers["extends"]({},k,{debugSourceBufferRangesAfterFinish:void 0,operationState:"succeeded",operationTiming:s});case"error":if(l.errorIsPendingUpdateEnd)throw e("SecondErrorEvent");if(l.abortIsPendingUpdateEnd)throw e("ErrorAfterAbort");return babelHelpers["extends"]({},l,{errorIsPendingUpdateEnd:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSourceBufferErrorEvent")});case"abort":if(l.abortIsPendingUpdateEnd)throw e("SecondAbortEvent");if(l.errorIsPendingUpdateEnd)throw e("AbortAfterError");return babelHelpers["extends"]({},l,{abortIsPendingUpdateEnd:!0});default:f.sourceBufferEventType;throw e()}default:l.operationState;throw e()}}(),q=m,r=p.operationState==="succeeded"||p.operationState==="errored"||p.operationState==="aborted",s=p!==l?r?null:p:k.currSourceBufferOperation;r=p!==l&&r?p:k.lastSourceBufferOperation;if(s!==k.currSourceBufferOperation||r!==k.lastSourceBufferOperation){var t,u,v=r!=null&&r.operationType==="append_operation"?r:k.lastAppendOperation,w=r!=null&&r.operationType==="remove_operation"?r:k.lastRemoveOperation,x=k.appendChain;h=r!=null&&r.operationType==="append_operation"&&r.operationState==="succeeded"?r.appendInfo.appendInfoType==="init"?{playheadMinimumTimeSec:h,representationId:r.appendInfo.representationId}:x!=null&&x.playheadMinimumTimeSec>r.appendInfo.segment.mediaTimeRange[1]+j?{playheadMinimumTimeSec:h,representationId:r.appendInfo.representationId}:x!=null?{mediaTail:{mediaTimeSec:r.appendInfo.segment.mediaTimeRange[1],segmentId:r.appendInfo.segment.segmentId},playheadMinimumTimeSec:x.playheadMinimumTimeSec,representationId:x.representationId}:x:x;t=a.config.disableSourceBufferRangesAnnotation?null:ja(k.sourceBufferRangesAnnotated,n,(t=o)==null?void 0:t.segment.mediaTimeRange,(t=o)==null?void 0:t.representationId,c.manifestRepresentationsCount);p=""+l.operationType+(l.operationType==="append_operation"?"/"+L(l.appendInfo):"")+":"+l.operationState+"--"+f.sourceBufferEventType+(f.sourceBufferEventType==="_exception"?"/"+f.exception.name:"")+"-->"+p.operationState+(p.operationState==="wait_updateend"?""+(p.errorIsPendingUpdateEnd?",errorIsPendingUpdateEnd":"")+(p.abortIsPendingUpdateEnd?",abortIsPendingUpdateEnd":""):p.operationState==="errored"?",waitForMediaElementError":"")+(q!=null?",SegmentBufferedInsufficiently":"");u=c.type+":"+((u=c.targetRepresentationId)!=null?u:"no_target_representation")+":";e.push(u+"handleSourceBufferEvent:"+p);v!==k.lastAppendOperation&&e.push(u+"...:lastAppendOperation:"+(v!=null?L(v.appendInfo):"null"));w!==k.lastRemoveOperation&&e.push(u+"...:lastRemoveOperation:"+(w!=null?N(w.removeRange):"null"));h!==x&&e.push(u+"...:appendChain:"+O(x)+"-->"+O(h));return{appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},k,{appendChain:h,currSourceBufferOperation:s,lastAppendOperation:v,lastRemoveOperation:w,lastSourceBufferOperation:r,sourceBufferRanges:(p=n)!=null?p:k.sourceBufferRanges,sourceBufferRangesAnnotated:(e=t)!=null?e:k.sourceBufferRangesAnnotated,workaroundForSegmentBufferedInsufficiently:q!=null&&!c.appendState.workaroundForSegmentBufferedInsufficiently.some(function(a){return a.representationId===q.representationId&&a.segment.segmentId===q.segment.segmentId})?[].concat(c.appendState.workaroundForSegmentBufferedInsufficiently,[q]):c.appendState.workaroundForSegmentBufferedInsufficiently}))}}return null}function ja(a,b,c,d,e){if(b==null)return null;var f=a[0],g=f!=null?f[2]:null;e=Math.max(e,d!=null||g!=null?d!=null&&g!=null?2:1:0);if(e===1&&b.length>0){var h;g=(h=(h=g)!=null?h:d)!=null?h:null;return b.map(function(a){var b=a[0];a=a[1];return[b,a,g]})}else if(e>1&&b.length>0){h=function(){var e=new Set(),h,i,j;for(h=0,i=b.length;h<i;++h)j=b[h],e.add(j[0]),e.add(j[1]);for(h=0,i=a.length;h<i;++h)j=a[h],e.add(j[0]),e.add(j[1]);c!=null&&(e.add(c[0]),e.add(c[1]));j=Array.from(e).sort(function(a,b){return a-b});e=[];var k,l,m;for(h=0,i=j.length-1;h<i;++h){k=j[h];l=j[h+1];if(b.some(function(a){return a[0]<=k&&l<=a[1]})){var n;m=(k+l)/2;g=(n=(n=a.find(function(a){return a[0]<=m&&m<=a[1]}))==null?void 0:n[2])!=null?n:null;g==null&&c!=null&&d!=null&&(g=d);f=e[e.length-1];g==null&&f!=null&&f[1]===k?e[e.length-1]=[f[0],l,f[2]]:f!=null&&f[1]===k&&f[2]===g?e[e.length-1]=[f[0],l,g]:e.push([k,l,g])}}return{v:e}}();if(typeof h==="object")return h.v}else if(a.length>0)return[];else return null}function ka(a){var b=new Map();for(var a=a,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;var g=d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(f);if(b.has(g))continue;b.set(g,f)}return Array.from(b.values())}function la(a,b,c){var d=function(b,c){return a.filter(function(a){return a.lang===b&&a.role===c})},e=[],f=d(b,c);if(f.length===0){var g;g=((g=b)!=null?g:"null")+"+"+((g=c)!=null?g:"null");var h=a.map(function(a){return a.lang});h.includes(b)&&h.unshift(b);h=Array.from(new Set(h));var i=Array.from(new Set(a.map(function(a){return a.role})));for(var j=0;f.length===0&&j<h.length;++j){var k=h[j];for(var l=0;f.length===0&&l<i.length;++l){var m=i[l];if(k!==b||m!==c){var n;e.push((k===b?"sameLang":"lang#"+j)+"+"+(m===c?"sameRole":"role#"+l)+";"+g+"-->"+((n=k)!=null?n:"null")+"+"+((n=m)!=null?n:"null"));f=d(k,m)}}}n=a[0];if(f.length===0&&n!=null){e.push("firstRepresentation;"+g+"-->"+n.representationId+":"+((m=n.lang)!=null?m:"null")+"+"+((k=n.role)!=null?k:"null"));f=[n]}}return{debugFallbacksTried:e,filteredRepresentations:f}}function ma(a,b){a=la(a,b.videoLang,b.videoRole);b=a.debugFallbacksTried;a=a.filteredRepresentations;return{debugFallbacksTried:b,representationsByVariant:ka(a)}}function na(a,b){var c=a.some(function(a){return b==null||d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(a)===b});a=a.filter(function(a){return c?b==null||d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(a)===b:!0});return a}function oa(a,b){a=la(a,b.audioLang,b.audioRole);b=a.debugFallbacksTried;a=a.filteredRepresentations;return{debugFallbacksTried:b,representationsByVariant:a}}function pa(a,b,e,f,g,h,i,j,l,m,n,o,p,q,r){var s,t;s=(s=g.find(function(a){return a.representationId===j}))!=null?s:null;var u,v=s,w=q,x=r;t=(t=n)!=null?t:k;var y=ma(h,t),z=y.debugFallbacksTried;y=y.representationsByVariant;var A=y.map(function(a){return a.representationId}),B=na(y,o);if(z.length>0&&!z.every(function(a){return a.startsWith("lang#0+sameRole;null+null-->")})||B.length===0){var C=R(g);h=R(h);y=R(y);var D=R(B);b(d("nextgendasherr").nextgendasherr(a,B.length===0?"VideoPlayerNextgendashPlaybackLoopRepresentationAllFiltered[video]":"VideoPlayerNextgendashPlaybackLoopRepresentationFallback[video]","%s:%s - No representations for variant, "+(B.length===0?"all filtered":"fallback applied")+". %s %s %s %s %s %s %s %s","video",(b=j)!=null?b:"no_target_representation","selectedVariant="+JSON.stringify(n),"targetVariant="+(t===n?"same":JSON.stringify(t)),"manifestRepresentations="+C,"playableRepresentations="+(h===C?"same":h),"blockedRepresentations="+P(i),"targetVariantRepresentations="+y,"filteredRepresentations="+(D===y?"same":D),"fallbacksTried="+z.join(";")))}C=(b=l)!=null?b:k;h=n!=null&&(t.videoLang!==C.videoLang||t.videoRole!==C.videoRole)||o!=null&&o!==m;if(B.length>0){i=null;if(q==null&&p!=null){y=B.filter(function(a){return(a=p.prefetchedRepresentationIds.includes(a.representationId))!=null?a:!1});if(y.length>0){D=y[0];w={bestRepresentationId:D.representationId,bestRepresentationIsPrefetched:!0,hasMadeInitialDecision:!1,lastEvaluationReason:null};x=p.prefetchStartedAt;i=D;v=D;u="prefetch"}}else{i=(z=B.find(function(a){return a.representationId===(q==null?void 0:q.bestRepresentationId)}))!=null?z:null}l=5e3;b=h||v==null||i==null||r!=null&&d("VideoPlayerNextgendashHostAPI").diffVideoPlayerNextgendashClockstamp(e,r).unixMs>l;if(b){n=f(a,B,q);t=n.bestRepresentation;c("deepEquals")(n.nextABRState,q)||(w=n.nextABRState,x=a.host.clock());t!=null&&t.representationId!==((C=v)==null?void 0:C.representationId)?(v=t,h?u="selected_switch":u="abr_switch"):v!=null?h?u="selected_keep":u="abr_keep":h?u="selected_keep":v!=null?u="keep_prev_no_representation_from_abr":u="null_no_representation_from_abr"}else u==null&&(u="abr_skip")}else v!=null?u="keep_prev":g.length>0?u="null_no_representations_for_variant":u="null_no_representations_in_manifest";return{prevTargetRepresentation:s,targetRepresentation:v,targetRepresentationReason:u,targetVariantRepresentationIds:A,videoABRState:w,videoABRStateClock:x}}function qa(a,b,c,e,f,g,h,i){var j,l;j=(j=c.find(function(a){return a.representationId===g}))!=null?j:null;var m=j;l=(l=i)!=null?l:k;var n=oa(e,l),o=n.debugFallbacksTried;n=n.representationsByVariant;var p=n.map(function(a){return a.representationId}),q=n;if(o.length>0&&!o.every(function(a){return a.startsWith("lang#0+sameRole;null+null-->")})||q.length===0){var r=S(c);e=S(e);n=S(n);var s=S(q);b(d("nextgendasherr").nextgendasherr(a,q.length===0?"VideoPlayerNextgendashPlaybackLoopRepresentationAllFiltered[audio]":"VideoPlayerNextgendashPlaybackLoopRepresentationFallback[audio]","%s:%s - No representations for variant, "+(q.length===0?"all filtered":"fallback applied")+". %s %s %s %s %s %s %s %s","audio",(b=g)!=null?b:"no_target_representation","selectedVariant="+JSON.stringify(i),"targetVariant="+(l===i?"same":JSON.stringify(l)),"manifestRepresentations="+r,"playableRepresentations="+(e===r?"same":e),"blockedRepresentations="+P(f),"targetVariantRepresentations="+n,"filteredRepresentations="+(s===n?"same":s),"fallbacksTried="+o.join(";")))}b=(a=h)!=null?a:k;r=i!=null&&(l.audioLang!==b.audioLang||l.audioRole!==b.audioRole);if(q.length>0){e=q.slice().sort(function(a,b){return b.bandwidth-a.bandwidth}).find(function(a){return!0});e!=null&&e.representationId!==((f=m)==null?void 0:f.representationId)?(m=e,r?n="selected_switch":n="abr_switch"):m!=null?r?n="selected_keep":n="abr_keep":r?n="selected_keep":m!=null?n="keep_prev_no_representation_from_abr":n="null_no_representation_from_abr"}else m!=null?n="keep_prev":c.length>0?n="null_no_representations_for_variant":n="null_no_representations_in_manifest";return{prevTargetRepresentation:j,targetRepresentation:m,targetRepresentationReason:n,targetVariantRepresentationIds:p}}function ra(a,b,c,e,f,g,h,i,j){i=i;var k,l,m,n;if(i.type==="video"){var o;c=pa(a,b,c,function(b,c,f){return d("VideoPlayerNextgendashABR").evaluateVideoPlayerNextgendashABRForVideo(b,c,f,{abrConfig:e.abrConfig,bandwidthDiagnostics:a.host.networkDiagnosticsReadBandwidth(),devicePixelRatio:e.devicePixelRatio,isDocumentHidden:e.isDocumentHidden,mediaDurationSec:(c=(b=e.mediaElementSnapshot)==null?void 0:b.duration)!=null?c:0,playerDimensions:e.playerViewportDimensions,playheadMediaTimeSec:(b=(f=e.mediaElementSnapshot)==null?void 0:f.currentTime)!=null?b:0,prefetchResult:g,sourceBufferBufferedRangesSec:h})},f.manifestRepresentations.video,i.playableRepresentations,i.blockedRepresentations,i.targetRepresentationId,i.prevSelectedMediaVariant,i.prevSelectedVideoQualityDisplayLabel,e.selectedMediaVariant,e.selectedVideoQualityDisplayLabel,g,i.videoABRState,i.videoABRStateClock);k=c.prevTargetRepresentation;m=c.targetRepresentation;l=c.targetRepresentationReason;n=c.targetVariantRepresentationIds;o=c.videoABRState;c=c.videoABRStateClock;if(o!==i.videoABRState){var p;j.push(i.type+":"+((p=i.targetRepresentationId)!=null?p:"no_target_representation")+":videoABRState:"+(((p=o)==null?void 0:p.bestRepresentationId)!==((p=i.videoABRState)==null?void 0:p.bestRepresentationId)?(p=(p=o)==null?void 0:p.bestRepresentationId)!=null?p:"no_best_representation":"best_representation_unchanged")+(((p=o)==null?void 0:p.bestRepresentationIsPrefetched)===!0?"(prefetched)":"")+":"+((p=(p=o)==null?void 0:p.lastEvaluationReason)!=null?p:"?"));i=babelHelpers["extends"]({},i,{videoABRState:o,videoABRStateClock:c})}}else if(i.type==="audio"){p=qa(a,b,f.manifestRepresentations.audio,i.playableRepresentations,i.blockedRepresentations,i.targetRepresentationId,i.prevSelectedMediaVariant,e.selectedMediaVariant);k=p.prevTargetRepresentation;m=p.targetRepresentation;l=p.targetRepresentationReason;n=p.targetVariantRepresentationIds}else{i.type;l="unexpected_stream_type";n=(c=(o=f.manifestRepresentations[i.type])==null?void 0:o.map(function(a){return a.representationId}))!=null?c:[]}if(m==null){var q;i.type==="video"?q=f.manifestRepresentations.video:i.type==="audio"?q=f.manifestRepresentations.audio:i.type;q=(b=q)!=null?b:[];throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopNoTargetRepresentation["+i.type+"]","%s:%s - Unable to select representation ("+l+"). %s",i.type,k!=null?k.representationId:"no_target_representation","manifestRepresentations="+(q.map(function(a){return a.representationId}).join(",")||"none"),"blockedRepresentations="+P(i.blockedRepresentations))}return{prevTargetRepresentation:k,stream:sa(a,i,j,k,m,l,n,e.selectedMediaVariant,e.selectedVideoQualityDisplayLabel),targetRepresentation:m,targetRepresentationReason:l}}function sa(a,b,c,e,f,g,h,i,j){if(f!=null&&f.type!==b.type)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopRepresentationTypeMismatch","Unexpected representation type "+f.type+" for stream of type "+b.type);if((f==null?void 0:f.representationId)!==(e==null?void 0:e.representationId)){c.push(b.type+":"+((a=b.targetRepresentationId)!=null?a:"no_target_representation")+":switchRepresentation:"+g+":"+((c=e==null?void 0:e.representationId)!=null?c:"null")+"->"+((a=f==null?void 0:f.representationId)!=null?a:"null"));return babelHelpers["extends"]({},b,{prevSelectedMediaVariant:i,prevSelectedVideoQualityDisplayLabel:j,targetRepresentationId:(e=f==null?void 0:f.representationId)!=null?e:null,targetRepresentationReason:g,targetVariantRepresentationIds:h})}else return b}function W(a,b,c){for(var e=0,f=a.length;e<f;++e){var g=a[e];if(d("VideoPlayerNextgendashMediaUtils").isWithinRange(g,b[0],c)&&d("VideoPlayerNextgendashMediaUtils").isWithinRange(g,b[1],c))return!0}return!1}function ta(a,b){return W(a,b.mediaTimeRange,1e-5)||b.isEndingSegment&&W(a,b.mediaTimeRange,1e-4)}function ua(a){var b=[],c=a.segmentTimeline,e=a.startNumber;a=a.timescale;var f=c.every(function(a){return a.id!=null}),g=c.length;for(var h=0;h<g;++h){var i=c[h],j=i.r+1;for(var k=0;k<j;++k){var l,m=b.length;l=f&&i.id!=null?i.id-(i.r-k):((l=e)!=null?l:0)+m;var n=i.t+k*i.d;b.push({isEndingSegment:h===g-1&&k===j-1,mediaFileByteRange:d("VideoPlayerNextgendashMediaUtils").ZERO_TO_EOF_OPEN_ENDED_BYTE_RANGE,mediaTimeRange:[(i.t+k*i.d)/a,(i.t+(k+1)*i.d)/a],segmentId:m,templateNumber:l,templateTime:n})}}return b}function X(a,b,c,e){var f=void 0,g=void 0,h=function(a,b){return Math.abs(a-b)>.001};return e.filter(function(i,j){if(g!==void 0&&i.segmentId<=g)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopBadSegmentIdSequenceInSidx","%s:%s - sidx segmentId %s duplicates or decreases from previous %s",b,c,i.segmentId,g);g=i.segmentId;if(i.mediaTimeRange[1]<i.mediaTimeRange[0])throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopFoundNegativeSegmentDurationFromSidx","%s:%s - sidx segmentId %s for time %ss - %ss has negative duration %s",b,c,i.segmentId,i.mediaTimeRange[0],i.mediaTimeRange[1],i.mediaTimeRange[1]-i.mediaTimeRange[0]);if(f!==void 0&&h(i.mediaTimeRange[0],f))throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopFoundNonContinuousMediaTimeRangesFromSidx","%s:%s - sidx segmentId %s start time %s too far from previous segment's end time %s",b,c,i.segmentId,i.mediaTimeRange[0],f);f=i.mediaTimeRange[1];var k=i.mediaTimeRange[1]<=0;if(k&&i.isEndingSegment)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopFoundNonPositiveRepresentationEndTimeFromSidx","%s:%s - sidx segmentId %s isEndingSegment with non-positive end time %s",b,c,i.segmentId,i.mediaTimeRange[1]);if(i.isEndingSegment!==(j===e.length-1))throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopSidxHasBadEndingSegmentFlag","%s:%s - sidx with segment count %s has segmentId %s incorrectly marked as "+(i.isEndingSegment?"ending":"not ending"),b,c,e.length,i.segmentId);return!k})}function va(a,b,c,e,f,g,h,i){if(e.mediaTail==null)return e;var k=e.playheadMinimumTimeSec,l=e.mediaTail.mediaTimeSec;if(k>l+j)throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopIncoherentAppendChain","%s:%s - appendChain.playheadMinimumTimeSec %ss > appendChain.mediaTail.mediaTimeSec %ss",b,c,k,l);if(!d("VideoPlayerNextgendashMediaUtils").isWithinRange([k,l+j],f)){var m={playheadMinimumTimeSec:f,representationId:e.representationId};i.push(b+":"+c+":appendChain:"+O(e)+"-->"+O(m)+"(playhead_outside)");return m}if(Math.abs(l-k)>j){m=[k,Math.max(f,l-j)];if(g===void 0||!W(g,m,0)){k={playheadMinimumTimeSec:f,representationId:e.representationId};i.push(b+":"+c+":appendChain:"+O(e)+"-->"+O(k)+"(GapFoundIn"+N(m)+":ActualBuffered"+(g!=null?M(g):"Unavailable")+":MSEstate="+U(a.host.mediaSourceCollectSnapshot(a,h))+")");return k}}return e}function Y(a,b,c){var d=null,e=null,f=null,g=null,h=null;for(var i=0,j=a.length,k=0;i<j;++i){var l=a[i];l=k+l.byteLength;d==null&&b>=k&&b<l&&(d=i,e=b-k);if(d!=null&&e!=null){f=i;var m=c!=null?Math.min(b+c,l):l;h=m-b;g=m-Math.max(b,k);if(c!=null&&h>=c)break}k=l}return d==null||e==null||f==null||g==null||h==null||h===0?null:{copyTotalBytesCount:h,endChunkBytesCount:g,endChunkIndex:f,startChunkByteOffset:e,startChunkIndex:d}}function wa(a,b){var c=b.startChunkByteOffset,d=b.startChunkIndex,e=b.copyTotalBytesCount,f=b.endChunkBytesCount;b=b.endChunkIndex;var g=null;if(b===d){g=c===0&&f===a[d].byteLength?a[d]:a[d].subarray(c,c+f);return g}while(g==null&&b>d)try{g=new Uint8Array(new ArrayBuffer(e))}catch(h){g=null,e-=f,b--,f=a[b].byteLength-(b===d?c:0)}if(g!=null){e=0;for(var h=d;h<=b;++h){var i=a[h];i=h===d||h===b?i.subarray(h===d?c:0,h===b?f:i.byteLength):i;g.set(i,e);e+=i.byteLength}}return g}function Z(a,b,c,e,f){var g;e=(e=e==null?void 0:e.manifestRepresentations[c.type])!=null?e:[];g=(g=e==null?void 0:e.filter(function(a){return c.blockedRepresentations[a.representationId]==null}))!=null?g:[];var h=null;if(e.length>0&&g.length===0){var i,j=Q(e),k=Q(g);i=["VideoPlayerNextgendashPlaybackLoopBlockedAllRepresentations["+c.type+"]","%s:%s - Blocked all representations: %s %s %s",c.type,(i=c.targetRepresentationId)!=null?i:"no_target_representation","manifestRepresentations="+j,"playableRepresentations="+(k===j?"same":k),"blockedRepresentations="+P(c.blockedRepresentations)];h=f!=null?d("nextgendasherr").nextgendasherrFromCause.apply(void 0,[a,f].concat(i)):d("nextgendasherr").nextgendasherr.apply(void 0,[a].concat(i))}b.push(c.type+":"+((j=c.targetRepresentationId)!=null?j:"no_target_representation")+":playableRepresentations:"+g.length+"-of-"+e.length);if(h!=null){b.push(c.type+":"+((k=c.targetRepresentationId)!=null?k:"no_target_representation")+":streamFatalError:"+h.name)}return babelHelpers["extends"]({},c,{manifestRepresentationsCount:e.length,playableRepresentations:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(g),streamFatalError:(f=h)!=null?f:c.streamFatalError})}function $(a,b,c,e,f,g,h){var i;c.push(e.type+":"+((i=e.targetRepresentationId)!=null?i:"no_target_representation")+":blockedRepresentations+"+g+":"+h.name);b(h);return Z(a,c,babelHelpers["extends"]({},e,{blockedRepresentations:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},e.blockedRepresentations,(i={},i[g]=h,i)))}),f,h)}function xa(a,b,c,e,f,g,h){var i=c.appendState,j=i.pendingRemoveOperations,k=j[0],l=c.sourceBufferState;if(i.currSourceBufferOperation==null&&k!=null&&k.operationState==="wait_start"&&l!=null){var m=f.representationId,n=k.removeRange;g=a.host.mediaSourceGetDuration(a,g);k.removeRange[0]>g&&(k=babelHelpers["extends"]({},k,{removeRange:[0,k.removeRange[1]]}));g={appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},i,{currSourceBufferOperation:k,pendingRemoveOperations:j.slice(1)}))};e.push(c.type+":"+m+":pendingRemoveOperations:currSourceBufferOperation:"+N(k.removeRange)+(k.removeRange!==n?":adjustedFrom="+N(n):""));var o;try{i=V(a,b,{appendState:g.appendState,manifestRepresentationsCount:c.manifestRepresentationsCount,targetRepresentationId:c.targetRepresentationId,type:c.type},e,{debugStreamType:c.type,sourceBuffer:l.sourceBuffer,sourceBufferEventType:"_started",type:"_source_buffer_event"},a.host.clock(),h,function(){return T(a,l)});i!=null&&(g=babelHelpers["extends"]({},g,i));a.host.sourceBufferRemove(a,l.sourceBuffer,{mimeCodecsParsed:f.mimeCodecsParsed,removeRange:k.removeRange,representationId:m,type:c.type})}catch(b){o=d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashPlaybackLoopSourceBufferRemoveException")}if(o!=null){j=V(a,b,{appendState:g.appendState,manifestRepresentationsCount:c.manifestRepresentationsCount,targetRepresentationId:c.targetRepresentationId,type:c.type},e,{debugStreamType:c.type,exception:o,sourceBuffer:l.sourceBuffer,sourceBufferEventType:"_exception",type:"_source_buffer_event"},a.host.clock(),h,function(){return T(a,l)});j!=null&&(g=babelHelpers["extends"]({},g,j))}return g}return null}function ya(a,b,c,e,f,g,h){var i=c.appendState,j=i.pendingRemoveOperations,k=i.pendingAppendOperations,l=k[0],m=c.sourceBufferState;f=f.representationId;if(i.currSourceBufferOperation==null&&j.length<=0&&l!=null&&l.operationState==="wait_start"&&m!=null){var n;j=l.appendInfo;if(j.appendInfoType!=="init"&&((n=i.appendChain)==null?void 0:n.representationId)!==j.representationId){throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashPlaybackLoopDataRepresentationIdMismatchesLastInit","%s: Dequeued append operation appendInfoType %s representationId %s mismatches last init segment representationId %s, targetRepresentationId %s",c.type,j.appendInfoType,j.representationId,(n=i.appendChain)==null?void 0:n.representationId,f)}i={appendState:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},c.appendState,{currSourceBufferOperation:l,pendingAppendOperations:k.slice(1)})),sourceBufferState:m};e.push(c.type+":"+f+":pendingAppendOperations:currSourceBufferOperation:"+L(l.appendInfo));if(j.appendInfoType==="data"&&j.dataByteRangeLength===0){n=V(a,b,{appendState:i.appendState,manifestRepresentationsCount:c.manifestRepresentationsCount,targetRepresentationId:c.targetRepresentationId,type:c.type},e,{debugStreamType:c.type,sourceBuffer:m.sourceBuffer,sourceBufferEventType:"_finished",type:"_source_buffer_event"},a.host.clock(),g,function(){return T(a,m)});n!=null&&(i=babelHelpers["extends"]({},i,n))}else{var o;try{k=V(a,b,{appendState:i.appendState,manifestRepresentationsCount:c.manifestRepresentationsCount,targetRepresentationId:c.targetRepresentationId,type:c.type},e,{debugStreamType:c.type,sourceBuffer:m.sourceBuffer,sourceBufferEventType:"_started",type:"_source_buffer_event"},a.host.clock(),g,function(){return T(a,m)});k!=null&&(i=babelHelpers["extends"]({},i,k));j.appendInfoType==="init"&&(e.push(c.type+":"+f+":abort:MSEbefore="+U(a.host.mediaSourceCollectSnapshot(a,h))),a.host.sourceBufferAbort(a,m.sourceBuffer,{mimeCodecsParsed:j.mimeCodecsParsed,representationId:j.representationId,type:c.type}));n=j.mimeCodecsParsed;k=m.sourceBufferMimeCodecsParsed;var p=n.contentType!==k.contentType,q=n.containerType!==k.containerType;n=n.codecFamily!==k.codecFamily;(p||q||n)&&(e.push(c.type+":"+f+":sourceBufferState:changeType:"+d("VideoPlayerNextgendashMediaUtils").debugStringifyMimeCodecs(m.sourceBufferMimeCodecsParsed)+"-->"+d("VideoPlayerNextgendashMediaUtils").debugStringifyMimeCodecs(j.mimeCodecsParsed)+":MSEbefore="+U(a.host.mediaSourceCollectSnapshot(a,h))),a.host.sourceBufferChangeType(a,m.sourceBuffer,{mimeCodecsParsed:j.mimeCodecsParsed,mimeCodecsParsedBeforeChangeType:m.sourceBufferMimeCodecsParsed,representationId:j.representationId,type:c.type}),m=babelHelpers["extends"]({},m,{sourceBufferMimeCodecsParsed:j.mimeCodecsParsed}),i=babelHelpers["extends"]({},i,{sourceBufferState:m}));e.push(c.type+":"+f+":append:MSEbefore="+U(a.host.mediaSourceCollectSnapshot(a,h)));a.host.sourceBufferAppendBuffer(a,h,m.sourceBuffer,l.buffer,{mimeCodecsParsed:j.mimeCodecsParsed,representationId:j.representationId,type:c.type})}catch(b){o=d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashPlaybackLoopSourceBufferAppendException")}if(o!=null){k=V(a,b,{appendState:i.appendState,manifestRepresentationsCount:c.manifestRepresentationsCount,targetRepresentationId:c.targetRepresentationId,type:c.type},e,{debugStreamType:c.type,exception:o,sourceBuffer:m.sourceBuffer,sourceBufferEventType:"_exception",type:"_source_buffer_event"},a.host.clock(),g,function(){return T(a,m)});k!=null&&(i=babelHelpers["extends"]({},i,k))}}return i}return null}g.originalMediaVariant=k;g.VideoPlayerNextgendashPlaybackLoopSM=a;g.addByteRangeParamsToURL=m;g.internal_substituteParamsInSegmentURLTemplate=n;g.internal_coalesceAdjacentDebugLogLines=v;g.makeSegmentFetchDataKey=G;g.findDataForDataKey=H;g.debugPrepareFetchDemands=J;g.internal_handleSourceBufferEvent=V;g.internal_updateSourceBufferRangesAnnotated=ja;g.internal_filterVideoRepresentationsByVariant=ma;g.internal_filterVideoRepresentationsByQuality=na;g.internal_filterAudioRepresentationsByVariant=oa;g.internal_selectTargetVideoRepresentation=pa;g.internal_selectTargetAudioRepresentation=qa;g.internal_checkRangeBufferedWithoutGap=W;g.internal_makeSidxFromSegmentTemplate=ua;g.internal_validateAndNormalizeSidx=X;g.internal_selectDataChunksToAppend=Y;g.internal_combineDataChunksIntoContiguousBuffer=wa;g.internal_blockRepresentationInStream=$;g.internal_startPendingRemoveOperation=xa;g.internal_startPendingAppendOperation=ya}),98);
__d("VideoPlayerNextgendashWorkerPrefetchCache",["Promise","VideoPlayerNextgendashABR","VideoPlayerNextgendashManifestParser","VideoPlayerNextgendashMediaUtils","VideoPlayerNextgendashPlaybackLoop","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function j(a){var b=i.get(a);b||(b=new Map(),i.set(a,b));return b}function a(a,b,c){try{var e=j(b.prefetchKey);if(e.size>0)return;var f=a.host.networkDiagnosticsReadBandwidth();l(a,e,b.representations,c.devicePixelRatio,c.isDocumentHidden,c.prefetchResolutionThreshold,(f=f)!=null?f:c.bandwidthDiagnostics,c.abrConfig);k(a,e,b.representations)}catch(b){a.logging.log(a,{error:d("nextgendasherr").nextgendasherrFromCause(a,b,"VideoPlayerNextgendashInitiatePrefetchException"),type:"generic_error_as_warning"})}}function k(a,b,c){c=c.find(function(a){return a.mimeType.indexOf("audio")>-1});if(c==null)return;t(a,b,c)}function l(a,b,c,d,e,f,g,h){c=c.filter(function(a){return a.mimeType.indexOf("video")>-1});c=q(a,c,d,f);if(c.length===0)return;c.sort(function(a,b){return a.bandwidth-b.bandwidth});f=c[0];c=o(a,c,d,e,g,h);e=(d=c)!=null?d:f;t(a,b,e)}var m=500,n=400;function o(a,b,c,e,f,g){var h=b.map(function(a){return p(a)}),i={height:m,width:n};a=d("VideoPlayerNextgendashABR").evaluateVideoPlayerNextgendashABRForVideo(a,h,null,{abrConfig:g,bandwidthDiagnostics:f,devicePixelRatio:c,isDocumentHidden:e,mediaDurationSec:NaN,playerDimensions:i,playheadMediaTimeSec:0,prefetchResult:null,sourceBufferBufferedRangesSec:[]});if(a.bestRepresentation==null)return null;var j=d("VideoPlayerNextgendashManifestParser").unopaqueVideoPlayerNextgendashManifestRepresentationId(a.bestRepresentation.representationId);h=b.find(function(a){return a.representationID===j});return h}function p(a){return{abrPolicyTags:[],bandwidth:a.bandwidth,contentProtections:void 0,height:a.height,lang:null,mimeCodecsParsed:d("VideoPlayerNextgendashMediaUtils").parseMimeCodecs(d("VideoPlayerNextgendashMediaUtils").combineMimeTypeAndCodecs(a.mimeType,a.codecs)),playbackResolutionCsvqmScoreCurve:a.playbackResolutionCSVQM,playbackResolutionMosScoreCurve:a.playbackResolutionMOS,qualityLabel:null,representationId:d("VideoPlayerNextgendashManifestParser").makeVideoPlayerNextgendashOpaqueManifestRepresentationId(a.representationID),role:null,segmentsInfo:{baseURL:a.baseURL,indexByteRange:{byteLength:1,byteOffset:0},initByteRange:{byteLength:1,byteOffset:1},type:"SegmentBase"},type:"video",variantKey:null,width:a.width}}function q(a,b,c,e){b=b.filter(function(b){return a.host.mediaSourceIsTypeSupported(d("VideoPlayerNextgendashMediaUtils").combineMimeTypeAndCodecs(b.mimeType,b.codecs))});var f=b.filter(function(a){a=Math.min(a.width,a.height);return a/c<=e});return f.length>0?f:b.length>0?[b[0]]:[]}function r(a,b,c){var d=a.get(b);if(!d)return;a.set(b,babelHelpers["extends"]({},d,{resultState:c}))}function s(a,c,e,f){var g=new AbortController(),i=new(h||(h=b("Promise")))(function(b){a.host.fetch(a,e,{signal:g.signal}).then(function(a){a={response:a,resultState:"has_response"};r(c,e,a);b(a)})["catch"](function(f){f={error:d("nextgendasherr").nextgendasherrFromFetchRejection(a,f,"VideoPlayerNextgendashPrefetchRejection"),resultState:"errored"};r(c,e,f);b(f)})});c.set(e,{abortController:g,representationID:f,resultState:{resultPromise:i,resultState:"pending"}})}function t(a,b,c){c.segments.forEach(function(e){e=d("VideoPlayerNextgendashPlaybackLoop").addByteRangeParamsToURL(a,c.baseURL,d("VideoPlayerNextgendashMediaUtils").makeByteRangeFromStartEndByteIndex(a,e.start,e.end));s(a,b,e,c.representationID)})}function c(a,b){b=i.get(b);var c=[];b==null?void 0:b.forEach(function(a){a=a.representationID;c.indexOf(a)===-1&&c.push(a)});return c.length>0?{prefetchedRepresentationIds:c,prefetchStartedAt:a.host.clock()}:null}function e(a,b){a=i.get(a);var c=null;a&&(c=a.get(b),c&&a["delete"](b));return c}g.internal_getOrAddPrefetchCacheEntry=j;g.initiatePrefetch=a;g.internal_startFetchForPrefetch=s;g.getCachedRepresentationsForPrefetchKey=c;g.getCachedValueForPrefetchKeyAndURL=e}),98);
__d("VideoPlayerNextgendashMediaElement",["VideoPlayerNextgendashMediaUtils","VideoPlayerNextgendashStateMachine","clearTimeout","deepEquals","nextgendasherr","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(){return{isBuffering:!1,isBufferingInitial:!0,lastNonZeroNonErrorCurrentTimeSec:null,mediaElement:null,mediaElementSnapshot:null,mediaElementSnapshotBeforeErrorOccurred:null,mediaElementSnapshotClock:null,mediaElementUnsubscribe:null,mediaSource:null,mediaSourceHandle:null,mediaSourceIndex:null,playheadLastMovedClock:null,playheadWatchdogTimer:null,state:"idle"}},function(a){var b=a.args,e=b.getWorkaroundForSegmentBufferedInsufficientlyMediaTimeRanges,f=b.logPlayerWarning,g=b.onBufferingChanged;b=b.onMediaSourceAttachedChanged;var j=a.env,k=a.event,l=a.eventClock,m=a.sendToSelf,n=a.state;a=a.thisName;var o=function(){m({type:"_playhead_watchdog"})},p=function(b,c,e){var a=n.mediaElement;if(a==null)return;j.host.mediaElementSetPlayhead(j,a,b);f(d("nextgendasherr").nextgendasherr(j,"VideoPlayerNextgendashMediaElementSkippedBufferGap","Buffers: %s, playhead: %s, skipped to: %s, reason: %s",JSON.stringify(c.buffered),c.currentTime,b,e))};switch(n.state){case"idle":switch(k.type){case"__enter":return;case"__exception":return;case"__dispose":return;case"update_media_element":var q,r=n.mediaElement,s=n.mediaElementUnsubscribe;q=(q=k.mediaElement)!=null?q:null;if(q===r){j.logging.log(j,{format:"["+a+"] Ignored "+k.type+" with the same mediaElement=%s",params:[r],type:"generic_info"});return}else{s&&s();r!=null&&j.host.mediaElementSetSource(j,r,null);a=null;q!=null&&(a=j.host.mediaElementSubscribe(j,q,["durationchange","ended","error","pause","play","playing","progress","ratechange","seeked","seeking","timeupdate","volumechange","waiting"],function(a){var b=a.domEventAdjustedClock,c=a.domEventType;a=a.eventTarget;a=j.host.mediaElementCollectSnapshot(j,a);m({domEventAdjustedClock:b,domEventType:c,mediaElementSnapshot:a,type:"_media_element_event"})}),n.mediaSourceHandle?j.host.mediaElementSetSource(j,q,{mediaSourceHandle:n.mediaSourceHandle},n.lastNonZeroNonErrorCurrentTimeSec!=null&&n.lastNonZeroNonErrorCurrentTimeSec!==0?{playheadMediaTimeSec:n.lastNonZeroNonErrorCurrentTimeSec}:void 0):n.mediaSource?j.host.mediaElementSetSource(j,q,{mediaSource:n.mediaSource},n.lastNonZeroNonErrorCurrentTimeSec!=null&&n.lastNonZeroNonErrorCurrentTimeSec!==0?{playheadMediaTimeSec:n.lastNonZeroNonErrorCurrentTimeSec}:void 0):j.host.mediaElementSetSource(j,q,null));s=q!=null?j.host.mediaElementCollectSnapshot(j,q):null;r=l;return babelHelpers["extends"]({},i(n,l,s,null,g),h(j,n,o,e,p,b,s,r,k.type),{mediaElement:q,mediaElementUnsubscribe:a})}case"update_media_source":s=n.mediaElement;s!=null&&(k.mediaSourceHandle?j.host.mediaElementSetSource(j,s,{mediaSourceHandle:k.mediaSourceHandle},n.lastNonZeroNonErrorCurrentTimeSec!=null&&n.lastNonZeroNonErrorCurrentTimeSec!==0?{playheadMediaTimeSec:n.lastNonZeroNonErrorCurrentTimeSec}:void 0):k.mediaSource?j.host.mediaElementSetSource(j,s,{mediaSource:k.mediaSource},n.lastNonZeroNonErrorCurrentTimeSec!=null&&n.lastNonZeroNonErrorCurrentTimeSec!==0?{playheadMediaTimeSec:n.lastNonZeroNonErrorCurrentTimeSec}:void 0):j.host.mediaElementSetSource(j,s,null));r=n.mediaElement!=null?j.host.mediaElementCollectSnapshot(j,n.mediaElement):null;q=l;return babelHelpers["extends"]({},i(n,l,r,null,g),h(j,n,o,e,p,b,r,q,k.type),{mediaSource:(a=k.mediaSource)!=null?a:null,mediaSourceHandle:(s=k.mediaSourceHandle)!=null?s:null,mediaSourceIndex:(r=k.mediaSourceIndex)!=null?r:null});case"_media_element_event":if(n.mediaElementSnapshotClock!=null&&k.domEventAdjustedClock.unixMs<=n.mediaElementSnapshotClock.unixMs)return;q=k.mediaElementSnapshot;if(c("deepEquals")(q,n.mediaElementSnapshot))return;a=k.domEventAdjustedClock;return babelHelpers["extends"]({},i(n,l,q,k,g),h(j,n,o,e,p,b,q,a,k.type+":"+k.domEventType));case"_playhead_watchdog":s=n.mediaElement!=null?j.host.mediaElementCollectSnapshot(j,n.mediaElement):null;r=l;return babelHelpers["extends"]({},i(n,l,s,null,g),h(j,n,o,e,p,b,s,r,k.type));default:k.type;return}case"__disposed__":switch(k.type){case"__enter":q=k.prevState;a=q.mediaElement;l=q.mediaElementUnsubscribe;l&&l();a!=null&&j.host.mediaElementSetSource(j,a,null);return;default:return}default:n.state}});function h(a,b,e,f,g,h,i,j,k){var l=b.mediaElement,m=b.mediaElementSnapshot,n=b.playheadLastMovedClock,o=b.playheadWatchdogTimer;o!=null&&c("clearTimeout")(o);var p=(o=i==null?void 0:i.currentTime)!=null?o:0;o=(o=m==null?void 0:m.currentTime)!=null?o:0;var q=200,r=p===o,s=i!=null&&i.error==null&&!i.seeking&&!i.paused&&!i.ended&&i.buffered.length>0;o=p!==o||i!=null&&m==null?j:null;f=f();if(l!=null&&i!=null&&f!=null&&r&&n!=null&&j.perfMs-n.perfMs>=q&&s&&f.some(function(a){return d("VideoPlayerNextgendashMediaUtils").isWithinRange(a,p,0)})&&!i.buffered.some(function(a){return d("VideoPlayerNextgendashMediaUtils").isWithinRange(a,p,0)})){q=(l=i.buffered.find(function(a){return a[0]>p}))==null?void 0:l[0];q!=null&&g(q,i,k+":SegmentBufferedInsufficiently")}f=200;l=r&&(s||(i==null?void 0:i.seeking)===!0||(i==null?void 0:i.buffered.length)===0)?c("setTimeout")(e,f):null;k=(q=(g=o)!=null?g:n)!=null?q:null;var t=(r=i==null?void 0:i.mediaSourceAttached)!=null?r:!1;e=(s=m==null?void 0:m.mediaSourceAttached)!=null?s:!1;t!==e&&a.workQueue.enqueueWork(function(){h(j,t)});return{lastNonZeroNonErrorCurrentTimeSec:i!=null&&i.error==null&&i.currentTime!=null&&i.currentTime!==0?i.currentTime:b.lastNonZeroNonErrorCurrentTimeSec,mediaElementSnapshot:i,mediaElementSnapshotBeforeErrorOccurred:i==null||m==null?b.mediaElementSnapshotBeforeErrorOccurred:m.error==null&&i.error!=null?m:m.error!=null&&i.error==null?null:b.mediaElementSnapshotBeforeErrorOccurred,mediaElementSnapshotClock:j,playheadLastMovedClock:k,playheadWatchdogTimer:l}}function i(a,b,c,d,e){var f=a.isBuffering,g=a.isBufferingInitial&&((d==null?void 0:d.domEventType)==="play"||(d==null?void 0:d.domEventType)==="playing"||(c==null?void 0:c.paused)===!1)?!1:a.isBufferingInitial;a.isBuffering?(c==null||c.paused||j(c,"high"))&&(f=!1):c!=null&&!c.paused&&!j(c,"low")&&(f=!0);if(!a.isBuffering&&f||a.isBuffering&&!f){e((c=d==null?void 0:d.domEventAdjustedClock)!=null?c:b,f,g)}return babelHelpers["extends"]({},a,{isBuffering:f,isBufferingInitial:g})}function j(a,b){var c=.1,d=1,e=.2,f=a.currentTime,g=a.duration,h=null;for(var i=0;i<a.buffered.length;i++){var j=a.buffered[i];if(j[0]<=f&&f<=j[1]){h=j;break}}j=h!=null&&Math.abs(h[1]-g)<=e||Math.abs(f-g)<=e;i={high:d,low:c}[b];return j||h!=null&&h[1]-f>i}g.VideoPlayerNextgendashMediaElementSM=a}),98);
__d("VideoPlayerNextgendashParsedManifest",["VideoPlayerNextgendashManifestParser","VideoPlayerNextgendashStateMachine","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(){return{dashManifestXmlString:null,state:"not_parsed"}},function(a){var b=a.args.audioOnly,c=a.env,e=a.event,f=a.sendToSelf;a=a.state;if(a.state==="__disposed__")return;switch(e.type){case"__enter":return;case"__exception":return;case"__dispose":return;case"parse_dash_manifest_xml":var g=e.dashManifestXmlString;if(g==null)return{dashManifestXmlString:null,state:"not_parsed"};else if(a.dashManifestXmlString!==g){try{var h=c.host.parseXML(c,g),i,j;try{i=d("VideoPlayerNextgendashManifestParser").parseMPD(c,h,{audioOnly:b})}catch(a){j=a}i!=null?f({dashManifestXml:h,data:i,type:"_parse_succeeded"}):f({dashManifestXml:h,error:d("nextgendasherr").nextgendasherrFromCause(c,j,"VideoPlayerNextgendashParsedManifestMPDParseError"),type:"_parse_failed"})}catch(a){f({dashManifestXml:null,error:d("nextgendasherr").nextgendasherrFromCause(c,a,"VideoPlayerNextgendashParsedManifestXMLParseError"),type:"_parse_failed"})}return babelHelpers["extends"]({},a,{dashManifestXmlString:g})}else return;case"_parse_succeeded":return{dashManifestXml:e.dashManifestXml,dashManifestXmlString:a.dashManifestXmlString,data:e.data,state:"parsed"};case"_parse_failed":return{dashManifestXml:e.dashManifestXml,dashManifestXmlString:a.dashManifestXmlString,error:e.error,state:"failed_to_parse"};default:e.type;return}});g.VideoPlayerNextgendashParsedManifestSM=a}),98);
__d("VideoPlayerNextgendashMain",["VideoPlayerNextgendashConnectionMainToWorker","VideoPlayerNextgendashFetchedResource","VideoPlayerNextgendashMediaElement","VideoPlayerNextgendashParsedManifest","VideoPlayerNextgendashStateMachine","deepEquals","emptyFunction","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return{abrConfig:a.abrConfig,configFromMain:b,dashManifestData:a.state==="linked_to_worker"&&a.dashManifestParsed.state.state==="parsed"?a.dashManifestParsed.state.data:null,devicePixelRatio:(b=window.devicePixelRatio)!=null?b:1,isDocumentHidden:document.hidden,mediaElementSnapshot:(b=a.mediaElement.state.mediaElementSnapshot)!=null?b:null,mediaSourceIndexApplied:(b=a.mediaElement.state.mediaSourceIndex)!=null?b:null,playerViewportDimensions:a.playerViewportDimensions,selectedMediaVariant:a.selectedMediaVariant,selectedVideoQualityDisplayLabel:a.selectedVideoQualityDisplayLabel,shouldSendPlayerStateForDebug:a.shouldSendPlayerStateForDebug}}a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(a){var b=a.args,c=b.abrConfig,e=b.audioOnly,f=b.onBufferingChanged,g=b.onMediaSourceAttachedChanged,h=b.playerViewportDimensionsInitial;b=b.workerTypeInitial;var i=a.makeChildSm,j=a.sendToSelf,k=a.thisSm;return{abrConfig:c,audioOnly:e,dashManifestFromUrl:null,dashManifestFromUrlRequestIndex:0,dashManifestParsed:i("dashManifestParsed",d("VideoPlayerNextgendashParsedManifest").VideoPlayerNextgendashParsedManifestSM,{audioOnly:e,onTransitioned:function(a,b,c){j({fromState:a,toState:b,type:"_dash_manifest_parsed_transitioned"},c)}}),mediaElement:i("mediaElement",d("VideoPlayerNextgendashMediaElement").VideoPlayerNextgendashMediaElementSM,{getWorkaroundForSegmentBufferedInsufficientlyMediaTimeRanges:function(){var a;return(a=k.state.playerStateFromWorker)==null?void 0:a.workaroundForSegmentBufferedInsufficientlyMediaTimeRanges},logPlayerWarning:function(a){j({type:"_log_player_warning",warning:a})},onBufferingChanged:f,onMediaSourceAttachedChanged:g,onTransitioned:function(a,b,c){j({type:"_media_element_transitioned"},c)}}),pendingEvents:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject([]),playerViewportDimensions:h,selectedMediaVariant:null,selectedVideoQualityDisplayLabel:null,shouldSendPlayerStateForDebug:!1,state:"waiting_worker_connection",workerType:b}},function(a){var b=a.args,e=b.nextgendashInstanceIndex,f=b.onError,g=b.onManifestUpdated,m=b.onSendHaltedToWorkerChanged,n=b.onVideoRepresentationChanged,o=b.playerInstanceKey,p=b.playerSubOrigin,q=b.prefetchResultInitial;b=b.videoFBID;var r=a.env,s=a.event,t=a.makeChildSm,u=a.sendToOther,v=a.sendToSelf,w=a.state,x=a.unexpectedEvent;if(w.state!=="__disposed__"&&s.type==="debug_config")return babelHelpers["extends"]({},w,{shouldSendPlayerStateForDebug:s.shouldSendPlayerStateForDebug});if(w.state!=="__disposed__"&&s.type==="_log_player_warning"){y(s.warning);return w}if(w.state!=="__disposed__"&&s.type==="update_player_viewport_dimensions")return babelHelpers["extends"]({},w,{playerViewportDimensions:s.playerViewportDimensions});function y(a){if(w.state==="__disposed__")return;r.logging.log(r,{error:d("nextgendasherr").nextgendasherrFromCause(r,a,"VideoPlayerNextgendashMainWith"+w.workerType),type:"generic_error_as_warning"})}function z(a){a=d("VideoPlayerNextgendashConnectionMainToWorker").connectToWorker(r,a,o,function(a){v(a)});m==null?void 0:m(a.sendHaltedToWorker);return a}function A(a,b){m==null?void 0:m(null),a.sendToWorker({eventToWorker:{playerInstanceKey:o,type:"from_main_to_worker_unlink_player"},type:"send_to_worker"}),a.disconnectFromWorker(b)}function B(a){if(w.state!=="__disposed__"&&(w.workerType==="RealWorker"||w.workerType==="RealWorkerV2")){var b=d("nextgendasherr").nextgendasherrFromCause(r,a,"VideoPlayerNextgendashMainWith"+w.workerType+"/FallbackToVirtualWorker","Fallback to VirtualWorker from "+w.workerType);r.logging.log(r,{error:b,type:"generic_error"});w.playerStateForDebug;w.playerStateFromMainSent;w.playerStateFromWorker;var c=w.workerConnection,e=babelHelpers.objectWithoutPropertiesLoose(w,["playerStateForDebug","playerStateFromMainSent","playerStateFromWorker","workerConnection"]);c!=null&&A(c,b);return babelHelpers["extends"]({},e,{pendingEvents:(c=e.pendingEvents)!=null?c:[],state:"waiting_worker_connection",workerType:"VirtualWorker"})}else throw a}function C(a,b,c,d){d=d!=null?{mediaSourceHandle:d,mediaSourceIndex:b,type:"update_media_source"}:c!=null?{mediaSource:c,mediaSourceIndex:b,type:"update_media_source"}:null;if(d==null)throw x("throw","Expected either mediaSourceHandle or mediaSource from Worker.");u(a,d)}function D(a,b){var c=(a=a==null?void 0:a.targetRepresentationId.video)!=null?a:null,d=(a=b==null?void 0:b.targetRepresentationId.video)!=null?a:null;d!==c&&r.workQueue.enqueueWork(function(){n(c,d)})}switch(w.state){case"waiting_worker_connection":switch(s.type){case"__enter":a=z(w.workerType);a.sendToWorker({eventToWorker:{nextgendashInstanceIndex:e,playerInstanceKey:o,playerStateFromMain:h(w,r.config),playerSubOrigin:p,prefetchKey:b,prefetchResultInitial:q,type:"from_main_to_worker_link_player",videoFBID:b},type:"send_to_worker"});return babelHelpers["extends"]({},w,{state:"waiting_linked_to_worker",workerConnection:a});case"__exception":return B(s.exception);case"__dispose":return;case"debug_config":return;case"update_player_viewport_dimensions":return;default:s.type;w.pendingEvents.push(s);return w}case"waiting_linked_to_worker":switch(s.type){case"__enter":z=w.pendingEvents.reduce(function(a,b){b.type==="from_worker_to_main_player_new_media_source"||b.type==="from_worker_to_main_player_unlinked"||b.type==="from_worker_to_main_player_warning"||b.type==="from_worker_to_main_player_fatal_error"||b.type==="debug_config"||b.type==="update_player_viewport_dimensions"?a.thisStatePendingEvents.push(b):a.nextStatePendingEvents.push(b);return a},{nextStatePendingEvents:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject([]),thisStatePendingEvents:[]});e=z.nextStatePendingEvents;p=z.thisStatePendingEvents;p.forEach(function(a){v(a)});return babelHelpers["extends"]({},w,{pendingEvents:e});case"__exception":return B(s.exception);case"__dispose":return;case"debug_config":return;case"update_player_viewport_dimensions":return;case"from_worker_to_main_player_new_media_source":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;C(w.mediaElement,s.mediaSourceIndex,s.mediaSource,s.mediaSourceHandle);q=w.pendingEvents;b=babelHelpers.objectWithoutPropertiesLoose(w,["pendingEvents"]);q.forEach(function(a){v(a)});return babelHelpers["extends"]({},b,{playerStateForDebug:i(s.playerStateForDebug,w.mediaElement.state.mediaElementSnapshot),playerStateFromMainSent:null,playerStateFromWorker:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(s.playerStateFromWorker),state:"linked_to_worker"});case"from_worker_to_main_player_unlinked":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;v({exception:s.exceptionSnapshot!=null?d("nextgendasherr").nextgendasherrFromCause(r,d("nextgendasherr").nextgendasherrFromSnapshot(s.exceptionSnapshot),"VideoPlayerNextgendashMainUnexpectedUnlinkedBeforeLinked"):d("nextgendasherr").nextgendasherr(r,"VideoPlayerNextgendashMainUnexpectedUnlinkedBeforeLinked"),type:"__exception"});return;case"from_worker_to_main_player_warning":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;y(d("nextgendasherr").nextgendasherrFromSnapshot(s.warningErrorSnapshot));return;case"from_worker_to_main_player_fatal_error":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;v({exception:d("nextgendasherr").nextgendasherrFromCause(r,d("nextgendasherr").nextgendasherrFromSnapshot(s.errorSnapshot),"VideoPlayerNextgendashMainFatalFromWorkerPlayerBeforeLinked"),type:"__exception"});return;default:s.type;w.pendingEvents.push(s);return w}case"linked_to_worker":switch(s.type){case"__enter":D(s.prevState.playerStateFromWorker,w.playerStateFromWorker);return;case"__exception":return;case"__dispose":return;case"_dash_manifest_from_url_transitioned":return k(r,s.fromState,s.toState,w.dashManifestParsed,v,u);case"_dash_manifest_parsed_transitioned":return l(r,s.fromState,s.toState,v,g);case"_media_element_transitioned":return j(r,o,w);case"debug_config":return;case"update_player_viewport_dimensions":return;case"update_dash_manifest":a=s.dashManifestUrl;z=s.dashManifestXmlString;if(z!=null){u(w.dashManifestParsed,{dashManifestXmlString:z,type:"parse_dash_manifest_xml"});return babelHelpers["extends"]({},w,{dashManifestFromUrl:null})}else{p=w.dashManifestFromUrlRequestIndex;e=null;if(a!=null){p+=1;q={qplName:"dash_manifest_from_url",requestCreatedClock:r.host.clock(),requestID:"dash_manifest_from_url_"+p,requestInfo:a,responseMode:"text"};e=t("dashManifestFromUrl",d("VideoPlayerNextgendashFetchedResource").VideoPlayerNextgendashFetchedResourceSM,{onNetworkDiagnostics:c("emptyFunction"),onTransitioned:function(a,b,c){v({fromState:a,toState:b,type:"_dash_manifest_from_url_transitioned"},c)},request:q});u(e,{type:"start"})}return babelHelpers["extends"]({},w,{dashManifestFromUrl:e,dashManifestFromUrlRequestIndex:p})}case"_send_state_to_worker":return j(r,o,w);case"update_media_element":u(w.mediaElement,{mediaElement:s.mediaElement,type:"update_media_element"});return;case"update_config_from_env":return j(r,o,w);case"select_video_quality":return j(r,o,babelHelpers["extends"]({},w,{selectedVideoQualityDisplayLabel:s.videoQualityDisplayLabel}));case"select_media_variant":return j(r,o,babelHelpers["extends"]({},w,{selectedMediaVariant:s.mediaVariant}));case"debug_log_stall_details":w.workerConnection.sendToWorker({eventToWorker:{mediaElementSnapshotFromMain:w.mediaElement.state.mediaElementSnapshot,playerInstanceKey:o,stallStartClock:s.stallStartClock,type:"from_main_to_worker_debug_log_stall_details"},type:"send_to_worker"});return;case"from_worker_to_main_player_new_media_source":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;C(w.mediaElement,s.mediaSourceIndex,s.mediaSource,s.mediaSourceHandle);b=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(s.playerStateFromWorker);D(w.playerStateFromWorker,b);return babelHelpers["extends"]({},w,{playerStateForDebug:i(s.playerStateForDebug,w.mediaElement.state.mediaElementSnapshot),playerStateFromWorker:b});case"from_worker_to_main_player_unlinked":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;g=s.exceptionSnapshot!=null?d("nextgendasherr").nextgendasherrFromCause(r,d("nextgendasherr").nextgendasherrFromSnapshot(s.exceptionSnapshot),"VideoPlayerNextgendashMainUnexpectedUnlinkedFromWorker","Reason: "+s.reason):d("nextgendasherr").nextgendasherr(r,"VideoPlayerNextgendashMainUnexpectedUnlinkedFromWorker","Reason: "+s.reason);if((w.workerType==="RealWorker"||w.workerType==="RealWorkerV2")&&!r.config.disableFallbackFromRealWorkerAfterLinked)return B(g);else{v({exception:g,type:"__exception"});return}case"from_worker_to_main_player_warning":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;y(d("nextgendasherr").nextgendasherrFromSnapshot(s.warningErrorSnapshot));z=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(s.playerStateFromWorker);D(w.playerStateFromWorker,z);return babelHelpers["extends"]({},w,{playerStateForDebug:i(s.playerStateForDebug,w.mediaElement.state.mediaElementSnapshot),playerStateFromWorker:z});case"from_worker_to_main_player_fatal_error":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;v({exception:d("nextgendasherr").nextgendasherrFromCause(r,d("nextgendasherr").nextgendasherrFromSnapshot(s.errorSnapshot),"VideoPlayerNextgendashMainFatalFromWorkerPlayer"),type:"__exception"});a=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(s.playerStateFromWorker);D(w.playerStateFromWorker,a);return babelHelpers["extends"]({},w,{playerStateForDebug:i(s.playerStateForDebug,w.mediaElement.state.mediaElementSnapshot),playerStateFromWorker:a});case"from_worker_to_main_playback_loop_state":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;t=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(s.playerStateFromWorker);D(w.playerStateFromWorker,t);return babelHelpers["extends"]({},w,{playerStateFromWorker:t});case"from_worker_to_main_player_state_for_debug":if(s.workerType!==w.workerType||s.playerInstanceKey!==o)return;return babelHelpers["extends"]({},w,{playerStateForDebug:i(s.playerStateForDebug,w.mediaElement.state.mediaElementSnapshot)});default:s.type;return}case"__disposed__":switch(s.type){case"__enter":q=s.prevState;e="VideoPlayerNextgendashMainWith"+q.workerType+"/Disposed["+w.reason+"@"+q.state+"]";p="Disposed: "+w.reason+"@"+q.state+"; playerStateFromWorker=%s";b=[(C=JSON.stringify(q.playerStateFromWorker))!=null?C:"undefined"];B=w.exception!=null?d("nextgendasherr").nextgendasherrFromCause.apply(void 0,[r,w.exception,e,p].concat(b)):null;if(q.workerConnection!=null){A(q.workerConnection,(g=B)!=null?g:d("nextgendasherr").nextgendasherr.apply(void 0,[r,e,p].concat(b)))}B!=null&&f(B);return;default:return}default:w.state;return}});function i(a,b){return a==null||b==null?a:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(babelHelpers["extends"]({},a,{bufferedRanges:babelHelpers["extends"]({},a.bufferedRanges,{combo:b.buffered.map(function(a){return{endTime:a[1],startTime:a[0]}})})}))}function j(a,b,d){a=h(d,a.config);if(c("deepEquals")(a,d.playerStateFromMainSent))return d;d.workerConnection.sendToWorker({canSendOnlyLatestOfTypeIfThrottled:!0,eventToWorker:{playerInstanceKey:b,playerStateFromMain:a,type:"from_main_to_worker_sync_state"},type:"send_to_worker"});return babelHelpers["extends"]({},d,{playerStateFromMainSent:a})}function k(a,b,c,e,f,g){if(c.state!==b.state)switch(c.state){case"completed":b=c.responseData.state;switch(b.state){case"done_text":g(e,{dashManifestXmlString:b.text,type:"parse_dash_manifest_xml"});return;default:f({exception:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashMainDashManifestFetchUnexpectedState",'Unexpected response data state "'+b.state+'" when DASH manifest request is completed.'),type:"__exception"});return}case"failed":f({exception:d("nextgendasherr").nextgendasherrFromCause(a,c.error,"VideoPlayerNextgendashMainDashManifestFetchFailed"),type:"__exception"});return;case"aborted":f({exception:d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashMainDashManifestFetchAborted"),type:"__exception"});return;default:c.state;return}}function l(a,b,c,e,f){if(c.state!==b.state)switch(c.state){case"failed_to_parse":e({exception:d("nextgendasherr").nextgendasherrFromCause(a,c.error,"VideoPlayerNextgendashMainDashManifestParseFailed"),type:"__exception"});break;case"parsed":f();break}}g.VideoPlayerNextgendashMainSM=a}),98);
__d("VideoPlayerNextgendashEngine",["VideoPlayerImplementationEngineAPI","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerNextgendashABR","VideoPlayerNextgendashConnectionMainToWorker","VideoPlayerNextgendashEngineErrors","VideoPlayerNextgendashEngineExtrasAPI","VideoPlayerNextgendashHostAPI","VideoPlayerNextgendashHostAPIBrowser","VideoPlayerNextgendashLoggingAPI","VideoPlayerNextgendashLoggingDestinationEngineWarning","VideoPlayerNextgendashLoggingDestinationQPLFromEngine","VideoPlayerNextgendashMain","VideoPlayerNextgendashQPL","VideoPlayerNextgendashWorkQueue","clearTimeout","cr:5058","cr:8971","cr:8972","emptyFunction","gkx","guid","nextgendasherr","setTimeout","videoPlayerUniqueID"],(function(a,b,c,d,e,f,g){"use strict";var h=c("emptyFunction");function i(){d("VideoPlayerNextgendashConnectionMainToWorker").preloadWorker(d("VideoPlayerNextgendashConnectionMainToWorker").initialWorkerType,m())}var j=null,k=c("videoPlayerUniqueID")("ngdprefetch-"+c("guid")());function l(){if(j!=null)return j;i();var a={config:m(),host:c("VideoPlayerNextgendashHostAPIBrowser"),logging:d("VideoPlayerNextgendashLoggingAPI").combineLoggingDestinations([b("cr:5058")]),loggingState:{logstampPrefix:k,logstampTint:.5,metadata:{nextgendashCreatedAt:c("VideoPlayerNextgendashHostAPIBrowser").clock(),playerInstanceKey:k}},workQueue:d("VideoPlayerNextgendashWorkQueue").createVideoPlayerNextgendashWorkQueue(c("VideoPlayerNextgendashHostAPIBrowser").scheduleToRun)};j={connection:d("VideoPlayerNextgendashConnectionMainToWorker").connectToWorker(a,d("VideoPlayerNextgendashConnectionMainToWorker").initialWorkerType,k,function(b){throw d("nextgendasherr").nextgendasherr(a,"VideoPlayerNextgendashUnexpectedEventFromWorkerPrefetcher","Unexpected event received",b)}),env:a,workerType:d("VideoPlayerNextgendashConnectionMainToWorker").initialWorkerType};return j}function a(a){var b=l();if(b.connection!=null&&a.representations.length>0){b.connection.sendToWorker({eventToWorker:{initialAbrParams:{abrConfig:d("VideoPlayerNextgendashABR").createVideoPlayerNextgendashABRConfig(),bandwidthDiagnostics:b.env.host.networkDiagnosticsReadBandwidth(),devicePixelRatio:(b=window.devicePixelRatio)!=null?b:1,isDocumentHidden:document.hidden,prefetchResolutionThreshold:1e3},prefetchInfo:a,type:"from_main_to_worker_prefetch"},type:"send_to_worker"})}}function m(){var a;return{debugLog:(a=c("gkx"))("24365"),debugOverlay:a("24366"),debugViz:a("24367"),disableFallbackFromRealWorkerAfterLinked:a("4811"),disableSourceBufferRangesAnnotation:a("8788"),fetchCombineSegments:a("5735"),isInWorkerType:null,logStallDetailsAsPlayerWarning:a("1762"),qplMarkersEnded:[]}}var n=0;function e(a){var e,f=a.checkInDOM,g=a.debugLogId,i=a.handleFatalError,j=a.initialProps;a=a.setExposedStateInReact;var k=j.videoFBID,l=j.loggingMetaData.instanceKey;e=(e=j.loggingMetaData.coreVideoPlayerMetaData.subOrigin)!=null?e:void 0;var p=c("VideoPlayerNextgendashHostAPIBrowser"),q=n++,r="#"+q+"::"+l,s=j.initialRepresentationIds,t=!1,u=null,v=d("VideoPlayerNextgendashWorkQueue").createVideoPlayerNextgendashWorkQueue(p.scheduleToRun),w=b("cr:8972")==null?void 0:b("cr:8972")(r,v),x=b("cr:8971")?new(b("cr:8971"))():null,y={current:null},z={current:null},A={config:m(),host:p,logging:d("VideoPlayerNextgendashLoggingAPI").combineLoggingDestinations([d("VideoPlayerNextgendashLoggingDestinationEngineWarning").createVideoPlayerNextgendashLoggingDestinationEngineWarning(function(a){B.point("warning",d("VideoPlayerNextgendashQPL").qplAnnotationsForError(o(A,a))),K.dispatch({payload:{warningError:a},type:"implementation_warning"})}),b("cr:5058"),w==null?void 0:w.loggingDestination,x==null?void 0:x.loggingDestination,d("VideoPlayerNextgendashLoggingDestinationQPLFromEngine").createVideoPlayerNextgendashLoggingDestinationQPLFromEngine(y,z)]),loggingState:{logstampPrefix:r,logstampTint:q%5/5,metadata:{nextgendashCreatedAt:p.clock(),nextgendashInstanceIndex:q,playerInstanceKey:l,playerSubOrigin:e,videoFBID:k}},workQueue:v},B=d("VideoPlayerNextgendashQPL").qplStartPlayingApi(A);z.current=B;B.start();var C=null,D=null,E=null,F=d("VideoPlayerNextgendashMain").VideoPlayerNextgendashMainSM.createSM("VideoPlayerNextgendashMain",A,null,{abrConfig:d("VideoPlayerNextgendashABR").createVideoPlayerNextgendashABRConfig(),audioOnly:j.audioOnly===!0,nextgendashInstanceIndex:q,onBufferingChanged:function(a,b,c){C!=null&&(C(),C=null),b?(C=B.subspan("buffering"),K.dispatch({payload:{bufferingType:c?"start/unpause":"in_play"},type:"buffering_begin_requested"})):K.dispatch({payload:{domEventPerfTimestamp:a.perfMs},type:"buffering_end_requested"})},onError:function(a){B.point("error",d("VideoPlayerNextgendashQPL").qplAnnotationsForError(a)),u==null&&(u=a),w?(w.setHalted(a.name),v.enqueueWork(function(){J(a,"comet_nextgendash_main_error")})):J(a,"comet_nextgendash_main_error")},onManifestUpdated:function(){B.point("manifest_updated"),K.dispatch({payload:{selectedVideoQuality:H.getUserSelectedVideoQuality()},type:"implementation_engine_qualities_changed"})},onMediaSourceAttachedChanged:function(a,b){D!=null&&(D(),D=null);b&&(D=B.subspan("media_source"));a=(a=F.state.mediaElement)==null?void 0:a.state.mediaElement;a=a!=null?d("VideoPlayerNextgendashHostAPI").unopaqueVideoPlayerNextgendashHostMediaElement(a):null;(a==null||L.current==null||a!==L.current.getUnderlyingVideoElement())&&(L.current=a!=null?d("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(a):null);b&&!t&&(t=!0,K.dispatch({payload:{selectedVideoQuality:H.getUserSelectedVideoQuality()},type:"implementation_engine_initialized"}))},onSendHaltedToWorkerChanged:w==null?void 0:w.onSendHaltedToWorkerChanged,onVideoRepresentationChanged:function(a,b){B.point("video_representation_changed",{string:{fromVideoRepresentationId:String(a),toVideoRepresentationId:String(b)}}),K.dispatch({payload:{},type:"representation_changed"})},playerInstanceKey:l,playerSubOrigin:e,playerViewportDimensionsInitial:j.dimensions,prefetchResultInitial:s!=null&&s.length>0?{prefetchedRepresentationIds:s,prefetchStartedAt:A.host.clock()}:null,videoFBID:k,workerTypeInitial:d("VideoPlayerNextgendashConnectionMainToWorker").initialWorkerType});y.current=F;(j.manifest!=null||j.manifestUrl!=null)&&F.sendEvent({dashManifestUrl:j.manifestUrl,dashManifestXmlString:j.manifest,type:"update_dash_manifest"});function G(){var a;return(a=L.current)!=null?a:null}var H=d("VideoPlayerNextgendashEngineExtrasAPI").createVideoPlayerNextgendashEngineExtrasAPI({getVideoElementAPI:G,mainSm:F}),I=null;r=d("VideoPlayerImplementationEngineAPI").createVideoPlayerImplementationEngine({checkInDOM:f,createDebugAPI:function(b){var a=b.getVideoElementAPI;b=b.loggerToVPL;return x==null?void 0:x.createDebugAPI({engineExtrasAPI:H,getConfig:function(){return j.experimentationConfig},getVideoElementAPI:a,loggerToVPL:b,mainSm:F})},createVideoPlayerError:function(a,b){var c;return d("VideoPlayerNextgendashEngineErrors").createVideoPlayerErrorFromNextgendashEngine(A,(c=d("nextgendasherr").nextgendasherrFromNextgendasherr(a))!=null?c:d("nextgendasherr").nextgendasherrFromCause(A,a,"VideoPlayerNextgendashEngineFatalError"),b)},debugLog:h,debugLogId:g,destroyEngineParts:function(a){a();function a(){B.point("destroy"),F.sendEvent({reason:"destroyEngineParts",type:"__dispose"}),w==null?void 0:w.disconnect()}},engineExtrasAPI:H,engineMetadata:{isAbrEnabled:!0,playerVersion:"comet_nextgendash",streamingFormat:"dash"},handleFatalError:i,handleVideoElementChanged:function(a,b){E!=null&&(E(),E=null),a!=null&&(E=B.subspan("video_element"),I!=null&&(c("clearTimeout")(I),I=null),F.sendEvent({mediaElement:d("VideoPlayerNextgendashHostAPI").opaqueVideoPlayerNextgendashHostMediaElement(a),type:"update_media_element"}))},handleVideoInfoChange:function(a){if(F.state.state!=="__null__"&&F.state.state!=="__disposed__"){var b=F.state;(a.dimensions.height!==b.playerViewportDimensions.height||a.dimensions.width!==b.playerViewportDimensions.width)&&F.sendEvent({playerViewportDimensions:a.dimensions,type:"update_player_viewport_dimensions"})}return!1},initialProps:j,setExposedStateInReact:a});p=r.engine;var J=r.handleFatalImplementationError,K=r.machine,L=r.videoElementAPIRef,M=void 0,N=null,O=null;z=function(){var a=K.getCurrentState().controlledState,b=a.error;a=a.playbackState;if(a!==M){N!=null&&(b!=null||a!=="paused")&&(N(),N=null);O!=null&&(b!=null||a!=="stalling")&&(O(),O=null);if(b!=null){var c;B.endWithError((c=u)!=null?c:o(A,b));P.remove()}else a==="playing"?(B.endWithSuccess(),P.remove()):a==="paused"?N=B.subspan("paused"):a==="stalling"&&(O=B.subspan("stalling"));M=a}};var P=p.implementationController.subscribe(z);z();if(A.config.logStallDetailsAsPlayerWarning){var Q=void 0,R=null;q=function(){var a=K.getCurrentState().controlledState,b=a.error;a=a.playbackState;if(a!==Q){(b!=null||a!=="stalling")&&(R!=null&&(c("clearTimeout")(R),R=null));if(b!=null)S.remove();else if(a==="stalling"&&R==null){var d=A.host.clock();b=200;R=c("setTimeout")(function(){F.sendEvent({stallStartClock:d,type:"debug_log_stall_details"})},b)}Q=a}};var S=p.implementationController.subscribe(q);q()}B.point("engine_created");return p}function o(a,b){return d("nextgendasherr").nextgendasherr.apply(void 0,[a,b.errorName,b.errorMessageFormat].concat(b.errorMessageParams))}g.preloadVideoPlayerNextgendashWorker=i;g.prefetchUsingNextgendash=a;g.createVideoPlayerNextgendashEngine=e}),98);
__d("VideoPlayerNextgendashLoggingDestinationQPLWorkerToMain",["Batcher"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=new(d("Batcher").Batcher)(50,20,function(b){a.postMessage({calls:b,type:"comet_video_player_nextgendash__worker_to_main_qpl_calls"},[])});return{displayName:"VideoPlayerNextgendashLoggingDestinationQPLWorkerToMain",log:function(a,c){switch(c.type){case"qpl_call":b.push(c.qplCall);return;default:return}}}}g.createVideoPlayerNextgendashLoggingDestinationQPLWorkerToMain=a}),98);
__d("VideoPlayerNextgendashWorkerPlayer",["VideoPlayerNextgendashManifestParser","VideoPlayerNextgendashPlaybackLoop","VideoPlayerNextgendashStateMachine","deepEquals","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";a=d("VideoPlayerNextgendashStateMachine").defineStateMachine({augmentEnv:function(a,b){return babelHelpers["extends"]({},a,{config:b.playerStateFromMain.configFromMain,loggingState:babelHelpers["extends"]({},a.loggingState,{logstampPrefix:a.loggingState.logstampPrefix+"::#"+b.nextgendashInstanceIndex+"::"+b.playerInstanceKey,logstampTint:b.nextgendashInstanceIndex%20/20,metadata:babelHelpers["extends"]({},a.loggingState.metadata,{nextgendashInstanceIndex:b.nextgendashInstanceIndex,playerInstanceKey:b.playerInstanceKey,playerSubOrigin:b.playerSubOrigin,prefetchKey:b.prefetchKey,videoFBID:b.videoFBID})})})}},function(a){var b=a.args,c=b.linkedAt,e=b.playerInstanceKey,f=b.playerStateFromMain,g=b.prefetchResult;b=b.videoFBID;var h=a.env,i=a.makeChildSm,j=a.sendToSelf;return{linkedAt:c,playbackLoop:i("playbackLoop",d("VideoPlayerNextgendashPlaybackLoop").VideoPlayerNextgendashPlaybackLoopSM,{onTransitioned:function(a,b,c){j({type:"_playback_loop_transitioned"},c)},playerStateFromMain:f,prefetchResult:g,sendMediaSourceToMain:function(a,b){j({mediaSource:a,mediaSourceIndex:b,type:"_send_media_source_to_main"})},sendPlayerWarningToMain:function(a){h.logging.log(h,{error:a,format:"sendPlayerWarningToMain",type:"generic_error_as_warning"}),j({type:"_send_player_warning_to_main",warningError:a})}}),playerInstanceKey:e,playerStateFromWorkerSent:null,shouldSendPlayerStateForDebug:!1,state:"initial",videoFBID:b}},function(a){var b=a.args,e=b.playerInstanceKey,f=b.sendToMain;b=b.workerType;var g=a.env,j=a.event,k=a.sendToOther,l=a.sendToSelf;a=a.state;if(j.type==="update_player_state_from_main"){if(a.state!=="__disposed__"){Object.assign(g.config,j.playerStateFromMain.configFromMain);k(a.playbackLoop,{playerStateFromMain:j.playerStateFromMain,type:"update_player_state_from_main"});return babelHelpers["extends"]({},a,{shouldSendPlayerStateForDebug:j.playerStateFromMain.shouldSendPlayerStateForDebug})}return}k=a.state!=="__disposed__"&&a.playbackLoop.state.state==="playing"?a.playbackLoop.state:null;switch(a.state){case"initial":switch(j.type){case"__enter":return;case"__exception":return;case"__dispose":return;case"_playback_loop_transitioned":var m=null,o=i(k,g.config.disableSourceBufferRangesAnnotation);o!==h&&!c("deepEquals")(o,a.playerStateFromWorkerSent)&&(f({playerInstanceKey:e,playerStateFromWorker:o,type:"from_worker_to_main_playback_loop_state",workerType:b},[],!0),m=o);a.playbackLoop.state.state==="__disposed__"&&a.playbackLoop.state.exception!=null&&l({exception:a.playbackLoop.state.exception,type:"__exception"});a.shouldSendPlayerStateForDebug&&f({playerInstanceKey:e,playerStateForDebug:n(g,k),type:"from_worker_to_main_player_state_for_debug",workerType:b},[],!0);if(m!=null)return babelHelpers["extends"]({},a,{playerStateFromWorkerSent:m});return;case"_send_media_source_to_main":o=j.mediaSource;l=j.mediaSourceIndex;m=n(g,k);var p=i(k,g.config.disableSourceBufferRangesAnnotation);if(b==="RealWorker"||b==="RealWorkerV2"){var q=g.host.mediaSourceGetHandleInWorker(g,o);f({mediaSourceHandle:q,mediaSourceIndex:l,playerInstanceKey:e,playerStateForDebug:m,playerStateFromWorker:p,type:"from_worker_to_main_player_new_media_source",workerType:b},[q])}else f({mediaSource:o,mediaSourceIndex:l,playerInstanceKey:e,playerStateForDebug:m,playerStateFromWorker:p,type:"from_worker_to_main_player_new_media_source",workerType:b},[]);return babelHelpers["extends"]({},a,{playerStateFromWorkerSent:p});case"_send_player_warning_to_main":q=n(g,k);o=i(k,g.config.disableSourceBufferRangesAnnotation);f({playerInstanceKey:e,playerStateForDebug:q,playerStateFromWorker:o,type:"from_worker_to_main_player_warning",warningErrorSnapshot:d("nextgendasherr").nextgendasherrToSnapshot(j.warningError),workerType:b},[]);return babelHelpers["extends"]({},a,{playerStateFromWorkerSent:o});case"debug_log_stall_details":l=g.host.clock();m=n(g,k);p=i(k,g.config.disableSourceBufferRangesAnnotation);q=k==null?void 0:k.playerStateFromMain.mediaElementSnapshot;o={fetchDemands:k?d("VideoPlayerNextgendashPlaybackLoop").debugPrepareFetchDemands(k.fetchDemands,!0):void 0,loopIteration:k==null?void 0:k.loopState.loopIteration,loopReasons:k==null?void 0:k.loopState.loopReasons,mediaElementSnapshotFromMain:j.mediaElementSnapshotFromMain,mediaElementSnapshotFromPlaybackLoop:c("deepEquals")(q,j.mediaElementSnapshotFromMain)?"same":q,playerStateFromWorker:p,stallDetailsClock:l,stallStartClock:j.stallStartClock,streams:k?k.streams.map(function(a){return{sourceBufferRanges:a.appendState.sourceBufferRanges,type:a.type}}):void 0};q=d("nextgendasherr").nextgendasherr(g,"VideoPlayerNextgendashDebugStallDetails","Stall details: %s %s",JSON.stringify(o),"debugPlaybackLoopRecentChanges:"+(k==null?"undefined":"\n "+k.debugPlaybackLoopRecentChanges.join("\n ")));f({playerInstanceKey:e,playerStateForDebug:m,playerStateFromWorker:p,type:"from_worker_to_main_player_warning",warningErrorSnapshot:d("nextgendasherr").nextgendasherrToSnapshot(q),workerType:b},[]);return babelHelpers["extends"]({},a,{playerStateFromWorkerSent:p});default:j.type;return}case"__disposed__":switch(j.type){case"__enter":if(a.exception!=null){l=d("nextgendasherr").nextgendasherrToSnapshot(a.exception);o=j.prevState.playbackLoop.state.state==="playing"?j.prevState.playbackLoop.state:null;k=i(o,g.config.disableSourceBufferRangesAnnotation);q=k===h?(m=j.prevState.playerStateFromWorkerSent)!=null?m:k:k;f({errorSnapshot:l,playerInstanceKey:e,playerStateForDebug:n(g,o),playerStateFromWorker:q,type:"from_worker_to_main_player_fatal_error",workerType:b},[])}return;default:return}default:a.state;return}});var h=d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({blockedRepresentationIds:{audio:[],video:[]},playingRepresentationId:{audio:null,video:null},targetRepresentationId:{audio:null,video:null},targetVariantRepresentationIds:{audio:[],video:[]},workaroundForSegmentBufferedInsufficientlyMediaTimeRanges:[]});function i(a,b){var c,e;if(a==null)return h;var f=a.streams.find(function(a){return a.type==="audio"}),g=a.streams.find(function(a){return a.type==="video"});if(f==null&&g==null)return h;var i=g==null?void 0:g.appendState,k=f==null?void 0:f.appendState;c=[].concat((c=i==null?void 0:i.workaroundForSegmentBufferedInsufficiently.map(function(a){return a.segment.mediaTimeRange}))!=null?c:[],(c=k==null?void 0:k.workaroundForSegmentBufferedInsufficiently.map(function(a){return a.segment.mediaTimeRange}))!=null?c:[]);a=(a=a.playerStateFromMain.mediaElementSnapshot)==null?void 0:a.currentTime;return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({blockedRepresentationIds:{audio:Object.keys((e=f==null?void 0:f.blockedRepresentations)!=null?e:{}),video:Object.keys((e=g==null?void 0:g.blockedRepresentations)!=null?e:{})},playingRepresentationId:b?{audio:f==null?void 0:f.targetRepresentationId,video:g==null?void 0:g.targetRepresentationId}:{audio:j(a,k,f==null?void 0:f.targetRepresentationId),video:j(a,i,g==null?void 0:g.targetRepresentationId)},targetRepresentationId:{audio:f==null?void 0:f.targetRepresentationId,video:g==null?void 0:g.targetRepresentationId},targetVariantRepresentationIds:{audio:(e=f==null?void 0:f.targetVariantRepresentationIds)!=null?e:[],video:(b=g==null?void 0:g.targetVariantRepresentationIds)!=null?b:[]},workaroundForSegmentBufferedInsufficientlyMediaTimeRanges:c.length>0?c:void 0})}function j(a,b,c){return a!=null&&b!=null?(b=(b=b.sourceBufferRangesAnnotated.findLast(function(b){var c=b[0];b=b[1];return c<=a&&a<=b}))==null?void 0:b[2])!=null?b:c:void 0}function k(a,b,c){var e=a!=null&&b!=null?a.sidxByRepresentationId[b.representationId]:null,f=b!=null&&b.type==="audio"?d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromAudioRepresentation(b):b!=null&&b.type==="video"?d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation(b)+(b.lang!=null?" - "+b.lang:"")+(b.role!=null?" - "+b.role:""):void 0,g=b!=null?b.mimeCodecsParsed.codecFamily:void 0;return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject((e=e==null?void 0:e.map(function(e){var h,i=a!=null&&b!=null?d("VideoPlayerNextgendashPlaybackLoop").makeSegmentFetchDataKey(b,e):null;i=i!=null&&c!=null?d("VideoPlayerNextgendashPlaybackLoop").findDataForDataKey(c,i):null;var j=i==null?void 0:i.responseFetch;i=i==null?void 0:i.responseInfo;var k=i!=null&&j!=null&&j.state.state!=="__null__"&&j.state.state!=="__disposed__"&&j.state.state!=="waiting_start"?j.state.request.requestInfo+("#"+i.responseByteRange.byteOffset+"B.."+(i.responseByteRange.byteLength!=null?i.responseByteRange.byteOffset+i.responseByteRange.byteLength-1:"?")+"B"):void 0,l=j!=null?""+j.state.state+(j.state.responseData!=null?":"+j.state.responseData.state.state+(j.state.responseData.state.state==="reading_stream"||j.state.responseData.state.state==="done_stream"?"["+j.state.responseData.state.chunks.length+"]":""):""):void 0,m=e.mediaFileByteRange.byteLength,n=j!=null&&j.state.state!=="__null__"&&j.state.state!=="__disposed__"?j.state.request.requestCreatedClock.unixMs:void 0,o=j!=null&&(j.state.state==="waiting_headers"||j.state.state==="waiting_data")?j.state.requestStartedClock.unixMs:void 0,p=j!=null&&j.state.state!=="__null__"&&j.state.state!=="__disposed__"?j.state.prefetchResultState:void 0;h=j!=null&&(j.state.state==="waiting_data"||j.state.state==="completed")?parseInt((h=j.state.responseHeader.httpHeaders)==null?void 0:h.get("Content-Length"),10)||void 0:void 0;var q=j!=null&&j.state.state==="waiting_headers"?0:j!=null&&(j.state.state==="waiting_data"||j.state.state==="completed")?j.state.responseData.state.state==="reading_stream"||j.state.responseData.state.state==="done_stream"?j.state.responseData.state.dataBytesLengthTotal:j.state.responseData.state.state==="done_buffer"?j.state.responseData.state.buffer.byteLength:j.state.responseData.state.state==="done_text"?j.state.responseData.state.text.length:void 0:void 0;return{byteLength:m,dataState:j==null?"not_ready":{__disposed__:"disposed",__null__:"not_ready",aborted:"failed",completed:"ready",failed:"failed",waiting_data:"fetching",waiting_headers:"fetching",waiting_retry_or_failed:"retrying",waiting_start:"not_ready",waiting_start_from_retry:"retrying"}[j.state.state],debugJsonString:JSON.stringify({bytesDownloaded:q,bytesExpected:h,error:j!=null&&j.state.state==="aborted"?String(j.state.abortReason):j!=null&&j.state.state==="failed"?String(j.state.error):j!=null&&j.state.state==="__disposed__"&&j.state.exception!=null?String(j.state.exception):void 0,label:[f,g].filter(Boolean).join(" / "),prefetchResultState:p,requestCreatedClockUnixMs:n,requestStartedClockUnixMs:o,responseByteRange:i==null?void 0:i.responseByteRange,state:l,url:k}),mediaTimeEnd:e.mediaTimeRange[1],mediaTimeStart:e.mediaTimeRange[0],segmentId:e.segmentId}}))!=null?e:[])}function l(a){return a.map(function(a){return{endTime:a[1],startTime:a[0]}})}function m(a,b,c){return a.map(function(a){var d=b==null?void 0:b.find(function(b){return b.representationId===a[2]});return{debugJsonString:JSON.stringify({label:d?c(d):void 0,representationId:a[2]}),endTime:a[1],startTime:a[0]}})}function n(a,b){var c,e,f,g;if(!a.config.debugOverlay)return void 0;var h=b==null?void 0:b.streams.find(function(a){return a.type==="audio"});a=b==null?void 0:(a=b.playerStateFromMain.dashManifestData)==null?void 0:a.manifestRepresentations.audio.find(function(a){return a.representationId===(h==null?void 0:h.targetRepresentationId)});var i=b==null?void 0:b.streams.find(function(a){return a.type==="video"});c=b==null?void 0:(c=b.playerStateFromMain.dashManifestData)==null?void 0:c.manifestRepresentations.video.find(function(a){return a.representationId===(i==null?void 0:i.targetRepresentationId)});e=m((e=h==null?void 0:h.appendState.sourceBufferRangesAnnotated)!=null?e:[],b==null?void 0:(e=b.playerStateFromMain.dashManifestData)==null?void 0:e.manifestRepresentations.audio,d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromAudioRepresentation);f=m((f=i==null?void 0:i.appendState.sourceBufferRangesAnnotated)!=null?f:[],b==null?void 0:(f=b.playerStateFromMain.dashManifestData)==null?void 0:f.manifestRepresentations.video,d("VideoPlayerNextgendashManifestParser").getDisplayLabelFromVideoRepresentation);g=b==null?void 0:(g=b.playerStateFromMain)==null?void 0:(g=g.mediaElementSnapshot)==null?void 0:g.buffered;g=l((g=g)!=null?g:[]);a=k(h,a,b==null?void 0:b.fetchDemands);c=k(i,c,b==null?void 0:b.fetchDemands);return d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject({bufferedRanges:{audio:e,captions:[],combo:g,video:f},segments:{audio:a,captions:[],combo:[],video:c}})}g.VideoPlayerNextgendashWorkerPlayerSM=a}),98);
__d("VideoPlayerNextgendashWorker",["VideoPlayerNextgendashConnectionWorkerToMain","VideoPlayerNextgendashStateMachine","VideoPlayerNextgendashWorkerPlayer","VideoPlayerNextgendashWorkerPrefetchCache","nextgendasherr"],(function(a,b,c,d,e,f,g){"use strict";a=d("VideoPlayerNextgendashStateMachine").defineStateMachine(null,function(a){var b=a.args,c=b.portToMain,e=b.subscribeToDebugHalt;b=b.workerType;var f=a.env,g=a.sendToSelf;a=d("VideoPlayerNextgendashConnectionWorkerToMain").connectToMain(f,b,c,e,function(a){g(a)});return{mainConnection:a,players:new Map(),state:"port_to_main_ready"}},function(a){var b=a.args.workerType,c=a.env,e=a.event,f=a.eventClock,g=a.makeChildSm,h=a.sendToOther,i=a.sendToSelf,j=a.state;switch(j.state){case"port_to_main_ready":switch(e.type){case"__enter":return;case"__exception":return;case"__dispose":return;case"_worker_player_disposed":a=j.players;var k=a.get(e.playerInstanceKey);if(!k)return;a["delete"](e.playerInstanceKey);j.mainConnection.sendToMain({eventToMain:{exceptionSnapshot:e.exception!=null?d("nextgendasherr").nextgendasherrToSnapshot(e.exception):void 0,playerInstanceKey:e.playerInstanceKey,reason:e.exception!=null?"VideoPlayerNextgendashWorkerPlayer_exception":"VideoPlayerNextgendashWorkerPlayer_disposed",type:"from_worker_to_main_player_unlinked",workerType:b},type:"send_to_main"});return j;case"from_main_to_worker_link_player":k=j.players;a=k.get(e.playerInstanceKey);if(!a){var l;l=(l=e.prefetchKey!=null?d("VideoPlayerNextgendashWorkerPrefetchCache").getCachedRepresentationsForPrefetchKey(c,e.prefetchKey):null)!=null?l:e.prefetchResultInitial;a=g("player-"+e.playerInstanceKey,d("VideoPlayerNextgendashWorkerPlayer").VideoPlayerNextgendashWorkerPlayerSM,{linkedAt:f,nextgendashInstanceIndex:e.nextgendashInstanceIndex,onDisposed:function(a,b,c){i({exception:b.exception,playerInstanceKey:e.playerInstanceKey,type:"_worker_player_disposed"})},playerInstanceKey:e.playerInstanceKey,playerStateFromMain:d("VideoPlayerNextgendashStateMachine").skipAutoDisposeInsideThisObject(e.playerStateFromMain),playerSubOrigin:e.playerSubOrigin,prefetchKey:e.prefetchKey,prefetchResult:l,sendToMain:function(a,b,c){j.mainConnection.sendToMain({canSendOnlyLatestOfTypeIfThrottled:c,eventToMain:a,transferList:b,type:"send_to_main"})},videoFBID:e.videoFBID,workerType:b})}k.set(e.playerInstanceKey,a);return j;case"from_main_to_worker_unlink_player":g=j.players;g["delete"](e.playerInstanceKey);return j;case"from_main_to_worker_sync_state":f=j.players;l=f.get(e.playerInstanceKey);if(!l)return;h(l,{playerStateFromMain:e.playerStateFromMain,type:"update_player_state_from_main"});return;case"from_main_to_worker_debug_log_stall_details":b=j.players;k=b.get(e.playerInstanceKey);if(!k)return;h(k,{mediaElementSnapshotFromMain:e.mediaElementSnapshotFromMain,stallStartClock:e.stallStartClock,type:"debug_log_stall_details"});return;case"from_main_to_worker_prefetch":d("VideoPlayerNextgendashWorkerPrefetchCache").initiatePrefetch(c,e.prefetchInfo,e.initialAbrParams);return;default:e.type;return}case"__disposed__":switch(e.type){case"__enter":a=e.prevState;if(a.state==="port_to_main_ready"){g=a.mainConnection.disconnectFromMain;g!=null&&g(j.exception!=null?d("nextgendasherr").nextgendasherrFromCause(c,j.exception,"VideoPlayerNextgendashWorkerDisposed"):d("nextgendasherr").nextgendasherr(c,"VideoPlayerNextgendashWorkerDisposed"))}return;default:return}default:j.state;return}});g.VideoPlayerNextgendashWorkerSM=a}),98);
__d("VideoPlayerNextgendashWorkerEnvironment",["VideoPlayerNextgendashHostAPIBrowser","VideoPlayerNextgendashLoggingAPI","VideoPlayerNextgendashLoggingDestinationQPLWorkerToMain","VideoPlayerNextgendashWorkQueue","VideoPlayerNextgendashWorker"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f){var g;a=a;g=(g=a.isInWorkerType)!=null?g:"VirtualWorker";var i=c("VideoPlayerNextgendashHostAPIBrowser");e={config:a,host:i,logging:d("VideoPlayerNextgendashLoggingAPI").combineLoggingDestinations([a.debugLog?e:null,a.debugViz?f==null?void 0:f.createLoggingDestination({portToMain:b,workerType:g}):null,d("VideoPlayerNextgendashLoggingDestinationQPLWorkerToMain").createVideoPlayerNextgendashLoggingDestinationQPLWorkerToMain(b)]),loggingState:h(g),workQueue:d("VideoPlayerNextgendashWorkQueue").createVideoPlayerNextgendashWorkQueue(i.scheduleToRun)};d("VideoPlayerNextgendashWorker").VideoPlayerNextgendashWorkerSM.createSM("VideoPlayerNextgendashWorker",e,null,{portToMain:b,subscribeToDebugHalt:f==null?void 0:f.subscribeToDebugHalt,workerType:g})}function h(a){return{logstampPrefix:{RealWorker:"nextgendash_real_worker",RealWorkerV2:"nextgendash_real_worker_v2",VirtualWorker:"nextgendash_virtual_worker"}[a],logstampTint:{RealWorker:.9,RealWorkerV2:.8,VirtualWorker:.3}[a],metadata:{}}}g.createVideoPlayerNextgendashWorkerEnvironment=a;g.createWorkerDefaultLoggingState=h}),98);
__d("VideoPlayerNextgendashWorkerEnvironmentImportUnconditionally",["VideoPlayerNextgendashWorkerEnvironment"],(function(a,b,c,d,e,f){"use strict";Object.keys(importNamespace("VideoPlayerNextgendashWorkerEnvironment")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("VideoPlayerNextgendashWorkerEnvironment")[a]})}),null);