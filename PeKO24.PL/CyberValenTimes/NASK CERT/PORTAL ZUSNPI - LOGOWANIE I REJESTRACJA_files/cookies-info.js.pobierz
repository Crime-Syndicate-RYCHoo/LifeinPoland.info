define("plugins/cookies-info",["require","jquery","lib/plugins/cookie","common/basePlugin","adapter/jsClass","adapter/dom","adapter/enumerable"],function(e){var d=e("common/basePlugin"),h=e("adapter/dom"),g=e("jquery"),b=e("adapter/enumerable"),c=e("adapter/jsClass"),f=e("lib/plugins/cookie");var a=c.Class(d,{constructor:function(m,j,l,i){var k={cookieAcceptName:"cookieInfo",cookieCloseName:null,cookieAcceptValue:"true",cookieCloseValue:"true",cookieClass:"cookies",cookieCloseSelector:".close-cookie",cookieAcceptSelector:".accept-cookie",delay:1000,duration:500,cookieExpireTime:365*10,cookiePath:"/",cookieAcceptValueSelector:null,cookieCloseValueSelector:null,cookiePresentValueSelector:null};this.settings=b.defaults(i,k);a.$super.call(this,m,j,l,i);this.body=h.find("body");this.context=h.find("#"+this.modId);this.init()},areCookiesEnabled:function(){var i=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!i){document.cookie="testcookie";i=(document.cookie.indexOf("testcookie")!=-1)?true:false}this.log("cookieEnabled: "+i);return(i)},init:function(){var i=true,k=true;this.cookieValue=this.getCookieValue(this.settings.cookieAcceptValueSelector,this.settings.cookieAcceptValue);if(this.areCookiesEnabled()){if(this.settings.cookiePresentValueSelector){var n=h.find(this.settings.cookiePresentValueSelector);if(h.getProperty(n,"value")=="true"){k=false}}if(this.settings.cookieCloseName&&g.cookie(this.settings.cookieCloseName)){var j=this.getCookieValue(this.settings.cookieCloseValueSelector,"");var l=g.cookie(this.settings.cookieCloseName).split("|");if(h.inArray(j,l)!=-1){i=false}}var m=g.cookie(this.settings.cookieAcceptName);if((m&&m!=this.cookieValue&&i)||(!m&&i&&k)){h.removeClass(this.context,"hidden");h.addClass(this.body,this.settings.cookieClass);h.on(h.find(this.settings.cookieCloseSelector,this.context),"click",null,this.onCloseLinkClick.bind(this));h.on(h.find(this.settings.cookieAcceptSelector,this.context),"click",null,this.onSetCookie.bind(this))}}},onSetCookie:function(i){i.preventDefault();g.cookie(this.settings.cookieAcceptName,this.cookieValue,{expires:this.settings.cookieExpireTime,path:this.settings.cookiePath});this.slideCookie()},getCookieValue:function(k,i){if(k){var j=h.find(k);if(j.length>0){if(j[0].tagName.toLowerCase()=="input"){return j[0].value}else{return h.getHtml(j,true)}}return i}return i},onCloseLinkClick:function(l){l.preventDefault();var k=this;if(this.settings.cookieCloseName){var j=this.getCookieValue(this.settings.cookieCloseValueSelector,this.settings.cookieCloseValue);var i=g.cookie(this.settings.cookieCloseName);if(i){i+="|"+j}else{i=j}g.cookie(this.settings.cookieCloseName,i,{expires:this.settings.cookieExpireTime,path:this.settings.cookiePath})}this.slideCookie()},slideCookie:function(){var i=this;g(this.context).slideToggle(this.settings.duration,function(){h.remove(h.parent(i.context,".portlet-body"));h.removeClass(i.body,i.settings.cookieClass)})}});return a});