"use strict";(function(){var r={PLACEHOLDERS:{USERSNAP_HOST_PREFIX:"//screencapture.kampyle.com/",USER_AGENT_CLIENT_HINTS_LIST:'["brands", "mobile", "platform", "architecture", "model", "bitness", "platformVersion", "fullVersionList", "wow64", "uaFullVersion"]',ONSITE_DATA_PATH:"resource.digital.voice.va.gov/wdcvoice/2/onsite/onsiteData1731941049278.json",SUBMIT_URL_PREFIX:"https://feedback.digital.voice.va.gov/",JS_SITE_CODE:"resource.digital.voice.va.gov/wdcvoice/2/onsite/generic1731941049831.js",COOLADATA_API_HOST:"udc-neb.kampyle.com/",COOLADATA_SRC_PREFIX:"https://resource.digital.voice.va.gov/",ONSITE_VERSION:"1.64.1",USERSNAP_V4_HOST_PREFIX:"//scp.kampyle.com",URL_PREFIX:"https://resource.digital.voice.va.gov/",USERSNAP_ONPREM_HOST_PREFIX:"https://md-scp.kampyle.com/"},SRC:{OPEN_SANS:"resources/form/FormBuilder/vendor/fonts-googleapis/css/open-sans-v14.css",OOPS:"resources/onsite/images/oops.svg"},FORM_HEIGHT:"450",FORM_WIDTH:"450",COOKIE_EXPIRATION:365,DELAY_BETWEEN_TABS_TRIGGER_MS:550,DEVICES:{DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"},FEATURE_VERSIONS:{MOBILE_DYNAMIC_SIZING:2},TIME_FORMATS:{SECONDS:"seconds",MINUTES:"minutes",HOURS:"hours",DAYS:"days",WEEKS:"weeks",MONTHS:"months",YEARS:"years"},DISPLAY_TYPES:{LIGHTBOX:"lightbox",ANIMATION:"animation",POPUP:"popup",EMBEDDED:"embedded"},FORM_TYPES:{EMBEDDED:"embedded",INVITATION:"invitation",BUTTON:"button",CODE:"code"},EVENT_DATA:{PAGE_NUMBER:"pageNumber",FEEDBACK_CORRELATION_UUID:"feedbackCorrelationUUID",FEEDBACK_UUID:"feedbackUUID"},EVENT_NAME:{NEB_LOAD_FORM:"neb_loadForm"},FEATURE_FLAGS:{WCAG:"WCAG",EXEMPT_BUTTON_FORMS_FROM_QUARANTINE:"exemptButtonFormsFromQuarantine",EXEMPT_EMBEDDED_FORMS_FROM_QUARANTINE:"exemptEmbeddedFormsFromQuarantine",EXEMPT_CODE_FORMS_FROM_QUARANTINE:"exemptCodeFormsFromQuarantine"},PROVISIONS:{cooladataNewEvents:"cooladataNewEvents",NEW_SCREEN_CAPTURE_CONFIG:"newScreenCaptureConfiguration",ON_PREM_HYBRID:"onPremHybrid",FORM_TEMPLATE_DATA_SEPERATION:"separateFormTemplateFromData",EVENT_INCLUDE_FEEDBACK_CONTENT:"eventIncludeFeedbackContent",CP_EXT_REFACTOR:"cpExtractRefactor",ADOBE_INCLUDE_LINK_TRACK_VARS:"adobeIncludeLinkTrackVars",ADOBE_ANALYTICS_OBJECT_NAME:"adobeAnalyticsObjectName",ADOBE_CONCAT_LINK_TRACK_VARS:"adobeConcatLinkTrackVars",ENABLE_OVERFLOW:"enableOverflow",ENABLE_SPA_OVERFLOW_FIX:"24dcr1_MPC7514_enableSPAOverflowFix",SERVER_BASED_TARGETING:"serverBasedTargeting",COOLADATA_EVNETS_LIMIT:"cooladataEventsLimit",UBT_EXTRA_EVENTS:"UBTExtraEvents",ALTERNATIVE_UUID:"alternativeUUID",DISABLE_COOKIE_STORAGE:"cookieStorageDisable",SHARE_PROPERTY_DOMAIN:"sharePropertyBetweenSubdomains",SKIP_INVITATION_OPTIMIZATION:"skipInvitationOptimization",COOLADATA_SUBMITTED_BY_XHR:"cooladataSubmittedByXhr",DO_NOT_SURVEY_ON_UBT_NETWORK_FAIL:"doNotSurveyOnUBTNetworkFail",DHH:"dynamicHybridHosting",USER_SNAP_V4:"userSnapV4",DYNAMIC_ONSITE_EVENTS:"dynamicOnsiteEvents",CSP_RULES:"CSPRemoveInlineStyling",CREATE_SESSION:"cooladataCreateSessionEvent",FORM_TEMPLATES_WCAG:"formTemplatesWCAG",PREVENT_IFRAME_SCROLLBAR_FLICKERING:"20dcr32_NM11146_PreventIFrameScrollFlickering",BACKEND_GENERATED_UUID:"20dcr4_MPC2802_enable_backendGeneratedUUID",CHTML_LOGS:"chtmlLogs",EXEMPT_FORMS_FROM_QUARANTINE:"20dcr4_MPC2952_enable_exemptFormsFromQuarantine",USER_SNAP_AS_COMPONENT:"20dcr4_MPC2893_enable_ScreenCaptureAsComponent",ADDITIONAL_BUTTON_STYLES:"21dcr1_MPC3199_AdditionalButtonStyles",RTL:"21dcr1_MPC_3283_enable_RTL",GREATER_SMALLER_THAN_DECODE:"21dcr1_MPC3370_EnableGreaterSmallerThanSupport",NEW_MODAL_DIALOGS:"21dcr3_MPC3281_enable_newModalDialogs",IS_CHTML_HANDLE_INIT_FOCUS_INDEPENDENTLY:"21dcr3_MPC3281_enable_CHTMLHandleFocusIndependently",WCAG_TRAP_FOCUS_IN_MODAL:"WCAGTrapFocusInModal",WCAG_REVIEW_FIXES:"20dcr4_MPC2905_wcagReviewFixes",PROPERTY_MESSAGES:"propertyMessages",NOT_SCROLL_TO_LAST_POSITION_DISPLAY_TYPE_ANIMATION:"willNotScrollToLastPositionDisplayTypeAnimation",CLEAR_EMBEDDED_ON_UPDATE_PAGE:"21dcr2_MPC3571_enable_ClearEmbeddedFormOnUpdatePageView",ENABLE_EVENTS_FOR_CE_DEBUG:"21DCR2_MPC3662_EnableEventsForCEDebug",EXPOSE_SELECTION_QUESTIONS:"21DCR3_MPC3866_exposeSelectionQuestionsInCustomEvent",EXPOSE_VERBATIM_QUESTIONS:"21DCR3_MPC3866_exposeVerbatimQuestionsInCustomEvent",EXTENSION_ENABLED:"21dcr6_MPC4042_enable_exmdextension",LIVE_FORM_V2:"21dcr2_MPC2743_enable_newLiveForm",ENABLE_FIX_FOR_SPA_TIME_ON_PAGE:"21DCR5_MPC4030_EnableFixForSpaTimeOnPage",ENABLE_UBT_IDENTIFIER_HASH:"21dcr6_MPC4296_enable_UBTIdentifierHash",TARGETING_EVENTS_REPORTING:"targetingEventsReporting",IBM_CP_INCLUSION:"ibmIncludeSpecificCPsInCooladataEvent",PARALLEL_TAB_SOLUTION:"parallelTabSolution",UNDERSCORE_LOCALIZATION:"underScoreLocalization",ADD_RANDOM_TIME_FOR_SESSION:"addingRandomTimeForTimeInSession",SPA_URL_POLLING:"spaUrlPolling",ENABLE_WCAG_PREPEND_SURVEY:"23dcr1_MPC6711_enableWCAGPrependSurvey",MOBILE_WEB_BANNER_FIX:"23dcr1_mpc6083_enableMobileWebiOSBannerFix",ENABLE_ZOOM_WCAG_REFLOW:"23dcr2_mpc36711_enableFormWCAGReflow",ENABLE_COOLADATA_SESSION_EVENTS:"23dcr2_MPC6869_enableCXJSessionEvents",DISABLE_COOLADATA_NEW_PAGE_EVENTS:"23dcr2_MPC6869_disableNewPageEvents",ENABLE_CXJ_UPGRADE:"23dcr3_MPC6996_enableCXJUpgrade",ENABLE_ONSITE_DOMAIN_APPROVAL:"23dcr3_MPC6996_enableOnsiteDomainApproval",ENABLE_INVITATION_SPINNER_FIX:"23dcr4_MPC7186_enableInvitationSpinnerFix",ENABLE_INCLUDE_EXCLUDE_NEW_LINE_FIX:"24dcr1_MPC7724_enableIncludeExcludeNewlineFix",ENABLE_CUSTOM_EVENT_SUBMISSION_VIA_CALLBACK:"23dcr5_MPC7724_enableCustomEventSubmissionViaCallback",ENABLE_VIEWPORT_LOGIC_FIX:"24dcr2_MPC7960_enableViewportLogicFix",ENABLE_ONSITE_POST_MESSAGE_VERIFICATION:"24dcr2_MPC7960_enableOnsitePostMessageVerification"},MEDALLIA_DIGITAL_EMBED_FILE:"medallia-digital-embed.js",DEFAULT_ADOBE_SDK_NAME:"s",ANALYTICS_EVENT_FORBIDDEN_PROPERTIES:{sourceWindow:!0,content:!0,feedbackCorrelationUUID:!0},FORM_TRIGGER_TYPES_MAP:{embedded:"Embedded",invitation:"Intercept",button:"AlwaysOn",code:"TriggeredByCode"},EXPOSED_FEEDBACK_KEYS:{FORM_ID_LABEL:"Form_ID",FORM_TYPE_LABEL:"Form_Type",FEEDBACK_UUID_LABEL:"Feedback_UUID",FEEDBACK_CONTENT_LABEL:"Content",FORM_LANGUAGE_LABEL:"Form_Language"},LANG_MEMORY_DATA_KEY_PREFIX:"formLanguage:",FORM_JSON_DATA_KEY_PREFIX:"formJsonData:",INVITE_JSON_DATA_KEY_PREFIX:"inviteJsonData:",FORM_BUTTON:"button",FORM_INVITATION:"invitation",CUSTOM_EVENT_OTHER:"Other",LOCALIZED_FORM_DEFAULT_REPLACE_VALUE:"default",NOT_RECORDING:"NOT_RECORDING",IFRAME_SETTINGS:{EMBEDDED:{IFRAME_ID_PREFIX:"embeddedIframe"},LIGHTBOX:{IFRAME_ID_PREFIX:"kampyleForm",CONTAINER_ID_PREFIX:"kampyleFormModal",WRAPPER_ID:"MDigitalLightboxWrapper"},ANIMATION:{CONTAINER_ID:"KampyleAnimationContainer",IFRAME_ID:"kampyleFormAnimation",WRAPPER_ID:"MDigitalAnimationWrapper"},INVITATION:{IFRAME_ID:"kampyleInvite",CONTAINER_ID:"kampyleInviteModal",IFRAME_TITLE:"Invitation to provide feedback",WRAPPER_ID:"MDigitalInvitationWrapper"},PREVIEW:{IFRAME_ID:"kampyleForm"},OOPS:{CONTAINER_ID_PREFIX:"mdigital-no-json-modal_",CLOSE_BUTTON_ID:"close-no-json-modal"},IFRAME_TITLE:"Feedback Survey",USERSNAP_V4_IFRAME_TITLE:"Screen Capture"},IBM_CPS_TO_SEND:{testData:!0,offeringId:!0,language:!0,trialUser:!0,country:!0,offeringIdShell:!0,testDataShell:!0,trialUserShell:!0,countryShell:!0},PROPERTY_SETTINGS:{MANUALLY_INVITE_TARGETING:"MANUALLY_INVITE_TARGETING",CUSTOM_CSS_UPLOAD:"CUSTOM_CSS_UPLOAD"},EVENTS:{MDIGITAL_MANUALLY_INVITE_TARGETING:"MDigital_manuallyInviteTargeting",MDIGITAL_PAGE_TARGETING_PHASE_ENDED:"MDigital_pageTargetingPhaseEnded",MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED:"MDigital_behavioralTargetingPhaseEnded",MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED:"MDigital_quarantinedSurveyPhaseEnded",MDIGITAL_TARGETING_RULE_EVALUATED:"MDigital_targetingRuleEvaluated",MDIGITAL_SCREEN_CAPTURE_LOADED:"neb_screenCaptureLoaded",MDIGITAL_SDK_PAGE_VIEW:"neb_sdkPageView",MDIGITAL_WARNING:"MDigital_warning",MDIGITAL_COULD_NOT_FETCH_DATA:"MDigital_couldNotFetchData",MDIGITAL_COULD_NOT_LOAD_FORM_APPLICATION:"MDigital_couldNotLoadFormApplication",NEB_EVENT_DISPATCHER_ERROR:"neb_eventDispatcherError",NEB_LOAD_FORM:"neb_loadForm",NEB_FORM_LOADING_HAS_FAILED:"neb_formLoadingHasFailed",NEB_RESET_FORM_STATE:"neb_resetFormState",MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY:"MDigital_DynamicOnsiteInitializedSuccessfully",CREATE_SESSION:"createSession",MDIGITAL_NO_JSON_MODAL_SHOWN:"MDigital_noJsonModalShown",MDIGITAL_NO_JSON_MODAL_CLOSED:"MDigital_noJsonModalClosed",MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_FORM_CLOSED:"MDigital_updateTargetingWithDeclinedDateFormClosed",MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_INVITE_DECLINED:"MDigital_updateTargetingWithDeclinedDateInviteDeclined",MDIGITAL_CHTML_LOGS:"MDigital_CHTML_Logs",SCREEN_CAPTURE_RETAKE:"MDigital_screenCaptureRetake",SCREEN_CAPTURE_DELETE:"MDigital_screenCaptureDelete",CUSTOM_EVENTS_DEBUG_MESSAGE:"mdigital_customEventsDebugMessage",MDIGITAL_VALIDATE_ORIGIN:"MDigital_validate_origin"},LOG_MESSAGES:{TRIGGER_MESSAGE_TEMPLATE:"Event {{EVENT_NAME}} has been {{STATUS}}. \n the data is: {{DATA}}. \n the context is :{{CONTEXT}}. \n the options are : {{OPTIONS}}.\n",ERROR_LOG_TEMPLATE:"Error Message is {{ERROR_MESSAGE}}",ERROR_DYNAMIC_ONSITE_INITIALIZATION:"Failed to fetch onsite data.",ERROR_ONSITE_SDK_CONFIGURATION_MISSING:"Failed to execute KAMPYLE_ONSITE_SDK.{{METHOD}}, due to missing onsite configuration."},LOG_STATUSES:{FAILED:"failed",TRIGGERED:"triggered"},OPERATORS:{REGEX:"regex",EQUALS:"equals",DOES_NOT_EQUAL:"doesnotequal",CONTAINS:"contains",DOES_NOT_CONTAIN:"doesnotcontain",STARTS_WITH:"startswith",ENDS_WITH:"endswith",HAS_VALUE:"hasvalue",LATER_THAN:"laterthan",EARLIER_THAN:"earlierthan",GREATER_THAN:"greaterthan",SMALLER_THAN:"smallerthan"},TARGETING_STATUS:{CANDIDACY:"candidacy",TRIGGERED:"triggered",QUARANTINED:"quarantined"},TARGETING_PHASES:{PAGE_TARGETING:"pageTargeting",BEHAVIORAL_TARGETING:"behavioralTargeting",QUARANTINE_TARGETING:"quarantineTargeting"},TARGETING_RULES:{INVITE_IF_ANY_SURVEY_ALREADY_SUBMITTED_PER_SESSION:"InviteAnySurveyAlreadySubmittedPerSession",INVITE_IF_ANY_INVITE_ALREADY_SHOWN_PER_SESSION:"InvitePerSession"},REGIONS:{DEV:"dev",QA:"qa",COLO_QA:"digital-cloud-qa",COLO_US:"digital-cloud-us"},MEMORY_DATA_FIELDS:{MDIGITAL_ALTERNATIVE_UUID:"mdigital_alternative_uuid",FETCHING_DATA_IN_PROGRESS:"FETCHING_DATA_IN_PROGRESS_",DATA_JSON:"dataJson",HAS_ONSITE_CONFIGURATION:"hasOnsiteConfiguration",SESSION_TAB_PREFIX:"ONSITE_SESSION_TAB_",CURRENT_SESSION_TAB_ID:"CURRENT_SESSION_TAB_ID",TIMEOUT_HANDLERS:"mdTimeoutHandlers",FEEDBACK_CORRELATION_UUID:"feedbackCorrelationUUID",IS_BUTTON_CONTAINER_CREATED:"isButtonContainerCreated",REGION:"region",FEEDBACK_BUTTON_POSITION_STYLE:"buttonPositionStyle",LIVE_FORM_V2_DEBUG_MODE:"md_liveFormV2_isDebugMode",DOM_EVENT_HANDLERS:"domEventHandlers",DECIBEL_DATA:"decibelData"},SESSION_DATA_FIELDS:{IS_SURVEY_SUBMITTED_IN_SESSION:"md_isSurveySubmittedInSession"},TIMEOUT_HANDLERS:{FORM_APP_STATUS:"formAppStatus",EMBEDDED_STATUS:"embeddedFormStatus"},CSS_FONT_RULE:"CSSFontFaceRule",NETWORK:{RETRY_TIMEOUT:1e3,REQUEST_TIMEOUT:5e3,TIME_FOR_FORM_TO_LOAD_MS:6e4,NUM_OF_RETRIES:3},ERROR_CODE:{SECURITY_ERROR:18},KEY_CODES:{SPACE:32,TAB:9,ENTER:13,ESC:27},BROWSERS:{IE:"IE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari"},TEXTS:{DEFAULT_JSON_ERROR_MESSAGES:{title:"Oops...",body:"We can\u2019t collect your feedback at the moment.<br/>Refresh your page and try again",close:"Close this modal"},SCREEN_CAPTURE:{DEFAULT_TITLE:"Screen Capture",DEFAULT_DESCRIPTION:'Click "Capture Image" button or drag the cursor to highlight a specific area'}},FORM_LOADING_FAILURE_CAUSE:{APPLICATION_FAILED:"applicationFailed",JSON_FAILED:"jsonFailed"},PROPERTY_MESSAGES:{NO_JSON_MESSAGE:{TYPE:"noJsonMessage",KEYS:{TITLE:"title",BODY:"body",CLOSE:"close"}}},BROWSER_EVENTS:{FOCUS:"focus",MOUSE_DOWN:"mousedown"},COOLADATA_INSTANCE_NAME:"cooladata_instance_for_medallia_digital",SCREEN_CAPTURE:{DOM_SELECTION:"DOM_SELECTION",DOM_SELECTION_VALUE:"domSelector",AREA_SELECTION_VALUE:"highlight"},COOLADATA_HTTP_EVENTS_BY_METHOD:{BEFORE:{POST:"neb_beforeHttpPostRequest"},AFTER:{GET:"neb_afterHttpGetRequest",POST:"neb_afterHttpPostRequest"},TIMEOUT:{GET:"neb_afterHttpGetRequestOnTimeout",POST:"neb_afterHttpPostRequestOnTimeout"},ERROR:{GET:"neb_afterHttpGetRequestOnError",POST:"neb_afterHttpPostRequestOnError"},ERROR_STATUS_CODE:{GET:"neb_afterHttpGetRequestOnErrorStatusCode",POST:"neb_afterHttpPostRequestOnErrorStatusCode"}},HTTP_METHODS:{GET:"GET",POST:"POST"},COLORS:{USERSNAP_V4_SELECTION_COLOR:"#fb585b",USERSNAP_ONPREM_SELECTION_COLOR:"#004CCB"},VIEW:{FEEDBACK_BUTTON_ID:"nebula_div_btn",FEEDBACK_BUTTON_CONTAINER_ID:"kampyleButtonContainer"},CLOSE_FORM_PARAM_VALUES:{ALL:"all",EMBEDDED:"embedded",MODAL:"modal"},SPINNER_SETTINGS:{ID:"MDigital_spinnerCircle",CONTAINER_ID:"MDigital_spinnerContainer",SIZE:{LARGE:"large",SMALL:"small"}},CSS_SETTINGS:{STYLE_SHEET_ANIMATION_NAME:"MDigital_animationStyle",ANIMATION_RULE_SPIN_NAME:"MDigital_spin"}};function Ie(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),a.forEach(function(i){Ie(t,i,n[i])})}return t}function w(t,e){return e!=null&&typeof Symbol!="undefined"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):w(t,e)}function Se(t){"@swc/helpers - typeof";return t&&typeof Symbol!="undefined"&&t.constructor===Symbol?"symbol":typeof t}function xr(){o.setMemoryData(r.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION,!1);var t=Ut(),e=t&&t.region||r.REGIONS.DEV;o.setMemoryData(r.MEMORY_DATA_FIELDS.REGION,e)}function Br(){return!o.getMemoryData(r.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION)}function Ut(){var t=o.getMemoryData(r.MEMORY_DATA_FIELDS.DATA_JSON);return t||{provisions:{"21dcr1_mpc3281_alignWCAGLogoMarkup":!0,"24dcr2_MPC7960_enableOnsitePostMessageVerification":null,"20dcr4_MPC2905_wcagReviewFixes":!0,ibmIncludeSpecificCPsInCooladataEvent:null,cpExtractRefactor:null,chtmlLogs:null,customEventsBroadcast:!0,sharePropertyBetweenSubdomains:null,googleAnalyticsClientEventsEnabled:null,spaUrlPolling:!0,"20dcr4_MPC2802_enable_backendGeneratedUUID":!0,"21dcr2_MPC2743_enable_newLiveForm":!0,"23dcr1_MPC6711_enableWCAGPrependSurvey":null,customCssUpload:null,willNotScrollToLastPositionDisplayTypeAnimation:null,cooladataNewEvents:null,"20dcr4_MPC2893_enable_ScreenCaptureAsComponent":null,adobeAnalytics:null,eventIncludeFeedbackContent:!0,dynamicModalSizeInCustomHtml:null,"23dcr5_MPC7724_enableCustomEventSubmissionViaCallback":null,"23dcr2_mpc36711_enableFormWCAGReflow":null,"24dcr3_MPC7720_enableNewLiveFormCSP":null,customHtmlFormsEnable:!0,propertyMessages:!0,cooladataEventsLimit:null,"21DCR5_MPC4030_EnableFixForSpaTimeOnPage":!0,targetingEventsReporting:null,"23dcr2_MPC6869_disableNewPageEvents":null,"21DCR3_MPC3866_exposeSelectionQuestionsInCustomEvent":null,"23dcr1_mpc6083_enableMobileWebiOSBannerFix":null,"21dcr3_MPC3281_enable_CHTMLHandleFocusIndependently":null,serverBasedTargeting:null,CSPRemoveInlineStyling:null,enableOverflow:null,doNotSurveyOnUBTNetworkFail:null,"23dcr4_MPC7186_enableInvitationSpinnerFix":null,mobileInvitationLayout:null,addingRandomTimeForTimeInSession:null,"21dcr2_MPC3571_enable_ClearEmbeddedFormOnUpdatePageView":!0,"21dcr3_mpc3662_delaySurveyUntilCSSLoad":null,mobileWebDynamicFormSizeInFormBuilder:null,cookieStorageDisable:null,"23dcr5_MPC7425_enableTextAreaLimitation":null,screenCaptureEnabled:null,skipInvitationOptimization:null,"23dcr5_MPC7566_extractProvisionsToOnsiteData":null,reusableResourcesLibrary:null,formTemplatesWCAG:!0,formSpacing:null,"24dcr1_MPC7724_enableFormv2andInviteCSSDelay":null,"21dcr1_MPC_3283_enable_RTL":null,"21DCR3_MPC3866_exposeVerbatimQuestionsInCustomEvent":null,"23dcr3_MPC7098_enableForm2GapSpacing":!0,"20dcr4_MPC2952_enable_exemptFormsFromQuarantine":!0,"21dcr1_MPC3199_AdditionalButtonStyles":!0,"22dcr2_MPC4277_useDecibelTriggers":null,"23dcr2_MPC6711_enableWCAGerrorMessagesPreQuestions":null,"21dcr6_MPC4143_enable_HideAlternativeOptions":null,"21dcr6_MPC4296_enable_UBTIdentifierHash":null,onPremHybrid:null,"24dcr1_MPC7724_enableIncludeExcludeNewlineFix":null,responsiveRatingComponent:!0,"23dcr3_MPC6996_enableCXJUpgrade":null,"23dcr3_MPC6996_enableOnsiteDomainApproval":null,"21dcr3_MPC3281_enable_newModalDialogs":!0,"23dcr3_MPC4831_enableEncapsulation":!0,UBTExtraEvents:null,adobeAnalyticsObjectName:null,mobileWebDynamicFormSize:null,"23dcr5_MPC7505_enableDescriptiveRequiredText":null,WCAGTrapFocusInModal:!0,dynamicHybridHosting:null,"21dcr1_MPC3370_EnableGreaterSmallerThanSupport":null,underScoreLocalization:null,"24dcr1_MPC_7567_enableDigitalFeedbackAnalytics":null,"24dcr1_MPC7514_enableSPAOverflowFix":null,thermoFisherTeaLeafIntegration:null,alternativeUUID:null,adobeConcatLinkTrackVars:null,adobeIncludeLinkTrackVars:null,"20dcr32_NM11146_PreventIFrameScrollFlickering":!0,separateFormTemplateFromData:!0,dynamicOnsiteEvents:null,"21dcr6_MPC4042_enable_exmdextension":null,cooladataIntegration:!1,cooladataCreateSessionEvent:null,"21DCR1_MPC3199_enable_RatingLabelAlign":!0,"21DCR2_MPC3662_EnableEventsForCEDebug":null,"24dcr2_MPC7960_enableViewportLogicFix":null,"23dcr2_MPC6869_enableCXJSessionEvents":null,parallelTabSolution:null},onsiteDataUrl:null,region:"digital-cloud-voice",websiteId:2,accountId:1,packageVersion:"#####ON_PREM_PACKAGE_VERSION#####",placeholders:{USERSNAP_HOST_PREFIX:"//screencapture.kampyle.com/",USER_AGENT_CLIENT_HINTS_LIST:'["brands", "mobile", "platform", "architecture", "model", "bitness", "platformVersion", "fullVersionList", "wow64", "uaFullVersion"]',ONSITE_DATA_PATH:"resource.digital.voice.va.gov/wdcvoice/2/onsite/onsiteData1731941049278.json",SUBMIT_URL_PREFIX:"https://feedback.digital.voice.va.gov/",JS_SITE_CODE:"resource.digital.voice.va.gov/wdcvoice/2/onsite/generic1731941049831.js",COOLADATA_API_HOST:"udc-neb.kampyle.com/",COOLADATA_SRC_PREFIX:"https://resource.digital.voice.va.gov/",ONSITE_VERSION:"1.64.1",USERSNAP_V4_HOST_PREFIX:"//scp.kampyle.com",URL_PREFIX:"https://resource.digital.voice.va.gov/",USERSNAP_ONPREM_HOST_PREFIX:"https://md-scp.kampyle.com/"},isSpa:!1,isWCAG:!0,sharedSubdomain:null,customCssUpload:!1,isManuallyInviteTargeting:!1,isGoogleAnalyticsClientGTM:!1,isFormsPreloaded:!0,exemptButtonFormsFromQuarantine:!1,exemptCodeFormsFromQuarantine:!1,exemptEmbeddedFormsFromQuarantine:!1,screenCaptureSelectionTool:null,cookieExpirationTime:null,adobeSdkName:null}}function Hr(t){s.httpRequest(r.HTTP_METHODS.GET,t,null,p.onsiteDataSuccess,p.onsiteDataFailed)}function Yr(t){if(!t||t.error)p.onsiteDataFailed(t);else{o.setMemoryData(r.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION,!0);var e=p.formatConfiguration(t);e&&(e.provisions=Object.assign({},e.provisions,p.getOnsiteConfiguration().provisions));var n=Object.assign({},p.getOnsiteConfiguration(),e);n.provisions&&n.provisions[r.PROVISIONS.DYNAMIC_ONSITE_EVENTS]&&E.trigger(r.EVENTS.MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY),z.initOnsite(n)}}function Kr(t){var e={errorMessage:r.LOG_MESSAGES.ERROR_DYNAMIC_ONSITE_INITIALIZATION,additionalInfo:t};E.triggerError(e),o.setMemoryData(r.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION,!1)}function Wr(t){var e=t,n;if(e.formNodes&&e.formNodes.length)for(var a=0;a<e.formNodes.length;a++)typeof e.formNodes[a].customParams=="string"&&(n=JSON.parse(e.formNodes[a].customParams),e.formNodes[a].customParams=n);return e}var p={init:xr,isOnsiteConfigurationMissing:Br,getOnsiteConfiguration:Ut,onsiteDataSuccess:Yr,onsiteDataFailed:Kr,fetchOnsiteExternalConfiguration:Hr,formatConfiguration:Wr};var Xr=["formHtmlUrl","buttonData.buttonUrl","formDataUrl","inviteData.inviteUrl","inviteData.inviteDataUrl","versionedResourcesUrl"];function zr(){return window.KAMPYLE_EMBED.getResourcesPrefix()}function qr(){return s.getNestedPropertyValue(p.getOnsiteConfiguration(),"packageVersion")}function Gt(t){t=t||"";var e;if(t.indexOf(r.PLACEHOLDERS.ONPREM_URL_PREFIX)===-1)return t;var e=t.replace(r.PLACEHOLDERS.ONPREM_URL_PREFIX,window.KAMPYLE_EMBED.getResourcesPrefix());return e}function Jr(t){return t?(Xr.forEach(function(e){var n=s.getNestedPropertyValue(t,e);n&&s.setNestedPropertyValue(t,e,Gt(n))}),t):!1}var J={replaceOnPremPrefixes:Gt,getPackageVersion:qr,getPackageRoot:zr,replaceFormNodeUrls:Jr};function jr(t){return KAMPYLE_ONSITE_SDK.loadForm(t)}function Qr(t,e){return KAMPYLE_ONSITE_SDK.showForm(t,e)}function Zr(t){return KAMPYLE_ONSITE_SDK.closeForm(t)}function $r(t,e){o.isV2Form(e)&&o.getData(r.MEMORY_DATA_FIELDS.LIVE_FORM_V2_DEBUG_MODE)&&(t=t.replace("/index.html","/debug/index.html")),t+="?formId="+e,t+="&type=live",t+="&isMobile="+o.isMobile();var n=window.location.href,a=n.split("?");a&&a.length&&(n=a[0]),t+="&referrer="+encodeURIComponent(n);var i=o.getMemoryData("region");return i&&(t+="&region="+i),o.isFeatureEnabled("WCAG")&&(t+="&isWCAG=true"),c.checkProvision(r.PROVISIONS.CHTML_LOGS)&&o.isCustomHtmlForm(e)&&(t+="&chtmlLogs=true"),t+="&displayType="+o.getDisplayType(o.getFormData(e)),c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)&&(t+="&isSeparateFormTemplateFromData=true"),t+="&domainsListRelativePath="+encodeURIComponent(Vt(t)),t}function ei(t){for(var e="",n=0;n<t;n++)e+="..|";return e}function Vt(t){var e=xt().match(/((?:[\/](?!\/))[a-zA-Z0-9_-]+[\/a-zA-Z0-9_-]*)$/),n=e?e[0]+"resources/config":"/resources/config";if(o.getMemoryData("context")==="preview")return n;var a=s.getParsedUrl(KAMPYLE_EMBED.getGenericLocation()),i=s.getParsedUrl(t);if(a.hostname!==i.hostname)return n;var l=a.pathname,d=i.pathname;if(l&&d){var u=l.split("/").slice(1,-1),f=d.split("/").slice(1,-1);return ei(f.length)+u.join("/")}return""}function ti(t){var e=o.getFormState(t),n=null;for(var a in r.FORM_LOADING_FAILURE_CAUSE){var i=r.FORM_LOADING_FAILURE_CAUSE[a];if(e[i]===!0){n=i;break}}return n}function xt(){var t=c.checkProvision(r.PROVISIONS.ON_PREM_HYBRID);return t?J.getPackageRoot()+"/":r.PLACEHOLDERS.URL_PREFIX}function ni(){var t='<div id="'+r.SPINNER_SETTINGS.CONTAINER_ID+'" class="neb-loading-spinner">';return t+='<div id="'+r.SPINNER_SETTINGS.ID+'"> </div>',t+="</div>",t}var R={loadForm:jr,showForm:Qr,closeForm:Zr,createFormUrl:$r,getSpinnerTemplate:ni,getUrlPrefix:xt,getFormFailureCause:ti,getDomainsListRelativePath:Vt};function ai(t){if(!c.checkProvision(r.PROVISIONS.CP_EXT_REFACTOR))return c.getSafeCustomParamVal(t);var e=t||{},n=b.extractCPValue(e);return b.castCPValue(n,e.type||"")}function ri(t){var e=b.getFormCustomParams(t)||[];return e.map(b.appendValueToCPObject)}function ii(t){var e=p.getOnsiteConfiguration().customParams||[],n=o.getFormData(t)||{};return Bt(t)?n.customParams.map(function(a){return e.find(function(i){return i.id===a})}):null}function Bt(t){var e=o.getFormData(t);return!!e&&!!e.customParams&&Array.isArray(e.customParams)&&!!e.customParams.length}function oi(){return p.getOnsiteConfiguration().customParams||[]}function si(t){var e=b.getCustomParamByUniqueName(t)||{};return b.getCustomParamValue(e)}function li(t){var e=p.getOnsiteConfiguration().customParams||[];return e.find(function(n){return n.unique_name===t})}function di(t,e){if(t!==void 0&&e&&e.customParams&&e.customParams.length){var n=p.getOnsiteConfiguration().customParams||[];return n.find(function(a){return Number(a.id)===Number(t)})||null}else return null}function Ht(t){var e=t.value,n=(t.source||"var").toLowerCase(),a=t.name||t.source_name||"";switch(s.safeToLower(n)){case"var":e=s.getNestedPropertyValue(window,a);break;case"url":e=s.getUrlParam(a);break;case"cookie":e=s.getCookie(a);break;default:e=null;break}return e!==""?e:null}function ui(t){var e=t.value;return e===void 0&&(e=Ht(t)),e!==""?e:null}function ci(t,e){if(t===null)return t;switch(e.toLowerCase()){case"datetime":return b.handleDatetimeCasting(t);case"number":return s.getNumericValue(t);case"text":return b.handleTextCasting(t);case"boolean":return b.handleBooleanCasting(t);default:return console.error("Invalid custom parameter type "+e),null}}function fi(t){return typeof t=="string"?Number(t)||null:!w(t,Date)&&(!(t||{}).getTime||isNaN(t.getTime()))?null:t.getTime()}function Ei(t){return typeof t=="string"?t:null}function mi(t){return t==="true"?!0:t==="false"?!1:typeof t=="boolean"?t:null}function gi(t){t=t||{};var e=b.getCustomParamValue({name:t.source_name,type:t.type,source:t.source});return Object.assign(t,{value:e})}var b={getCustomParamValue:ai,formatCustomParams:ri,getFormCustomParams:ii,hasCustomParams:Bt,fetchCPValue:Ht,getAllCustomParams:oi,getCustomParamValueByUniqueName:si,getCustomParamByUniqueName:li,getCustomParamById:di,extractCPValue:ui,castCPValue:ci,handleDatetimeCasting:fi,handleTextCasting:Ei,handleBooleanCasting:mi,appendValueToCPObject:gi};var _i={DECLINED_DATE:"The user did not decline",SUBMITTED_DATE:"The user did not submit"};function pi(){var t={neb_targetingInit:[rn],MDigital_manuallyInviteTargeting:[on],neb_initButton:[Kt]};E.subscribeMany(t),o.setMemoryData("targetingState",{})}function He(t,e){var n=Number(o.getData(e));if(t=Number(t),!n||!t)return!1;var a=1e3*60*60*24;return n+a*t>s.getCurrentTimestamp()}function Kt(t,e){e=e||{};var n=o.getFormData(e.formId);if(!n)return!1;var a=o.getMemoryData("kampyleDevice");return(a===r.DEVICES.MOBILE||a===r.DEVICES.TABLET)&&c.isPreloadConfigured()&&E.trigger(r.EVENTS.NEB_LOAD_FORM,{formId:e.formId}),o.setFormState(e.formId,{loaded:null}),o.setMemoryData("buttonFormId",e.formId),E.trigger("neb_showButton",{formId:e.formId}),o.setMemoryData("isButtonShown",!0),!0}function Ii(t){return o.getData(t)?new Date(parseInt(o.getData(t))):_i[t]}function $(t){s.sendMessageToIframe("kampyleInvite",{action:r.EVENTS.MDIGITAL_VALIDATE_ORIGIN});var e=o.getMemoryData("currentInviteFormId");if(t=t||o.getFormData(e),!t||o.getMemoryData("isInvitationShouldBeIgnored"))return!1;var n=s.getNestedPropertyValue(t,"inviteData.skipInvitation"),a=o.getMemoryData("targetingState");for(var i in a)if(a[i]!==!0)return!1;var l=T.shouldDisableIntercept(t);if(E.trigger(r.EVENTS.MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED,t),l)return!1;var d=Wt(t);return E.trigger(r.EVENTS.MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED,t),d?(o.setData("kampyleInvitePresented",!0),s.isTruthy(n)?Si(t):T.handleNotSkippedInvitaion(t),!0):!1}function Wt(t){var e=sn(t),n=o.getMemoryData("formIsShown")===!0,a=s.isTrue(s.getNestedPropertyValue(t,"onSiteData.kampyleInvitePerSession.inviteOncePerSession")),i=!a&&s.isTrue(o.getData("kampyleInvitePresented"));E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:r.TARGETING_RULES.INVITE_IF_ANY_INVITE_ALREADY_SHOWN_PER_SESSION,formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!i,expected:"Display Invite "+(a?"more than once per session":"once per session"),actual:!i});var l=!1;return c.checkProvision(r.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)&&(l=!a&&s.isTrue(o.getData(r.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION)),E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:r.TARGETING_RULES.INVITE_IF_ANY_SURVEY_ALREADY_SUBMITTED_PER_SESSION,formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!l,expected:"Display Invite "+(a?"more than once per session":"once per session"),actual:!l})),!e&&!n&&!i&&!l}function Xt(t){var e=c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING)&&c.checkProvision(r.PROVISIONS.DO_NOT_SURVEY_ON_UBT_NETWORK_FAIL)&&!o.getMemoryData("isGuest")&&!o.getMemoryData("isSyncedIdentifierData");return e&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"ubtFailed",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:!e,expected:"should ignore quarantine rules evaluation",actual:e}),e}function Si(t){c.isPreloadConfigured()||E.trigger(r.EVENTS.NEB_LOAD_FORM,{formId:t.formId}),E.trigger("neb_skipInvitation",{formId:t.formId})}function vi(t){var e=Fi(t.onSiteData)===!0,n=s.getNestedPropertyValue(t,"onSiteData.submitted.days"),a=T.getTextByQuarentine("SUBMITTED_DATE");return n&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"DontInviteOnSubmitted",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!e,expected:n+" days",actual:"Current: "+new Date+" Submitted: "+a}),e}function Ai(t){var e=Li(t.onSiteData)===!0,n=T.getTextByQuarentine("DECLINED_DATE"),a=s.getNestedPropertyValue(t,"onSiteData.declined.days");return a&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"DontInviteOnDeclined",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!e,expected:a+" days",actual:"Current: "+new Date+" Declined: "+n}),e}function Ti(t){var e=!1,n=s.getNestedPropertyValue(t,"onSiteData.disableInterceptRule");return n&&(typeof n=="string"&&(n=JSON.parse(n)),e=T.evaluateRule(n,t),E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"disableInterceptRule",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.BEHAVIORAL_TARGETING,isPassed:e,expected:"Disable intercept rule should be true",actual:e})),e}function bi(t){o.getDisplayType(t)===r.DISPLAY_TYPES.POPUP?(o.setFormState(t.formId,{inviteShown:!0}),E.trigger("neb_showInvitation",{formId:t.formId})):c.isFormLoaded(t.formId)?E.trigger("neb_showInvitation",{formId:t.formId}):(o.setMemoryData(T.generateShouldShowInviteParamName(t.formId),!0),E.trigger(r.EVENTS.NEB_LOAD_FORM,{formId:t.formId}))}function Di(){var t=o.getMemoryData("targetingState");t.kampyleTimeInSession=!1,o.getMemoryData("kampyleDevice")==="desktop"&&(t.abandon=!1),t.kampylePageElementEvent=!1,t.kampyleTimeOnPage=!1,o.setMemoryData("targetingState",t)}function hi(t){var e=!0,n;if(e===!0&&(n=jt(t),s.getNestedPropertyValue(t,"urlRules.exclusionUrl.rule")&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"UrlExclude",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:!n,expected:s.getNestedPropertyValue(t,"urlRules.exclusionUrl.rule"),actual:location.href}),n===!0&&(e=!1)),e===!0){var a=Qt(t);s.getNestedPropertyValue(t,"urlRules.inclusionUrl.rule")&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,formTriggerType:o.getFormTriggerType(t.formId),targetingRule:"UrlInclude",targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:a,expected:s.getNestedPropertyValue(t,"urlRules.inclusionUrl.rule"),actual:location.href}),a===!1&&(e=!1)}if(e===!0){var i=zt(t);s.getNestedPropertyValue(t,"onSiteData.genericRule")&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"GenericRule",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:i,expected:"Generic rule evaluation result should be true",actual:i}),e=i}return e===!0&&(e=Zt(t),s.getNestedPropertyValue(t,"onSiteData.devicetypes")&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"DeviceTypes",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:e,expected:s.getNestedPropertyValue(t,"onSiteData.devicetypes").toString(),actual:o.getMemoryData("kampyleDevice")})),e}function zt(t){return t&&t.onSiteData&&t.onSiteData.genericRule?(typeof t.onSiteData.genericRule=="string"&&(c.checkProvision(r.PROVISIONS.GREATER_SMALLER_THAN_DECODE)&&(t.onSiteData.genericRule=s.htmlDecode(t.onSiteData.genericRule)),t.onSiteData.genericRule=JSON.parse(t.onSiteData.genericRule)),T.evaluateRule(t.onSiteData.genericRule,t)):!0}function qt(t){if(typeof t!="string")return!1;if(c.checkProvision(r.PROVISIONS.ENABLE_INCLUDE_EXCLUDE_NEW_LINE_FIX)){if(t==="")return!1;t=t.replace(/%3B/g,";")}t=t.toLowerCase();var e=document.location.href.toLowerCase(),n=e.substring(0,t.length);return n===t?!0:(e=e.replace(/^(?:https?:\/\/)?(?:www\.)?([^\/]+)/i,""),n=e.substring(0,t.length),n===t)}function Jt(t){t=t.split(";");for(var e=t.length,n=0;n<e;n++){var a=qt(t[n]);if(a===!0)return!0}return!1}function jt(t){if(t.urlRules&&t.urlRules.exclusionUrl&&t.urlRules.exclusionUrl.rule){var e=Jt(t.urlRules.exclusionUrl.rule);return e}return!1}function Qt(t){if(t.urlRules&&t.urlRules.inclusionUrl&&t.urlRules.inclusionUrl.rule){var e=Jt(t.urlRules.inclusionUrl.rule);return e}return!0}function yi(t,e){var n={text:[r.OPERATORS.EQUALS,r.OPERATORS.DOES_NOT_EQUAL,r.OPERATORS.CONTAINS,r.OPERATORS.DOES_NOT_CONTAIN,r.OPERATORS.STARTS_WITH,r.OPERATORS.ENDS_WITH,r.OPERATORS.HAS_VALUE,r.OPERATORS.REGEX],boolean:[r.OPERATORS.EQUALS,r.OPERATORS.HAS_VALUE],datetime:[r.OPERATORS.EQUALS,r.OPERATORS.DOES_NOT_EQUAL,r.OPERATORS.LATER_THAN,r.OPERATORS.EARLIER_THAN,r.OPERATORS.HAS_VALUE],number:[r.OPERATORS.EQUALS,r.OPERATORS.DOES_NOT_EQUAL,r.OPERATORS.GREATER_THAN,r.OPERATORS.SMALLER_THAN,r.OPERATORS.HAS_VALUE]};return t=s.safeToLower(t),e=s.safeToLower(e),!(!t||!e||!n[t]||n[t].indexOf(e)===-1)}function Oi(t,e){var n=!1,a,i,l;if(!t)return!1;var d=["customParam"],u=s.safeToLower(t.condition);if(!t||t.value===void 0||t.value===null||d.indexOf(t.fieldOrigin)===-1)n=!1;else switch(t.fieldOrigin){case"customParam":var f=b.getCustomParamById(t.fieldId,e);f&&f.source_name&&(a=b.getCustomParamValue({type:f.type,name:f.source_name,source:f.source}),i=b.getCustomParamValue({type:f.type,name:f.source_name,source:f.source,value:t.value}),l=yi(f.type,t.condition)),a!==void 0&&l&&(n=s.kampyleCompareByOperator(a,i,u,f.type));break;default:break}return n}function Ni(t,e){var n,a=!1,i=!1;if(t&&t.type==="criteriaGroup"&&t.childrenCriterias&&t.childrenCriterias.length&&t.conjunction)for(var l=0;l<t.childrenCriterias.length&&!i;l++)n=T.evaluateRule(t.childrenCriterias[l],e),n&&t.conjunction==="OR"?(a=!0,i=!0):!n&&t.conjunction==="AND"?(a=!1,i=!0):a=n;else t&&t.type==="criteria"&&(a=Oi(t,e));return a}function Ci(t){var e=o.getData("kampyleUserSessionsCount"),n=!1,a=s.getNestedPropertyValue(t,"onSiteData.numberOfVisits.numberOfRepeats"),i=s.getNestedPropertyValue(t,"onSiteData.numberOfVisits.compareString");return e&&(a===null||i===null?n=!0:n=s.kampyleCompareByOperator(parseInt(e),parseInt(a),i)),a&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"NumberOfVisits",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:n,expected:i+" "+a,actual:e}),n}function Zt(t){if(t&&t.onSiteData&&t.onSiteData.devicetypes){for(var e=t.onSiteData.devicetypes.length,n=0;n<e;n++)if(t.onSiteData.devicetypes[n]===o.getMemoryData("kampyleDevice"))return!0;return!1}return!0}function $t(t){t=t||{};var e=Number(o.getData("kampyleSessionPageCounter")||0);return s.kampyleCompareByOperator(e,parseInt(t.numberOfRepeats),t.compareString)}function en(){var t=o.getStorageDataByPrefix(r.MEMORY_DATA_FIELDS.SESSION_TAB_PREFIX);t.sort(function(n,a){return Number(n)-Number(a)});var e=t.findIndex(function(n){return Number(n)===o.getMemoryData(r.MEMORY_DATA_FIELDS.CURRENT_SESSION_TAB_ID)});return e>=0?(e+1)*r.DELAY_BETWEEN_TABS_TRIGGER_MS:null}function Mi(){var t=en();typeof t=="number"&&setTimeout(function(){$()},t)}function Pi(t,e){Ye(t,e,!0)}function Ri(){var t=o.getData("kampyleUserSession"),e=parseInt(t),n=s.getTimeDiff(e);return n}function Ye(t,e,n){var a=parseInt(t)*1e3,i=Ri(),l=o.getMemoryData("targetingState");if(l&&i>=a)l.kampyleTimeInSession=!0,o.setMemoryData("targetingState",l),E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"TimeInSession",formTriggerType:o.getFormTriggerType(e.formId),targetingPhase:r.TARGETING_PHASES.BEHAVIORAL_TARGETING,isPassed:!0,expected:a,actual:"Over on the expected "+a}),c.checkProvision(r.PROVISIONS.PARALLEL_TAB_SOLUTION)?n?T.isShowInvite():T.onTimeInSessionEnds():T.isShowInvite();else{if(c.checkProvision(r.PROVISIONS.PARALLEL_TAB_SOLUTION)&&n){var d=Math.ceil(Math.random()*999999999999);o.setData(r.MEMORY_DATA_FIELDS.SESSION_TAB_PREFIX+d,d),o.setMemoryData(r.MEMORY_DATA_FIELDS.CURRENT_SESSION_TAB_ID,d)}var u=0;if(c.checkProvision(r.PROVISIONS.ADD_RANDOM_TIME_FOR_SESSION)){var f=500,m=9e3;u=s.getRandomTimeMS(f,m)}var g=a-i,S=this;setTimeout(function(){Ye(t,e,!1)},g+u)}}function Li(t){if(t=t||{},t.declined!==null&&t.declined!==void 0){var e=He(t.declined.days,"DECLINED_DATE");return e}return!1}function Fi(t){if(s.getNestedPropertyValue(t,"submitted")){var e=He(t.submitted.days,"SUBMITTED_DATE");return e}return!1}function wi(t){var e=Qt(t)&&!jt(t);e&&(o.setMemoryData("targetingState.abandon",!0),$()===!1&&o.setMemoryData("targetingState.abandon",!1)),E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"UserAbandonment",formTriggerType:o.getFormTriggerType(t.formId),isPassed:e,targetingPhase:r.TARGETING_PHASES.BEHAVIORAL_TARGETING,expected:"Mouse over user abandonment",actual:"Mouse was over user abandonment"})}function ki(t,e){var n="0",a="5";t||(t={height:a,zIndex:n});var i=t.zIndex?t.zIndex:n,l=t.height&&t.height!=="0"?t.height+"px":a+"px",d=document.getElementById("kampyle_abandon_zone");if(d===null){var d=document.createElement("div");d.id="kampyle_abandon_zone",d.style.width="100%",d.style.height=l,d.style.zIndex=i,d.style.position="fixed",d.style.top="0px",d.onmouseover=function(){wi(e)},document.body.appendChild(d)}else d.style.height=l,d.style.zIndex=i}function tn(t){if(!t||!t.selectorValue||!t.selectorType)return null;var e="{{selector}}{{value}}";switch(t.selectorType){case"className":e=e.replace("{{selector}}",".");break;case"objectId":e=e.replace("{{selector}}","#");break;default:return s.showWarning("Invalid selector type:"+t.selectorType),null}return e=e.replace("{{value}}",t.selectorValue),e}function nn(t,e){var n=tn(t);if(!n)return null;for(var a=Number(t.time)||0,i=document.querySelectorAll(n)||[],l=0;l<i.length;l++){var d=function(){var f=setTimeout(function(){o.setMemoryData("targetingState.kampylePageElementEvent",!0),E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"PageElement",formTriggerType:o.getFormTriggerType(e.formId),isPassed:!0,targetingPhase:r.TARGETING_PHASES.BEHAVIORAL_TARGETING,expected:t.eventName+" for element with "+t.selectorType+"="+t.selectorValue,actual:!0}),$()===!1&&o.setMemoryData("targetingState.kampylePageElementEvent",!1),clearTimeout(f)},a*1e3);o.setTimeoutHandler("triggerByEventTimeout_"+l,f)};i[l].addEventListener(t.eventName,d),o.setDOMEventHandler("triggerByEvent_"+l,t.eventName,d,i[l])}}function Ui(t){var e=s.getNestedPropertyValue(t,"onSiteData.kampyleTimeOnPage.time");e&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"TimeOnPage",formTriggerType:o.getFormTriggerType(t.formId),isPassed:!0,targetingPhase:r.TARGETING_PHASES.BEHAVIORAL_TARGETING,expected:e,actual:"Over on the expecetd "+e})}function Gi(t,e){if(t===null){o.setMemoryData("targetingState.kampyleTimeOnPage",!0);return}var n=setTimeout(function(){o.setMemoryData("targetingState.kampyleTimeOnPage",!0),Ui(e),$()},t*1e3);if(c.checkProvision(r.PROVISIONS.ENABLE_FIX_FOR_SPA_TIME_ON_PAGE)){var a="timeOnPage_"+e.formId;o.setTimeoutHandler(a,n)}o.setData("kampylePageLoadedTimestamp",s.getCurrentTimestamp())}function Ke(t){var e=o.getData("kampyleUserPercentile");return!e&&e!=="0"&&(e=Math.random()*100,o.setData("kampyleUserPercentile",e)),Number(e)&&Number(e).toFixed?Number(e).toFixed(1):Number(e)}function an(t){var e=Ke();if(t&&e){var n=Number(t.prec);if(e>n)return!1}return!0}function Vi(t){o.setMemoryData("isInviteActivated",!0);var e=o.getMemoryData("targetingState");if(0)var n,a;t.onSiteData.kampyleTimeInSession!==void 0?Pi(t.onSiteData.kampyleTimeInSession.time,t):e.kampyleTimeInSession=!0,t.onSiteData.abandon?o.getMemoryData("kampyleDevice")==="desktop"&&ki(t.onSiteData.abandon,t):e.abandon=!0;var i=o.getTargetingData(t.formId,"pageEvents");i?nn(i,t):e.kampylePageElementEvent=!0,t.onSiteData.kampyleTimeOnPage!==void 0?Gi(t.onSiteData.kampyleTimeOnPage.time,t):e.kampyleTimeOnPage=!0,o.setMemoryData("targetingState",e);for(var l in e)if(e.hasOwnProperty(l)&&!e[l])return!1;$(t)}function rn(t,e){xi(),Di(),on(t,e)}function xi(){o.setMemoryData("invitationTimeStamp",null),o.setMemoryData("buttonFormId",null),o.setMemoryData("formIsShown",!1),o.setMemoryData("isButtonShown",!1),o.setMemoryData("isInviteActivated",!1),o.setMemoryData("targetingState",{})}function Bi(){var t=o.getAllForms();if(!(!t||!t.length)){for(var e,n=t.length-1;n>=0;n--)if(t[n].formType===r.FORM_TYPES.EMBEDDED&&(e=T.validateCommonTargetingOnForm(t[n]),e)){var a=!T.checkQuarantine(t[n]),i=T.validateCommonSessionTargeting(t[n].formId),l=!Xt(t[n]);l&&a&&i&&E.trigger(r.EVENTS.NEB_LOAD_FORM,{formId:t[n].formId})}}}function Hi(){var t=null;if(c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING)){t=c.getUserIdentifierVal();var e=t!==null;o.setMemoryData("isGuest",!e),E.trigger("neb_initUserIdentifier",{hasIdentifierValue:e})}return t}function Yt(t,e,n){c.shouldSyncIdentifier(t)?(E.trigger("MDigital_settingIdentifierValueOnMemory",{hasIdentifierValue:t!==null}),o.setMemoryData("identifierValue",t),c.syncIdentifierData(encodeURIComponent(t),Be.bind(this,arguments[0],arguments[1]))):(E.trigger("MDigital_shouldNotSyncIdentifier"),Be(e,n))}function on(t,e){var n=Hi();if(c.checkProvision(r.PROVISIONS.ENABLE_UBT_IDENTIFIER_HASH)){var a=s.sha512(n);a.then(function(i){Yt(i,t,e)})}else Yt(n,t,e)}function Be(t,e){e=e||{};var n=o.getAllForms();if(!(!n||!n.length)){T.initEmbeddedTargeting();for(var a,i=n.length-1;i>=0&&(n[i].formType===r.FORM_TYPES.BUTTON&&!e.skipButtonTargeting&&o.getMemoryData("isButtonShown")===!1?(a=T.validateCommonTargetingOnForm(n[i]),a===!0&&E.trigger("neb_initButton",{formId:n[i].formId})):T.shouldCheckInvite(n[i],e)&&(a=T.validateCommonTargetingOnForm(n[i])&&T.validateCommonSessionTargeting(n[i].formId),a===!0&&T.initDynamicTargeting(n[i])),!(o.getMemoryData("isInviteActivated")===!0&&o.getMemoryData("isButtonShown")===!0));i--);E.trigger(r.EVENTS.MDIGITAL_PAGE_TARGETING_PHASE_ENDED)}}function Yi(t,e){return t.formType===r.FORM_TYPES.INVITATION&&s.kampyleIsCookieEnabled()&&!e.skipInviteTargeting&&o.getMemoryData("isInviteActivated")===!1&&!T.isUbtFailed(t)}function Ki(t){t=t||"";var e=o.getFormData(t)||{},n=e.formType===r.FORM_TYPES.INVITATION;if(n&&o.setMemoryData("currentInviteFormId",t),T.isNumSessions(e)===!1)return!1;if(s.getNestedPropertyValue(e,"onSiteData.kampyleInvitePercentageUsers.prec")){var a=an(e.onSiteData.kampyleInvitePercentageUsers);if(E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"UsersPercentage",formTriggerType:o.getFormTriggerType(e.formId),targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:a,expected:s.getNestedPropertyValue(e,"onSiteData.kampyleInvitePercentageUsers.prec"),actual:Ke()}),a===!1)return!1}var i=!!e.onSiteData.numberOfPagesViewed&&$t(e.onSiteData.numberOfPagesViewed)===!1;return s.getNestedPropertyValue(e,"onSiteData.numberOfPagesViewed.numberOfRepeats")&&E.trigger(r.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"NumberOfPagesViewed",targetingPhase:r.TARGETING_PHASES.PAGE_TARGETING,isPassed:!i,expected:s.getNestedPropertyValue(e,"onSiteData.numberOfPagesViewed.numberOfRepeats"),actual:o.getData("kampyleSessionPageCounter")}),i?!1:(n&&(s.isTrue(e.inviteData.skipInvitation)?c.isPreloadConfigured()&&E.trigger(r.EVENTS.NEB_LOAD_FORM,{formId:t}):E.trigger("neb_loadInvitation",{formId:t})),!0)}function Wi(t,e){o.setMemoryData("targetingState."+t,e)}function Xi(t){return t?"shouldShowInvite_"+t:null}function sn(t){var e=T.isAlreadyDeclined(t),n=T.isAlreadySubmitted(t);return e||n}var T={init:pi,initTargeting:rn,initFormsTargeting:Be,validateCommonTargetingOnForm:hi,isShowInvite:$,handleButton:Kt,isDataValid:He,generateShouldShowInviteParamName:Xi,handleNotSkippedInvitaion:bi,initDynamicTargeting:Vi,validateCommonSessionTargeting:Ki,isUbtFailed:Xt,evaluateRule:Ni,shouldDisableIntercept:Ti,checkPagesInSession:$t,isNumSessions:Ci,targetingDevice:Zt,getUserPercentile:Ke,checkPercentageUsers:an,validateGap:Ye,getEventQuery:tn,handleTriggerByEvents:nn,isUrlMatch:qt,onTimeInSessionEnds:Mi,getDelayTimeByTabIndex:en,setTargetingState:Wi,getTextByQuarentine:Ii,shouldCheckInvite:Yi,isQuarantinePhasePassed:Wt,isGenericRuleValid:zt,checkQuarantine:sn,initEmbeddedTargeting:Bi,isAlreadyDeclined:Ai,isAlreadySubmitted:vi};function zi(t){var e=s.getNestedPropertyValue(t,"formId"),n=s.getNestedPropertyValue(t,"formLocalizationSettings.customParam"),a=o.getFormData(e)||{},i=b.getCustomParamById(n,a)||{};return b.fetchCPValue(i)||s.getNestedPropertyValue(t,"formLocalizationSettings.defaultLanguage")}function ln(t){var e=s.isTruthy(s.getNestedPropertyValue(t,"formLocalizationSettings.useCustomParam"));return e?N.getLangCodeFromCP(t):s.getLangCodeFromNavAPI()}function dn(t,e){var n=s.getNestedPropertyValue(t,"availableLanguages"),a=t.formLocalizationSettings.defaultLanguage,i=e.split("-")[0].toLowerCase(),l=n.find(function(d){return d.toLowerCase()===i})||n.find(function(d){return d.indexOf(i)===0});return l||a}function qi(t){if(!t.availableLanguages)return null;var e=ln(t)||"";return c.checkProvision(r.PROVISIONS.UNDERSCORE_LOCALIZATION)&&(e=e.replace("_","-")),t.availableLanguages.find(function(n){return n.toLowerCase()===e.toLowerCase()})||dn(t,e)}function We(t){return N.detectUsableLanguageCode({availableLanguages:t.availableLanguages,formLocalizationSettings:t.formLocalizationSettings,formId:t.formId})}function Ji(t){var e=r.LANG_MEMORY_DATA_KEY_PREFIX+t.formId,n=o.getMemoryData(e);n||(n=We(t),o.setMemoryData(e,n));var a=s.getNestedPropertyValue(t,"buttonData.textLocalization")||{},i=a[n]||t.buttonData.text;return i&&typeof i=="object"&&(i=i.buttonText),i}function un(t){if(!t)return null;var e=r.LANG_MEMORY_DATA_KEY_PREFIX+t.formId,n=We(t);return o.setMemoryData(e,n),n}function ji(t){var e=We(t),n=s.getNestedPropertyValue(t,"buttonData.textLocalization")||{};return n[e]&&n[e].isRtl==="true"}function Qi(t){var e=o.getFormData(t)||{};return e?o.getMemoryData(r.LANG_MEMORY_DATA_KEY_PREFIX+t)||un(e):null}var N={getLangCodeFromCP:zi,getLangCode:ln,getLangaugeFallback:dn,detectUsableLanguageCode:qi,detectAndSetFormLanguage:un,getLocalizedButtonText:Ji,getFormLanguage:Qi,isFormLanguageRtl:ji};function Zi(){var t=s.getOrCreateWrapperContainer(r.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID),e=Object.assign(document.createElement("div"),{id:"kampyleFormContainer"}),n={top:0,left:0,width:"100%",height:"100%",position:"fixed",visibility:"hidden",display:"table",backgroundColor:"rgba(102,102,102,0.4)",zIndex:"99999999",webkitOverflowScrolling:"touch"};s.setElementStyle(e,n,!0);var a=document.createElement("div");a.id="kampyleFormContainer";var i=Xe(),l=document.createElement("div");l.id="kampyleFormModal",s.setElementStyle(l,{zIndex:"99999999",webkitOverflowScrolling:"touch"},!0),a.appendChild(i),a.appendChild(l),e.appendChild(a),t.appendChild(e),s.setSpinnerStyle(i,r.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(r.PROVISIONS.ENABLE_WCAG_PREPEND_SURVEY)?document.body.prepend(t):document.body.appendChild(t)}function $i(t){var e=s.getOrCreateWrapperContainer(r.IFRAME_SETTINGS.INVITATION.WRAPPER_ID),n=Object.assign(document.createElement("div"),{id:"kampyleInviteContainer"});s.setElementStyle(n,{top:"0",left:"0",width:"100%",height:"100%",position:"fixed",visibility:"hidden",display:"none",backgroundColor:"rgba(22,22,22,0.5)",zIndex:"99999999",overflow:"auto"},!0);var a=Xe(),i=document.createElement("div");i.id="kampyleInviteModal",s.setElementStyle(i,{overflow:"hidden",margin:"0 auto",height:t.inviteData.inviteHeight,width:t.inviteData.inviteWidth,position:"relative",zIndex:"99999999",top:"25%",webkitBoxShadow:"0 0 10px rgba(0,0,0,0.4)",mozBoxShadow:"0 0 10px rgba(0,0,0,0.4)",boxShadow:"0 0 10px rgba(0,0,0,0.4)"}),n.appendChild(i),n.appendChild(a),e.appendChild(n),s.setSpinnerStyle(a,r.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(r.PROVISIONS.ENABLE_PREPEND_SURVEY)?document.body.prepend(e):document.body.appendChild(e)}function eo(t,e,n,a,i){var l=document.createElement("div"),d=c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)?{id:t}:{tabIndex:0,id:t,role:"alertdialog","aria-modal":!0,"aria-labelledby":"title-no-json-modal","aria-describedby":"description-no-json-modal",lang:l};s.addAttributesOnElement(l,d),s.setElementStyle(l,{position:"relative",textAlign:"center",backgroundColor:"rgba(255,255,255, 1)",margin:o.getMemoryData("context")==="preview"?"100px auto 2% auto":"5% auto 2% auto",border:"1px solid #cccccc",boxShadow:"8px 10px 58px 2px rgba(64, 64, 74, 0.56)",color:"#2C3548",fontFamily:"helvetica",height:"500px",width:o.isMobile()?"98%":"450px"});var u=io(i,e),f=so(),m=oo(n),g=lo(a);return l.appendChild(u),l.appendChild(f),l.appendChild(m),l.appendChild(g),l}function to(t){var e=_.getButtonText(t),n="kampyle_"+t.buttonData.position,a=document.createElement("button"),i=c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion"),l=1;if(i){var d=s.getZoomedIn();o.setMemoryData("kampylePageZoom",d.zoom),l=d.isZoomedIn?fn():1}var u=125*l,f=35*l,m=14*l,g=-45*l,S=window.innerHeight,O=S*.55-u;s.addAttributesOnElement(a,{id:"nebula_div_btn",alt:e,tabIndex:"0",class:"kampyle_vertical_button "+n+" "+_.getWCAGClass()}),s.setElementStyle(a,{backgroundColor:"transparent",height:"auto",minHeight:f+"px",maxHeight:f+"px",width:u+"px",minWidth:u+"px",maxWidth:u+"px",padding:0},!1),s.setElementStyle(a,{fontFamily:"Open Sans, sans-serif",cursor:"pointer",position:"fixed",bottom:O+"px",border:"none",zIndex:"99999990",height:f+"px","-ms-transform":"rotate(90deg)","-webkit-transform":"rotate(90deg)",transform:"rotate(90deg)"}),o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)?s.addWcagStyleOnFocus(a):s.setElementStyle(a,{outline:"none"},!1),a.style[t.buttonData.position]=g+"px";var I=document.createElement("div");I.setAttribute("class","kampyle_button");var A=t.buttonData.position==="left"?"3px 3px 0 0":"0 0 3px 3px";s.setElementStyle(I,{width:u+"px",minWidth:u+"px",maxWidth:u+"px",minHeight:f+"px",maxHeight:f+"px","-webkit-border-radius":A,"-moz-border-radius":A,"-ms-border-radius":A,"border-radius":A},!1),s.setElementStyle(I,{height:f+"px",background:t.buttonData.backgroundColor,color:t.buttonData.textColor,position:"absolute",top:0,left:0,zIndex:"-1"});var v=document.createElement("div");if(s.addAttributesOnElement(v,{"data-aut":"feedback",class:"kampyle_button-text"}),s.setElementStyle(v,{fontWeight:"normal"},!1),s.setElementStyle(v,{color:t.buttonData.textColor,fontSize:m+"px",lineHeight:f+"px",textAlign:"center"}),c.checkProvision(r.PROVISIONS.RTL)&&N.isFormLanguageRtl(t)&&s.setElementStyle(v,{transform:"scale(-1)","-ms-transform":"scale(-1)","-webkit-transform":"scale(-1)"}),c.checkProvision(r.PROVISIONS.ADDITIONAL_BUTTON_STYLES)){var P="#FFFFFF",F="#396CEF";cn(a,{bgElementStyle:{backgroundColor:t.buttonData.backgroundColor},textElementStyle:{color:t.buttonData.textColor}},{bgElementStyle:{backgroundColor:t.buttonData.backgroundHoverColor||F},textElementStyle:{color:t.buttonData.textHoverColor||P}})}var U=document.createTextNode(e);return v.appendChild(U),a.appendChild(I),a.appendChild(v),a}function cn(t,e,n){t&&e&&n&&typeof t.addEventListener=="function"&&(t.addEventListener("mouseenter",function(){var a=t.children[0],i=t.children[1];s.setElementStyle(a,n.bgElementStyle),s.setElementStyle(i,n.textElementStyle)}),t.addEventListener("mouseleave",function(){var a=t.children[0],i=t.children[1];s.setElementStyle(a,e.bgElementStyle),s.setElementStyle(i,e.textElementStyle)}))}function no(t,e){return{topRight:{btnStyle:{top:0,right:0},div1Style:{top:0,right:0,borderTop:e+" solid "+t.buttonData.backgroundColor,borderLeft:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(45deg)","-webkit-transform":"rotate(45deg)",transform:"rotate(45deg)"}},topLeft:{btnStyle:{top:0,left:0},div1Style:{top:0,left:0,borderTop:e+" solid "+t.buttonData.backgroundColor,borderRight:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(-45deg)","-webkit-transform":"rotate(-45deg)",transform:"rotate(-45deg)"}},bottomRight:{btnStyle:{bottom:0,right:0},div1Style:{bottom:0,right:0,borderBottom:e+" solid "+t.buttonData.backgroundColor,borderLeft:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(-45deg)","-webkit-transform":"rotate(-45deg)",transform:"rotate(-45deg)"}},bottomLeft:{btnStyle:{bottom:0,left:0},div1Style:{bottom:0,left:0,borderBottom:e+" solid "+t.buttonData.backgroundColor,borderRight:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(45deg)","-webkit-transform":"rotate(45deg)",transform:"rotate(45deg)"}}}}function fn(){var t=s.getZoomedIn();return t.constraint/t.zoom}function ao(t){var e=c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion"),n=e&&s.getZoomedIn().isZoomedIn?fn():1,a=81*n+"px",i=no(t,a),l=document.createElement("button"),d=_.getButtonText(t),u=t.buttonData.position||"topLeft",f=_.getClassDirectonByPosition(u),m=i[u].btnStyle,g=i[u].div1Style,S=i[u].div2Style;s.addAttributesOnElement(l,{id:"nebula_div_btn",alt:d,tabindex:0,class:"kampyle_feedback-button "+f.leftright+" "+_.getWCAGClass()}),s.setElementStyle(l,{backgroundColor:"transparent",height:"auto",padding:0},!1),s.setElementStyle(l,Object.assign({fontFamily:"Open Sans, sans-serif",cursor:"pointer",position:"fixed",border:"none",zIndex:"99999990"},m)),o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)?(l.addEventListener("focusin",function(v){s.setElementStyle(l,{outline:"1px dashed #595959",outlineOffset:"2px",transition:"none"},!1)}),l.addEventListener("focusout",function(v){l.style.outline="none",l.style.outlineOffset=null,l.style.transition=null})):s.setElementStyle(l,{outline:"none"},!1);var O=document.createElement("div");O.setAttribute("class","kampyle_triangle"),s.setElementStyle(O,Object.assign({position:"absolute",width:0,height:0,zIndex:-1},g));var I=document.createElement("div");s.addAttributesOnElement(I,{"data-aut":"feedback",class:"kampyle_button-text "+f.topbottom}),s.setElementStyle(I,{fontWeight:"normal",lineHeight:u==="bottomLeft"||u==="bottomRight"?108*n+"px":53*n+"px"},!1),s.setElementStyle(I,Object.assign({height:a,width:a,textAlign:"center",zIndex:"1000",color:t.buttonData.textColor,fontSize:14*n+"px"},S));var A=document.createTextNode(d);return I.appendChild(A),l.appendChild(O),l.appendChild(I),l}function ro(t){var e={bottomLeft:{bottom:0,left:0},bottomRight:{bottom:0,right:0},topLeft:{top:0,left:0},topRight:{top:0,right:0},left:{left:0,top:"50%"},right:{right:0,top:"50%"}},n=document.createElement("button"),a=document.createElement("img"),i=_.getButtonText(t),l=e[t.buttonData.position];return s.addAttributesOnElement(n,{id:"nebula_div_btn",tabindex:0,class:"nebula_image_button "+_.getWCAGClass()}),s.setElementStyle(n,{zIndex:"99999990",position:"fixed",cursor:"pointer",border:"none",lineHeight:"1px",width:"auto",background:"transparent"},!1),s.setElementStyle(n,Object.assign({padding:0},l)),o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)?(n.addEventListener("focusin",function(d){s.setElementStyle(n,{outline:"1px dashed #595959",outlineOffset:"2px",transition:"none"},!1)}),n.addEventListener("focusout",function(d){n.style.outline="none",n.style.outlineOffset=null,n.style.transition=null})):s.setElementStyle(n,{outline:"none"},!1),s.addAttributesOnElement(a,{alt:i,src:t.buttonData.buttonUrl}),n.appendChild(a),n}function io(t,e){var n=document.createElement("i");return s.addAttributesOnElement(n,{"aria-hidden":!c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS),tabIndex:c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)?0:-1,id:"close-no-json-modal","data-aut":"no-json-modal-close-button",role:"button",lang:e,"aria-label":t}),s.setElementStyle(n,{cursor:"pointer",position:"absolute",top:"3px",right:"12px",fontStyle:"normal",fontSize:"28px",opacity:.7}),o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)&&s.addWcagStyleOnFocus(n),s.isDesktop()&&s.addHoverEffectOnElement(n,{opacity:.7},{opacity:1}),n.innerHTML="\xD7",n}function oo(t){var e=document.createElement("h2");return s.addAttributesOnElement(e,{id:"title-no-json-modal"}),s.setElementStyle(e,{fontWeight:"bold",margin:"40px 0 16px",fontSize:"24px"}),e.appendChild(document.createTextNode(t)),e}function so(){var t=document.createElement("img");return s.addAttributesOnElement(t,{src:R.getUrlPrefix()+r.SRC.OOPS}),s.setElementStyle(t,{marginLeft:"-1px"}),t}function lo(t){var e=document.createElement("div");s.addAttributesOnElement(e,{id:"description-no-json-modal"}),s.setElementStyle(e,{padding:"0 44px",color:"#2C3548",fontFamily:"helvetica",lineHeight:"23px",fontSize:"16px"});var n=document.createElement("p");return n.innerHTML=t,e.appendChild(n),e}function Xe(){var t=document.createElement("div");t.id=r.SPINNER_SETTINGS.CONTAINER_ID,s.addAttributesOnElement(t,{class:"neb-loading-spinner"});var e=document.createElement("div");return e.id=r.SPINNER_SETTINGS.ID,t.appendChild(e),t}var G={createFormContainer:Zi,createInviteIframeContainer:$i,getErrorModal:eo,getVerticalButton:to,getTriangularButton:ao,getCustomButton:ro,addHoverStyleToFeedbackButton:cn,createSpinnerElement:Xe};function uo(){var t=x({neb_formLoadingHasFailed:[fo],neb_formClosed:[co]},c.checkProvision(r.PROVISIONS.TARGETING_EVENTS_REPORTING)&&{MDigital_targetingRuleEvaluated:[En]});E.subscribeMany(t)}function co(t,e){var n=e.formId;n&&o.setFormState(e.formId,{shown:!1})}function fo(t,e){var n={};n[e.failureCause]=!0,o.setFormState(e.formId,n)}function En(t,e){if(!gn(e))return!1;var n=o.getFormState(e.formId),a=[].concat(n.targeting[e.targetingPhase]||[]);a.push(mn(e));var i={};i[e.targetingPhase]=a,o.setFormState(e.formId,{targeting:i})}function Eo(t){var e=o.getFormState(t);return!!e&&!!e.inviteLoaded}function mo(t){var e=o.getFormState(t);return!!e&&!!e.loaded}function go(t){var e=c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION),n=o.getFormState(t);return e?n.loaded&&c.isJsonDataLoaded(t,!1):n.loaded}function _o(t){var e=o.getFormState(t);return e&&e.shouldBeShown}function po(t){var e=o.getFormState(t);return e&&e.shown}function mn(t){var e={targetingRule:"",isPassed:!1,expected:"",actual:""};return Object.keys(e).forEach(function(n){e[n]=t[n]}),e}function gn(t){t=t||{};var e=o.getFormState(t.formId);return!(!e||!e.targeting||!t.targetingPhase)}var M={init:uo,updateTargetingState:En,getRuleData:mn,canUpdateState:gn,shouldFormBeShown:_o,isFormLoaded:mo,isInviteLoaded:Eo,isFormShown:po,isFormFullyLoaded:go};function Io(){var t={DEBUG:"log",INFO:"info",WARN:"warn",ERROR:"warn"};this._logs=[],this.init=function(){this.setLoggerStatus(!1)},this.getLoggerStatus=function(){var e=o.getData("mdLogger");return e==="true"||e===!0},this.setLoggerStatus=function(e){o.setData("mdLogger",e)},this.debug=function(e){this.writeLog("DEBUG",e)},this.warn=function(e){this.writeLog("WARN",e)},this.error=function(e){this.writeLog("ERROR",e)},this.writeLog=function(e,n){var a=t[e]||t.DEBUG;n=this.setTimeAndLevelOnMessage(e,n),this._logs.push({type:a,message:n||""})},this.setTimeAndLevelOnMessage=function(e,n){return new Date+" ["+e+"] "+n},this.printLogs=function(){var e="";return this._logs.forEach(function(n){console[n.type](n.message),e+=" "+n.message}),e}}var h=new Io;function se(){var t=p.getOnsiteConfiguration();return t&&t.propertyMessages||{}}function ze(){var t=se();return s.getNestedPropertyValue(t,"localizationSettings.defaultLanguage")}function _n(){var t=se(),e=s.getNestedPropertyValue(t,"localizationSettings.customParam");return b.getCustomParamValue({type:e.type,name:e.source_name,source:e.source})||ze()}function pn(){var t=se(),e=s.getNestedPropertyValue(t,"localizationSettings.useCustomParam");return e?_n():s.getLangCodeFromNavAPI()}function So(t,e){var n=se().messagesData||{},a=s.safeToLower(pn()),i=n[t]&&n[t][a];if(i&&i[e]!=null)return i[e];var l=s.safeToLower(ze()),d=n[t]&&n[t][l];return d&&d[e]!=null?d[e]:r.TEXTS.DEFAULT_JSON_ERROR_MESSAGES[e]}var Y={getPropertyMessageLanguageCode:pn,getPropertyMessageTranslation:se,getDefaultLanguageFromPropertyData:ze,getLanguageCodeByCustomParam:_n,getMessageByTypeAndKey:So};var ve={CORNER_MARGIN:0,TRIANGULAR_MARGIN:0,VERTICAL_MARGIN:30},In={vertical:"getVerticalButton",triangular:"getTriangularButton",custom:"getCustomButton"};function vn(t,e){if(e=e||{},!c.hasApplicationLoadingFailed(e.formId,!0)){var n=document.getElementById("kampyleInviteContainer");if(le()){if(de(),n){var a=c.checkProvision(r.PROVISIONS.MOBILE_WEB_BANNER_FIX);s.setElementStyle(n,{top:"",bottom:"",left:"",right:"",background:"none",visibility:a?"hidden":"",display:a?"":"none"},!0)}}else{s.setElementStyle(n,{visibility:"visible"},!0);var i=document.getElementById("kampyleInvite");i&&s.setElementStyle(i,{visibility:"visible"},!0)}}}function An(t){s.showInvite(),s.removeEventHandler(t.srcElement,"blur",An)}function Tn(t){s.hideInvite(),s.setEventHandler(t.srcElement,"blur",An)}function bn(){var t=document.querySelectorAll("input"),e=document.querySelectorAll("textarea"),n=[],a;for(a=0;a<t.length;a++)n.push(t[a]);for(a=0;a<e.length;a++)n.push(e[a]);return n}function vo(t,e){e=e||{},e.formId=e.formId||o.getMemoryData("currentFormId");var n=_.getInvitePosition(e.formId);if(le()&&n==="bottom")for(var a=bn(),i=0;i<a.length;i++)s.setEventHandler(a[i],"focus",Tn)}function qe(t,e){e=e||{},e.formId=e.formId||o.getMemoryData("currentFormId");var n=_.getInvitePosition(e.formId);if(le()&&n==="bottom")for(var a=bn(),i=0;i<a.length;i++)s.removeEventHandler(a[i],"focus",Tn)}function Ao(t,e){var n=T.generateShouldShowInviteParamName(e.formId),a=o.getMemoryData(n);a&&(E.trigger("neb_invitation_loaded",{formId:e.formId}),E.trigger("neb_showInvitation",{formId:e.formId}),o.deleteMemoryData(n))}function Dn(t){document.getElementById(r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t).scrollIntoView()}function hn(t){window.scrollTo(0,t)}function To(t,e){e=e||{},o.isEmbeddedDisplayType(e.formId)||hn(0)}function yn(t,e){var n=(e||{}).numberOfPixels||0;if(o.isEmbeddedDisplayType(e.formId)){Dn(e.formId);var a=(s.getScrollPosition()||{}).y||0;_.doScrollY(n+a)}else _.doScrollY(n)}function On(t,e){if(!c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)){var n=s.getNestedPropertyValue(s.getBrowser(),"name");if(n===r.BROWSERS.SAFARI){var a;if(c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)){var i=o.getMemoryJsonKey(e.formId,!0),l=o.getMemoryData(i);a=l.desktopDesign.invitationContentText}else a=e.inviteContent;var d=s.htmlDecode(a)||"";d=d.replace(/<[^>]+>/g,"").trim();var u=document.getElementById("kampyleInvite");u.title=d}}}function bo(t,e){o.isPopupDisplayType(e.formId)&&Ze()}function Nn(t,e){o.getData("isSkipInvitationOptimized")==="true"&&(s.setElementStyle(document.getElementById("kampyleFormContainer"),{visibility:"visible"},!0),_.prepareHostingDOM(),o.setData("isSkipInvitationOptimized",!1))}function Do(){var t={neb_targetingInit:[Qn],neb_loadInvitation:[ls],neb_loadForm:[qn,Oo,rs],neb_formReady:[ee],neb_formLoaded:[Kn,Ze,Ao],neb_formShown:[Nn],neb_inviteHeightChanged:[Xn],neb_iFrameHeightChanged:[is],neb_scrollToTop:[To],neb_scrollFromTop:[yn],neb_inviteReady:[vn,vo],neb_scrollToForm:[No],neb_showButton:[et,Co,Ln,Mn],neb_buttonClicked:[ko],neb_sdkShowForm:[ee],neb_captureInit:[je,ee],neb_inviteAccepted:[Ae,ee,qe],neb_showForm:[Wn],neb_sdkPageView:[Ae,qe],neb_inviteDeclined:[Ae,qe],neb_formClosed:[Te],neb_popupBlocked:[Te],neb_formHide:[je],neb_captureImageClicked:[Je],MDigital_Capture_Cancelled:[Je],neb_formLoadingHasFailed:[Qe],neb_inviteLoaded:[On,bo],MDigital_Invalid_Origin:[Qe]};c.checkProvision(r.PROVISIONS.ADDITIONAL_BUTTON_STYLES)&&t.neb_showButton.push(Fn),E.subscribeMany(t),c.checkProvision(r.PROVISIONS.CSP_RULES)||(s.addStyle(".noOutline{outline: none !important;}"),s.addStyle(".wcagOutline:focus{outline: 1px dashed #595959 !important;outline-offset: 2px !important;transition: none !important;}")),s.setEventHandler(window,"resize",function(e){tt()}),o.setMemoryData("isOriginalHostingDom",!0)}function Cn(t){var e=t?"block":"none",n=document.getElementsByClassName("neb-loading-spinner");if(n&&n.length)for(var a=n.length-1;a>=0;a--)s.setElementStyle(n[a],{display:e})}function Mn(t,e){var n=o.getFormData(e.formId),a=c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(n,"urlVersion");a&&s.setEventHandler(window,"resize",Pn(n))}function Pn(t){var e=!o.isMobile(),n=_.onResizeButton.bind(null,t),a=s.debounce(n,100,e);return _.debouncedOnResize=a,a}function ho(t){var e=s.getZoomedIn(),n=e.zoom,a=n&&n===o.getMemoryData("kampylePageZoom");if(!a){o.setMemoryData("kampylePageZoom",n);var i={buttonVerticalOffset:s.getNestedPropertyValue(t,"buttonData.verticalOffset")||0,buttonType:s.getNestedPropertyValue(t,"buttonData.type")||"",buttonPosition:$e(t)};if(i.buttonType==="custom"){var l=document.querySelector("#nebula_div_btn > img"),d=!0;Hn(l,i,d)}else Jo(i),Ln("windowResize",i)}}function yo(){s.removeEventHandler(window,"resize",_.debouncedOnResize)}function Ze(t,e){Cn(!1)}function Oo(t,e){Cn(!0)}function No(t,e){document.getElementById("kampyleFormContainer").scrollIntoView()}function Rn(t){t=t||{};var e=s.getNestedPropertyValue(t,"formType")==="invitation",n;if(e)n=ve.CORNER_MARGIN;else{var a=s.getNestedPropertyValue(t,"buttonData.type");switch(a){case"vertical":case"triangular":n=ve.TRIANGULAR_MARGIN;break;case"custom":n=s.getNestedPropertyValue(t,"buttonData.cornerMargin")||ve.CORNER_MARGIN;break;default:n=ve.CORNER_MARGIN;break}}return parseInt(n,10)}function $e(t){return t=t||{},s.getNestedPropertyValue(t,"buttonData.position")||"right"}function Co(t,e){e=e||{};var n=o.getFormData(e.formId),a=document.getElementById("nebula_div_btn");if(!a||!n)return!1;var i=Rn(n)+"px";switch($e(n)){case"bottomRight":a.style.right=i;break;case"bottomLeft":a.style.left=i;break;default:break}}function Ln(t,e){var n=0,a=35,i="",l="",d=e&&e.formId&&o.getFormData(e.formId)||{};if(t==="windowResize")n=e.buttonVerticalOffset,i=e.buttonPosition,l=e.buttonType;else{var u=s.getNestedPropertyValue(d,"buttonData");n=s.getNestedPropertyValue(u,"verticalOffset")||0,i=u.position,l=s.getNestedPropertyValue(u,"type")}if(l!=="custom"){var f=t==="windowResize"||c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(d,"urlVersion");if(!isNaN(n)){var m=document.getElementById("nebula_div_btn");if(m&&m.style){if(f){var g=s.getZoomedIn();n=Number(n)/g.zoom,g.isZoomedIn&&(a=a*(g.constraint/g.zoom))}i.indexOf("bottom")>-1?m.style.marginBottom=n+"px":i.indexOf("top")>-1?(n=Number(n)*-1,m.style.marginTop=n+"px"):(n=Number(n),m.style.bottom=window.innerHeight*.55-a+n+"px")}}}}function Fn(t,e){var n=o.getFormData(e.formId),a=s.getNestedPropertyValue(n,"buttonData.zIndex");if(s.isValueNumericAndDefined(a)){var i=document.getElementById("nebula_div_btn");i.style.zIndex=a}}function Je(t,e){var n=o.getMemoryData("currentFormId"),a=o.getFormData(n);if(o.getDisplayType(a)==="animation")return!1;var i=document.getElementById("kampyleFormContainer"),l=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+n);i&&l&&s.setElementStyle(i,{display:"block",visibility:"visible"},!0)}function be(){return o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)?" wcagOutline ":" noOutline "}function je(){var t=o.getMemoryData("currentFormId");if(t){var e=document.getElementById("kampyleFormContainer"),n=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+t),a=document.getElementById("mdigital-no-json-modal_"+t);e&&(n||a)&&s.setElementStyle(e,{display:"none",visibility:"hidden"},!0)}}function Te(t,e){e=e||{};var n=o.getMemoryData("currentFormId");te("remove");var a=document.getElementById("kampyleFormContainer");if(a!==null){var i=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+n);i&&(o.initOnsiteDefaultState(n),i&&i.remove&&i.remove(),s.setElementStyle(a,{display:"none",visibility:"hidden"},!0)),je(),de()}o.isPopupDisplayType(n)&&e.sourceWindow&&e.sourceWindow.close&&e.sourceWindow.close()}function wn(t){var e=t.buttonData||{},n="81px",a="14px",i="53px",l="108px";if(c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion")){var d=s.getZoomedIn();d.isZoomedIn&&(n=String(81*(d.constraint/d.zoom))+"px",a=String(14*(d.constraint/d.zoom))+"px",i=String(53*(d.constraint/d.zoom))+"px",l=String(108*(d.constraint/d.zoom))+"px")}var u=["button#nebula_div_btn { height: auto }",".kampyle_feedback-button{",'background-color:transparent;font-family:"Open Sans",sans-serif;cursor:pointer;position:fixed;z-index:99999990',"}",".kampyle_feedback-button .kampyle_triangle{position:absolute;width:0;height:0;z-index:-1}",".kampyle_feedback-button .kampyle_button-text{","height:"+n+";width:"+n+";text-align:center;z-index:1000;color:"+e.textColor+";font-size:"+a+";font-weight:normal;","}",".kampyle_feedback-button .kampyle_bottom{","line-height:"+l+";","}",".kampyle_feedback-button .kampyle_top {","line-height:"+i+";","}",".kampyle_feedback-button.kampyle_top-right{","top:0;right:0;","}",".kampyle_feedback-button.kampyle_top-left .kampyle_triangle, .kampyle_feedback-button.kampyle_top-right .kampyle_triangle {","top:0;border-top:"+n+" solid;","}",".kampyle_feedback-button.kampyle_bottom-left .kampyle_triangle, .kampyle_feedback-button.kampyle_bottom-right .kampyle_triangle {","border-bottom:"+n+" solid;","}",".kampyle_feedback-button.kampyle_bottom-right .kampyle_triangle, .kampyle_feedback-button.kampyle_top-right .kampyle_triangle {","right:0;border-left:"+n+" solid transparent;","}",".kampyle_feedback-button.kampyle_bottom-left .kampyle_triangle, .kampyle_feedback-button.kampyle_top-left .kampyle_triangle {","left:0;border-right:"+n+" solid transparent;","}","#nebula_div_btn .kampyle_triangle {","border-bottom-color: "+e.backgroundColor+";","border-top-color: "+e.backgroundColor+";","}",".kampyle_feedback-button.kampyle_top-right .kampyle_button-text, .kampyle_feedback-button.kampyle_bottom-left .kampyle_button-text {","-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);transform:rotate(45deg);","}",".kampyle_feedback-button.kampyle_top-left .kampyle_button-text, .kampyle_feedback-button.kampyle_bottom-right .kampyle_button-text {","-ms-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);transform:rotate(-45deg);","}",".kampyle_feedback-button.kampyle_top-left {","top:0;left:0;","}",".kampyle_feedback-button.kampyle_bottom-right {","bottom:0;right:0;","}",".kampyle_feedback-button.kampyle_bottom-left {","bottom:0;left:0;","}",".kampyle_feedback-button.kampyle_bottom-left, .kampyle_feedback-button.kampyle_bottom-right, .kampyle_feedback-button.kampyle_top-left, .kampyle_feedback-button.kampyle_top-right {","padding: 0;","}"].join(" ");return u}function kn(t){var e=t.buttonData||{},n="";c.checkProvision(r.PROVISIONS.RTL)&&N.isFormLanguageRtl(t)&&(n="transform: scale(-1);-ms-transform: scale(-1);-webkit-transform: scale(-1)");var a=125,i=35,l=14,d=-45,u=window.innerHeight,f=u*.55-a;if(c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion")){var m=s.getZoomedIn();m.isZoomedIn&&(a=a*(m.constraint/m.zoom),i=i*(m.constraint/m.zoom),l=l*(m.constraint/m.zoom),d=d*(m.constraint/m.zoom))}var g=["button#nebula_div_btn { height: auto }",".kampyle_vertical_button {",'background-color:transparent;font-family:"Open Sans",sans-serif;cursor:pointer;position:fixed;bottom:'+f+"px;z-index:99999990;height:"+i+"px;min-height:"+i+"px;max-height:"+i+"px;width:"+a+"px;max-width:"+a+"px;min-width:"+a+"px;-ms-transform:rotate(90deg);-webkit-transform:rotate(90deg);transform:rotate(90deg)","}",".kampyle_vertical_button .kampyle_button {","height:"+i+"px;min-height:"+i+"px;;max-height:"+i+"px;width:"+a+"px;min-width:"+a+"px;max-width:"+a+"px; background:"+e.backgroundColor+";color:"+e.textColor+";position:absolute;top:0;left:0;z-index:-1;","}",".kampyle_vertical_button .kampyle_button-text {","color:"+e.textColor+";font-size:"+l+"px;line-height:"+i+"px;text-align:center;font-weight:normal;"+n,"}",".kampyle_vertical_button.kampyle_left .kampyle_button {","-webkit-border-radius:3px 3px 0 0;-moz-border-radius:3px 3px 0 0;-ms-border-radius:3px 3px 0 0;border-radius:3px 3px 0 0;","}",".kampyle_vertical_button.kampyle_right {","right:"+d+"px;","}",".kampyle_vertical_button.kampyle_left {","left:"+d+"px;","}",".kampyle_vertical_button.kampyle_right .kampyle_button {","-webkit-border-radius:0 0 3px 3px;-moz-border-radius:0 0 3px 3px;-ms-border-radius:0 0 3px 3px;border-radius:0 0 3px 3px","}",".kampyle_vertical_button.kampyle_right, .kampyle_vertical_button.kampyle_left  {","padding: 0;","}"].join(" ");return c.checkProvision(r.PROVISIONS.ADDITIONAL_BUTTON_STYLES)&&(g+=[".kampyle_vertical_button:hover .kampyle_button-text {","color:"+e.textHoverColor+";","}",".kampyle_vertical_button:hover .kampyle_button {","background-color:"+e.backgroundHoverColor+";","}"].join(" ")),g}function Mo(t){var e=_.getButtonText(t),n=Gn(t.buttonData.position);return'<button id="nebula_div_btn" style="border: none; background: none" alt="'+e+'" tabindex="0" class="kampyle_feedback-button '+n.leftright+" "+be()+'"><div class="kampyle_triangle"></div><div data-aut="feedback" class="kampyle_button-text '+n.topbottom+'">'+e+"</div></button>"}function Po(t){var e="kampyle_left",n=_.getButtonText(t);switch(t.buttonData.position){case"left":e="kampyle_left";break;case"right":e="kampyle_right";break}return'<button id="nebula_div_btn" style="position: fixed !important; border: none" alt="'+n+'" tabindex="0" class="kampyle_vertical_button '+e+" "+be()+'"><div class="kampyle_button"></div><div data-aut="feedback" class="kampyle_button-text">'+n+"</div></button>"}function Ro(t){var e={vertical:{html:Po,style:kn},triangular:{html:Mo,style:wn}}[t.buttonData.type];return e?(s.addStyle(e.style(t)),e.html(t)):(s.showWarning("Invalid button type "+t.buttonData.type),"")}function Lo(t){var e="z-index: 99999990;position: fixed;cursor: pointer;line-height:1px; padding:0;",n=_.getButtonText(t),a=[".nebula_image_button {","width: auto;","background: transparent;","}"].join(" ");switch(s.addStyle(a),t.buttonData.position){case"bottomLeft":e+="bottom:0;left:0;";break;case"bottomRight":e+="bottom:0;right:0;";break;case"topLeft":e+="top:0;left:0;";break;case"topRight":e+="top:0;right:0;";break;case"left":e+="left:0;top:50%;";break;case"right":e+="right:0;top:50%;";break;default:break}return'<button id="nebula_div_btn" class="nebula_image_button '+be()+'" style="'+e+';border: none" tabindex="0"><img alt="'+n+'" src="'+t.buttonData.buttonUrl+'" /></button>'}function Sn(t){te("add");var e=document.getElementById("kampyleFormContainer");if(e){var n=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+t);n&&s.setElementStyle(n,{display:"block"},!0),s.setElementStyle(e,{display:"block",visibility:"visible"},!0)}}function Un(t){var e="mdigital-no-json-modal_"+t;Te({formId:t});var n=document.getElementById(e);n&&(n.style.display="none"),o.setFormState(t,{shown:!1}),_.resetFormState(t),et("",{formId:o.getMemoryData("buttonFormId")}),s.triggerCustomEvent(r.EVENTS.MDIGITAL_NO_JSON_MODAL_CLOSED,{formId:t}),E.trigger(r.EVENTS.MDIGITAL_NO_JSON_MODAL_CLOSED,{formId:t})}function Fo(t){var e=o.getFormTriggerType(t)===r.FORM_TYPES.INVITATION,n=o.getMemoryJsonKey(t,e),a=o.getMemoryJsonKey(t,e,r.MEMORY_DATA_FIELDS.FETCHING_DATA_IN_PROGRESS);o.setMemoryData(n,null),o.setMemoryData(a,null),o.setFormState(t,{loaded:null,loading:null}),o.setMemoryData(r.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!1),E.trigger(r.EVENTS.NEB_RESET_FORM_STATE,{formId:t})}function wo(t){var e="en",n=r.TEXTS.DEFAULT_JSON_ERROR_MESSAGES.title,a=r.TEXTS.DEFAULT_JSON_ERROR_MESSAGES.body,i=r.TEXTS.DEFAULT_JSON_ERROR_MESSAGES.close;n=Y.getMessageByTypeAndKey(r.PROPERTY_MESSAGES.NO_JSON_MESSAGE.TYPE,r.PROPERTY_MESSAGES.NO_JSON_MESSAGE.KEYS.TITLE),a=Y.getMessageByTypeAndKey(r.PROPERTY_MESSAGES.NO_JSON_MESSAGE.TYPE,r.PROPERTY_MESSAGES.NO_JSON_MESSAGE.KEYS.BODY),i=Y.getMessageByTypeAndKey(r.PROPERTY_MESSAGES.NO_JSON_MESSAGE.TYPE,r.PROPERTY_MESSAGES.NO_JSON_MESSAGE.KEYS.CLOSE),e=Y.getPropertyMessageLanguageCode();var l="mdigital-no-json-modal_"+t;return G.getErrorModal(l,e,n,a,i)}function ko(t,e){var n=o.getFormData(e.formId),a=o.getDisplayType(n);if(a=a.toLowerCase(),a==="lightbox"){var i=document.getElementById("kampyleFormContainer");if(!i||c.hasApplicationLoadingFailed(e.formId,!1)||c.isAnyOtherFormAlreadyShown(e.formId,!0))return!1;s.setElementStyle(i,{display:"block",visibility:"visible"},!0)}}function Gn(t){var e={topbottom:"kampyle_bottom",leftright:"kampyle_bottom-left"};switch(t){case"bottomLeft":e.leftright="kampyle_bottom-left",e.topbottom="kampyle_bottom";break;case"bottomRight":e.leftright="kampyle_bottom-right",e.topbottom="kampyle_bottom";break;case"topLeft":e.leftright="kampyle_top-left",e.topbottom="kampyle_top";break;case"topRight":e.leftright="kampyle_top-right",e.topbottom="kampyle_top";break;default:break}return e}function Uo(t,e){var n={};switch(t){case"bottomLeft":n={"border-bottom-width":e,"border-right-width":e};break;case"bottomRight":n={"border-bottom-width":e,"border-left-width":e};break;case"topLeft":n={"border-top-width":e,"border-right-width":e};break;case"topRight":n={"border-top-width":e,"border-left-width":e};break;default:break}return n}function Go(t){var e=o.getFormTriggerType(t);return M.shouldFormBeShown(t)&&(e===r.FORM_TYPES.BUTTON||e===r.FORM_TYPES.CODE)}function Vn(t,e){t.keyCode===r.KEY_CODES.SPACE||t.keyCode===r.KEY_CODES.ENTER?_.onErrModalClose(e):t.keyCode===r.KEY_CODES.TAB&&(t.preventDefault(),t.stopPropagation())}function xn(t,e){if(t.preventDefault(),t.keyCode===r.KEY_CODES.ESC){_.onErrModalClose(e);return}var n=document.querySelector("#mdigital-no-json-modal_"+e+" #close-no-json-modal");n&&t.keyCode===r.KEY_CODES.TAB&&!t.shiftKey&&(n.setAttribute("aria-hidden",!1),n.focus())}function Qe(t,e){if(!(c.isAnyOtherFormAlreadyShown(e.formId)||!_.shouldShowErrMsgOnForm(e.formId))){var n="mdigital-no-json-modal_"+e.formId,a=document.getElementById("kampyleFormModal");if(Ze(),Sn(e.formId),document.getElementById(n))document.getElementById(n).style.display="block";else{a||(nt(),a=document.getElementById("kampyleFormModal"),Sn(e.formId));var i=wo(e.formId);a.innerHTML="",a&&a.appendChild&&a.appendChild(i);var l=document.querySelector("#"+n+" #close-no-json-modal");l.onclick=Un.bind(null,e.formId),(o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)||c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS))&&(i.addEventListener("keydown",function(f){xn(f,e.formId)}),l.addEventListener("keydown",function(f){Vn(f,e.formId)}))}o.setFormState(e.formId,{loaded:null,shown:!0,shouldBeShown:!1}),ee("",{formId:o.getMemoryData("buttonFormId")}),s.triggerCustomEvent(r.EVENTS.MDIGITAL_NO_JSON_MODAL_SHOWN,{formId:e.formId});var d=R.getFormFailureCause(e.formId),u={failureCause:d};d===r.FORM_LOADING_FAILURE_CAUSE.JSON_FAILED&&(u.jsonPath=o.getDataJsonUrl(e.formId,!1)),E.trigger(r.EVENTS.MDIGITAL_NO_JSON_MODAL_SHOWN,{additionalInfo:u,formId:e.formId})}}function Vo(n,e){var n=n.toLowerCase();return typeof G[In[n]]=="function"?G[In[n]](e):(h.error("Invalid button type - "+n),null)}function xo(){var t=document.getElementById(r.VIEW.FEEDBACK_BUTTON_ID);t!=null&&(s.setElementStyle(t,Bn(!1),!1),s.removeAttribute(t,"tabindex"),s.removeAttribute(t,"aria-hidden"))}function Bo(){var t=document.getElementById(r.VIEW.FEEDBACK_BUTTON_ID);t!=null&&(s.setElementStyle(t,Bn(!0),!1),s.addAttributesOnElement(t,{tabindex:-1,"aria-hidden":!0}))}function et(t,e){c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)&&document.getElementById(r.VIEW.FEEDBACK_BUTTON_CONTAINER_ID)!=null&&document.getElementById(r.VIEW.FEEDBACK_BUTTON_ID)!=null?(_.showFeedbackButtonVisually(),Ho(t,e)):_.createButton(t,e)}function Ho(t,e){e=e||{};var n=o.getFormData(e.formId)||{};E.trigger("neb_button_displayed",{formId:e.formId,position:s.getNestedPropertyValue(n,"buttonData.position")||"",formClosed:s.getNestedPropertyValue(e,"formClosed")||!1})}function Bn(t){var e=o.getMemoryData(r.MEMORY_DATA_FIELDS.FEEDBACK_BUTTON_POSITION_STYLE)||{},n="",a=t?"9999px":0;switch(e){case"left":n="rotate(90deg) translateY("+a+")";break;case"right":n="rotate(90deg) translateY(-"+a+")";break;case"bottomRight":case"topRight":case"customRight":n="translateX("+a+")";break;case"bottomLeft":case"topLeft":case"customLeft":n="translateX(-"+a+")";break}return{transform:n}}function Yo(t,e){var n=t&&t.style;return n!=null&&e!=null&&e.length?e.reduce(function(a,i){var l=n[i];return l!=null&&(a[i]=l),a},{}):{}}function Hn(t,e,n){if(Number(t.naturalWidth)>0&&Number(t.naturalHeight)>0){var a=document.getElementById("nebula_div_btn"),i={el:t,width:t.naturalWidth,height:t.naturalHeight};qo(a,i,e,n),s.removeEventHandler(t,"load",this.boundHandleLoadCustomBtnEvent)}}function Ko(t,e){var n="";e=e||{};var a=o.getFormData(e.formId)||{},i=s.getNestedPropertyValue(a,"buttonData.type")||"",l={buttonVerticalOffset:s.getNestedPropertyValue(a,"buttonData.verticalOffset")||"",buttonType:i,buttonPosition:$e(a)};if(c.checkProvision(r.PROVISIONS.CSP_RULES)){var d=Vo(i,a);if(d){var u=document.getElementById("kampyleButtonContainer");u===null?(u=document.createElement("span"),u.id="kampyleButtonContainer",u.appendChild(d),document.body.appendChild(u)):(u.innerHTML="",u.appendChild(d))}}else{switch(i.toLowerCase()){case"vertical":case"triangular":n=Ro(a);break;case"custom":n=Lo(a);break;default:return s.showWarning("Invalid button type - "+i),!1}var u=document.getElementById("kampyleButtonContainer");u===null?(u=document.createElement("span"),u.innerHTML=n,u.id="kampyleButtonContainer",document.body.appendChild(u)):u.innerHTML=n}if(i.toLowerCase()==="custom"){var f=c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(a,"urlVersion"),m=document.querySelector("#nebula_div_btn > img");this.boundHandleLoadCustomBtnEvent=Hn.bind(this,m,l,f),s.setEventHandler(m,"load",this.boundHandleLoadCustomBtnEvent)}if(c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)){var g=l.buttonPosition;i.toLowerCase()==="custom"&&(g=l.buttonPosition.toLowerCase().indexOf("right")>-1?"customRight":"customLeft"),o.setMemoryData(r.MEMORY_DATA_FIELDS.FEEDBACK_BUTTON_POSITION_STYLE,g)}E.trigger("neb_button_displayed",{formId:e.formId,position:s.getNestedPropertyValue(a,"buttonData.position")||"",formClosed:s.getNestedPropertyValue(e,"formClosed")||!1}),u.onclick=function(I){c.isAnyOtherFormAlreadyShown(e.formId,!0)||(E.trigger("neb_buttonClicked",{formId:e.formId}),I.preventDefault(),I.stopPropagation())};var S=o.getMemoryData("kampyleDevice")===r.DEVICES.DESKTOP;if(S){this.boundHandleLoadFormEvent=Yn.bind(this,e,u),s.setEventHandler(u,"mouseover",this.boundHandleLoadFormEvent);var O=function(A){var v=o.getFormState(e.formId),P=c.checkProvision(r.PROVISIONS.ENABLE_INVITATION_SPINNER_FIX)&&o.getMemoryData("inviteLoadedAndShown");if(!v||v.loading||v.loaded||P||o.getMemoryData(r.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED))return!1;var F=s.isNear("nebula_div_btn",100,A);F&&(E.trigger("neb_load_form_preload_proximity",{formId:e.formId}),E.trigger("neb_loadForm",{formId:e.formId}),o.setMemoryData(r.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!0))};s.setEventHandler(window,"mousemove",O)}u.onkeyup=function(I){switch(I.keyCode){case r.KEY_CODES.TAB:M.isFormLoaded(e.formId)||E.trigger("neb_loadForm",{formId:e.formId});break;default:break}},u.onkeypress=function(I){switch(I.keyCode){case r.KEY_CODES.ENTER:c.isAnyOtherFormAlreadyShown(e.formId,!0)||E.trigger("neb_buttonClicked",{formId:e.formId});break;default:break}}}function Yn(t,e){var n=o.getFormState(t.formId);n.loaded||o.getMemoryData(r.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED)||(E.trigger("neb_loadForm",{formId:t.formId}),o.setMemoryData(r.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!0)),s.removeEventHandler(e,"mouseover",this.boundHandleLoadFormEvent)}function Kn(t,e){if(e.origin!=null){var n=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);n&&n.setAttribute&&n.setAttribute("origin",e.origin)}}function Wo(t,e,n,a){var i=document.querySelector(".kampyle_vertical_button.kampyle_right"),l=document.querySelector(".kampyle_vertical_button.kampyle_left"),d=document.querySelector(".kampyle_button"),u=t.constraint,f=t.isZoomedIn?String(125*(u/t.zoom))+"px":"125px",m=t.isZoomedIn?String(35*(u/t.zoom))+"px":"35px",g=t.isZoomedIn?"-"+String(45*(u/t.zoom))+"px":"-45px",S=t.isZoomedIn?String(14*(u/t.zoom))+"px":"14px";s.setElementStyle(e,{width:f,minWidth:f,maxWidth:f,height:m,minHeight:m,maxHeight:m},!1),s.setElementStyle(i,{right:g},!1),s.setElementStyle(l,{left:g},!1),s.setElementStyle(d,{width:f,minWidth:f,maxWidth:f,height:m,minHeight:m,maxHeight:m},!1),s.setElementStyle(n,{lineHeight:m,fontSize:S},!1)}function Xo(t,e,n,a){var i=t.constraint,l=document.querySelector(".kampyle_triangle"),d=t.isZoomedIn?String(81*(i/t.zoom))+"px":"81px",u=t.isZoomedIn?String(53*(i/t.zoom))+"px":"53px",f=t.isZoomedIn?String(108*(i/t.zoom))+"px":"108px",m=t.isZoomedIn?String(14*(i/t.zoom))+"px":"14px",g=Uo(a,d),S=a.indexOf("top")===0?u:f;s.setElementStyle(e,{lineHeight:S},!1),s.setElementStyle(n,{height:d,width:d,fontSize:m,lineHeight:S},!1),s.setElementStyle(l,g,!0)}function zo(t,e,n){var a={};return t.indexOf("bottom")>-1?a={bottom:0,marginBottom:n+"px",top:"unset"}:t.indexOf("top")>-1?a={top:0,marginTop:n*-1+"px",bottom:"unset"}:a={bottom:window.innerHeight*.5-e+"px",marginBottom:n+"px",top:"unset"},a}function qo(t,e,n,a){var i=a?1/s.getZoomedIn().zoom:1,l=e?e.el:document.querySelector("#nebula_div_btn>img"),d=e?e.width:l.naturalWidth,u=e?e.height:l.naturalHeight,f=String(d*i),m=String(u*i),g=n.buttonVerticalOffset;g=isNaN(g)?0:Number(g)*i;var S=zo(n.buttonPosition,m,g);s.setElementStyle(t,{width:f+"px",height:m+"px"},!1),s.setElementStyle(t,S,!0),s.setElementStyle(l,{width:"inherit",height:"inherit"},!1)}function Jo(t){var e=document.getElementById("nebula_div_btn");if(e!==null){var n=document.querySelector(".kampyle_button-text"),a=s.getZoomedIn();t.buttonType==="vertical"?Wo(a,e,n,t.buttonPosition):t.buttonType==="triangular"&&Xo(a,e,n,t.buttonPosition)}}function tt(t){var e=o.getMemoryData("currentFormId")||o.getShownFormId();if(!(document.getElementById("kampyleFormContainer")===null||!e)){if(t=t||o.getFormData(e)||{},o.isMobileDynamicSizing(t.formId))return Qo(t);jo(t)}}function jo(t){var e=(t||{}).formId||o.getMemoryData("currentFormId")||o.getShownFormId(),n,a;t&&(n=parseInt(t.formWidth,10)||450,a=parseInt(t.formHeight,10)||450);var i=document.documentElement.clientHeight,l={overflowY:"auto",height:"100%"};s.setElementStyle(document.getElementById("innerContainer"),l);var d={border:0,position:"relative",margin:"50px auto 50px",height:a+"px",width:n+"px"},u=o.getMemoryData("kampyleDevice");u===r.DEVICES.MOBILE||u===r.DEVICES.TABLET?(a="100%",n="100%",d={position:"relative",margin:"0",height:a,width:n}):o.isCustomHtmlAndFixedSizeForm(e)?(d={position:"absolute",top:"50%","margin-top":-a/2+"px",left:"50%","margin-left":-n/2+"px",height:a+"px",width:n+"px"},i<a&&(d.position="relative",d.top="0",d["margin-top"]="50px",d["margin-bottom"]="50px")):d={position:"fixed",height:"100%",width:"100%"};var f=document.getElementById("kampyleFormModal");f&&f.style&&f.removeAttribute&&(f.removeAttribute("style"),s.setElementStyle(f,d,!0))}function Qo(t){var e=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID);e&&e.setAttribute("aria-hidden",!1);var n=document.getElementById("kampyleFormModal");n&&s.setElementStyle(n,{top:0,margin:0,width:"100%"},!0)}function Zo(t,e,n,a,i){t=R.createFormUrl(t,e);var l="NebulaCX"+e,d="width="+n+", height="+a+",scrollbars=yes",u=window.open(t,l,d),f=!u||u.closed||typeof u.closed=="undefined";o.setMemoryData("popupHandler",u),setTimeout(function(){f&&(i!=="neb_skipInvitation"&&alert("The survey was blocked, please disable popup blocker and refresh the page."),E.trigger("neb_popupBlocked",{formId:e}))},25)}function $o(t,e,n,a,i){c.shouldRenderForm({formId:e})&&Zo(t,e,n,a,i)}function Wn(t,e){var n=t==="neb_skipInvitation";e=e||{};var a=o.getFormData(e.formId);if(_.ignoreShowForm(a)||c.hasApplicationLoadingFailed(e.formId,!1)||c.isAnyOtherFormAlreadyShown(e.formId,!0))return!1;var i=a.formHtmlUrl,l=a.formWidth,d=a.formHeight,u=o.getDisplayType(a);u=u.toLowerCase(),te("add"),o.setMemoryData("currentFormId",e.formId),o.isEmbeddedDisplayType(e.formId)||(o.setMemoryData("formIsShown",!0),o.setMemoryData("isInvitationShouldBeIgnored",!0));var f=o.getMemoryData("kampyleDevice"),m=n&&c.checkProvision(r.PROVISIONS.SKIP_INVITATION_OPTIMIZATION);if(u==="lightbox"){m?o.setData("isSkipInvitationOptimized",!0):_.prepareHostingDOM();var g=document.getElementById("kampyleFormContainer");if(g){tt(a);var S=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);S&&s.setElementStyle(S,{display:"block"},!0),s.setElementStyle(g,{display:"block",visibility:m?"hidden":"visible"},!0)}else s.showWarning("formContainer wasn't loaded properly")}else u==="popup"&&$o(i,e.formId,l,d,t);return!0}function es(t){return!t||o.getDisplayType(t)==="animation"}function Ae(){o.setMemoryData("inviteLoadedAndShown",!1),te("remove");var t=document.getElementById("kampyleInviteContainer"),e=document.getElementById("kampyleInvite");t&&e&&(s.setElementStyle(t,{display:"none"},!0),de())}function Xn(t,e){e=e||{};var n=["top","bottom"],a=(o.getFormState(e.formId)||{}).inviteShown;if(!le()||!a)return!1;var i=_.getInvitePosition(e.formId),l=document.getElementById("kampyleInviteContainer"),d=document.getElementById("kampyleInvite");document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"?(s.hideInvite(),s.setEventHandler(document.activeElement,"blur",function(f){return function m(){s.removeEventHandler(f,"blur",m),s.showInvite()}}(document.activeElement))):s.showInvite();var u={display:"block",height:e.newHeight+"px",left:"0",right:"0"};u[i]=0,u[n[(n.indexOf(i)+1)%2]]="",s.setElementStyle(l,u,!0)}function te(t){if(t=t||"",o.getMemoryData("kampyleDevice")!=="desktop"){var e=c.checkProvision(r.PROVISIONS.FORM_TEMPLATES_WCAG)?"width=device-width, initial-scale=1.0":"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",n=document.getElementById("kampyleMetaViewport"),a=c.checkProvision(r.PROVISIONS.ENABLE_VIEWPORT_LOGIC_FIX),i=o.getMemoryData("hostedViewportContent")||[];if(!i.length){var l=document.getElementsByName("viewport"),d=l&&l.length>0;if(d)for(var u=l.length-1;u>=0;u--){var f=l[u].getAttribute("content");f&&(a?i.push({el:l[u],content:f}):i.push(l[u]))}}var m=a&&!!i.length&&!n;switch(t.toLowerCase()){case"add":if(i&&i.length){for(var u=i.length-1;u>=0;u--)if(m)i[u].el&&i[u].el.setAttribute("content",e);else if(!i[u].el){if(i[u].hasAttribute("id")&&i[u].id==="kampyleMetaViewport")continue;i[u].remove&&i[u].remove()}}if(!m)if(n)n.content=e,n.name="viewport";else{var g=document.createElement("meta");g.content=e,g.name="viewport",g.id="kampyleMetaViewport",document.getElementsByTagName("head")[0].appendChild(g)}break;case"remove":if(n&&(n.content="",n.name="",n.remove&&n.remove()),i&&i.length){for(var u=i.length-1;u>=0;u--)if(m)i[u].el&&i[u].el.setAttribute("content",i[u].content);else if(!i[u].el){if(i[u].hasAttribute("id")&&i[u].id==="kampyleMetaViewport")continue;document.getElementsByTagName("head")[0].appendChild(i[u])}}break}o.setMemoryData("hostedViewportContent",i)}}function le(){return Number(o.getMemoryData("inviteVersion"))>0&&o.isNewMobileInvitation()}function ts(t){var e=o.getFormData(t)||{};return(e.inviteData||{}).invitationPosition||"top"}function ns(t,e){te("add");var n="25%",a=o.getInviteData(e.formId);if(!a||!M.isInviteLoaded(e.formId)||!c.isJsonDataLoaded(e.formId,!0))return!1;var i=o.getMemoryData("kampyleDevice");(i===r.DEVICES.MOBILE||i===r.DEVICES.TABLET)&&(a.inviteHeight="100%",a.inviteWidth="100%",n=0);var l=s.getCurrentTimestamp();o.setMemoryData("invitationTimeStamp",l),o.setData("LAST_INVITATION_VIEW",l);var d=document.getElementById("kampyleInviteContainer");if(d&&o.getMemoryData("formIsShown")===!1){s.setElementStyle(d,{display:"block",visibility:o.isNewMobileInvitation()?"hidden":"visible"},!0),zn(),E.trigger("neb_invitation_ready",{formId:e.formId});var u=document.getElementById("kampyleInviteModal");u&&s.setElementStyle(u,{top:n,width:a.inviteWidth+"px","max-width":a.inviteWidth+"px",height:a.inviteHeight+"px","max-height":a.inviteHeight+"px",display:"block"},!0);var f=document.getElementById("kampyleInvite");f&&s.setElementStyle(f,{width:a.inviteWidth+"px","max-width":a.inviteWidth+"px",height:a.inviteHeight+"px","max-height":a.inviteHeight+"px",display:"block",visibility:o.isNewMobileInvitation()?"hidden":"visible"},!0)}return!0}function zn(){if(!(c.checkProvision(r.PROVISIONS.ENABLE_SPA_OVERFLOW_FIX)&&!o.getMemoryData("isOriginalHostingDom")))if(o.setMemoryData("isOriginalHostingDom",!1),o.isMobileDynamicSizing())_.manipulateAriaHiddens(),o.setMemoryData("hostedBodyOverflowXAttr",document.body.style.overflowX),document.body.style.overflowX="hidden";else{if(o.setMemoryData("hostedBodyPositionAttr",document.body.style.position),c.checkProvision(r.PROVISIONS.ENABLE_OVERFLOW))return!1;o.setMemoryData("hostedBodyOverflowAttr",document.body.style.overflow),document.body.style.overflow="hidden"}}function de(){if(!(c.checkProvision(r.PROVISIONS.ENABLE_SPA_OVERFLOW_FIX)&&o.getMemoryData("isOriginalHostingDom")))if(o.setMemoryData("isOriginalHostingDom",!0),o.isMobileDynamicSizing()){var t=document.getElementById("kampyleFormModal");s.setElementStyle(t,{height:"100%"},!0),_.restoreAriaHidden(),document.body.style.overflowX=o.getMemoryData("hostedBodyOverflowXAttr")||""}else c.checkProvision(r.PROVISIONS.ENABLE_OVERFLOW)||(document.body.style.overflow=o.getMemoryData("hostedBodyOverflowAttr")||""),document.body.style.position=o.getMemoryData("hostedBodyPositionAttr")||""}function nt(){if(c.checkProvision(r.PROVISIONS.CSP_RULES))G.createFormContainer();else{var t=s.getOrCreateWrapperContainer(r.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID),e="";e+='<div id="kampyleFormContainer" style="top:0 !important;left:0 !important;width: 100% !important;height: 100% !important;position: fixed !important;visibility:hidden !important;display:table !important;background-color: rgba(102,102,102,0.4) !important;z-index:99999999 !important;-webkit-overflow-scrolling: touch !important; ">',e+=' <div id="innerContainer">',e+='   <div id="kampyleFormModal" style="z-index:99999999 !important; -webkit-overflow-scrolling: touch !important;"></div>',e+=" </div>",e+="</div>",t.innerHTML=e;var n=G.createSpinnerElement();t.querySelector("#innerContainer").appendChild(n),s.setSpinnerStyle(n,r.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(r.PROVISIONS.ENABLE_WCAG_PREPEND_SURVEY)?document.body.prepend(t):document.body.appendChild(t)}}function qn(t,e){e=e||{};var n=o.getFormState(e.formId);if(!(n&&n.loaded||c.hasApplicationLoadingFailed(e.formId,!1))){var a=o.getFormData(e.formId),i=o.getDisplayType(a);if(!(!a||!e.formId||i!=="lightbox")){var l=r.TIMEOUT_HANDLERS.FORM_APP_STATUS+"_"+e.formId,d=!!o.getTimeoutHandler(l);if(!d){var u=window.setTimeout(function(){c.isFormLoaded(e.formId)||E.trigger(r.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:e.formId,failureCause:r.FORM_LOADING_FAILURE_CAUSE.APPLICATION_FAILED,formState:o.getFormState(e.formId)})},r.NETWORK.TIME_FOR_FORM_TO_LOAD_MS);o.setTimeoutHandler(l,u)}document.getElementById("kampyleFormContainer")||nt();var f=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);if(!f){var m={border:0,height:"100%","max-height":"100%","min-height":"100%",width:"100%","max-width":"100%","min-width":"100%",display:"none"};!o.isCustomHtmlForm(e.formId)&&!o.isMobileDynamicSizing(a.formId)&&(m.position="fixed");var g=!0,S=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.CONTAINER_ID_PREFIX);_.createFormIframe(e.formId,r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX,S,m,g)}}}}function as(t,e,n,a,i){var l=o.getFormData(t),d=document.createElement("iframe");s.setElementStyle(d,a,i),d.id=e+t;var u=l.formHtmlUrl;return u=R.createFormUrl(u,t),d.src=u,d.tabIndex=-1,d.setAttribute("title",r.IFRAME_SETTINGS.IFRAME_TITLE),n.appendChild(d),d}function rs(t,e){var n=e.formId,a=document.getElementById("kampyleFormContainer");if(!(n&&a&&o.isMobileDynamicSizing(n)))return!1;s.setElementStyle(a,{height:s.getDocumentSize().height+"px",position:"absolute"},!0)}function Jn(){return s.isIos()?"30px":"100%"}function jn(t){if(o.isLightBoxDisplayType(t.formId)){var e=document.getElementById("kampyleFormModal"),n=Number((t||{}).newHeight);n=isNaN(n)?Jn():n+"px",s.setElementStyle(e,{height:n},!0)}}function is(t,e){if(o.isMobileDynamicSizing((e||{}).formId)){jn(e);var n=s.getNestedPropertyValue(e,"newHeight");if(_.shouldAddScroll(n)){var a=document.getElementById("kampyleFormContainer");s.setElementStyle(a,{overflowY:"auto"},!0)}}}function os(){for(var t=document.body.children,e=[],n=0;n<t.length;n++)e.push({element:t[n],prevAriaHiddenValue:t[n].getAttribute("aria-hidden")}),t[n].setAttribute("aria-hidden",!0);o.setMemoryData("initialAriaHiddenValues",e)}function ss(){for(var t=o.getMemoryData("initialAriaHiddenValues")||[],e=0;e<t.length;e++)t[e].element&&w(t[e].element,Element)&&(t[e].prevAriaHiddenValue===null?t[e].element.removeAttribute("aria-hidden"):t[e].element.setAttribute("aria-hidden",t[e].prevAriaHiddenValue));o.deleteMemoryData("initialAriaHiddenValues")}function ls(t,e){var n=o.getFormData(e.formId),a=s.getOrCreateWrapperContainer(r.IFRAME_SETTINGS.INVITATION.WRAPPER_ID);if(c.checkProvision(r.PROVISIONS.CSP_RULES))G.createInviteIframeContainer(n);else{var i="top:0 !important;left:0 !important;width: 100% !important;";i+="height: 100% !important;position: fixed !important;visibility:hidden !important;",i+="display:none !important;background-color: rgba(22,22,22,0.5) !important;",i+="z-index:99999999 !important;overflow:auto !important",a.innerHTML='<div id="kampyleInviteContainer" style="'+i+'"><div id="kampyleInviteModal" style="overflow: hidden;margin: 0 auto;height:'+n.inviteData.inviteHeight+";width:"+n.inviteData.inviteWidth+';position:relative;z-index:99999999;top: 25%;-webkit-box-shadow:0 0 10px rgba(0,0,0,0.4);-moz-box-shadow:0 0 10px rgba(0,0,0,0.4); box-shadow:0 0 10px rgba(0,0,0,0.4);"></div></div>';var l=G.createSpinnerElement();a.querySelector("#kampyleInviteContainer").appendChild(l),s.setSpinnerStyle(l,r.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(r.PROVISIONS.ENABLE_WCAG_PREPEND_SURVEY)?document.body.prepend(a):document.body.appendChild(a)}var d=document.createElement("iframe");d.id=r.IFRAME_SETTINGS.INVITATION.IFRAME_ID,d.title=r.IFRAME_SETTINGS.INVITATION.IFRAME_TITLE,d.tabIndex=-1;var u=n.inviteData.inviteHeight,f=n.inviteData.inviteWidth,m=o.getMemoryData("kampyleDevice");if(m===r.DEVICES.MOBILE||m===r.DEVICES.TABLET){u="100%",f="100%";var g=document.getElementById("kampyleInviteModal");g&&s.setElementStyle(g,{height:"100%",width:"100%"},!0)}s.setElementStyle(d,{height:u,width:f,display:"none",border:"0"},!0);var S=n.inviteData.inviteUrl+"?formId="+e.formId;if(o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)&&(S+="&isWCAG=true"),S+="&domainsListRelativePath="+R.getDomainsListRelativePath(S),d.src=S,document.getElementById("kampyleInviteModal").appendChild(d),o.isNewMobileInvitation()){var O=document.getElementsByClassName("neb-loading-spinner")[0];s.setElementStyle(O,{display:"none"},!0),s.setElementStyle(a,{"z-index":99999998},!0);var I=document.getElementById("kampyleInviteContainer");I&&s.setElementStyle(I,{"z-index":99999998},!0)}setTimeout(function(){o.getFormState(n.formId).inviteLoaded!==!0&&o.setFormState(n.formId,{inviteLoaded:!1,inviteShown:!1})},r.NETWORK.TIME_FOR_FORM_TO_LOAD_MS)}function ee(t,e){!e||o.isEmbeddedDisplayType(e.formId)||(c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)?_.hideFeedbackButtonVisually():(_.removeButton(t,e),_.unlistenToResize()))}function ds(t,e){var n=document.getElementById("kampyleButtonContainer");n&&(n.innerHTML="",c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)&&o.setMemoryData(r.MEMORY_DATA_FIELDS.FEEDBACK_BUTTON_POSITION_STYLE,{}))}function Qn(t,e){c.checkProvision(r.PROVISIONS.ENABLE_SPA_OVERFLOW_FIX)&&de();var n=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID),a=document.getElementById(r.IFRAME_SETTINGS.INVITATION.WRAPPER_ID),i=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.WRAPPER_ID),l=document.getElementById("kampyle_abandon_zone");_.removeButton(t,e),_.unlistenToResize(),n&&s.removeAllContent(n),a&&s.removeAllContent(a),i&&s.removeAllContent(i),l&&s.removeAllContent(l)}function us(t){return typeof N!="undefined"&&N.getLocalizedButtonText?N.getLocalizedButtonText(t):t.buttonData.text}function cs(t){var e=s.getElementStyle(document.body,"position");return(e==="fixed"||e==="absolute")&&s.getDocumentSize().height<=t}var _={setIframeOrigin:Kn,ignoreShowForm:es,scrollToEmbeddedForm:Dn,scrollFromTop:yn,doScrollY:hn,removeAllShownElements:Qn,handleLightBoxIframe:qn,createFormIframe:as,createFormContainer:nt,showForm:Wn,hideForm:Te,showButton:et,createButton:Ko,listenToResize:Mn,unlistenToResize:yo,onResizeButton:ho,debouncedOnResize:Pn,hideInvite:Ae,hideButton:ee,hideFeedbackButtonVisually:Bo,showFeedbackButtonVisually:xo,removeButton:ds,handleInvitationSkippedForms:Nn,updateIframeStyle:tt,formatTriangularStyle:wn,formatVerticalStyle:kn,prepareHostingDOM:zn,restoreHostingDOM:de,getInvitePosition:ts,newMobileInvite:le,changeInviteHeight:Xn,iFrameHeightChangedHandler:jn,manipulateAriaHiddens:os,restoreAriaHidden:ss,getDefaultIframeHeight:Jn,shouldAddScroll:cs,shouldShowErrMsgOnForm:Go,onErrModalClose:Un,handleLoadFormEvent:Yn,handleCloseButtonInErroModalKeydown:Vn,onErrorModalKeyPressed:xn,pickElementStyleProperties:Yo,resetFormState:Fo,init:Do,setMetaViewport:te,setZIndex:Fn,showVisibility:Je,getCornerMargin:Rn,showFormCouldNotFechtedErrorMsg:Qe,handleInviteReady:vn,getButtonText:us,showInvite:ns,getWCAGClass:be,getClassDirectonByPosition:Gn,updateInviteIframeTitle:On};var fs={ANIMATION_DIRECTION:"centerRight"};function Es(){var t={neb_buttonClicked:[De],neb_sdkShowForm:[De],neb_loadForm:[lt,dt,Zn],neb_inviteAccepted:[De],neb_skipInvitation:[De],neb_formClosed:[he,at],neb_popupBlocked:[he,at],neb_captureInit:[he],neb_captureImageClicked:[rt],MDigital_Capture_Cancelled:[rt],neb_formHide:[he],neb_formLoadingHasFailed:[ot],neb_skipShowingForm:[ta],neb_resetFormState:[at]};E.subscribeMany(t)}function Zn(t,e){var n=o.getFormData(e.formId),a=o.isMobile(),i=s.getNestedPropertyValue(n,"formDisplay.displayDirection"),l=c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(n,"urlVersion");l&&!a&&i&&i.indexOf("center")>-1&&s.setEventHandler(window,"resize",$n(n))}function $n(t){var e=H.resizeAnimationContainer.bind(null,t),n=s.debounce(e,100,!0);return H.debouncedOnResize=n,n}function ms(t){var e=document.getElementById("KampyleAnimationContainer");s.setElementStyle(e,{top:it(t.formHeight)})}function De(t,e){dt(t,e),setTimeout(function(){rt(t,e)},10)}function gs(t,e,n){return!t||!e||!ue(t)||c.hasApplicationLoadingFailed(n,!1)}function rt(t,e){e=e||{};var n=o.getFormData(e.formId),a=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(gs(n,a,e.formId))return!1;o.setMemoryData("isInvitationShouldBeIgnored",!0);var i=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId),l={display:"block",backgroundColor:n.designSettings.formBackgroundColor||"white"},d={display:"block",boxShadow:"-4px 0px 18px -1px rgba(0,0,0,0.37)",backgroundColor:n.designSettings.formBackgroundColor||"white"};c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&(d.maxWidth="100vw",d.maxHeight="100vh");var u=st(n);switch(u){case"centerRight":s.setElementStyle(a,{right:0}),d.borderRadius="8px 0px 0px 8px";break;case"centerLeft":s.setElementStyle(a,{left:0}),d.borderRadius="0px 8px 8px 0px";break;case"bottomRight":s.setElementStyle(a,{bottom:0}),d.borderRadius="8px 0px 0px 0px";break;case"bottomLeft":s.setElementStyle(a,{bottom:0}),d.borderRadius="0px 8px 0px 0px";break;case"topRight":s.setElementStyle(a,{top:0}),d.borderRadius="0px 0px 0px 8px";break;case"topLeft":s.setElementStyle(a,{top:0}),d.borderRadius="0px 0px 8px 0px";break;default:return s.showWarning("Invalid animation type - "+u),!1}i&&(o.isV2Form(e.formId)?s.setElementStyle(i,d):s.setElementStyle(i,l))}function ot(){var t=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);t&&s.setElementStyle(t,{width:0,height:0})}function at(t,e){setTimeout(function(){var n=o.getFormData(e.formId),a=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);a&&(a.remove(),s.removeEventHandler(window,"resize",H.debouncedOnResize),o.initOnsiteDefaultState(e.formId)),ot()},1e3)}function he(t,e){var n=o.getFormData(e.formId);if(o.getDisplayType(n)!=="animation")return!1;e=e||{};var a=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(!n||!a||!ue(n))return!1;ea(n,a)}function it(t){return String(Math.max(0,(window.innerHeight-parseInt(t,10))/2))+"px"}function st(t){return t=t||{},s.getNestedPropertyValue(t,"formDisplay.displayDirection")||fs.ANIMATION_DIRECTION}function ea(t,e){var n;switch(st(t)){case"centerRight":s.setElementStyle(e,{top:it(e.style.height),right:"-"+t.formWidth+"px",bottom:null,left:null,transition:"right 1s ease-in-out"});break;case"centerLeft":s.setElementStyle(e,{top:it(e.style.height),right:null,bottom:null,left:"-"+t.formWidth+"px",transition:"left 1s ease-in-out"});break;case"bottomRight":n=_.getCornerMargin(t)+"px",s.setElementStyle(e,{top:null,right:n,bottom:"-"+t.formHeight+"px",left:null,transition:"bottom 1s ease-in-out"});break;case"bottomLeft":n=_.getCornerMargin(t)+"px",s.setElementStyle(e,{top:null,right:null,bottom:"-"+t.formHeight+"px",left:n,transition:"bottom 1s ease-in-out"});break;case"topLeft":n=_.getCornerMargin(t)+"px",s.setElementStyle(e,{top:"-"+t.formHeight+"px",right:null,bottom:null,left:n,transition:"top 1s ease-in-out"});break;case"topRight":n=_.getCornerMargin(t)+"px",s.setElementStyle(e,{top:"-"+t.formHeight+"px",right:n,bottom:null,left:null,transition:"top 1s ease-in-out"});break;default:return s.showWarning("Invalid animation type - "+t.formDisplayDirection),!1}}function ue(t){return o.getDisplayType(t)==="animation"}function ta(t,e){var n=o.getFormData(e.formId);if(ue(n)){var a=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);a&&s.setElementStyle(a,{display:"none"})}}function _s(t){var e=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(!e){var n=s.getOrCreateWrapperContainer(r.IFRAME_SETTINGS.ANIMATION.WRAPPER_ID);e=document.createElement("div"),s.addAttributesOnElement(e,{id:r.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID}),e.style.zIndex="2147483000",n.appendChild(e),document.body.appendChild(n);var a={border:0,position:"fixed",display:"block",zIndex:"2147483000"};t&&(a.maxWidth="100vw",a.maxHeight="100vh"),s.setElementStyle(e,a)}return e}function lt(t,e){e=e||{};var n=o.getFormData(e.formId);if(!n||!H.isAnimationForm(n))return!1;var a=c.checkProvision(r.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(n,"urlVersion"),i=H.getOrCreateAnimationContainer(a),l=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);if(!l){var d={border:0,height:n.formHeight+"px",width:n.formWidth+"px",display:"none"};a&&(d.maxWidth="100vw",d.maxHeight="100vh");var u=!1;_.createFormIframe(e.formId,r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID,i,d,u)}var f=i.querySelector("#"+r.SPINNER_SETTINGS.CONTAINER_ID);f||(f=G.createSpinnerElement(),i.appendChild(f),s.setSpinnerStyle(f,r.SPINNER_SETTINGS.SIZE.LARGE))}function dt(t,e){e=e||{};var n=o.getFormData(e.formId),a=o.isSkipInvitation(e.formId),i=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(!i||!n||!ue(n)||a&&c.isAnyOtherFormAlreadyShown(e.formId))return!1;document.getElementById(r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId)||lt(t,e),s.setElementStyle(i,{height:n.formHeight+"px",width:n.formWidth+"px"}),ea(n,i)}var H={initAnimationPosition:dt,getDisplayDirection:st,getOrCreateAnimationContainer:_s,init:Es,hideAnimationContainer:ot,hideFormAnimationContainer:ta,handleAnimationIframe:lt,isAnimationForm:ue,listenToResizeAnimation:Zn,resizeAnimationContainer:ms,debouncedOnResize:$n};function ps(){s.setEventHandler(window,"message",ra)}function na(t){for(var e=r.IFRAME_SETTINGS,n=[e.EMBEDDED.IFRAME_ID_PREFIX,e.LIGHTBOX.IFRAME_ID_PREFIX,e.INVITATION.IFRAME_ID,e.ANIMATION.IFRAME_ID,e.PREVIEW.IFRAME_ID],a=0;a<n.length;a++)for(var i=document.querySelectorAll('iframe[id^="'+n[a]+'"]'),l=0;l<i.length;l++)if(t===i[l].contentWindow)return!0;var d=o.getMemoryData("popupHandler");return!!(d&&d===t)}function aa(t){if(s.isDebugMode())return!0;var e=c.checkProvision(r.PROVISIONS.ENABLE_ONSITE_POST_MESSAGE_VERIFICATION);if(!t||!t.origin||!t.data||e&&(!t.source||!na(t.source)))return!1;var n=o.getFormData(JSON.parse(t.data).formId);if(n&&n.formHtmlUrl&&s.getParsedUrl(n.formHtmlUrl).origin!==t.origin)return!1;var a=r.PLACEHOLDERS.URL_PREFIX;if(a.indexOf("://")>-1){var i=a.split("/");a=i[0]+"//"+i[2]}else{var l=a.indexOf("/");l>-1&&(a=a.slice(0,l))}return c.checkProvision(r.PROVISIONS.ON_PREM_HYBRID)||t.origin===a}function ra(t){var e;try{e=JSON.parse(t.data)}catch(g){return!1}if(!aa(t))return!1;switch(e.action){case"inviteAccepted":E.trigger("neb_inviteAccepted",{formId:e.formId});break;case"inviteDeclined":case"inviteDefered":E.trigger("neb_inviteDeclined",{formId:e.formId});break;case"inviteHeightChanged":E.trigger("neb_inviteHeightChanged",{formId:e.formId,newHeight:e.newHeight});break;case"formLoaded":E.trigger("neb_formLoaded",{formId:e.formId,origin:t.origin,isScreenCaptureEnabled:e.isScreenCaptureEnabled});break;case"formSubmitPending":case"formHide":E.trigger("neb_formHide",{formId:e.formId});break;case"formSubmitted":var n={formId:e.formId,feedbackUUID:c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackUUID:e.uuid,feedbackCorrelationUUID:c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackCorrelationUUID:e.uuid};e&&e.formLanguage&&(n.formLanguage=e.formLanguage),c.isContentPayloadEnabled()&&e.content&&(n.content=e.content),E.trigger("neb_feedbackSubmitted",n);break;case"formClose":var n={formId:e.formId,feedbackUUID:c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackUUID:e.uuid,sourceWindow:t.source,isFormSubmitted:e.isFormSubmitted,feedbackCorrelationUUID:c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackCorrelationUUID:e.uuid};E.trigger("neb_formClosed",n);break;case"formPageShown":var n={formId:e.formId,pageNumber:e.pageNumber,feedbackCorrelationUUID:c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackCorrelationUUID:e.uuid};E.trigger("neb_formPageShown",n);break;case"triggerScreenCapture":var n={formId:e.formId,screenCaptureSettings:e.screenCaptureSettings,feedbackCorrelationUUID:c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackCorrelationUUID:e.uuid,screenCaptureUuid:c.checkProvision(r.PROVISIONS.USER_SNAP_AS_COMPONENT)?e.screenCaptureUuid:null};break;case"screenCaptureDelete":E.trigger("screenCaptureDelete",e);break;case"screenCaptureRetake":E.trigger("screenCaptureRetake",e);break;case"scrollToForm":E.trigger("neb_scrollToForm",{formId:e.formId});break;case"iFrameHeightChanged":E.trigger("neb_iFrameHeightChanged",{formId:e.formId,newHeight:e.newHeight});break;case"scrollToTop":E.trigger("neb_scrollToTop",{formId:e.formId});break;case"scrollFromTop":E.trigger("neb_scrollFromTop",{formId:e.formId,numberOfPixels:e.numberOfPixels});break;case"inviteLoaded":E.trigger("neb_inviteLoaded",{formId:e.formId,inviteVersion:e.inviteVersion,inviteContent:e.inviteContent});break;case"loadMultipleForms":E.trigger("neb_loadMultipileForms",{formId:e.formId,formIds:e.formIds});break;case"routeToForm":E.trigger("neb_routeToForm",{formId:e.destinationForm,sourceFormId:e.formId},null,{isStrictMode:!0});break;case"submitFeedbackFailed":E.trigger("neb_submitFeedbackFailed",e);break;case"feedbackUUIDisNull":E.trigger("neb_feedbackUUIDisNull",e);break;case"MDigital_Form_Next_Page":case"MDigital_Form_Back_Page":case"MDigital_ThankYou_Displayed":case"MDigital_ThankYou_Close":case"MDigital_Form_Close_No_Submit":case"MDigital_Form_Close_Submitted":case"MDigital_CHTML_Logs":c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)||(e.feedbackCorrelationUUID=e.uuid),E.trigger(e.action,e);break;case"MDigital_Invalid_Origin":var a="Message origin domain is not allowed, ",i=o.getFormData(e.formId),l=o.getDisplayType(i)===r.DISPLAY_TYPES.POPUP,d=o.getFormTriggerType(e.formId)===r.FORM_TYPES.INVITATION,u=s.getNestedPropertyValue(o.getFormData(e.formId),"inviteData.skipInvitation");!l&&d&&M.isFormShown(e.formId)&&(KAMPYLE_ONSITE_SDK.closeForm(e.formId),console.warn(a+"form has been closed!")),o.setFormState(e.formId,{shown:!1});var f=(o.getFormState(e.formId)||{}).inviteShown;if(f&&(KAMPYLE_VIEW.hideInvite(),console.warn(a+"invitation has been closed!")),l&&!f){var m=o.getMemoryData("popupHandler");e.sourceWindow=m,KAMPYLE_VIEW.hideForm("MDigital_Invalid_Origin",e),console.warn(a+"popup has been closed!")}o.setMemoryData(KAMPYLE_TARGETING.generateShouldShowInviteParamName(e.formId),!1),u&&o.setMemoryData("isInvitationShouldBeIgnored",!0),E.trigger("MDigital_Invalid_Origin",{formId:e.formId});break;default:return c.checkProvision(r.PROVISIONS.ON_PREM_HYBRID)||s.showWarning("invalid action - "+e.action),!1}}var ye={init:ps,handleMessage:ra,validateMessageEvent:aa,isAllowedSource:na};function Is(){var t={neb_loadForm:[oa],neb_formLoaded:[sa],neb_iFrameHeightChanged:[ca],neb_formClosed:[hs],MDigital_ThankYou_Displayed:[ma],neb_targetingInit:[ia]};E.subscribeMany(t)}function ia(){if(c.checkProvision(r.PROVISIONS.CLEAR_EMBEDDED_ON_UPDATE_PAGE))for(var t=o.getAllForms(),e=0;e<t.length;e++){var n=t[e];o.isEmbeddedDisplayType(n.formId)&&j.deleteEmbeddedIframe(n.formId)}}function Ss(t){var e=o.getFormData(t);return s.getNestedPropertyValue(e,"isFullWidthEmbedded")}function oa(t,e){if(e=e||{},!o.isEmbeddedDisplayType(e.formId))return!1;var n=la(e.formId);if(!vs(n))return!1;if(n){var a=parseInt(getComputedStyle(n).height),i=parseInt(getComputedStyle(n).paddingTop)+parseInt(getComputedStyle(n).paddingBottom);i===a&&(a=0),fa(n.id,a)}var l=setTimeout(function(){c.isFormLoaded(e.formId)||E.trigger(r.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:e.formId,failureCause:r.FORM_LOADING_FAILURE_CAUSE.APPLICATION_FAILED,formState:o.getFormState(e.formId)})},r.NETWORK.TIME_FOR_FORM_TO_LOAD_MS);o.setTimeoutHandler(r.TIMEOUT_HANDLERS.EMBEDDED_STATUS+"_"+e.formId,l);var d=As(e.formId),u=o.getFormData(e.formId);return d.src=R.createFormUrl(u.formHtmlUrl,e.formId),n.appendChild(d),o.setFormState(e.formId,{shouldBeShown:!0}),!0}function sa(t,e){if(!o.isEmbeddedDisplayType(e.formId)||c.hasApplicationLoadingFailed(e.formId))return!1;var n=document.getElementById(r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId);return n&&ut(n,{display:"block"}),!0}function vs(t){return t!==null&&(!t.innerHTML||typeof t.innerHTML=="string"&&t.innerHTML.trim()==="")}function la(t){var e=o.getFormData(t);return document.getElementById(s.getNestedPropertyValue(e,"embeddedData.pageElementId"))}function da(t){var e=c.checkProvision(r.PROVISIONS.PREVENT_IFRAME_SCROLLBAR_FLICKERING),n=o.isV2Form(t),a=o.isCustomHtmlForm(t);return e&&!n&&!a}function As(t){var e=r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t,n=document.getElementById(e);return n||(n=document.createElement("iframe"),n.id=e,n.setAttribute("title",r.IFRAME_SETTINGS.IFRAME_TITLE),da(t)&&n.setAttribute("scrolling","no"),ut(n,{display:"none"})),n}function ut(t,e){var n={border:0,width:"100%",height:"100%"},a=Object.assign({},n,e);s.setElementStyle(t,a,!1)}function ua(t,e){e?s.removeAttribute(t,"scrolling"):s.addAttributesOnElement(t,{scrolling:"no"})}function ca(t,e){e=e||{};var n=o.getFormData(e.formId)||{},a=la(e.formId),i=document.getElementById(r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId);if(!o.isEmbeddedDisplayType(e.formId)||a===null||i===null)return!1;var l=Ts(a,n,e),d=Ds(a,n),u={height:l.iframeHeight+"px",width:Ss(e.formId)?"100%":d+"px"};ut(i,u),da(e.formId)&&ua(i,l.shouldBeStatic);var f={height:l.formHeight,width:d,shouldBeStatic:l.shouldBeStatic};return s.sendMessageToIframe(r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId,{action:"setFormStyle",data:f}),f}function Ts(t,e,n){var a=e.isFixedSize==="true"||e.isFixedSize===!0,i=a,l=a?parseInt(e.formHeight):n.newHeight,d=getComputedStyle(t),u=Ea(t.id);u=isNaN(u)?parseInt(t.style.height||0):u;var f=isNaN(parseInt(d.maxHeight))?u||0:parseInt(d.maxHeight),m=isNaN(parseInt(d.minHeight))?0:parseInt(d.minHeight),g=f===0&&m===0;return f!==0&&m>f&&(f=m),bs(l,i,g,f,m,u)}function bs(t,e,n,a,i,l){var d,u=t;return n?(u=t,d=u):(a!==0&&t>=a&&(u=a,e=!0),d=u,(t<i||t<l)&&(d=i!==0?i:l)),{formHeight:u,iframeHeight:d,shouldBeStatic:e}}function Ds(t,e){var n=parseInt(e.formWidth);return Math.min(n,s.getElementSize(t).width)}function hs(t,e){j.deleteEmbeddedIframe(e.formId)}function ys(t){if(!o.isEmbeddedDisplayType(t))return!1;var e=document.getElementById(r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t);return e===null?!1:(s.removeAllContent(e),!0)}function fa(t,e){var n=o.getMemoryData("hostingElementsHeights");n[t]=e,o.setMemoryData("hostingElementsHeights",n)}function Ea(t){return o.getMemoryData("hostingElementsHeights")[t]||0}function ma(t,e){e=e||{},o.isEmbeddedDisplayType(e.formId)&&o.isMobile()&&_.scrollToEmbeddedForm(e.formId)}var j={removeEmbeddedIFrames:ia,init:Is,createEmbeddedIframe:oa,showForm:sa,calculateFormSize:ca,deleteEmbeddedIframe:ys,addHostingElementHeight:fa,getHostingElementHeight:Ea,handleThankyouPage:ma,setIframeScrolling:ua};var ga={sessionCam:"sessionCamRecorder",quantumMetrics:"QuantumMetricAPI"};function ft(t){switch(t.source){case"var":return s.getNestedPropertyValue(window,t.param);case"cookie":return s.kampyleGetCookie(t.param);case"function":var e=s.getNestedPropertyValue(window,t.param);if(typeof e=="function")try{var n=t.predefinedArgs;return n?(n=n.split(","),w(n,Array)?e.apply(t.context,n):null):e.apply(t.context)}catch(a){return null}else return null;case"url":return s.getUrlParam(s.getNestedPropertyValue(window,t.param));case"storage":return localStorage.getItem(s.getNestedPropertyValue(window,t.param));default:}}function _a(t){for(var e=!0,n,a,i=t.isEnabled,l=ga[t.integrationName],d=s.getNestedPropertyValue(window,l),u=0;u<i.length;u++){var f=!1,m=i[u].param;a=i[u].paramValue,m||s.showWarning("no current name found"),n=ft({source:i[u].source,param:m,context:d,predefinedArgs:i[u].predefinedArguments}),a===null?f=n!=null:f=a===n,e=e&&f}return e}function ct(t){for(var e={},n={},a=t.parameters||[],i=ga[t.integrationName]||null,l=s.getNestedPropertyValue(window,i),d=0;d<a.length;d++){var u=ft({source:a[d].source,param:a[d].param,context:l,predefinedArgs:a[d].predefinedArguments}),f=t.parameters[d].putIn;s.setNestedPropertyValue(e,f,u)}return n={integrationName:t.integrationName,parameters:e},n}function Os(t){var e=o.getInegrations()||{},n={},a;for(var i in e)if(e.hasOwnProperty(i)){for(var l=e[i]||[],d=0;d<l.length;d++)if(a=l[d],_a(a))if(t){if(a.integrationName===t)return n[i]=[ct(a)],n}else n[i]=n[i]||[],n[i].push(ct(a))}return n}var ne={isEnabled:_a,prepareIntegrationData:ct,getIntegrationData:Os,getParameterBySource:ft};var Ns={},Cs={neb_pageView:{eventId:"nebula_page_view",disableProvision:r.PROVISIONS.DISABLE_COOLADATA_NEW_PAGE_EVENTS},neb_inviteAccepted:{eventId:"nebula_invite_accepted"},neb_inviteDeclined:{eventId:"nebula_invite_declined"},neb_showInvitation:x({eventId:"nebula_invitation_show",memoryDataKey:"invitationTriggeringData",eventDataKeys:["additionalData"]},!1),neb_feedbackSubmitted:x({eventId:"nebula_form_submitted"},!1),neb_formShown:x({eventId:"nebula_form_show"},!1),neb_buttonClicked:{eventId:"nebula_button_clicked"},neb_sdkShowForm:{eventId:"nebula_code_trigger_form"},neb_routeToForm:{eventId:"nebula_route_to_form",eventMdDataKeys:["formId"]},neb_formClosed:{eventId:"nebula_form_closed"},neb_popupBlocked:{eventId:"nebula_popup_blocked"},neb_skipInvitation:{eventId:"nebula_invitation_skipped"},neb_formPageShown:{eventId:"nebula_form_page_displayed"},neb_captureInit:{eventId:"nebula_capture_init"},neb_captureImageClicked:{eventId:"nebula_capture_image_clicked"},MDigital_Capture_Cancelled:{eventId:"nebula_cancel_capture_clicked"},neb_cancel_capture_clicked:{eventId:"nebula_cancel_capture_clicked"},neb_sdkSurveyDisplayed:{eventId:"nebula_code_survey_displayed"},neb_afterHttpGetRequestOnError:{eventId:"nebula_after_http_get_request_on_error",eventDataKeys:["httpRequestData"]},neb_afterHttpGetRequestOnErrorStatusCode:{eventId:"nebula_after_http_get_request_on_error_status_code",eventDataKeys:["httpRequestData"]},neb_afterHttpGetRequestOnTimeout:{eventId:"nebula_after_http_get_request_on_timeout",eventDataKeys:["httpRequestData"]},neb_afterHttpGetRequest:{eventId:"nebula_after_http_get_request",eventDataKeys:["httpRequestData"]},neb_eventDispatcherError:{eventId:"nebula_eventDispatcherError",eventDataKeys:["errorMessage","errorStack","additionalInfo"]},neb_feedbackUUIDisNull:{eventId:"nebula_feedbackUuidIsNull"},neb_submitFeedbackFailed:{eventId:"nebula_submitFeedbackFailed",eventDataKeys:["uuid","errorMessage","errorStack"]},MDigital_warning:{eventId:"MDigital_warning",eventDataKeys:["message"]},MDigital_couldNotFetchData:{eventId:"MDigital_couldNotFetchData",eventDataKeys:["errorData"]},MDigital_couldNotLoadFormApplication:{eventId:"MDigital_couldNotLoadFormApplication",eventDataKeys:["errorData"]},MDigital_Invalid_Origin:{eventId:"MDigital_Invalid_Origin"},MDigital_noJsonModalShown:{eventId:"mdigital_noDataMessageDisplayed",eventMdDataKeys:["additionalInfo"]},screenCaptureRetake:{eventId:r.EVENTS.SCREEN_CAPTURE_RETAKE},screenCaptureDelete:{eventId:r.EVENTS.SCREEN_CAPTURE_DELETE}},Ff={neb_sessionStart:{eventId:"session_start",provision:r.PROVISIONS.ENABLE_COOLADATA_SESSION_EVENTS},neb_load_form_preload_proximity:{eventId:"nebula_load_form_preload_proximity",provision:r.PROVISIONS.cooladataNewEvents},neb_button_displayed:{eventId:"nebula_button_displayed",provision:r.PROVISIONS.cooladataNewEvents,eventMdDataKeys:["position"]},neb_invitation_loaded:{eventId:"nebula_invitation_loaded",provision:r.PROVISIONS.cooladataNewEvents},neb_invitation_ready:{eventId:"nebula_invitation_ready",provision:r.PROVISIONS.cooladataNewEvents},neb_form_loaded:{eventId:"nebula_form_loaded",provision:r.PROVISIONS.cooladataNewEvents},neb_formReady:{eventId:"nebula_form_ready",provision:r.PROVISIONS.cooladataNewEvents},MDigital_updatingSbtServer:{eventId:"MDigital_updating_sbt_server",eventDataKeys:["dataObjForSbt"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_settingIdentifierValueOnMemory:{eventId:"MDigital_setting_identifier_value_on_memory",eventMdDataKeys:["hasIdentifierValue"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_shouldNotSyncIdentifier:{eventId:"MDigital_should_not_sync_identifier",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_beforeHttpPostRequest:{eventId:"nebula_before_http_post_request",eventDataKeys:["httpRequestData"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnError:{eventId:"nebula_after_http_post_request_on_error",eventDataKeys:["httpRequestData"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequest:{eventId:"nebula_after_http_post_request",eventDataKeys:["httpRequestData"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnErrorStatusCode:{eventId:"nebula_after_http_post_request_on_error_status_code",eventDataKeys:["httpRequestData"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnTimeout:{eventId:"nebula_after_http_post_request_on_timeout",eventDataKeys:["httpRequestData"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithDeclinedDateInviteDeclined:{eventId:"MDigital_update_targeting_with_declined_date_invite_declined",eventMdDataKeys:["declinedDate"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithSubmittedDate:{eventId:"MDigital_update_targeting_with_submitted_date",eventMdDataKeys:["submittedDate"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithDeclinedDateFormClosed:{eventId:"MDigital_update_targeting_with_declined_date_form_closed",eventMdDataKeys:["declinedDate"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_initUserIdentifier:{eventId:"nebula_init_user_identifier",eventMdDataKeys:["hasIdentifierValue"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_initUserIdentifierOnExtraData:{eventId:"nebula_init_user_identifier_on_extra_data",eventMdDataKeys:["hasIdentifierValue"],provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_Form_Next_Page:{eventId:"MDigital_Form_Next_Page",provision:r.PROVISIONS.cooladataNewEvents},MDigital_Form_Back_Page:{eventId:"MDigital_Form_Back_Page",provision:r.PROVISIONS.cooladataNewEvents},MDigital_Form_Close_No_Submit:{eventId:"MDigital_Form_Close_No_Submit",provision:r.PROVISIONS.cooladataNewEvents},MDigital_ThankYou_Displayed:{eventId:"MDigital_ThankYou_Displayed",provision:r.PROVISIONS.cooladataNewEvents},MDigital_ThankYou_Close:{eventId:"MDigital_ThankYou_Close",provision:r.PROVISIONS.cooladataNewEvents},MDigital_pageTargetingPhaseEnded:{eventId:r.EVENTS.MDIGITAL_PAGE_TARGETING_PHASE_ENDED,provision:r.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Ps,eventDataKeys:["additionalData"],rateLimit:1},MDigital_behavioralTargetingPhaseEnded:{eventId:r.EVENTS.MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED,provision:r.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Rs,eventDataKeys:["additionalData"],rateLimit:1},MDigital_quarantinedSurveyPhaseEnded:{eventId:r.EVENTS.MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED,provision:r.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Ls,eventDataKeys:["additionalData"],rateLimit:1},MDigital_DynamicOnsiteInitializedSuccessfully:{eventId:r.EVENTS.MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY,provision:r.PROVISIONS.DYNAMIC_ONSITE_EVENTS},MDigital_createSession:{eventId:r.EVENTS.CREATE_SESSION,provision:r.PROVISIONS.CREATE_SESSION,eventDataKeys:["additionalData"]},mdigital_customEventsDebugMessage:{eventId:r.EVENTS.CUSTOM_EVENTS_DEBUG_MESSAGE,eventDataKeys:["customEventId","customEventData"],provision:r.PROVISIONS.ENABLE_EVENTS_FOR_CE_DEBUG},MDigital_CHTML_Logs:{eventId:r.EVENTS.MDIGITAL_CHTML_LOGS,provision:r.PROVISIONS.CHTML_LOGS,eventMdDataKeys:["source_function","additional_data","error_logs"]}};Object.assign(Ns,Cs);function Ms(t,e){return t&&e.isPassed}function Et(t,e){t=t||{};var n=o.getFormState(t.formId);if(!n||!n.targeting)return h.error("Digital Analytics - getFormTargetingData: failed to build "+e+" phase data for form id: "+t.id),!1;var a=n.targeting[e],i={formId:t.formId,formType:t.formType,evaluationResult:a===null?!1:(a||[]).reduce(Ms,!0),conditions:a};return i}function Ps(){var t=[],e=o.getAllForms()||[];return e.forEach(function(n){t.push(Et(n,r.TARGETING_PHASES.PAGE_TARGETING))}),{mdTargetingData:t}}function Rs(t){return{mdTargetingData:Et(t,r.TARGETING_PHASES.BEHAVIORAL_TARGETING)}}function Ls(t){var e=Et(t,r.TARGETING_PHASES.QUARANTINE_TARGETING)||{};return e.hasUserIdentifier=!!o.getMemoryData("identifierValue"),e.userIdentifierValue=o.getMemoryData("identifierValue"),{mdTargetingData:e}}var C="formId",L="formTriggerType",pa="feedbackUUID",Q="feedbackCorrelationUUID",Fs="content",ws="isPassed",ks="targetingRule",Us="expected",Gs="actual",Vs="formLanguage",Ia=function(){return{MDigital_Form_Close_Submitted:{customEventId:"MDigital_Form_Close_Submitted",payload:[C,L]},neb_formReady:{customEventId:"MDigital_Form_Displayed",payload:[C,L]},neb_pageView:{customEventId:"MDigital_Page_View",payload:[]},MDigital_Form_Next_Page:{customEventId:"MDigital_Form_Next_Page",payload:[C,L]},MDigital_Form_Back_Page:{customEventId:"MDigital_Form_Back_Page",payload:[C,L]},MDigital_Form_Close_No_Submit:{customEventId:"MDigital_Form_Close_No_Submit",payload:[C,L]},MDigital_ThankYou_Displayed:{customEventId:"MDigital_ThankYou_Displayed",payload:[C,L]},MDigital_ThankYou_Close:{customEventId:"MDigital_ThankYou_Close",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?pa:Q)},neb_feedbackSubmitted:{customEventId:"MDigital_Submit_Feedback",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?pa:Q).concat(Aa()?Vs:[]).concat(c.isContentPayloadEnabled()?Fs:[])},neb_inviteAccepted:{customEventId:"MDigital_Invite_Accepted",payload:[C]},neb_showInvitation:{customEventId:"MDigital_Invite_Displayed",payload:[C]},neb_inviteDeclined:{customEventId:"MDigital_Invite_Declined",payload:[C]},neb_skipInvitation:{customEventId:"MDigital_invite_Skipped",payload:[C]},neb_buttonClicked:{customEventId:"MDigital_Feedback_Button_Clicked",payload:[C,L]},neb_captureInit:{customEventId:"MDigital_CaptureButton_Clicked",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?[]:Q)},neb_captureImageClicked:{customEventId:"MDigital_CaptureButton_Taken",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?[]:Q)},neb_initButton:{customEventId:"MDigital_Button_Displayed",payload:[C]},MDigital_Capture_Cancelled:{customEventId:"MDigital_CaptureButton_Cancel",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?[]:Q)},screenCaptureDelete:{customEventId:"MDigital_ScreenCapture_Delete",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?[]:Q)},screenCaptureRetake:{customEventId:"MDigital_ScreenCapture_Retake",payload:[C,L].concat(c.checkProvision(r.PROVISIONS.BACKEND_GENERATED_UUID)?[]:Q)},neb_sdkShowForm:{customEventId:"MDigital_ShowForm_Called",payload:[C,L]},MDigital_targetingRuleEvaluated:{customEventId:"MDigital_targetingRuleEvaluated",payload:[C,ws,ks,Us,Gs,L]}}},xs={formId:{exposedProperty:r.EXPOSED_FEEDBACK_KEYS.FORM_ID_LABEL,manipulateValueMethod:null},formTriggerType:{exposedProperty:r.EXPOSED_FEEDBACK_KEYS.FORM_TYPE_LABEL,manipulateValueMethod:Ys},feedbackCorrelationUUID:{exposedProperty:r.EXPOSED_FEEDBACK_KEYS.FEEDBACK_UUID_LABEL},feedbackUUID:{exposedProperty:r.EXPOSED_FEEDBACK_KEYS.FEEDBACK_UUID_LABEL,manipulateValueMethod:null},content:{exposedProperty:r.EXPOSED_FEEDBACK_KEYS.FEEDBACK_CONTENT_LABEL,manipulateValueMethod:null},formLanguage:{exposedProperty:r.EXPOSED_FEEDBACK_KEYS.FORM_LANGUAGE_LABEL,manipulateValueMethod:null}};function Bs(){c.checkProvision(r.PROVISIONS.ENABLE_CUSTOM_EVENT_SUBMISSION_VIA_CALLBACK)&&(window.dxa_digital_listener_disabled=!0);var t=Ia();try{return s.initEventSubscriptions(t,Sa),!0}catch(e){console.warn(e)}}function Hs(t,e){var n=Ia();if(!t||!e)return null;for(var a in n[t])n[t].hasOwnProperty(a)&&(e[a]=n[t][a]);return e.eventName=t,e.formTriggerType=o.getFormTriggerType(e.formId),e}function Sa(t,e){var n=Hs(t,e),a=va(n);if(a){var i=n.customEventId;s.triggerCustomEvent(i,a),c.checkProvision(r.PROVISIONS.ENABLE_CUSTOM_EVENT_SUBMISSION_VIA_CALLBACK)&&Ks(i,a),c.checkProvision(r.PROVISIONS.ENABLE_EVENTS_FOR_CE_DEBUG)}}function va(t){var e={};if(!t||!t.payload)return null;for(var n=0;n<t.payload.length;n++){var a=t.payload[n],i=s.getNestedPropertyValue(t,a),l;i!=null&&(l=xs[a],l&&l.exposedProperty?e[l.exposedProperty]=l.manipulateValueMethod?l.manipulateValueMethod.apply(this,[i]):i:e[a]=i)}return e}function Ys(t){return r.FORM_TRIGGER_TYPES_MAP[t]||r.CUSTOM_EVENT_OTHER}function Aa(){return c.checkProvision(r.PROVISIONS.EXPOSE_SELECTION_QUESTIONS)||c.checkProvision(r.PROVISIONS.EXPOSE_VERBATIM_QUESTIONS)}function Ks(t,e){function n(){window.dxa_digital_integration&&dxa_digital_integration(t,e)}typeof window.decibelInsight=="function"?window.decibelInsight("ready",n):(window._da_readyArray=window._da_readyArray||[],window._da_readyArray.push(n))}var Oe={init:Bs,triggerCustomEvent:Sa,getCustomEventDataToSend:va,isExposeFormLanguageAllowed:Aa};function Ws(){M.init(),Xs(),_.init(),j.init(),c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)?window.MDIGITAL.MODAL_DIALOGS&&window.MDIGITAL.MODAL_DIALOGS.init():c.checkProvision(r.PROVISIONS.WCAG_TRAP_FOCUS_IN_MODAL)&&window.MDIGITAL.WCAG&&window.MDIGITAL.WCAG.init(),T.init(),ye.init(),H.init();var t=p.getOnsiteConfiguration()||{};t=ya(t),c.checkProvision(r.PROVISIONS.ON_PREM_HYBRID)&&(t.formNodes.forEach(J.replaceFormNodeUrls),t.globalResourcesUrl=J.replaceOnPremPrefixes(t.globalResourcesUrl)),o.setMemoryData(r.MEMORY_DATA_FIELDS.DATA_JSON,t);var e=s.getUrlParam("nebContext")||window.MDIGITAL.nebContext||"live";if(o.setMemoryData("context",e),o.setMemoryData("kampyleDevice",At()),o.setMemoryData("hostedViewportContent",[]),o.setMemoryData("isGuest",!0),o.getMemoryData("context"),Oe.init(),Fa(),Ra(),Ca(),s.setEventHandler(window,"hashchange",Il),c.checkProvision(r.PROVISIONS.SPA_URL_POLLING)){o.setMemoryData("currentUrl",window.location.href);var n=setInterval(function(){window.location.href!==o.getMemoryData("currentUrl")&&(o.setMemoryData("currentUrl",window.location.href),KAMPYLE_ONSITE_SDK.updatePageView())},500)}}function ya(t){t.formNodes=t.formNodes||[];for(var e,n=t.formNodes.length-1;n>=0;n--)e=t.formNodes[n],(!e.formHeight||e.formHeight==="null")&&(e.formHeight=r.FORM_HEIGHT),(!e.formWidth||e.formWidth==="null")&&(e.formWidth=r.FORM_WIDTH);return t}function Xs(){var t={neb_inviteReady:[ka],neb_buttonClicked:[Ta],neb_inviteAccepted:[Ta],neb_showInvitation:[Ja],neb_sdkPageView:[ce,o.initOnsiteDefaultState,o.resetAllFormsLanguagesCode]};E.subscribeMany(t)}function Ta(t,e){var n=o.getFormState(e.formId);!n.loaded&&!n.loading&&E.trigger("neb_loadForm",{formId:e.formId})}function Oa(t,e){var n=(e||{}).formIds||[];n.forEach(function(a){R.loadForm(a)})}function Na(t,e){if(e=e||{},R.closeForm(e.sourceFormId),!R.showForm(e.formId))throw new Error("Form cannot be loaded")}function zs(){if(!c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)){var t=document.querySelector("#kampyleInvite");t&&typeof t.focus=="function"&&t.focus()}}function Ce(t,e){e=e||{};var n=(o.getFormState(e.formId)||{}).inviteShown;n&&M.isInviteLoaded(e.formId)&&Pe(e.formId,!0)&&!fe()?(_.showInvite("",{formId:e.formId}),E.trigger("neb_inviteReady",e),o.setMemoryData("inviteLoadedAndShown",!0)):(Me(e.formId,!0)||fe())&&o.setFormState(e.formId,{inviteShown:!1})}function Ca(){var t={neb_inviteDeclined:["neb_displayClosed"],neb_formClosed:["neb_displayClosed"]};E.subscribeMany(t)}function qs(t){var e=o.isSkipInvitation(t)&&fe(t),n=M.isFormShown(t);return e&&(E.trigger("neb_formReady",{formId:t}),o.setFormState(t,{shouldBeShown:!1}),E.trigger("neb_skipShowingForm",{formId:t})),e||n}function Me(t,e){var n=o.getMemoryJsonKey(t,e),a=o.getMemoryData(n),i=o.getFormState(t);return a===!1||!e&&i&&i.loaded===!1||e&&i&&i.inviteLoaded===!1}function Pe(t,e){var n=o.getMemoryJsonKey(t,e);return!c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)||o.getMemoryData(n)}function Js(t,e,n){var a=r.MEMORY_DATA_FIELDS.FETCHING_DATA_IN_PROGRESS+t+"_"+n,i=o.getMemoryData(a),l=c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION);return!l||Pe(t,!1)||Me(t,e)||i}function js(t,e){if(e.failureCause===r.FORM_LOADING_FAILURE_CAUSE.APPLICATION_FAILED){var n=o.getFormData(e.formId),a=o.getDisplayType(n),i=o.getFormState(e.formId),l={errorData:{formId:e.formId,displayType:a,formState:i}};E.trigger(r.EVENTS.MDIGITAL_COULD_NOT_LOAD_FORM_APPLICATION,l)}setTimeout(function(){o.setFormState(e.formId,{shouldBeShown:!1,loaded:!1})},0)}function Ma(t){var e=o.getFormData(t),n=o.getDisplayType(e);return M.isFormLoaded(t)}function Qs(t){var e=o.getMemoryJsonKey(t,!0),n=o.getMemoryData(e);o.setMemoryData("inviteVersion",n&&n.mobileDesign?1:-1)}function gt(t,e){var n=t==="neb_loadInvitation",a=o.getMemoryData(r.LANG_MEMORY_DATA_KEY_PREFIX+e.formId),i=r.MEMORY_DATA_FIELDS.FETCHING_DATA_IN_PROGRESS+e.formId;i=i+"_"+a,n&&(i=i+"_invite"),!c.shouldSkipFetchingFormData(e.formId,n,a)&&(o.setMemoryData(i,!0),o.fetchFormJsonData({formId:e.formId,isInvite:n,fetchingDataInProgressKey:i,callback:function(){n?(_.updateInviteIframeTitle("",e),Qs(e.formId),Ce("",e)):Re(e)},onError:Zs.bind(null,e,n)}))}function Pa(t){var e=o.isPopupDisplayType(t.formId),n=Ma(t.formId)&&Pe(t.formId,!1),a=M.shouldFormBeShown(t.formId)&&!qs(t.formId);return(n||e)&&a}function Zs(t,e,n){var a=o.getMemoryJsonKey(t.formId,e);o.setMemoryData(a,!1),e||E.trigger(r.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:t.formId,failureCause:r.FORM_LOADING_FAILURE_CAUSE.JSON_FAILED});var i={errorData:{formId:t.formId,isInvite:e,errorDetails:n}};E.trigger(r.EVENTS.MDIGITAL_COULD_NOT_FETCH_DATA,i)}function Re(t){var e=o.isPopupDisplayType(t.formId),n=M.isFormShown(t.formId),a=Pa(t),i=e&&n||!e&&a;a?(E.trigger("neb_showForm",{formId:t.formId}),o.setFormState(t.formId,{shown:!0,isCurrentlySubmitted:!1})):Me(t.formId,!1)&&E.trigger(r.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:t.formId}),i&&E.trigger("neb_formReady",{formId:t.formId})}function Ra(){var t={neb_pageView:[Ba],neb_showInvitation:[ce,s.setCurrentScrollPosition,mt,zs,Ce],neb_buttonClicked:[s.setCurrentScrollPosition,mt,Ne],neb_sdkShowForm:[s.setCurrentScrollPosition,mt,Ne],neb_skipInvitation:[s.setCurrentScrollPosition,Ne],neb_inviteLoaded:[ce,wa],neb_inviteAccepted:[ce,s.setCurrentScrollPosition,Ne],neb_inviteDeclined:[ce,Ha,s.handleAfterFormPosition],neb_formClosed:[pt,s.handleAfterFormPosition],neb_popupBlocked:[pt,s.handleAfterFormPosition],neb_loadForm:[gt,el],neb_loadInvitation:[gt],neb_formLoaded:[ul],neb_loadMultipileForms:[Oa],neb_routeToForm:[Na],neb_formReady:[Wa,Xa,Ya],neb_feedbackSubmitted:[It],neb_submitFeedbackFailed:[It],neb_sdkPageView:[xa],neb_screenCaptureLoaded:[cl],neb_formLoadingHasFailed:[js]};E.subscribeMany(t)}function La(t){var e={neb_buttonClicked:"Button",neb_sdkShowForm:"ByCode",neb_routeToForm:"ByCode",neb_skipInvitation:"Invitation",neb_inviteAccepted:"Invitation"};return e[t]||null}function Ne(t,e){e=e||{},e.triggerType=e.triggerType||La(t),o.saveFormExtraData(e.formId,{triggerType:e.triggerType}),o.setMemoryData("currentFormId",e.formId),o.setMemoryData("formIsShown",!0),o.setFormState(e.formId,{shouldBeShown:!0,triggerType:e.triggerType}),Re(e)}function Fa(){var t=c.isReferrerDifferentThanHost(),e=o.getData("kampyleUserSession"),n=!1;try{n=document.referrer===""||window.parent.document.referrer===""}catch(l){var a={errorMessage:l.message,errorStack:l.stack,additionalInfo:"createSession- failed to access document.referrer, probably CORS problem when the customer's iframe is hosted in a website with different domain."};t=!1}finally{if(!e||n||t){var i={user_session:e,direct_navigation:n,different_referrer:t};c.checkProvision(r.PROVISIONS.CREATE_SESSION),o.setMemoryData("isSyncedIdentifierData",!1),o.setData("kampyleUserSession",s.getCurrentTimestamp()),o.setData("kampyleSessionPageCounter",0),pl(),o.deleteData("kampyleUserPercentile"),o.deleteData("kampyleInvitePresented"),o.deleteData(r.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION),c.checkProvision(r.PROVISIONS.ENABLE_COOLADATA_SESSION_EVENTS),c.checkProvision(r.PROVISIONS.PARALLEL_TAB_SOLUTION)&&o.clearSessionTabs()}}}function $s(){var t=document.referrer.match(/:\/\/(.[^/]+)/);if(!t)return!0;if(t=t[1],t===window.location.host)return!1;var e=o.getPropertySharedSubdomain();return e?!s.isHostMatchesSubdomain(t,e)||!s.isHostMatchesSubdomain(window.location.host,e):!0}function wa(t,e){if(e=e||{},!o.getMemoryData("inviteVersion")){var n=s.getNestedPropertyValue(e,"inviteVersion");o.setMemoryData("inviteVersion",n)}var a=o.getFormState(e.formId)||{};a.inviteShown&&Ce("",e)}function el(t,e){e=e||{},o.setFormState(e.formId,{loading:!0}),E.trigger("neb_form_loaded",{formId:e.formId})}function ka(t,e){if(e=e||{},!o.getFormState(e.formId).inviteLoaded)return!1;s.sendMessageToIframe("kampyleInvite",{action:"inviteShown"});var n={accountId:e.accountId,websiteId:e.websiteId,environment:e.enviroment,url:document.location.href,kampyle_version:window.MDIGITAL.version||"0.0.0.0",formId:e.formId,cookie_size:s.getByteSize(document.cookie),isWCAG:o.isFeatureEnabled("WCAG"),deviceType:At(),provisions:vt(),position:_.getInvitePosition(e.formId),customCssUpload:o.isFeatureEnabled(r.PROPERTY_SETTINGS.CUSTOM_CSS_UPLOAD)};if(c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)){var a=function(d){var u=o.getFormData(e.formId),f=p.getOnsiteConfiguration(),m={submitUrlPrefix:f.submitUrlPrefix,submitUrlSuffix:f.submitUrlSuffix,globalResourcesUrl:f.globalResourcesUrl,versionedResourcesUrl:u.versionedResourcesUrl};n=Object.assign({},n,{inviteData:d},m),n.formLanguage=N.getFormLanguage(e.formId)||null,s.sendMessageToIframe("kampyleInvite",{action:"setExtraData",data:n})},i=function(d){console.error(d)};o.fetchFormJsonData({formId:e.formId,callback:a,onError:i,isInvite:!0},!0)}else s.sendMessageToIframe("kampyleInvite",{action:"setExtraData",data:n})}function ce(t,e){switch(s.sendMessageToIframe("kampyleInvite",{action:r.EVENTS.MDIGITAL_VALIDATE_ORIGIN}),e=e||{},e.formId=e.formId||o.getMemoryData("currentFormId"),t){case"neb_showInvitation":o.setFormState(e.formId,{inviteShown:!0});break;case"neb_inviteDeclined":case"neb_inviteAccepted":o.setFormState(e.formId,{inviteShown:!1});break;case"neb_inviteLoaded":o.setFormState(e.formId,{inviteLoaded:!0});break;case"neb_sdkPageView":o.setFormState(e.formId,{inviteLoaded:null,inviteShown:!1});break;default:s.showWarning("Unhandled event name "+t)}}function Ua(t){var e=t.formId,n,a;t&&(n=parseInt(t.formWidth,10),a=parseInt(t.formHeight,10));var i=document.documentElement.clientWidth,l=document.documentElement.clientHeight,d={overflowY:"auto",height:"100%"};s.setElementStyle(document.getElementById("innerContainer"),d);var u={border:0,position:"relative",margin:"50px auto 50px",height:a+"px",width:n+"px"};i>n&&l>a&&(o.isCustomHtmlAndFixedSizeForm(e)?u={position:"absolute",top:"50%","margin-top":-a/2+"px",left:"50%","margin-left":-n/2+"px",height:a+"px",width:n+"px"}:u={position:"fixed",height:"100%",width:"100%"});var f=document.getElementById("kampyleFormModal");f&&f.style&&f.removeAttribute&&(f.removeAttribute("style"),s.setElementStyle(f,u))}function tl(){var t=450,e=450,n=s.getUrlParam("url"),a;if(o.getMemoryData("kampyleDevice")===r.DEVICES.MOBILE)e="100%",t="100%";else{var i=s.getUrlParam("height"),l=s.getUrlParam("width");i&&!isNaN(i)&&(t=i),l&&!isNaN(l)&&(e=l)}if(n&&s.validateKampyleDomain(decodeURIComponent(n))){n=decodeURIComponent(n),n+="?region="+o.getMemoryData("region");var d=s.getUrlParam("formId");d?(n+="&formId="+d,o.setMemoryData("currentFormId",d)):(a=location.protocol+"//"+location.host,window.location=a+"/#/error/404");var u=decodeURIComponent(window.getUrlParam("provisions"));u&&(n+="&provisions="+encodeURIComponent(u));var f=decodeURIComponent(window.getUrlParam("websiteId"));f&&(n+="&websiteId="+encodeURIComponent(f));var m=s.getUrlParam("type")||"direct",g=["live","direct","preview"];g.indexOf(m.toLowerCase())===-1&&(m="direct"),n+="&type="+m;var S="100%",O="100%";o.isCustomHtmlAndFixedSizeForm(d)&&(S=t,O=e);var I=s.createIframe(n,O,S,r.IFRAME_SETTINGS.PREVIEW.IFRAME_ID+d);o.isCustomHtmlForm(d)&&Ua({formId:d,formHeight:t,formWidth:e});var A=document.getElementById("kampyleFormModal");A&&(A.appendChild(I),I.offsetTop<30&&!o.getMemoryData("kampyleDevice")===r.DEVICES.MOBILE&&(A.style.paddingTop=30-I.offsetTop+"px"))}else a=location.protocol+"//"+location.host,window.location=a+"/#/error/404"}function Ga(){var t=o.getUserIdentifier();if(!t)return null;var e=b.getCustomParamValue({name:t.source_name,type:t.type,source:t.source});return e||null}function nl(t){o.setMemoryData("isSyncedIdentifierData",!0),al(t.data)}function al(t){_t(t.DECLINED_DATE,"DECLINED_DATE"),_t(t.SUBMITTED_DATE,"SUBMITTED_DATE")}function _t(t,e){var n=parseInt(o.getData(e));n=n||null;var a={identifierDataState:e,identifierValOnLocalStorage:n},i={identifierDataState:e,identifierValOnSbt:t,identifierValOnLocalStorage:n};if(t=t||null,t===n)return null;t!==null&&n===null||t>n?o.setData(e,t):n!==null&&t===null||t<n?c.updateTargeting(e,n):s.showWarning("special case")}function rl(t,e){var n=p.getOnsiteConfiguration().websiteId||null,a=o.getServerBasedTargetingPrefix(),i=o.getServerBasedTargetingEnv(),l=a+"/api/targeting/property/"+i+n+"/identity/"+t,d=Va.bind(null,e),u=il.bind(null,e);s.httpRequest(r.HTTP_METHODS.GET,l,null,d,u)}function Va(t,e){!e||e.error||nl(e),typeof t=="function"&&t()}function il(t,e){typeof t=="function"&&t()}function ol(t){var e=o.getMemoryData("identifierValue"),n=o.getMemoryData("isSyncedIdentifierData")===!0,a=!!c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING),i=!!t;return i&&a&&(!n||e!==t)}function xa(){if(fe())return!1;if(o.setMemoryData("isInvitationShouldBeIgnored",!1),E.trigger("neb_pageView"),window.KAMPYLE_ONSITE_STATE!=="manual"){var t=o.isFeatureEnabled(r.PROPERTY_SETTINGS.MANUALLY_INVITE_TARGETING);E.trigger("neb_targetingInit",{skipInviteTargeting:t})}}function Ba(){var t=o.getData("kampyleSessionPageCounter")||0;t=parseInt(t),o.setData("kampyleSessionPageCounter",++t)}function sl(t){var e="DECLINED_DATE",n=s.getCurrentTimestamp();o.setData(e,n),c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING)&&E.trigger(t,{declinedDate:n}),St(e,n)}function pt(t,e){e=e||{},!e.isFormSubmitted&&(!c.checkProvision(r.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)||o.isFormOfType(e.formId,r.FORM_TYPES.INVITATION))&&c.setQuarantineDeclinedDate(r.EVENTS.MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_FORM_CLOSED),o.setMemoryData("formIsShown",!1),o.setFormState(e.formId,{shouldBeShown:!1,shown:!1,loaded:null}),c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)||(Ka(),s.triggerCustomEvent("neb_formClosed",{formId:e.formId}),o.getMemoryData("context")==="preview"&&window.close()),ba(e.formId)}function ba(t){var e=o.getMemoryData("buttonFormId"),n=o.getFormData(e),a=o.getDisplayType(n)==="animation"?1e3:0;e?setTimeout(function(){E.trigger("neb_showButton",{formId:e,formClosed:!0}),Da(t)},a):Da(t)}function Da(t){E.trigger("neb_afterFormClosed",{formId:t}),c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)&&s.triggerCustomEvent("neb_formClosed",{formId:t})}function St(t,e){if(c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING)&&o.getMemoryData("identifierValue")){var n={};n[t]=e;var a=o.getServerBasedTargetingPrefix(),i=o.getServerBasedTargetingEnv(),l=a+"/api/targeting/property/"+i+p.getOnsiteConfiguration().websiteId+"/identity/"+encodeURIComponent(o.getMemoryData("identifierValue")),d=n[t],u={dataState:d,dataValue:e};E.trigger("MDigital_updatingSbtServer",u),s.httpRequest(r.HTTP_METHODS.POST,l,n)}}function ll(){var t="SUBMITTED_DATE",e=s.getCurrentTimestamp();o.setData(t,e),c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING)&&E.trigger("MDigital_updateTargetingWithSubmittedDate",{submittedDate:e}),St(t,e)}function dl(t){switch(o.getFormTriggerType(t)){case r.FORM_TYPES.BUTTON:return o.isFeatureEnabled(r.FEATURE_FLAGS.EXEMPT_BUTTON_FORMS_FROM_QUARANTINE);case r.FORM_TYPES.CODE:return o.isFeatureEnabled(r.FEATURE_FLAGS.EXEMPT_CODE_FORMS_FROM_QUARANTINE);case r.FORM_TYPES.EMBEDDED:return o.isFeatureEnabled(r.FEATURE_FLAGS.EXEMPT_EMBEDDED_FORMS_FROM_QUARANTINE);default:return!1}}function It(t,e){(!c.checkProvision(r.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)||!dl(e.formId))&&c.setQuarantineSubmittedDate(),o.setData(r.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION,!0),o.setFormState(e.formId,{isCurrentlySubmitted:!0})}function Ha(t,e){c.setQuarantineDeclinedDate(r.EVENTS.MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_INVITE_DECLINED),Ka()}function ul(t,e){o.setFormState(e.formId,{loading:!1,loaded:!0}),Re(e)}function Ya(t,e){e=e||{}}function cl(t,e){e=e||{};var n=o.getFormData(e.formId),a;switch(o.getDisplayType(n)){case r.DISPLAY_TYPES.LIGHTBOX:a=r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX;break;case r.DISPLAY_TYPES.ANIMATION:a=r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID;break;default:a=r.IFRAME_SETTINGS.PREVIEW.IFRAME_ID}var i=a+e.formId;s.sendMessageToIframe(i,{action:"screenCaptureLoaded"})}function mt(){o.setMemoryData("kampyleFocusedElement",document.activeElement)}function Ka(){if(!c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)){var t=o.getMemoryData("kampyleFocusedElement");t&&t.focus&&t.focus()}}function fl(t){var e=p.getOnsiteConfiguration();return!!t&&!!e&&!!e.provisions&&(!!e.provisions[t]||e.provisions[t]==="true")}function vt(){var t=p.getOnsiteConfiguration().provisions,e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=c.checkProvision(n));return e}function At(){return o.getMemoryData("kampyleDevice")||o.setMemoryData("kampyleDevice",s.getDeviceTypeByUserAgent(navigator.userAgent,navigator.userAgentData)),o.getMemoryData("kampyleDevice")||"desktop"}function El(t){var e=o.getMemoryData("version");return e===1?t.screenCapture={isTaken:!1}:t.integrations.screenCapture={isTaken:!1},t}function Wa(t,e){e=e||{};var n=o.getFormData(e.formId);if(!n||!e.formId)return!1;var a,i,l=o.getDisplayType(n);switch(l){case"animation":i=document.getElementById(r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);break;case"lightbox":i=document.getElementById(r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);break;case"popup":a=o.getMemoryData("popupHandler");break;case r.DISPLAY_TYPES.EMBEDDED:i=document.getElementById(r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId);break;default:return s.showWarning("Invalid display type - "+l),!1}var d="*";if(i&&i.getAttribute&&(d=i.getAttribute("origin")||"*",a=i.contentWindow),a&&a.postMessage){if(b.hasCustomParams(e.formId)){var u=b.formatCustomParams(e.formId);a.postMessage('{"action": "customParamsLoaded","customParams" : '+JSON.stringify(u)+', "__isDigitalAction": true}',d)}var f='{"action": "setFormId","formId" : '+e.formId+', "__isDigitalAction": true}';if(a.postMessage(f,d),f={action:"setExtraData",__isDigitalAction:!0},f.clientHints=s.safeJsonParse(r.PLACEHOLDERS.USER_AGENT_CLIENT_HINTS_LIST)||[],f.provisions=vt(),f.integrations=ne.getIntegrationData(),0)var m;f.websiteId=p.getOnsiteConfiguration().websiteId||null,f.device=o.getMemoryData("kampyleDevice"),f.context=o.getMemoryData("context"),f.url=encodeURIComponent(document.location.href),f.customCssUpload=o.isFeatureEnabled(r.PROPERTY_SETTINGS.CUSTOM_CSS_UPLOAD),f.displayType=o.getDisplayType(n);var g=p.getOnsiteConfiguration();Object.assign(f,{submitUrlPrefix:g.submitUrlPrefix,submitUrlSuffix:g.submitUrlSuffix,submitUrlWithBackendUUID:g.submitUrlWithBackendUUID,globalResourcesUrl:g.globalResourcesUrl,versionedResourcesUrl:n.versionedResourcesUrl,textAreaLimit:g.textAreaLimit}),c.checkProvision(r.PROVISIONS.SERVER_BASED_TARGETING)&&(f.endUserIdentifier=Ga(),E.trigger("neb_initUserIdentifierOnExtraData",{hasIdentifierValue:f.endUserIdentifier!==null}));var S=o.flushFormExtraData(e.formId);if(S)for(var O in S)S.hasOwnProperty(O)&&(f[O]=S[O]);if(c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)){var I=function(P){f=Object.assign({},f,{formData:P}),f.formLanguage=N.getFormLanguage(e.formId)||null,a.postMessage(JSON.stringify(f),d)},A=function(P){console.error(P)};o.fetchFormJsonData({formId:n.formId,callback:I,onError:A},!0)}else a.postMessage(JSON.stringify(f),d)}E.trigger("neb_formShown",{formId:e.formId,feedbackCorrelationUUID:e.feedbackCorrelationUUID})}function Xa(t,e){e=e||{},o.setMemoryData("NEB_FORM_VERSION",e.formVersion||0)}function ml(){var t=o.getMemoryData("formsState")||{};for(var e in t)if(t.hasOwnProperty(e)&&t[e].inviteShown)return!0;return!1}function fe(t,e){var n=o.getMemoryData("formsState")||{};for(var a in n)if(n.hasOwnProperty(a)){var i=!M.isFormShown(a)&&(t&&t==a||e&&o.isSkipInvitation(a));if((n[a].shown||n[a].shouldBeShown)&&!o.isEmbeddedDisplayType(a)&&!i)return!0}return!1}function gl(t){t=t||{};var e=t.value,n=t.type||"";if(e===void 0&&(e=b.fetchCPValue(t)),e!==null)switch(n.toLowerCase()){case"datetime":typeof e=="string"?e=parseInt(e)||null:!w(e,Date)&&(!e.getTime||isNaN(e.getTime()))?e=null:e=e.getTime();break;case"number":e=s.getNumericValue(e);break;case"text":typeof e!="string"&&(e=null);break;case"boolean":e==="true"?e=!0:e==="false"&&(e=!1),typeof e!="boolean"&&(e=null);break;default:e=null,console.error("Invalid custom parameter type "+n);break}return e}function _l(){var t=p.getOnsiteConfiguration();return!!t&&t.isFormsPreloaded!=="false"&&t.isFormsPreloaded!==!1}function pl(){var t=o.getData("kampyleUserSessionsCount");t=Number(t)||0,o.setData("kampyleUserSessionsCount",++t)}function Il(){o.isFeatureEnabled("SPA")&&KAMPYLE_ONSITE_SDK.updatePageView()}function Sl(t){t=t||{},E.trigger("neb_buttonClicked",{formId:t.formId})}function za(){var t=Number(o.getData("kampyleUserSession"));return t?Math.floor(s.getTimeDiff(t,r.TIME_FORMATS.SECONDS)):0}function qa(){var t=Number(o.getData("kampylePageLoadedTimestamp"));return t?Math.floor(s.getTimeDiff(t,r.TIME_FORMATS.SECONDS)):0}function ha(t){var e=Number(o.getData(t));return e?s.getTimeDiff(e,r.TIME_FORMATS.DAYS):null}function Ja(t,e){var n=(o.getMemoryData("kampyleDevice")||r.DEVICES.DESKTOP).toLowerCase(),a=o.getFormData(e.formId),i={desktop:n===r.DEVICES.DESKTOP,mobile:n===r.DEVICES.MOBILE,tablet:n===r.DEVICES.TABLET,abandon:!!o.getMemoryData("targetingState.abandon"),time_in_session:za(),time_on_page:qa(),excluded_urls:s.getNestedPropertyValue(a,"urlRules.exclusionUrl.rule"),included_urls:s.getNestedPropertyValue(a,"urlRules.inclusionUrl.rule"),number_of_visits:Number(o.getData("kampyleUserSessionsCount"))||1,last_declined:ha("DECLINED_DATE"),last_feedback:ha("SUBMITTED_DATE"),percentage:T.getUserPercentile(e.formId)};o.setMemoryData("invitationTriggeringData",i)}function vl(){return c.checkProvision(r.PROVISIONS.EVENT_INCLUDE_FEEDBACK_CONTENT)||c.checkProvision(r.PROVISIONS.EXPOSE_SELECTION_QUESTIONS)||c.checkProvision(r.PROVISIONS.EXPOSE_VERBATIM_QUESTIONS)}var c={increasePageViewCounter:Ba,subscribeToCustomEvents:Ca,subscribeToPageEvents:Ra,createSession:Fa,updateTargeting:St,checkProvision:fl,getAllProvisions:vt,onSyncIdentifierDataSuccess:Va,shouldRenderForm:Pa,addScreenCaptureData:El,sendFormExtraData:Wa,handleVersion:Xa,showPreviewForm:tl,updatePreviewIframeStyle:Ua,validateFormContract:ya,getTriggerTypeByEvent:La,prepareInviteTriggeringData:Ja,loadScreenCaptureApi:Ya,handleInviteLoaded:wa,sendInviteInitialData:ka,checkDevice:At,shouldSyncIdentifier:ol,prepareJsonData:gt,shouldSkipFetchingFormData:Js,getTimeInSession:za,getTimeOnPage:qa,isReferrerDifferentThanHost:$s,setQuarantineDeclinedDate:sl,setQuarantineSubmittedDate:ll,handleFormClosed:pt,handleFeedbackSubmitted:It,handleInviteDeclined:Ha,init:Ws,startCheckingTargeting:xa,isAnyOtherFormAlreadyShown:fe,isAnyInviteShown:ml,getSafeCustomParamVal:gl,isPreloadConfigured:_l,kampyleButtonClicked:Sl,loadMultipileForms:Oa,routeToForm:Na,updateIdentifierDataIntegerIfNecessary:_t,syncIdentifierData:rl,getUserIdentifierVal:Ga,handleFormStateUpdated:Re,hasApplicationLoadingFailed:Me,isJsonDataLoaded:Pe,handleInviteApplicationUpdated:Ce,isFormLoaded:Ma,isContentPayloadEnabled:vl};var s={TOP_LEVEL_DOMAIN_COOKIE_PREFIX:"Tld-",startsWith:function(e,n,a){return e.substr(a||0,n.length)===n},isIos:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isSafari:function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<0},isiPhone:function(){return/iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isiPadOS13:function(){return s.isSafari()&&!s.isiPhone()&&(navigator.platform==="MacIntel"||navigator.platform==="Mac-Intel")&&navigator.maxTouchPoints>1},isDesktop:function(){return o.getMemoryData("kampyleDevice")===r.DEVICES.DESKTOP},triggerCustomEvent:function(e,n){var a;n=n?{detail:n}:{},a=new CustomEvent(e,n);try{window.dispatchEvent(a)}catch(i){s.showWarning("Could not trigger custom event "+e)}},isDebugMode:function(){var e=o.getMemoryData("region");return e===r.REGIONS.DEV||e===r.REGIONS.QA},showErrorStack:function(e){s.isDebugMode()&&console.warn(e.stack)},showWarning:function(e){s.isDebugMode()&&console.warn(e)},addStyle:function(e,n){if(c.checkProvision(r.PROVISIONS.CSP_RULES))console.error("Should not use this method if the provision csp rules is on");else{n=n||window.document;var a=n.getElementById("kampyleStyle");if(a===null){a=n.createElement("style"),a.type="text/css",a.id="kampyleStyle";var i=n.head||n.getElementsByTagName("head")[0];i.appendChild(a)}a.styleSheet?a.styleSheet.cssText+=e:(a.appendChild(document.createTextNode(e)),s.setAnimationRule(r.CSS_SETTINGS.ANIMATION_RULE_SPIN_NAME,"{0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); }}"))}},addAttributesOnElement:function(e,n){if(e&&n)for(var a in n)n.hasOwnProperty(a)&&e.setAttribute&&e.setAttribute(a,n[a])},removeAttribute:function(e,n){e&&e.hasAttribute(n)&&e.removeAttribute(n)},getViewportSize:function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},getDocumentSize:function(){var e=document.body,n=document.documentElement,a=Math.max(e.scrollHeight||0,e.offsetHeight||0,n.clientHeight||0,n.scrollHeight||0,n.offsetHeight||0),i=Math.max(e.scrollWidth||0,n.scrollWidth||0,e.offsetWidth||0,n.offsetWidth||0,n.clientWidth||0);return{width:i+(e.getBoundingClientRect&&e.getBoundingClientRect().left||0),height:a+(e.getBoundingClientRect&&e.getBoundingClientRect().top||0)}},getElementSize:function(e){var n=Math.max(e.scrollHeight||0,e.offsetHeight||0,e.clientHeight||0),a=Math.max(e.scrollWidth||0,e.offsetWidth||0,e.clientWidth||0);return{width:a,height:n}},getCurrentTimestamp:function(){return new Date().getTime()},getTimeDiff:function(e,n){var a=typeof e!="undefined"?e:"2014-01-01 01:02:03.123456";a=new Date(a).getTime();var i=s.getCurrentTimestamp();if(isNaN(a))return"";var l=0;switch(a<i?l=i-a:l=a-i,n){case r.TIME_FORMATS.SECONDS:return l.toFixed(1)/1e3;case r.TIME_FORMATS.DAYS:return Math.floor(l/1e3/60/60/24);default:return l}},setEventHandler:function(e,n,a){e.addEventListener?e.addEventListener(n,a,!1):e.attachEvent&&e.attachEvent("on"+n,a)},subscribeToCustomEvent:function(e,n){window&&window.addEventListener&&typeof n=="function"&&window.addEventListener(e,function(a){var i=a&&a.detail;n.apply(null,[e,i])},!1)},removeEventHandler:function(e,n,a){e.removeEventListener?e.removeEventListener(n,a):e.detachEvent&&e.detachEvent("on"+n,a)},setElementStyle:function(e,n,a){var i,l;if(a=a?"important":"",e){for(i in n)if(n.hasOwnProperty(i))if(a&&e&&e.style.setProperty){l=s.camelToDash(i);try{e.style.setProperty(l,""+n[i],a)}catch(d){e.style.setProperty(l,""+n[i],"!"+a)}}else e.style[i]=n[i]}},setAnimationRule:function(e,n,a){for(var i=a&&a.styleSheets&&a.styleSheets||!a&&window.document.styleSheets,l=null,d=0;d<i.length;d++)i[d].title==r.CSS_SETTINGS.STYLE_SHEET_ANIMATION_NAME&&(l=i[d]);if(l){for(var d=0;d<l.cssRules.length;d++)if(l.cssRules[d].name==e)return}if(!l){var u=document.createElement("style");u.title=r.CSS_SETTINGS.STYLE_SHEET_ANIMATION_NAME,a?(a.body.appendChild(u),l=a.styleSheets[a.styleSheets.length-1]):(document.body.appendChild(u),l=window.document.styleSheets[window.document.styleSheets.length-1])}var f="@keyframes "+e+" "+n,m=l.cssRules.length;l.insertRule(f,m)},isNear:function(e,n,a){var i=document.getElementById(e);if(!i)return!1;var l=s.offset(i).left-n,d=s.offset(i).top-n,u=l+i.clientWidth+2*n,f=d+i.clientHeight+2*n,m=a.pageX,g=a.pageY;return m>l&&m<u&&g>d&&g<f},offset:function(e){if(!e)return!1;var n=e.getBoundingClientRect(),a=document.body;return{top:+n.top+a.scrollTop,left:n.left+a.scrollLeft}},createIframe:function(e,n,a,i){var l=document.createElement("iframe");return l.width=n,l.height=a,l.src=e,l.id=i,l.style.border=0,l.frameBorder=0,l.style.display="inline-block",l},getUrlParam:function(e){var n=location.search.substr(location.search.indexOf("?")+1);n===""&&(n=location.hash.substr(location.hash.indexOf("?")+1));var a=null;n=n.split("&");for(var i=n.length,l=0;l<i;l++){var d=n[l].split("=");d&&[d[0]]==e&&(a=decodeURIComponent(d[1]))}return a},htmlDecode:function(e){e=e||"";var n;return n=new RegExp("&lt","g"),e=e.replace(n,"<"),n=new RegExp("&gt","g"),e=e.replace(n,">"),e},escapeRegExp:function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},replaceAll:function(e,n,a){return e.replace(new RegExp(s.escapeRegExp(n),"g"),a)},sendMessageToIframe:function(e,n){var i,l,a;if(e&&(a=document.getElementById(e),!(!a||!a.getAttribute))){var i=a.getAttribute("origin")||"*",l=a.contentWindow;l&&l.postMessage&&(n&&(n.__isDigitalAction=!0),l.postMessage(JSON.stringify(n),i))}},getZoomedIn:function(){var e={zoom:1,constraint:1,isZoomedIn:!1},n="",a=1,i=!1;try{o.isMobile()?e.zoom=window.visualViewport.scale:(n=s.getBrowser(),a=window.devicePixelRatio,n.name===r.BROWSERS.SAFARI?(i=a===2,e.zoom=window.outerWidth/window.innerWidth):n.name===r.BROWSERS.FIREFOX?(a>5?i=!0:i=window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.5), screen and (min-resolution: 1.5dppx), screen and (min-resolution: 144dpi)").matches,e.zoom=i?a*.5:a):(window.screen&&window.screen.pixelDepth?i=window.screen.pixelDepth>24:i=window.outerWidth-window.innerWidth*(a/2)<=60,e.zoom=i?a*.5:a),e.constraint=2)}catch(l){return e}return e.isZoomedIn=e.zoom>=2.4,e},getBrowser:function(){var e=navigator.userAgent,n,a=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(a[1]==="Chrome"&&(n=e.match(/\b(OPR|Edge)\/(\d+)/),n!=null)){var i=n.slice(1);return{name:i[0].replace("OPR","Opera"),version:i[1]||""}}return a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],(n=e.match(/version\/(\d+)/i))!=null&&a.splice(1,1,n[1]),{name:a[0],version:a[1]}},initEventSubscriptions:function(e,n){for(var a in e)e.hasOwnProperty(a)&&E.subscribe(a,n)},getRandomTimeMS:function(e,n){return e+Math.round(Math.random()*(n-e))},kampyleGetUserId:function(){var e=o.getData("kampyle_userid");return e||(e=s.kampyleCreateUUID(),o.setData("kampyle_userid",e),c.checkProvision(r.PROVISIONS.ALTERNATIVE_UUID)&&o.setData(r.MEMORY_DATA_FIELDS.MDIGITAL_ALTERNATIVE_UUID,s.generateUUID())),e},kampyleCreateUUID:function(){for(var e=8,n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},a=n(),i=0;i<e-1;i++)a+="-"+n();return a},removeAllContent:function(e){if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.parentNode.removeChild(e)}},safeToLower:function(e){return typeof e!="string"?e:e.toLowerCase()},getCookieFlagByProtocol:function(){var e=s.isSecureProtocol(),n=e?"None":"Lax",a=e?"Secure; ":"";return"SameSite="+n+"; "+a},buildQueryParams:function(e){return Object.keys(e||{}).map(function(n,a){return(a===0?"?":"")+n+"="+e[n]}).join("&")||""},kampyleSetCookie:function(e,n,a,i){var l=new Date;l.setTime(l.getTime()+a*24*60*60*1e3);var d="expires="+l.toUTCString(),u=i?";domain="+i+";":"",f=s.getCookieFlagByProtocol();e=i?s.TOP_LEVEL_DOMAIN_COOKIE_PREFIX+e:e,document.cookie=e+"="+n+"; "+f+d+";path=/"+u},isSecureProtocol:function(){return location.protocol==="https:"},getCookie:function(e){this.name=e+"=",this.ca=document.cookie.split(";");for(var n=0;n<this.ca.length;n++){for(this.c=this.ca[n];this.c.charAt(0)===" ";)this.c=this.c.substring(1);if(this.c.indexOf(this.name)===0){var a=this.c.substring(this.name.length,this.c.length);return a}}return null},getDomainFromHost:function(e){if(e===null)return null;var n=e.indexOf(":"),a=n===-1?e.length:n;return e.substring(0,a)},isHostMatchesSubdomain:function(e,n){var a=s.getDomainFromHost(e);return a===n||a.endsWith("."+n)},kampyleGetCookie:function(e){this.name=e+"=",this.ca=document.cookie.split(";");for(var n=0;n<this.ca.length;n++){for(this.c=this.ca[n];this.c.charAt(0)===" ";)this.c=this.c.substring(1);if(this.c.indexOf(this.name)===0)return this.c.substring(this.name.length,this.c.length)}return""},getByteSize:function(e){return encodeURIComponent("<q></q>"+e).length},getAllKampyleData:function(){var e=["SUBMITTED_DATE","kampyleUserPercentile","kampyleUserSession","kampyle_userid","kampyleInvitePresented","DECLINED_DATE","LAST_INVITATION_VIEW"];c.checkProvision(r.PROVISIONS.ALTERNATIVE_UUID)&&e.push(r.MEMORY_DATA_FIELDS.MDIGITAL_ALTERNATIVE_UUID),c.checkProvision(r.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)&&e.push(r.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION);for(var n={},a=e.length-1;a>=0;a--)n[e[a]]=o.getData(e[a]);return n},kampyleDeleteCookie:function(e,n){var a="";n&&(a=";domain="+n+";");var i=s.getCookieFlagByProtocol(),l="expires=Thu, 01 Jan 1970 00:00:00 UTC";document.cookie=e+"= ; "+i+l+";path=/"+a},kampyleIsCookieEnabled:function(){return navigator.cookieEnabled},kampyleCompareTimestamps:function(e,n,a){if(typeof e!="number"||typeof n!="number")return!1;switch(e=new Date(e),n=new Date(n),e.setHours(0,0,0,0),a){case"equals":return n.setHours(0,0,0,0),e.getTime()===n.getTime();case"laterthan":return n.setHours(23,59,59,999),e>n;case"earlierthan":return n.setHours(0,0,0,0),e<n;case"doesnotequal":return n.setHours(0,0,0,0),e.getTime()!==n.getTime();default:return!1}},kampyleCompareByOperator:function(e,n,a,i){i=s.safeToLower(i);var l=!1;if(e===void 0)return l;switch(a=s.safeToLower(a),a){case r.OPERATORS.EQUALS:i==="datetime"?l=s.kampyleCompareTimestamps(e,n,a):l=e===n;break;case r.OPERATORS.DOES_NOT_EQUAL:i==="datetime"?l=s.kampyleCompareTimestamps(e,n,a):l=e!==n;break;case r.OPERATORS.GREATER_THAN:l=e>n;break;case r.OPERATORS.LATER_THAN:i==="datetime"?l=s.kampyleCompareTimestamps(e,n,a):l=e>n;break;case r.OPERATORS.SMALLER_THAN:l=e<n;break;case r.OPERATORS.EARLIER_THAN:i==="datetime"?l=s.kampyleCompareTimestamps(e,n,a):l=e>n;break;case r.OPERATORS.CONTAINS:l=!!e&&e.indexOf&&e.indexOf(n)!==-1;break;case r.OPERATORS.DOES_NOT_CONTAIN:l=!!e&&e.indexOf&&e.indexOf(n)===-1;break;case r.OPERATORS.STARTS_WITH:l=!!e&&e.indexOf&&e.indexOf(n)===0;break;case r.OPERATORS.ENDS_WITH:l=!!e&&e.indexOf&&e.length&&e.indexOf(n,e.length-e.length)!==-1;break;case r.OPERATORS.HAS_VALUE:l=!!e||e===""||e===!1||e===0;break;case r.OPERATORS.REGEX:try{var d=new RegExp(n);l=!!e&&d.exec(e)!==null}catch(u){l=!1}break;default:break}return l},setNestedPropertyValue:function(e,n,a){for(var i=e,l=n.split("."),d=l.length,u=0;u<d-1;u++){var f=l[u];i[f]||(i[f]={}),i=i[f]}i[l[d-1]]=a},getNestedPropertyValue:function(e,n,a){if(!e||!n||typeof n!="string")return null;for(var i="#DOT#",l=n.split("."),d=e,u=l.length,f=0;f<u;f++){var m=l[f].split(i).join("."),g=d!==null&&typeof d=="object"&&m in d;if(d&&(d.hasOwnProperty(m)||g||d[m]))d=d[m];else return typeof a=="undefined"?null:a}return d},validateKampyleDomain:function(e){var n=/(^https?:\/\/[A-Za-z0-9\-]+\.kampyle\.com(\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\(\)\*\+,;\=]*)?)/,a=n.test(e);return a||console.warn("Invalid url in validateKampyleDomain: "+e),a},camelToDash:function(e){return typeof e!="string"?e:e.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()},objectPropertyObserver:function(e,n,a){var i=100,l=100,d=0;function u(){var f=s.getNestedPropertyValue(e,n);if(f&&w(a,Function))return a(f);d++<i&&window.setTimeout(u,l)}window.setTimeout(u,l)},showInvite:function(){var e=document.getElementById("kampyleInvite");s.setElementStyle(e,{visibility:"visible"},!0)},hideInvite:function(){var e=document.getElementById("kampyleInvite");s.setElementStyle(e,{visibility:"hidden"},!0)},getNumericValue:function(e){return e===""||e===null||typeof e!="number"&&isNaN(Number(e))?null:Number(e)},extractAllObjectNonFunctionsProperties:function(e){var n={};for(var a in e)typeof e[a]!="function"&&(n[a]=e[a]);return Object.keys(n).length>0?n:null},httpRequest:function(e,n,a,i,l,d){var u=0,f=(d||{}).numOfTimes||r.NETWORK.NUM_OF_RETRIES,m=(d||{}).timeout||r.NETWORK.REQUEST_TIMEOUT;function g(O,I,A){if(u<f){u++;var v=s.getRetryTimeout();setTimeout(S,v)}else E.trigger(I,A),typeof l=="function"&&l(O)}function S(){var O=s.getCurrentTimestamp(),I={attemptNumber:u,url:n};if(a){var A=Object.assign({},a);I=Object.assign({},I,{postData:A})}e==="POST"&&E.trigger(r.COOLADATA_HTTP_EVENTS_BY_METHOD.BEFORE.POST,{httpRequestData:I});var v=new XMLHttpRequest;v.open(e,n,!0),a&&v.setRequestHeader("Content-Type","application/json"),v.timeout=m||0,v.onerror=function(P){var F=s.getTimeDiff(O,r.TIME_FORMATS.SECONDS),U={requestUrl:n,responseStatus:v.status,error:P,requestTotalTimeInSeconds:F};g(U,r.COOLADATA_HTTP_EVENTS_BY_METHOD.ERROR[e],{httpRequestData:U})},v.ontimeout=function(P){var F=s.getTimeDiff(O,r.TIME_FORMATS.SECONDS),U={requestUrl:n,responseStatus:v.status,error:P,attemptNumber:u,networkConnectionDetails:s.extractAllObjectNonFunctionsProperties(window.navigator.connection),requestTotalTimeInSeconds:F};g(U,r.COOLADATA_HTTP_EVENTS_BY_METHOD.TIMEOUT[e],{httpRequestData:U})},v.onload=function(){var P=s.getTimeDiff(O,r.TIME_FORMATS.SECONDS),F=s.safeJsonParse(v.responseText);if(v.status===200){var U={requestUrl:n,attemptNumber:u,requestTotalTimeInSeconds:P};E.trigger(r.COOLADATA_HTTP_EVENTS_BY_METHOD.AFTER[e],{httpRequestData:U}),typeof i=="function"&&i(F)}else{var ie={requestUrl:n,responseStatus:v.status,responseText:F,attemptNumber:u,requestTotalTimeInSeconds:P};g(ie,r.COOLADATA_HTTP_EVENTS_BY_METHOD.ERROR_STATUS_CODE[e],{httpRequestData:ie})}},a?v.send(JSON.stringify(I.postData)):v.send()}S()},lowerize:function(e){return e.toLowerCase()},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},getDeviceTypeByUserAgent:function(e,n){var a="function",i="model",l="object",d="type",u="vendor",f="console",m="mobile",g="tablet",S="smarttv",O="wearable",I="desktop";if(n&&n.platform)return n.mobile?m:n.platform.toLowerCase()==="android"?g:I;if(s.isiPadOS13())return g;for(var A={},v=[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[i,u,[d,g]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[u,"Apple"],[d,g]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/SHIELD Tablet/,/A500/,/LG-V410\/V41020c/,/Puffin/,/^(?!.*Mobile).*Android.*$/],[u,i,[d,g]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[i,[u,"Amazon"],[d,g]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,u,[d,m]],[/\((ip[honed|\s\w*]+);/i],[i,[u,"Apple"],[d,m]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,i,[d,m]],[/\(bb10;\s(\w+)/i],[i,[u,"BlackBerry"],[d,m]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[i,[u,"Asus"],[d,g]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[i,"Xperia Tablet"],[d,g]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[i,"Xperia Phone"],[d,m]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,i,[d,g]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[i,/_/g," "],[d,m]],[/(nexus\s9)/i],[i,[u,"HTC"],[d,g]],[/(nexus\s6p)/i],[i,[u,"Huawei"],[d,m]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,i,[d,m]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[u,"Microsoft"],[d,m]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[u,"Motorola"],[d,m]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[u,"Motorola"],[d,g]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],i,[d,g]],[/smart-tv.+(samsung)/i],[u,[d,S],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],i,[d,m]],[/sie-(\w+)*/i],[i,[u,"Siemens"],[d,m]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],i,[d,m]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[i,[u,"Acer"],[d,g]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],i,[d,g]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[i,[u,"LG"],[d,m]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[u,"Lenovo"],[d,g]],[/linux;.+((jolla));/i],[u,i,[d,m]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,i,[d,m]],[/android.+;\s(pixel c)\s/i],[i,[u,"Google"],[d,g]],[/android.+;\s(pixel xl|pixel)\s/i],[i,[u,"Google"],[d,m]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[i,/_/g," "],[u,"Xiaomi"],[d,m]],[/android.+a000(1)\s+build/i],[i,[u,"OnePlus"],[d,m]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[d,s.lowerize],u,i],[/Mobile|iP(hone|od|ad)|(Android).*(Mobile|sdk)|BlackBerry|portalmmm|BOLT|Vodafone|WindowsCE|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/],[u,i,[d,m]]],P=e||navigator.userAgent,F=0,U,ie,pe,D,oe,B;F<v.length&&!oe;){var wt=v[F],kt=v[F+1];for(U=ie=0;U<wt.length&&!oe;)if(oe=wt[U++].exec(P),oe)for(pe=0;pe<kt.length;pe++)B=oe[++ie],D=kt[pe],(typeof D=="undefined"?"undefined":Se(D))===l&&D.length>0?D.length==2?Se(D[1])==a?A[D[0]]=D[1].call(A,B):A[D[0]]=D[1]:D.length==3?Se(D[1])===a&&!(D[1].exec&&D[1].test)?A[D[0]]=B?D[1].call(A,B,D[2]):void 0:A[D[0]]=B?B.replace(D[1],D[2]):void 0:D.length==4&&(A[D[0]]=B?D[3].call(A,B.replace(D[1],D[2])):void 0):A[D]=B||void 0;F+=2}return!A[d]||A[d]!==m&&A[d]!==g?I:A[d]},getElementStyle:function(e,n){if(w(e,HTMLElement))try{return window.getComputedStyle(e).getPropertyValue(n)}catch(a){}return null},isTruthy:function(e){if(typeof e!="string")return e;try{e=JSON.parse(e)}catch(n){}return e},safeJsonParse:function(e,n){try{return JSON.parse(e)}catch(a){return s.showWarning(n||"Failed to parse JSON, error message: "+(a||{}).message),s.showErrorStack(a||{}),null}},addWcagStyleOnFocus:function(e){o.isFeatureEnabled(r.FEATURE_FLAGS.WCAG)&&(e.addEventListener("focusin",function(){s.setElementStyle(e,{outline:"1px dashed #595959",outlineOffset:"2px",transition:"none"},!0)}),e.addEventListener("focusout",function(){e.style.outline="none",e.style.outlineOffset=null,e.style.transition=null}))},addHoverEffectOnElement:function(e,n,a){e&&typeof e.addEventListener=="function"&&(e.addEventListener("mouseenter",function(){s.setElementStyle(e,a)}),e.addEventListener("mouseleave",function(){s.setElementStyle(e,n)}))},handleAfterFormPosition:function(e,n){var a=!0;if(c.checkProvision(r.PROVISIONS.NOT_SCROLL_TO_LAST_POSITION_DISPLAY_TYPE_ANIMATION))var i=o.getFormData(n.formId),a=o.getDisplayType(i)!=="animation";a&&s.scrollToLastPosition()},scrollToLastPosition:function(){var e=o.getMemoryData("scrollPosition");e&&(window.scroll(e.x,e.y),o.deleteMemoryData("scrollPosition"))},setCurrentScrollPosition:function(){if(!c.checkProvision(r.PROVISIONS.NOT_SCROLL_TO_LAST_POSITION_DISPLAY_TYPE_ANIMATION)&&document.body!==document.activeElement)return!1;var e=s.getScrollPosition()||{};o.setMemoryData("scrollPosition",{x:e.x,y:e.y})},getScrollPosition:function(){var e=window.pageXOffset!==void 0,n=(document.compatMode||"")==="CSS1Compat",a=e?window.pageXOffset:n?document.documentElement.scrollLeft:document.body.scrollLeft,i=e?window.pageYOffset:n?document.documentElement.scrollTop:document.body.scrollTop;return{x:a,y:i}},getLangCodeFromNavAPI:function(){return window.navigator.language||window.navigator.userLanguage||null},getStrigifiedData:function(e){var n;if(typeof e=="object"&&e!==null)try{n=JSON.stringify(e)}catch(a){n=e}else n=e;return n},appendScript:function(e){var n=document.createElement("script");n.src=e,document.body.appendChild(n)},toBase64:function(e){return e=e||"",btoa(unescape(encodeURIComponent(e)))},styleObjToInline:function(e){var n="";for(var a in e)n+=a+":"+e[a]+";";return n},getBaseUrl:function(){return location.origin+location.pathname},generateUUID:function(){var e=s.getCurrentTimestamp();window.performance&&typeof window.performance.now=="function"&&(e+=performance.now());var n="xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/[x]/g,function(){var a=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),a.toString(16)});return n},getRetryTimeout:function(){var e=o.getMemoryData(r.MEMORY_DATA_FIELDS.DATA_JSON);return s.getNestedPropertyValue(e,"retryTimout")||r.NETWORK.RETRY_TIMEOUT},isTrue:function(e){return e===!0||e==="true"},isValueNumericAndDefined:function(e){var n=!!e,a=!isNaN(e);return n&&a},focusElement:function(e){e&&typeof e.focus=="function"&&e.focus()},fakePromise:function(e){return{then:function(a){a(e)}}},textEncode:function(e){if(window.TextEncoder)return new TextEncoder("utf-8").encode(e);for(var n=unescape(encodeURIComponent(e)),a=new window.Uint8Array(n.length),i=0;i<n.length;i++)a[i]=n.charCodeAt(i);return a},toHex:function(e){for(var n=new window.Uint8Array(e),a=[],i=0;i<n.length;i++){var l=n[i].toString(16),d=("00"+l).slice(-2);a.push(d)}return a.join("")},sha512:function(e){var n=window.crypto;if(!(n&&n.subtle)||!e||!window.Uint8Array)return s.fakePromise(null);var a=s.textEncode(e),i=n.subtle.digest("SHA-256",a);return typeof i.then=="function"&&typeof i.catch=="function"?i.then(function(l){return s.toHex(l)}).catch(function(){return null}):s.fakePromise(null)},isModalFormType:function(e){var n=o.getFormData(e),a=o.getDisplayType(n),i=!!n&&!!a&&n.formType!==r.FORM_TYPES.EMBEDDED&&a!==r.DISPLAY_TYPES.POPUP;return c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)?i&&a!==r.DISPLAY_TYPES.ANIMATION:i},isFormInPreviewContext:function(e){var n=o.getFormState(e);return n!=null&&(n.triggerType=="Preview"||n.triggerType=="DraftPreview")},setSpinnerStyle:function(e,n,a){if(e||n){var i={small:{widthHeight:15,border:3},large:{widthHeight:40,border:4}},l=i[n].widthHeight/2+i[n].border,d=e.querySelector("#"+r.SPINNER_SETTINGS.ID),u={display:"block",height:"100%","z-index":"2147483647"};n===r.SPINNER_SETTINGS.SIZE.LARGE&&(u.position="absolute",u.width="100%",u.top=0),s.setElementStyle(d,{border:i[n].border+"px solid #f3f3f3","border-radius":"50%",width:i[n].widthHeight+"px",height:i[n].widthHeight+"px","border-top":i[n].border+"px solid #4050C6","margin-top":"5px","margin-right":"5px",top:"calc(50% - "+l+"px)",left:"calc(50% - "+l+"px)",position:"relative"},!0),s.setElementStyle(e,u,!0),c.checkProvision(r.PROVISIONS.CSP_RULES)?d.animate([{transform:"rotate(0deg)"},{transform:"rotate(360deg)"}],{duration:1e3,iterations:1/0}):(s.setElementStyle(d,{animation:r.CSS_SETTINGS.ANIMATION_RULE_SPIN_NAME+" 1s linear infinite"},!0),s.setAnimationRule(r.CSS_SETTINGS.ANIMATION_RULE_SPIN_NAME,"{0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); }}",a))}},getParsedUrl:function(e){try{var n=document.createElement("a");return n.href=e,{protocol:n.protocol,host:n.host,hostname:n.hostname,port:n.port,pathname:n.pathname,hash:n.hash,search:n.search,origin:n.origin}}catch(a){return console.error("Not valid URL"+e),null}},debounce:function(e,n,a){var i;return function(){var l=this,d=arguments,u=function(){i=null,a||e.apply(l,d)},f=a&&!i;clearTimeout(i),i=setTimeout(u,n),f&&e.apply(l,d)}},getOrCreateWrapperContainer:function(e){return document.getElementById(e)||Object.assign(document.createElement("span"),{id:e})}};var K;function Al(){K={}}function ja(t){var e=r.LOG_MESSAGES.TRIGGER_MESSAGE_TEMPLATE;return e=e.replace("{{EVENT_NAME}}",t.eventName).replace("{{DATA}}",s.getStrigifiedData(t.data)).replace("{{CONTEXT}}",s.getStrigifiedData(t.context)).replace("{{OPTIONS}}",s.getStrigifiedData(t.options)),t.errorMessage?(e=e.replace("{{STATUS}}",r.LOG_STATUSES.FAILED),e+=r.LOG_MESSAGES.ERROR_LOG_TEMPLATE.replace("{{ERROR_MESSAGE}}",t.errorMessage)):e=e.replace("{{STATUS}}",r.LOG_STATUSES.TRIGGERED),e}function Qa(t){return t&&K&&K[t]?K[t]:K}var Tl=function(e,n){if(!e||typeof e!="string"||!n||typeof n!="function")return!1;var a=K[e];if(typeof a!="undefined"){var i=a.indexOf(n);i!==-1&&a.splice(i,1)}return!0},Tt=function(e,n){if(!e||typeof e!="string"||!n||typeof n!="function"&&typeof n!="string")return!1;var a=K[e];typeof a=="undefined"&&(a=K[e]=[]);var i=a.indexOf(n);return i===-1&&a.push(n),!0};function Za(t){t=t||{};var e=p.getOnsiteConfiguration(),n={};return e&&(n={accountId:e.accountId,websiteId:e.websiteId,enviroment:e.region}),Object.assign(t,n)}var bl=function(e,n,a,i){var l=s.getNestedPropertyValue(K,e),d,u;if(typeof l=="undefined"||l===null)return!1;n=Za(n);var f=w(n,Array)?n:[n];for(a=a||null,u=l.length,d=0;d<u;d+=1)if(typeof l[d]=="string")s.triggerCustomEvent(l[d]);else try{l[d].apply(a,[e].concat(f)),h.getLoggerStatus()&&h.debug(ja({eventName:e,data:n,context:a,options:i,errorMessage:null}))}catch(m){if(h.getLoggerStatus()&&h.error(ja({eventName:e,data:n,context:a,options:i,errorMessage:m.message})),s.showErrorStack(m),n&&(n.errorMessage=m.message,n.errorStack=m.stack),i&&i.isStrictMode)break;continue}return!0},Dl=function(e){E.trigger(r.EVENTS.NEB_EVENT_DISPATCHER_ERROR,e)},hl=function(e){for(var n in e)if(e.hasOwnProperty(n))for(var a=0;a<e[n].length;a++)Tt(n,e[n][a])};function yl(t,e){var n=Qa(t);(!n[t]||n.indexOf(e)===-1)&&Tt(t,e)}var E={subscribe:Tt,subscribeOnce:yl,subscribeMany:hl,trigger:bl,triggerError:Dl,unsubscribe:Tl,init:Al,getEventSubscriptions:Qa,appendDefaultEventParams:Za};var bt,Ee,$a={abandon:"abandon",percentage:"kampyleInvitePercentageUsers",timeInSession:"kampyleTimeInSession",timeOnPage:"kampyleTimeOnPage",deviceTypes:"devicetypes",pageEvents:"pageElementEvent"},Ol={GTM:"isGoogleAnalyticsClientGTM",WCAG:"isWCAG",SPA:"isSpa",MANUALLY_INVITE_TARGETING:"isManuallyInviteTargeting",CUSTOM_CSS_UPLOAD:"customCssUpload"},Nl=[r.FEATURE_FLAGS.EXEMPT_BUTTON_FORMS_FROM_QUARANTINE,r.FEATURE_FLAGS.EXEMPT_EMBEDDED_FORMS_FROM_QUARANTINE,r.FEATURE_FLAGS.EXEMPT_CODE_FORMS_FROM_QUARANTINE],Cl=function(){bt=p.getOnsiteConfiguration()||{},Ee={}};function Fe(t){var e=o.getMemoryData(r.MEMORY_DATA_FIELDS.DATA_JSON);return s.getNestedPropertyValue(e,t)}function Ml(){var t=W("formsState")||{};for(var e in t)if(t.hasOwnProperty(e)&&t[e].shouldBeShown)return e;return!1}function er(){return{loading:!1,loaded:null,shouldBeShown:!1,shown:!1,inviteLoaded:null,inviteShown:!1,jsonFailed:!1,applicationFailed:!1,isCurrentlySubmitted:!1,targeting:{pageTargeting:null,behavioralTargeting:[],quarantineTargeting:[]}}}function Pl(t){var e=isNaN(t)||!t,n;if(e){n={};for(var a=p.getOnsiteConfiguration()||{},i=a.formNodes||[],l=i.length,d,u=0;u<l;u++)d=i[u],d&&(n[d.formId]=er());q("formsState",n)}else n=o.getMemoryData("formsState"),n[t]=er(),q("formsState",n);q("hostingElementsHeights",{}),o.setMemoryData(r.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!1),o.clearAllTimeoutHandlers(),o.clearAllDOMEventsHandlers()}function Rl(){var t=W(r.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS);for(var e in t)window.clearTimeout(t[e]);q(r.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS,{})}function Ll(t,e){q(r.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS+"."+t,e)}function Fl(t){return W(r.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS+"."+t)}function wl(t,e,n,a){var i={eventName:e,eventHandler:n,targetElement:a};q(r.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS+"."+t,i)}function kl(t){return W(r.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS+"."+t)}function Ul(){var t=W(r.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS)||{};for(var e in t){var n=t[e].eventName,a=t[e].eventHandler,i=t[e].targetElement||document;i.removeEventListener(n,a)}tr(r.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS)}function Gl(t){var e=Ol[t];return e==null&&Nl.indexOf(t)!==-1&&(e=t),!!e&&!!s.getNestedPropertyValue(bt,e)}function Vl(t){try{return ht()?s.kampyleGetCookie(s.TOP_LEVEL_DOMAIN_COOKIE_PREFIX+t):localStorage[t]||s.kampyleGetCookie(t)}catch(e){return s.kampyleGetCookie(t)}}function W(t){return t=t||"",s.getNestedPropertyValue(Ee,t)}function q(t,e){s.setNestedPropertyValue(Ee,t,e)}function tr(t){delete(Ee||{})[t]}function xl(t,e,n){var a=c.checkProvision(r.PROVISIONS.DISABLE_COOKIE_STORAGE);if(a)if(o.getPropertySharedSubdomain())s.kampyleSetCookie(t,e,n||Le(),o.getPropertySharedSubdomain());else try{localStorage[t]=e}catch(i){s.kampyleSetCookie(t,e,n||Le(),o.getPropertySharedSubdomain())}else{if(!o.getPropertySharedSubdomain())try{localStorage[t]=e}catch(i){}s.kampyleSetCookie(t,e,n||Le(),o.getPropertySharedSubdomain())}return!0}var Bl=function(e){var n=ht();if(n){s.kampyleDeleteCookie(s.TOP_LEVEL_DOMAIN_COOKIE_PREFIX+e,n);return}try{localStorage[e]!==void 0&&delete localStorage[e]}catch(a){}s.kampyleDeleteCookie(e)};function X(t){for(var e=ar(),n=e.length,a,i=0;i<n;i++)if(a=e[i],parseInt(t)===parseInt(a.formId))return a;return null}function Hl(){return Ee}function Dt(t){return t=t||"",W("formsState."+t)||null}function nr(t,e){e=e||{};var n=W("formsState")||{};n[t]=n[t]||{};for(var a in e)typeof n[t][a]=="object"&&n[t][a]!==null?Object.assign(n[t][a],e[a]):n[t][a]=e[a];q("formsState",n)}function ar(){var t=p.getOnsiteConfiguration()||{},e=t.formNodes||[];return e}function Yl(){var t=p.getOnsiteConfiguration()||{};return t.integrations||{}}function Kl(t){var e=X(t);return e?e.inviteData:null}function Wl(){var t=c.checkProvision("mobileInvitationLayout"),e=W("kampyleDevice");return!!t&&e!=="desktop"}function Xl(t){var e=X(t)||{},n=s.getNestedPropertyValue(e,"inviteData.skipInvitation");return n&&n!=="false"}function zl(t){var e=X(t)||{};return e.isFixedSize===!0||e.isFixedSize==="true"}function ql(t){var e=rr(t),n=c.checkProvision("dynamicModalSizeInCustomHtml");return e&&(!n||n&&zl(t))}function we(t){var e=o.getMemoryData("kampyleDevice"),n=s.getNestedPropertyValue(t,"formDisplay.displayType");return e!==r.DEVICES.DESKTOP?n===r.DISPLAY_TYPES.EMBEDDED?r.DISPLAY_TYPES.EMBEDDED:r.DISPLAY_TYPES.LIGHTBOX:n||r.DISPLAY_TYPES.LIGHTBOX}function Jl(t,e){e=e||{};var n=(Dt(t)||{}).pendingExtraData||{};e=Object.assign(n,e),nr(t,{pendingExtraData:e})}function jl(t){var e=Dt(t)||{},n={};return e&&e.pendingExtraData&&(n=e.pendingExtraData,delete e.pendingExtraData),n}function rr(t){var e=X(t)||{},n=s.getUrlParam("isCustomHtml");return e.isCustomHtmlEnabled===!0||e.isCustomHtmlEnabled==="true"||n===!0||n==="true"}function Le(){return s.getNestedPropertyValue(bt,"cookieExpirationTime")||r.COOKIE_EXPIRATION}function Ql(t,e){if(!t||!e||!$a[e])return null;var n=X(t)||{},a=$a[e];return s.getNestedPropertyValue(n,"onSiteData."+a)}function Zl(t){var e=o.getFormData(t);return Number((e||{}).formVersion)||0}function $l(){return p.getOnsiteConfiguration().websiteId||null}function ed(t){var e=o.getMemoryData("kampyleDevice"),n=r.FEATURE_VERSIONS.MOBILE_DYNAMIC_SIZING;t=t||o.getMemoryData("currentFormId");var a=o.isCustomHtmlForm(t),i=a&&c.checkProvision("mobileWebDynamicFormSize")||!a&&c.checkProvision("mobileWebDynamicFormSizeInFormBuilder");return i&&e&&e!=="desktop"&&!o.isV2Form(t)&&o.getFormVersion(t)>=n}function td(){var t=o.getMemoryData("kampyleDevice");return t&&t!=="desktop"}function nd(){return Fe("sbtServerDomain")}function ad(){return Fe("sbtEnvPrefix")}function ht(){var t=Fe("sharedSubdomain");return t&&s.isHostMatchesSubdomain(window.location.host,t)?t:null}function rd(){for(var t=p.getOnsiteConfiguration().customParams||[],e=o.getNestedConfigurationProperty("formNodes")||[],n=0;n<e.length;n++){var a=(e[n].customParams||[]).map(function(l){return t.find(function(d){return d.id===l})}),i=(a||[]).find(function(l){return typeof l=="object"&&l.is_identifier===!0})||null;if(i!==null)return i}return null}function id(t){var e=X(t);return we(e)===r.DISPLAY_TYPES.POPUP}function od(t){var e=X(t);return we(e)===r.DISPLAY_TYPES.EMBEDDED}function sd(t){var e=X(t);return we(e)===r.DISPLAY_TYPES.LIGHTBOX}function ld(t,e,n){var a;return n?a=e?n+t+"_invite":n+t:a=(e?r.INVITE_JSON_DATA_KEY_PREFIX:r.FORM_JSON_DATA_KEY_PREFIX)+t,a+"_"+N.getFormLanguage(t)}function dd(t,e,n){var a=o.getMemoryJsonKey(t,n),i=o.getMemoryData(a);return i!=null?s.getNestedPropertyValue(i,e):null}function ud(t,e){var n=N.getFormLanguage(t)||r.LOCALIZED_FORM_DEFAULT_REPLACE_VALUE;return e.replace("###LANGUAGE_CODE###",n)}function cd(){for(var t=o.getAllForms(),e=0;e<t.length;e++){var n=t[e];N.detectAndSetFormLanguage(n)}}function fd(){for(var t in localStorage)t.indexOf(r.MEMORY_DATA_FIELDS.SESSION_TAB_PREFIX)>-1&&o.deleteData(t)}function Ed(t){var e=[];for(var n in localStorage)n.indexOf(t)>-1&&e.push(localStorage[n]);return e}function md(t,e){var n=o.getFormData(t),a=s.getNestedPropertyValue(n,e?"inviteData.inviteDataUrl":"formDataUrl");return a?o.localizeUrl(t,a):null}function gd(t,e){var n=o.getMemoryJsonKey(t.formId,t.isInvite),a=o.getMemoryData(n),i=o.getDataJsonUrl(t.formId,t.isInvite);if(a)return t.fetchingDataInProgressKey&&o.setMemoryData(t.fetchingDataInProgressKey,!1),typeof t.callback=="function"&&t.callback(a);if(!i){var l=new Error("Failed to get JSON, jsonDataUrl is missing.");return typeof t.onError=="function"&&t.onError(l)}s.httpRequest(r.HTTP_METHODS.GET,i,null,function(d){if(e){var u="second http request have been made to the url: "+i;E.trigger("MDigital_warning",{message:u})}if(d)o.setMemoryData(n,d),t.fetchingDataInProgressKey&&o.setMemoryData(t.fetchingDataInProgressKey,!1),typeof t.callback=="function"&&t.callback(d);else{var f="Invalid form json data. Data: "+JSON.stringify(d);typeof t.onError=="function"&&t.onError({message:f})}},function(d){typeof t.onError=="function"&&t.onError(d)})}function ir(t){var e=s.getNestedPropertyValue(o.getFormData(t),"formType");return r.FORM_TRIGGER_TYPES_MAP[e]?e:null}function _d(t,e){var n=ir(t);return!!n&&n===e}function pd(t){var e=o.getFormData(t);if(e==null)return null;if(e.formType===r.FORM_TYPES.EMBEDDED)return r.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t;var n=o.getDisplayType(e);return n===r.DISPLAY_TYPES.LIGHTBOX?r.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+t:n===r.DISPLAY_TYPES.ANIMATION?r.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+t:null}function Id(t){var e=o.getFormData(t);if(!(!t||!e||!e.formDataUrl))return e.formDataUrl.indexOf("formDataV2")>-1}var o={init:Cl,isFeatureEnabled:Gl,getData:Vl,setData:xl,deleteData:Bl,getAllForms:ar,getInegrations:Yl,getFormData:X,getMemoryData:W,getTargetingData:Ql,setMemoryData:q,getShownFormId:Ml,getFormState:Dt,setFormState:nr,getInviteData:Kl,getDisplayType:we,saveFormExtraData:Jl,flushFormExtraData:jl,isCustomHtmlForm:rr,getCookieExpiration:Le,isNewMobileInvitation:Wl,isCustomHtmlAndFixedSizeForm:ql,deleteMemoryData:tr,getFormVersion:Zl,isMobileDynamicSizing:ed,getPropertySharedSubdomain:ht,getUserIdentifier:rd,getServerBasedTargetingPrefix:nd,getServerBasedTargetingEnv:ad,isPopupDisplayType:id,isEmbeddedDisplayType:od,isLightBoxDisplayType:sd,fetchFormJsonData:gd,getFormTriggerType:ir,getPropertyId:$l,isMobile:td,isSkipInvitation:Xl,getFormIframeId:pd,isFormOfType:_d,getMemoryJsonNestedPropertyValue:dd,resetAllFormsLanguagesCode:cd,getMemoryJsonKey:ld,clearSessionTabs:fd,getStorageDataByPrefix:Ed,setTimeoutHandler:Ll,getTimeoutHandler:Fl,isV2Form:Id,setDOMEventHandler:wl,getDOMEventHandler:kl,clearAllDOMEventsHandlers:Ul,localizeUrl:ud,getMemory:Hl,initOnsiteDefaultState:Pl,getDataJsonUrl:md,clearAllTimeoutHandlers:Rl,getNestedConfigurationProperty:Fe};var Sd={},vd={neb_pageView:{eventId:"nebula_page_view",disableProvision:r.PROVISIONS.DISABLE_COOLADATA_NEW_PAGE_EVENTS},neb_inviteAccepted:{eventId:"nebula_invite_accepted"},neb_inviteDeclined:{eventId:"nebula_invite_declined"},neb_showInvitation:x({eventId:"nebula_invitation_show",memoryDataKey:"invitationTriggeringData"},!1),neb_feedbackSubmitted:x({eventId:"nebula_form_submitted"},!1),neb_formShown:x({eventId:"nebula_form_show"},!1),neb_buttonClicked:{eventId:"nebula_button_clicked"},neb_sdkShowForm:{eventId:"nebula_code_trigger_form"},neb_routeToForm:{eventId:"nebula_route_to_form"},neb_formClosed:{eventId:"nebula_form_closed"},neb_popupBlocked:{eventId:"nebula_popup_blocked"},neb_skipInvitation:{eventId:"nebula_invitation_skipped"},neb_formPageShown:{eventId:"nebula_form_page_displayed"},neb_captureInit:{eventId:"nebula_capture_init"},neb_captureImageClicked:{eventId:"nebula_capture_image_clicked"},MDigital_Capture_Cancelled:{eventId:"nebula_cancel_capture_clicked"},neb_cancel_capture_clicked:{eventId:"nebula_cancel_capture_clicked"},neb_sdkSurveyDisplayed:{eventId:"nebula_code_survey_displayed"},neb_afterHttpGetRequestOnError:{eventId:"nebula_after_http_get_request_on_error",eventDataKey:"httpRequestData"},neb_afterHttpGetRequestOnErrorStatusCode:{eventId:"nebula_after_http_get_request_on_error_status_code",eventDataKey:"httpRequestData"},neb_afterHttpGetRequestOnTimeout:{eventId:"nebula_after_http_get_request_on_timeout",eventDataKey:"httpRequestData"},neb_afterHttpGetRequest:{eventId:"nebula_after_http_get_request",eventDataKey:"httpRequestData"},neb_eventDispatcherError:{eventId:"nebula_eventDispatcherError",eventDataKeys:["errorMessage","errorStack","additionalInfo"]},neb_feedbackUUIDisNull:{eventId:"nebula_feedbackUuidIsNull"},neb_submitFeedbackFailed:{eventId:"nebula_submitFeedbackFailed",eventDataKeys:["uuid","errorMessage","errorStack"]},MDigital_warning:{eventId:"MDigital_warning",eventDataKey:"message"},MDigital_couldNotFetchData:{eventId:"MDigital_couldNotFetchData",eventDataKey:"errorData"},MDigital_couldNotLoadFormApplication:{eventId:"MDigital_couldNotLoadFormApplication",eventDataKey:"errorData"},MDigital_Invalid_Origin:{eventId:"MDigital_Invalid_Origin"},MDigital_noJsonModalShown:{eventId:"mdigital_noDataMessageDisplayed",eventDataKey:"additionalInfo"},screenCaptureRetake:{eventId:r.EVENTS.SCREEN_CAPTURE_RETAKE},screenCaptureDelete:{eventId:r.EVENTS.SCREEN_CAPTURE_DELETE}},Wm={neb_sessionStart:{eventId:"session_start",provision:r.PROVISIONS.ENABLE_COOLADATA_SESSION_EVENTS},neb_load_form_preload_proximity:{eventId:"nebula_load_form_preload_proximity",provision:r.PROVISIONS.cooladataNewEvents},neb_load_form_form_reload:{eventId:"nebula_load_form_form_reload",provision:r.PROVISIONS.cooladataNewEvents},neb_button_displayed:{eventId:"nebula_button_displayed",provision:r.PROVISIONS.cooladataNewEvents},neb_invitation_loaded:{eventId:"nebula_invitation_loaded",provision:r.PROVISIONS.cooladataNewEvents},neb_invitation_ready:{eventId:"nebula_invitation_ready",provision:r.PROVISIONS.cooladataNewEvents},neb_form_loaded:{eventId:"nebula_form_loaded",provision:r.PROVISIONS.cooladataNewEvents},neb_formReady:{eventId:"nebula_form_ready",provision:r.PROVISIONS.cooladataNewEvents},MDigital_updatingSbtServer:{eventId:"MDigital_updating_sbt_server",eventDataKey:"dataObjForSbt",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_settingIdentifierValueOnMemory:{eventId:"MDigital_setting_identifier_value_on_memory",eventDataKey:"hasIdentifierValue",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_shouldNotSyncIdentifier:{eventId:"MDigital_should_not_sync_identifier",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_beforeHttpPostRequest:{eventId:"nebula_before_http_post_request",eventDataKey:"httpRequestData",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnError:{eventId:"nebula_after_http_post_request_on_error",eventDataKey:"httpRequestData",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequest:{eventId:"nebula_after_http_post_request",eventDataKey:"httpRequestData",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnErrorStatusCode:{eventId:"nebula_after_http_post_request_on_error_status_code",eventDataKey:"httpRequestData",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnTimeout:{eventId:"nebula_after_http_post_request_on_timeout",eventDataKey:"httpRequestData",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithDeclinedDateInviteDeclined:{eventId:"MDigital_update_targeting_with_declined_date_invite_declined",eventDataKey:"declinedDate",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithSubmittedDate:{eventId:"MDigital_update_targeting_with_submitted_date",eventDataKey:"submittedDate",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithDeclinedDateFormClosed:{eventId:"MDigital_update_targeting_with_declined_date_form_closed",eventDataKey:"declinedDate",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_initUserIdentifier:{eventId:"nebula_init_user_identifier",eventDataKey:"hasIdentifierValue",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},neb_initUserIdentifierOnExtraData:{eventId:"nebula_init_user_identifier_on_extra_data",eventDataKey:"hasIdentifierValue",provision:r.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_Form_Next_Page:{eventId:"MDigital_Form_Next_Page",provision:r.PROVISIONS.cooladataNewEvents},MDigital_Form_Back_Page:{eventId:"MDigital_Form_Back_Page",provision:r.PROVISIONS.cooladataNewEvents},MDigital_Form_Close_No_Submit:{eventId:"MDigital_Form_Close_No_Submit",provision:r.PROVISIONS.cooladataNewEvents},MDigital_ThankYou_Displayed:{eventId:"MDigital_ThankYou_Displayed",provision:r.PROVISIONS.cooladataNewEvents},MDigital_ThankYou_Close:{eventId:"MDigital_ThankYou_Close",provision:r.PROVISIONS.cooladataNewEvents},MDigital_pageTargetingPhaseEnded:{eventId:r.EVENTS.MDIGITAL_PAGE_TARGETING_PHASE_ENDED,provision:r.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Td,rateLimit:1},MDigital_behavioralTargetingPhaseEnded:{eventId:r.EVENTS.MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED,provision:r.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:bd,rateLimit:1},MDigital_quarantinedSurveyPhaseEnded:{eventId:r.EVENTS.MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED,provision:r.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Dd,rateLimit:1},MDigital_DynamicOnsiteInitializedSuccessfully:{eventId:r.EVENTS.MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY,provision:r.PROVISIONS.DYNAMIC_ONSITE_EVENTS},MDigital_createSession:{eventId:r.EVENTS.CREATE_SESSION,provision:r.PROVISIONS.CREATE_SESSION,eventDataKey:"additionalData"},mdigital_customEventsDebugMessage:{eventId:r.EVENTS.CUSTOM_EVENTS_DEBUG_MESSAGE,eventDataKeys:["customEventId","customEventData"],provision:r.PROVISIONS.ENABLE_EVENTS_FOR_CE_DEBUG},MDigital_CHTML_Logs:{eventId:r.EVENTS.MDIGITAL_CHTML_LOGS,provision:r.PROVISIONS.CHTML_LOGS,eventDataKeys:["source_function","additional_data","error_logs"]}};Object.assign(Sd,vd);function Ad(t,e){return t&&e.isPassed}function yt(t,e){t=t||{};var n=o.getFormState(t.formId);if(!n||!n.targeting)return h.error("Cooladata - getFormTargetingData: failed to build "+e+" phase data for form id: "+t.id),!1;var a=n.targeting[e],i={formId:t.formId,formType:t.formType,evaluationResult:a===null?!1:(a||[]).reduce(Ad,!0),conditions:a};return i}function Td(){var t=[],e=o.getAllForms()||[];return e.forEach(function(n){t.push(yt(n,r.TARGETING_PHASES.PAGE_TARGETING))}),{targetingData:t}}function bd(t){return{targetingData:yt(t,r.TARGETING_PHASES.BEHAVIORAL_TARGETING)}}function Dd(t){var e=yt(t,r.TARGETING_PHASES.QUARANTINE_TARGETING)||{};return e.hasUserIdentifier=!!o.getMemoryData("identifierValue"),e.userIdentifierValue=o.getMemoryData("identifierValue"),{targetingData:e}}var or;function sr(t){var e=window.location.hostname,n=t.filter?t.filter(function(a){if(a[0]==="*"){var i=new RegExp("^.*"+a.slice(1)+"$");return i.test(e)}return a===e}):[];return!!n.length}function hd(){window.MDIGITAL=window.MDIGITAL||{},window.MDIGITAL.version=r.PLACEHOLDERS.ONSITE_VERSION,or=p.getOnsiteConfiguration(),yd(),o.setMemoryData(r.MEMORY_DATA_FIELDS.DATA_JSON,or);var t=c.checkProvision(r.PROVISIONS.DHH),e=window.KAMPYLE_EMBED.getOnsiteDataLocation();e?p.fetchOnsiteExternalConfiguration(window.KAMPYLE_EMBED.getOnsiteDataLocation(t)):p.onsiteDataFailed("onsiteDataLocation is ".concat(e))}function yd(){h.init(),E.init(),o.init(),p.init()}function Od(t){if(c.checkProvision(r.PROVISIONS.ENABLE_ONSITE_DOMAIN_APPROVAL)){var e=t.domainsConfiguration;if(e&&!e.allDomainsAllowed&&e.domainsNames&&!sr(e.domainsNames)){console.error("onsite origin domain is not allowed");return}}o.setMemoryData(r.MEMORY_DATA_FIELDS.DATA_JSON,t),o.initOnsiteDefaultState(),c.init(),c.startCheckingTargeting(),z.reportInitComplete()}function Nd(){s.triggerCustomEvent("neb_OnsiteLoaded")}var z={init:hd,initOnsite:Od,reportInitComplete:Nd,isAllowedDomain:sr};function lr(t){if(Array.isArray(t))return t}function dr(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var a=[],i=!0,l=!1,d,u;try{for(n=n.call(t);!(i=(d=n.next()).done)&&(a.push(d.value),!(e&&a.length===e));i=!0);}catch(f){l=!0,u=f}finally{try{!i&&n.return!=null&&n.return()}finally{if(l)throw u}}return a}}function ur(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ot(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function cr(t,e){if(t){if(typeof t=="string")return Ot(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ot(t,e)}}function ke(t,e){return lr(t)||dr(t,e)||cr(t,e)||ur()}function Cd(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;window[e]={};var a=function(){return console.warn("".concat(e," will be deprecated! Please, use in future KAMPYLE_ONSITE_SDK instead!"))};typeof t=="object"&&(n&&(window.MDIGITAL[e]={}),Object.entries(t).map(function(i){var l=ke(i,2),d=l[0],u=l[1];if(typeof u=="function"){var f=u;n?window.MDIGITAL[e][d]=function(){return a(),f.apply(window,arguments)}:window[e][d]=function(){return a(),f.apply(window,arguments)}}else window[e][d]=function(){return a(),u}}))}var y=Cd;function ae(t){var e={errorMessage:r.LOG_MESSAGES.ERROR_ONSITE_SDK_CONFIGURATION_MISSING.replace("{{METHOD}}",t)};E.triggerError(e),h.warn(e.errorMessage)}function Er(t){if(p.isOnsiteConfigurationMissing())return ae("loadForm"),!1;var e=o.getFormState(t);return e?(M.isFormFullyLoaded(t)||E.trigger("neb_loadForm",{formId:t}),!0):(s.showWarning("Error fetching data for form id "+t),!1)}function Md(t,e){if(p.isOnsiteConfigurationMissing())return ae("showForm"),!1;e=e||{};var n=o.getFormState(t);if(!n)return s.showWarning("Error fetching data for form id "+t),!1;if(o.getMemoryData("inviteLoadedAndShown"))return s.showWarning("There is already an invite displayed"),!1;if(c.isAnyOtherFormAlreadyShown(t,!0))return s.showWarning("There is already a form displayed"),!1;M.isFormFullyLoaded(t)||Er(t),e.triggerType=e.triggerType||"ByCode",o.saveFormExtraData(t,e);var a={formId:t};for(var i in e)e.hasOwnProperty(i)&&(a[i]=e[i]);return E.trigger("neb_sdkShowForm",{formId:t,triggerType:e.triggerType}),!0}function fr(t){var e=o.getFormState(t);if(!(e&&e.shown))return!1;var n=e.isCurrentlySubmitted;return E.trigger("neb_formClosed",{formId:t,isFormSubmitted:n}),!0}function Pd(t){switch(t){case r.CLOSE_FORM_PARAM_VALUES.ALL:return function(){return!0};case r.CLOSE_FORM_PARAM_VALUES.EMBEDDED:return function(e){return e&&e.formType===r.CLOSE_FORM_PARAM_VALUES.EMBEDDED};case r.CLOSE_FORM_PARAM_VALUES.MODAL:return function(e){var n=o.getDisplayType(e);return n===r.DISPLAY_TYPES.ANIMATION||n===r.DISPLAY_TYPES.LIGHTBOX};default:return function(){return!1}}}function Rd(t){if(p.isOnsiteConfigurationMissing())return ae("closeForm"),!1;if(!isNaN(t))return fr(t);for(var e=o.getAllForms(),n=t&&Pd(t.toLowerCase()),a=e.length,i,l=!1,d=0;d<a;d++)i=e[d],n&&n(i)&&(l=fr(+i.formId)||l);return l}function Ld(){if(p.isOnsiteConfigurationMissing())return ae("updatePageView"),!1;E.trigger("neb_sdkPageView")}function Fd(){return p.isOnsiteConfigurationMissing()?(ae("isSurveyDisplayed"),!1):c.isAnyInviteShown()||c.isAnyOtherFormAlreadyShown()?!0:(E.trigger("neb_sdkSurveyDisplayed"),!1)}function wd(){if(p.isOnsiteConfigurationMissing())return ae("startInviteTargeting"),!1;if(!o.isFeatureEnabled(r.PROPERTY_SETTINGS.MANUALLY_INVITE_TARGETING))return s.showWarning("Manually invite targeting feature is disabled"),!1;E.trigger(r.EVENTS.MDIGITAL_MANUALLY_INVITE_TARGETING,{skipButtonTargeting:!0,skipInviteTargeting:!1})}function kd(){h.setLoggerStatus(!0)}function Ud(){h.setLoggerStatus(!1)}function Gd(){h.printLogs()}function Vd(t){var e=ne.getIntegrationData(t);if(!e){console.log("no integration data!");return}var n={action:"updateIntegrationData",integrations:e,__isDigitalAction:!0},a=o.getMemoryData("formsState");for(var i in a)if(a[i]&&a[i].loaded){var l=o.getFormData(i);if(!l||!l.formDisplay||!l.formDisplay.displayType)continue;if(l.formDisplay.displayType==="popup"){var d=o.getMemoryData("popupHandler");d.postMessage(n,"*")}else s.sendMessageToIframe(o.getFormIframeId(i),n)}return e}var mr={loadForm:Er,showForm:Md,closeForm:Rd,updatePageView:Ld,isSurveyDisplayed:Fd,startInviteTargeting:wd,collectIntegrationData:Vd,startLogger:kd,stopLogger:Ud,printMdigitalLogs:Gd};var gr={formId:null,targetModalId:""},_r=window.top,V={};function xd(){Ue(),E.subscribeMany({neb_formShown:[pr],neb_inviteReady:[Ir],MDigital_noJsonModalShown:[Sr],neb_afterFormClosed:[Hd],neb_inviteAccepted:[Yd],neb_inviteDeclined:[Kd],MDigital_noJsonModalClosed:[Wd],neb_captureImageClicked:[Nt],MDigital_Capture_Cancelled:[Nt]})}function Ue(){Object.assign(V,gr)}function me(t){Object.assign(V,t)}function Bd(){return V}function pr(t,e){var n=e.formId;Rr(n),s.isModalFormType(n)&&(me({formId:n,focusedElement:Ge(n)?V.focusedElement:document.activeElement,targetModalId:o.getFormIframeId(n),isNoJsonModal:!1,isPreview:n!=null&&s.isFormInPreviewContext(n)}),qd(n),s.isSafari()||o.isCustomHtmlForm(n)&&!c.checkProvision(r.PROVISIONS.IS_CHTML_HANDLE_INIT_FOCUS_INDEPENDENTLY)?Dr():k.trapFocus())}function Ir(t,e){var n=e.formId;Lr(n),!o.isNewMobileInvitation()&&(me({formId:n,focusedElement:document.activeElement,targetModalId:r.IFRAME_SETTINGS.INVITATION.IFRAME_ID,isNoJsonModal:!1,isPreview:!1}),Jd(n),s.isSafari()?Dr():k.trapFocus())}function Sr(t,e){me({formId:e.formId,focusedElement:document.activeElement,targetModalId:r.IFRAME_SETTINGS.OOPS.CONTAINER_ID_PREFIX+e.formId,isNoJsonModal:!0,isPreview:!1}),jd(),k.focusOnOopsCloseButton(),k.trapFocus()}function Ge(t){return t!=null&&t==V.formId}function Hd(t,e){Ge(e.formId)&&vr()}function Yd(t,e){Ge(e.formId)&&(Mt(),Rt(),me({targetModalId:null}))}function Kd(t,e){Ge(e.formId)&&Xd()}function Wd(t,e){vr()}function Xd(){Mt(),Rt(),Or(),Ue()}function vr(){Mt(),Pt(),Or(),Ue()}function Ar(){br()}function zd(){if(!V.isPreview)try{_r.addEventListener(r.BROWSER_EVENTS.FOCUS,Ar,!0)}catch(t){Tr(t)}}function Mt(){if(!V.isPreview)try{_r.removeEventListener(r.BROWSER_EVENTS.FOCUS,Ar,!0)}catch(t){Tr(t)}}function Tr(t){h.getLoggerStatus()&&h.error(t)}function Nt(){var t=document.getElementById(V.targetModalId);t&&t.contentWindow&&t.contentWindow.focus()}function br(){V.isNoJsonModal?yr():hr()}function Dr(){s.isSafari()?setTimeout(function(){k.focusOnModal(),k.trapFocus()},0):(k.focusOnModal(),k.trapFocus())}function hr(){var t=document.getElementById(V.targetModalId);s.focusElement(t)}function yr(){var t=document.querySelector("#"+V.targetModalId+" #"+r.IFRAME_SETTINGS.OOPS.CLOSE_BUTTON_ID);s.focusElement(t)}function Or(){var t=V.focusedElement;if(t!=null&&t!==document.body)s.focusElement(t);else if(document.activeElement!==document.body&&s.isSafari()){var e=document.getElementById(V.targetModalId);e!=null&&document.activeElement===e&&(window.focus(),Zd())}}function qd(t){var e={role:"dialog","aria-modal":!0,"aria-label":Mr(t)},n=Cr(t);Pt(),Nr(Object.assign(e,{lang:n}))}function Jd(t){var e={role:"dialog","aria-modal":!0,"aria-label":Pr(t)},n=Cr(t);Rt(),Qd(n!=null?Object.assign(e,{lang:n}):e)}function jd(){var t={role:"alertdialog","aria-modal":!0,"aria-labelledby":"title-no-json-modal","aria-describedby":"description-no-json-modal"},e=$d();Pt(),Nr(e!=null?Object.assign(t,{lang:e}):t)}function Nr(t){k.setDialogAriaAttributes(r.IFRAME_SETTINGS.LIGHTBOX.CONTAINER_ID_PREFIX,t)}function Qd(t){k.setDialogAriaAttributes(r.IFRAME_SETTINGS.INVITATION.WRAPPER_ID,{"aria-live":"polite"}),k.setDialogAriaAttributes(r.IFRAME_SETTINGS.INVITATION.CONTAINER_ID,t)}function Zd(){var t=document.createElement("div");s.addAttributesOnElement(t,{tabindex:"-1","aria-hidden":!0}),document.body.appendChild(t),t.focus(),t.remove()}function $d(){return c.checkProvision(r.PROVISIONS.PROPERTY_MESSAGES)?Y.getPropertyMessageLanguageCode():null}function Cr(t){return N.getFormLanguage(t)}function eu(t,e){var n=document.getElementById(t);n!=null&&s.addAttributesOnElement(n,e)}function Pt(){Ct(r.IFRAME_SETTINGS.LIGHTBOX.CONTAINER_ID_PREFIX)}function Rt(){Ct(r.IFRAME_SETTINGS.INVITATION.WRAPPER_ID),Ct(r.IFRAME_SETTINGS.INVITATION.CONTAINER_ID)}function Ct(t){var e=document.getElementById(t);if(e!=null){var n=["role","aria-modal","aria-label","aria-labelledby","aria-describedby","lang","aria-live"];for(var a in n)s.removeAttribute(e,n[a])}}function Mr(t){var e;return c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)&&(e=o.getMemoryJsonNestedPropertyValue(t,"settings.formBasicSettings.formAnnouncement",!1)),e||r.IFRAME_SETTINGS.IFRAME_TITLE}function Pr(t){var e;return c.checkProvision(r.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)&&(e=o.getMemoryJsonNestedPropertyValue(t,"invitationAnnouncement",!0)),e||r.IFRAME_SETTINGS.INVITATION.IFRAME_TITLE}function Rr(t){var e=o.getFormIframeId(t);if(e!=null){var n=document.getElementById(e);n!=null&&(n.title=Mr(t))}}function Lr(t){var e=document.getElementById(r.IFRAME_SETTINGS.INVITATION.IFRAME_ID);e!=null&&(e.title=Pr(t))}var k={init:xd,initModalState:Ue,onFormShown:pr,onInviteReady:Ir,onNoJsonModalShown:Sr,getModalState:Bd,setModalState:me,setFocus:br,focusOnModal:hr,focusOnOopsCloseButton:yr,trapFocus:zd,refocusForm:Nt,setDialogAriaAttributes:eu,setLocalizedAnnouncementOnForm:Rr,setLocalizedAnnouncementOnInvite:Lr,CURRENT_SHOWN_MODAL_INITIAL_STATE:gr};var Fr={formId:null,targetModalId:""},wr=window.top,Z={};function tu(){re(),E.subscribeMany(x({neb_formShown:[kr],neb_captureImageClicked:[Lt],MDigital_Capture_Cancelled:[Lt],neb_inviteReady:[nu,ge,Ur,Ft],MDigital_noJsonModalShown:[au,ge,Ft],neb_formClosed:[ru],neb_inviteAccepted:[Ve,re],neb_inviteDeclined:[Ve,re],MDigital_noJsonModalClosed:[Ve,re]},c.checkProvision(r.PROVISIONS.WCAG_REVIEW_FIXES)&&{neb_button_displayed:[ou]}))}function re(){Object.assign(Z,Fr)}function kr(t,e){s.isModalFormType(e.formId)&&(xe({formId:e.formId,targetModalId:o.getFormIframeId(e.formId)}),_e.focusOnModal(),_e.trapFocus())}function Lt(){var t=document.getElementById(Z.targetModalId);t&&t.contentWindow&&t.contentWindow.focus()}function xe(t){Object.assign(Z,t)}function ge(){var t=document.getElementById(Z.targetModalId);t&&typeof t.focus=="function"&&t.focus()}function Ur(){var t=document.getElementById(Z.targetModalId),e=s.getNestedPropertyValue(s.getBrowser(),"name");t&&e===r.BROWSERS.FIREFOX&&(t.setAttribute("aria-hidden","true"),setTimeout(function(){t.setAttribute("role","alert"),t.setAttribute("aria-hidden","false")},250))}function Ft(){try{wr.addEventListener(r.BROWSER_EVENTS.FOCUS,ge)}catch(t){Gr(t)}}function nu(t,e){xe({targetModalId:r.IFRAME_SETTINGS.INVITATION.IFRAME_ID})}function au(t,e){xe({targetModalId:r.IFRAME_SETTINGS.OOPS.CONTAINER_ID_PREFIX+e.formId})}function ru(t,e){var n=e.formId;n===Z.formId&&(Ve(),re())}function Ve(){try{wr.removeEventListener(r.BROWSER_EVENTS.FOCUS,ge)}catch(t){Gr(t)}}function Gr(t){h.getLoggerStatus()&&h.error(t)}function iu(){return Z}function ou(t,e){if(e.formClosed){var n=document.getElementById("nebula_div_btn");n&&typeof n.focus=="function"&&n.focus()}}var _e={init:tu,initModalState:re,onFormShown:kr,getModalState:iu,setModalState:xe,focusOnModal:ge,trapFocus:Ft,refocusForm:Lt,announceInvitation:Ur,CURRENT_SHOWN_MODAL_INITIAL_STATE:Fr};function su(){window.KAMPYLE_ONSITE_SDK=mr;var t=location.search.slice(1).split("&").reduce(function(e,n){var a=ke(n.split("="),2),i=a[0],l=a[1];return Object.assign(e,Ie({},i,l))},{});(localStorage.isDebugMode==="true"||t.isDebugMode&&s.isFormInPreviewContext(t.isDebugMode))&&(window.KAMPYLE_DATA=o),window.KAMPYLE_DATA=o,y(r,"KAMPYLE_CONSTANT"),y(s,"KAMPYLE_UTILS"),y(E,"KAMPYLE_EVENT_DISPATCHER"),y(c,"KAMPYLE_FUNC"),y(H,"KAMPYLE_ANIMATION"),y(R,"KAMPYLE_COMMON"),y(ne,"KAMPYLE_INTEGRATION"),y(ye,"KAMPYLE_MESSAGE"),y(T,"KAMPYLE_TARGETING"),y(_,"KAMPYLE_VIEW"),y(G,"MDIGITAL_ELEMENT_BUILDER"),y(M,"FORM_STATE",!0),y(p,"CONFIGURATION",!0),y(Oe,"CUSTOM_EVENTS",!0),y(b,"CUSTOM_PARAMETERS"),y(j,"EMBEDDED",!0),y(z,"INIT",!0),c.checkProvision(r.PROVISIONS.LOCALIZED_FORMS)&&y(N,"LOCALIZATION",!0),y(h,"LOGGER",!0),c.checkProvision(r.PROVISIONS.NEW_MODAL_DIALOGS)&&y(k,"MODAL_DIALOGS",!0),c.checkProvision(r.PROVISIONS.ON_PREM_HYBRID)&&y(J,"ON_PREM",!0),y(Y,"PROPERTY_MESSAGES",!0),y(_e,"WCAG",!0)}var Vr={init:su};z.init();Vr.init();})();
//# sourceMappingURL=generic.js.map
