<!DOCTYPE html>
<!-- saved from url=(0064)https://static.opiniac.com/customers/934/yourcx.alytics.min.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body>
<script type="text/javascript">
var domainTranslation={};
(function(){var domainKey=null;var eventTimer=null;var hasLocalStorageAccess=true;var generalDataInit={geolocation:{longitude:0,altitude:0,accuracy:0,error:null,forceUpdate:true,lastUpdate:null}};var generateGUID=typeof window.crypto!="undefined"&&typeof window.crypto.getRandomValues!="undefined"?function(){var buf=new Uint16Array(8);window.crypto.getRandomValues(buf);var S4=function(num){var ret=num.toString(16);while(ret.length<4){ret="0"+ret}return ret};return S4(buf[0])+S4(buf[1])+"-"+S4(buf[2])+"-"+S4(buf[3])+"-"+S4(buf[4])+"-"+S4(buf[5])+S4(buf[6])+S4(buf[7])}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})};function parseMainDomain(url){var a=document.createElement("a");a.href=url;var parts=a.hostname.split(".");if(parts[0]=="www")parts.shift();if(parts.length>2){if(parts[parts.length-2].length>3)parts.shift()}var domain=parts.join(".");if(typeof domainTranslation[domain]!="undefined")domain=domainTranslation[domain];else{if(typeof domainTranslation["general"]!="undefined"){var i=0,g=null;for(i=0;i<domainTranslation["general"].length;i++){g=domainTranslation["general"][i];if(domain.search(g.pattern)!=-1)domain=g.domain}}}return domain}function updateCounter(){var cnt=JSON.parse(localStorage.getItem("storage.counter"));if(!cnt)cnt={count:1,time:(new Date).getTime()};else cnt={count:cnt.count+1,time:(new Date).getTime()};localStorage.setItem("storage.counter",JSON.stringify(cnt))}function init(event){var originDomain="_"+parseMainDomain(event.origin);var msg=JSON.parse(event.data);if(typeof msg.type=="undefined")throw new Exception("undefined type");msg.orig_type=msg.type;if(msg.type.substring(0,7)=="opiniac")msg.type=msg.type.substring(8);switch(msg.type){case"storage":break;case"storage_general":originDomain=".general";break;case"user_id":break;case"check.localStorage":break;case"event":originDomain=".events";break;default:throw new Exception("wrong type")}domainKey="storage"+originDomain;return msg}function processEventTable(){var eventsDomainKey="storage.events";var eventDomainData=getDomainData(eventsDomainKey);if(!eventDomainData)return;if(eventDomainData.length>0){eventDomainData=processEventTableInner(eventDomainData);setDomainData(eventDomainData,false,eventsDomainKey);if(eventTimer){clearTimeout(eventTimer);eventTimer=null}return}if(!eventTimer&&eventDomainData.length){eventTimer=setTimeout(function(){eventDomainData=getDomainData(eventsDomainKey);eventDomainData=processEventTableInner(eventDomainData);setDomainData(eventDomainData,false,eventsDomainKey);eventTimer=null},234)}else return}function processEventTableInner(_data){if(_data.length<1)return _data;if(!window.XMLHttpRequest)return _data;var xhttp;xhttp=new XMLHttpRequest;xhttp.open("POST","https://events.yourcx.io/events/",true);xhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhttp.send("data="+encodeURIComponent(JSON.stringify(_data)));_data=[];return _data}function getDomainData(_domainKey){_domainKey=_domainKey||domainKey;if(!hasLocalStorageAccess||!localStorage)return null;var domainData=localStorage.getItem(_domainKey);domainData=JSON.parse(domainData);return domainData}function setDomainData(domainData,_updateCounter,_domainKey){_domainKey=_domainKey||domainKey;if(!hasLocalStorageAccess)return;domainData["_last_update"]=(new Date).getTime();localStorage.setItem(_domainKey,JSON.stringify(domainData));if(_updateCounter)updateCounter()}function setGeneralData(msg){var value=null,domainData;switch(msg.key){case"geolocation":domainKey="storage.general";domainData=getDomainData();value={};if(domainData!=null&&typeof domainData[msg.key]!="undefined")value=domainData[msg.key];if(typeof msg.value["error"]!="undefined"&&msg.value["error"]){if(msg.value["error"].code==1){value.forceUpdate=false;value.lastUpdate=(new Date).getTime()}else{value.forceUpdate=true}value.error=msg.value["error"]}else{if(typeof msg.value["longitude"]!="undefined")value.longitude=msg.value["longitude"];if(typeof msg.value["latitude"]!="undefined")value.latitude=msg.value["latitude"];if(typeof msg.value["accuracy"]!="undefined"){if(parseInt(msg.value["accuracy"])<parseInt(value.accuracy)||!value.accuracy){value.accuracy=msg.value["accuracy"];value.forceUpdate=true;if(parseInt(value.accuracy)<200)value.forceUpdate=false}else value.forceUpdate=false}else{value.forceUpdate=true}value.lastUpdate=(new Date).getTime()}domainData[msg.key]=value;setDomainData(domainData,false,domainKey);break}}function handleRequest(event){var msg=null,domainData=null,value=null,tmpKey=null;try{domainKey=null;msg=init(event)}catch(e){return false}switch(msg.func){case"check.localStorage":event.source.postMessage(JSON.stringify({type:msg.orig_type,id:msg.id,key:msg.key,value:hasLocalStorageAccess}),event.origin);break}if(!hasLocalStorageAccess||!localStorage)return false;switch(msg.func){case"user_id":value=localStorage.getItem("storage.user_id");if(!value){value=generateGUID();setDomainData(value,false,"storage.user_id")}event.source.postMessage(JSON.stringify({type:msg.orig_type,id:msg.id,key:msg.key,value:value}),event.origin);break;case"get":domainData=getDomainData();tmpKey=msg.key;if(tmpKey.substring(0,7)=="opiniac")tmpKey=tmpKey.substring(8);else if(tmpKey=="_opiniac_analytics")tmpKey="_analytics";if(domainData!=null&&typeof domainData[tmpKey]!="undefined")value=domainData[tmpKey];event.source.postMessage(JSON.stringify({type:msg.orig_type,id:msg.id,key:msg.key,value:value}),event.origin);break;case"set":if(msg.type=="storage_general")setGeneralData(msg);else{domainData=getDomainData();tmpKey=msg.key;if(tmpKey.substring(0,7)=="opiniac")tmpKey=tmpKey.substring(8);else if(tmpKey=="_opiniac_analytics")tmpKey="_analytics";if(!domainData)domainData={};if(Array.isArray(domainData))domainData={};domainData[tmpKey]=msg.value;setDomainData(domainData,true)}break;case"del":domainData=getDomainData();if(!domainData)return;domainData[msg.key]=null;delete domainData[msg.key];setDomainData(domainData,true);break;case"event":domainData=getDomainData();if(!domainData)domainData=[];domainData.push({key:msg.key,val:msg.value});setDomainData(domainData,false);processEventTable();break}if(msg.func!="event")processEventTable()}try{typeof window.localStorage}catch(error){hasLocalStorageAccess=false}if(window.addEventListener){window.addEventListener("message",handleRequest,false)}else if(window.attachEvent){window.attachEvent("onmessage",handleRequest)}domainKey="storage.general";generalData=getDomainData();if(!generalData)setDomainData(generalDataInit,false);domainKey="storage.user_id";generalData=getDomainData();if(!generalData)setDomainData(generateGUID(),false,"storage.user_id")})();
</script>
</body></html>